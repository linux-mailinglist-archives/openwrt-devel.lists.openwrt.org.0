Return-Path: <openwrt-devel-bounces+lists+openwrt-devel=lfdr.de@lists.openwrt.org>
X-Original-To: lists+openwrt-devel@lfdr.de
Delivered-To: lists+openwrt-devel@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 4F88ECE535
	for <lists+openwrt-devel@lfdr.de>; Mon,  7 Oct 2019 16:29:21 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:
	Content-Transfer-Encoding:Content-Type:Cc:List-Subscribe:List-Help:List-Post:
	List-Archive:List-Unsubscribe:List-Id:Subject:MIME-Version:Message-Id:Date:To
	:From:Reply-To:Content-ID:Content-Description:Resent-Date:Resent-From:
	Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:In-Reply-To:References:
	List-Owner; bh=gJYrHGDxkamEimvhbvh5GcGsd6rzmctfYgdAmwl6/bE=; b=aoY2+3JRVZyDtD
	5beSc82MTG5/p293Jfw75kIxDmzD+Y4d1Xp1JPIuR+Kx0Z/QWuEuQDEHsi4OssrtAHF008ZwaK5K7
	WBtLJXEIiPj/B66AxH9P7ugwu7s293+rx/YIb3LRYyo4wxlZzLmQEtOIbAWmxNoAGUNHTiUZdVaN9
	5S1HMc82WFtijAyR1mtHzn03k+7p4vKvW7T2+zTntwT/eKZSWvefbqKQ9KyFt/muLHNlWZVrMHKnb
	fAT/RJPKUbOKQU/JNHTRzzV+BbSncsDEwX2psIwh748gXQ366eu/3RH8MOvVvWpqzqYzdk/xbOu6i
	avTCjCZrw99UME/0fOqw==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92.2 #3 (Red Hat Linux))
	id 1iHU0X-000446-Lj; Mon, 07 Oct 2019 14:29:05 +0000
Received: from smtp-out.xnet.cz ([178.217.244.18])
 by bombadil.infradead.org with esmtps (Exim 4.92.2 #3 (Red Hat Linux))
 id 1iHU0A-00043H-Ir
 for openwrt-devel@lists.openwrt.org; Mon, 07 Oct 2019 14:28:57 +0000
Received: from meh.true.cz (meh.true.cz [108.61.167.218])
 (Authenticated sender: petr@true.cz)
 by smtp-out.xnet.cz (Postfix) with ESMTPSA id 564BD41FB;
 Mon,  7 Oct 2019 16:28:39 +0200 (CEST)
Received: by meh.true.cz (OpenSMTPD) with ESMTP id 5a03005d;
 Mon, 7 Oct 2019 16:28:29 +0200 (CEST)
From: =?UTF-8?q?Petr=20=C5=A0tetiar?= <ynezz@true.cz>
To: openwrt-devel@lists.openwrt.org
Date: Mon,  7 Oct 2019 16:28:33 +0200
Message-Id: <20191007142833.26168-1-ynezz@true.cz>
MIME-Version: 1.0
X-Spam-Note: CRM114 run bypassed due to message size (232817 bytes)
X-Spam-Score: 0.0 (/)
X-Spam-Report: SpamAssassin version 3.4.2 on bombadil.infradead.org summary:
 Content analysis details:   (0.0 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -0.0 RCVD_IN_DNSWL_NONE     RBL: Sender listed at https://www.dnswl.org/,
 no trust [178.217.244.18 listed in list.dnswl.org]
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
 0.0 SPF_NONE               SPF: sender does not publish an SPF Record
Subject: [OpenWrt-Devel] [PATCH] libnl-tiny: move source code into separate
 Git repository
X-BeenThere: openwrt-devel@lists.openwrt.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <openwrt-devel.lists.openwrt.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/openwrt-devel>, 
 <mailto:openwrt-devel-request@lists.openwrt.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/openwrt-devel/>
List-Post: <mailto:openwrt-devel@lists.openwrt.org>
List-Help: <mailto:openwrt-devel-request@lists.openwrt.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/openwrt-devel>,
 <mailto:openwrt-devel-request@lists.openwrt.org?subject=subscribe>
Cc: =?UTF-8?q?Petr=20=C5=A0tetiar?= <ynezz@true.cz>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: "openwrt-devel" <openwrt-devel-bounces@lists.openwrt.org>
Errors-To: openwrt-devel-bounces+lists+openwrt-devel=lfdr.de@lists.openwrt.org

SW4gb3JkZXIgdG8gbWFrZSB0aGUgc291cmNlIGNvZGUgdXNhYmxlIGFuZCB0ZXN0YWJsZSBzZXBh
cmF0ZWx5IG91dCBvZgpidWlsZHJvb3QuCgpTaWduZWQtb2ZmLWJ5OiBQZXRyIMWgdGV0aWFyIDx5
bmV6ekB0cnVlLmN6PgotLS0KCnRsO2RyIHRoaXMgaXMganVzdCBhIGZpcnN0IHN0ZXAsIGhhdmlu
ZyBtb3JlIGluIHRoZSBwaXBlbGluZVswXQoKSSdtIHdvcmtpbmcgb24gYSBwcm9vZi1vZi1jb25j
ZXB0IENJIHN1aXRlWzFdIGJhc2VkIG9uIEdpdExhYiAoYnV0IGl0IGNvdWxkIGJlCnVzZWQgb24g
YW55dGhpbmcgd2hpY2ggc3VwcG9ydHMgRG9ja2VyKSBhbmQgd2hpY2ggY291bGQgYmUgaG9wZWZ1
bGx5IHJlLXVzZWQKZm9yIENJIHRlc3Rpbmcgb2YgYWxsIE9wZW5XcnQgQyBsYW5ndWFnZSBiYXNl
ZCBwcm9qZWN0cyB3aXRob3V0IG11Y2ggaGFzc2xlLApjdXJyZW50bHkgaXQgYm9pbHMgZG93biB0
byBhYm91dCAzLTcgbGluZXMgb2YgWUFNTCBjb2RlIGluIC5naXRsYWItY2kueW1sCmZpbGVbMl0u
CgpTbyBmYXIgSSd2ZSBhZGRlZCB0d28gQ0kgY29tcGlsZSB0ZXN0c1szXSwgb25lIG9mIHRoZW0g
aXMgYGNpLXNkay1vb3QtYnVpbGRgCndoaWNoIGlzIGJ1aWxkaW5nIHRoZSBzb3VyY2UgY29kZSBv
dXQgb2YgdGhlIHRyZWVbNF0gd2l0aCB0aGUgcHJvdmlkZWQgU0RLIGZvcgphIChyYW5kb21seSBz
ZWxlY3RlZCkgbGlzdCBvZiBwbGF0Zm9ybXMgYXRoNzksIGlteDYsIG1hbHRhX2JlIGFuZAptdmVi
dV9jb3J0ZXhhNTMgaW4gb3JkZXIgdG8gY292ZXIgZGlmZmVyZW50IENQVXMsIGVuZGlhbmVzcywg
cmVnaXN0ZXIgd2lkdGhzCmV0Yy4gVGhpcyB0ZXN0cyB3b3JrcyBmaW5lIHdpdGggdGhlIHNvdXJj
ZSBjb2RlIGluIHRoZSBidWlsZHJvb3QuCgpUaGUgMm5kIHRlc3QgaXMgYSAiZnJhbmtlbnN0ZWlu
IiBvbmVbNV0gY2FsbGVkIGBjaS1uYXRpdmUtY2hlY2tzYCwgd2hpY2ggaXMKY29tcGlsZSB0ZXN0
aW5nIHRoZSBzb3VyY2UgY29kZSBuYXRpdmVseSBvbiB4ODYvNjQgd2l0aCBnY2MtezcsOCw5fSxj
bGFuZy05CmFuZCB0aGVuIHdpdGggc2Nhbi1idWlsZCBhbmQgY3BwY2hlY2sgc3RhdGljIGFuYWx5
emVycy4gVGhpcyBkb2Vzbid0IHdvcmsKY3VycmVudGx5IGZvciBtZSB3aXRoIG9kaGNwZCBhcyBp
dCBkZXBlbmRzIG9uIGxpYm5sLXRpbnksIGFuZCBpbiBvcmRlciB0bwpwcm92aWRlIGxpYm5sLXRp
bnkgb25lIHdvdWxkIG5lZWQgdG8gY2hlY2sgb3V0IGNvbXBsZXRlIE9wZW5XcnQgdHJlZSBpbiBv
cmRlcgp0byBnZXQgaXRzIHNvdXJjZSBjb2RlIGFuZCBidWlsZCBpdC4KClRvIGJlIGNsZWFyLCBn
ZXR0aW5nIHRoZSBzb3VyY2UgY29kZSBpcyBhIG5vIGJyYWluZXIgZm9yIG1lLCBJIGNvdWxkIHNv
bHZlIGl0CnNvbWVob3cgZXZlbiB3aXRoIHRoZSBidWlsZHJvb3QgKHB1dHRpbmcgYXNpZGUgdGhl
IHdhc3RlIG9mIHJlc291cmNlcyksIGJ1dApydW5uaW5nIHRoZSBDSSB0ZXN0IHN1aXRlIG9uIGxp
Ym5sLXRpbnkgaXRzZWxmIHVuY292ZXJzIHNvbWUgaXNzdWVzWzZdIGFuZCBJCnRoaW5rLCB0aGF0
IGl0IHdvdWxkIHNpbXBseSBtYWtlIHNlbnNlIHRvIGFsbG93IHJ1bm5pbmcgb2YgdGhvc2UgdGVz
dCBlYXNpbHkKZm9yIGFueW9uZSAoY2xvbmUgdGhlIHJlcG8gb24gR2l0TGFiOyBwdXNoOyBwcm9m
aXQpIGluIHRoZSBmdXR1cmUgYXMgd2VsbC4KCjAuIGh0dHBzOi8vZ2l0bGFiLmNvbS95bmV6ei9v
cGVud3J0LWxpYm5sLXRpbnkvY29tbWl0cy93aXAKMS4gaHR0cHM6Ly9naXRsYWIuY29tL3luZXp6
L2dpdGxhYi1ldmFsdWF0aW9uL2Jsb2Ivd2lwL2dpdGxhYi1jaS9SRUFETUUubWQKMi4gaHR0cHM6
Ly9naXRsYWIuY29tL3luZXp6L29wZW53cnQtbGlibmwtdGlueS9ibG9iL3dpcC8uZ2l0bGFiLWNp
LnltbAozLiBodHRwczovL2dpdGxhYi5jb20veW5lenovZ2l0bGFiLWV2YWx1YXRpb24vYmxvYi93
aXAvZ2l0bGFiLWNpL2dpdGxhYi1jaS1waXBlbGluZS55bWwKNC4gaHR0cHM6Ly9naXRsYWIuY29t
L3luZXp6L2dpdGxhYi1ldmFsdWF0aW9uL2Jsb2Ivd2lwL2dpdGxhYi1jaS9zZGstYnVpbGQubWsj
TDQ1CjUuIGh0dHBzOi8vZ2l0bGFiLmNvbS95bmV6ei9naXRsYWItZXZhbHVhdGlvbi9ibG9iL3dp
cC9naXRsYWItY2kvbmF0aXZlLWJ1aWxkLm1rCjYuIGh0dHBzOi8veW5lenouZ2l0bGFiLmlvLy0v
b3BlbndydC1saWJubC10aW55Ly0vam9icy8zMTM2ODA4MTUvYXJ0aWZhY3RzL2J1aWxkL3NjYW4v
MjAxOS0xMC0wNy0xMjI3MTUtMTQzLTEvaW5kZXguaHRtbAoKIHBhY2thZ2UvbGlicy9saWJubC10
aW55L01ha2VmaWxlICAgICAgICAgICAgICB8ICAxOSArLQogcGFja2FnZS9saWJzL2xpYm5sLXRp
bnkvZmlsZXMvbGlibmwtdGlueS5wYyAgIHwgIDEwIC0KIHBhY2thZ2UvbGlicy9saWJubC10aW55
L3NyYy9NYWtlZmlsZSAgICAgICAgICB8ICAxNyAtCiBwYWNrYWdlL2xpYnMvbGlibmwtdGlueS9z
cmMvYXR0ci5jICAgICAgICAgICAgfCA2NjggLS0tLS0tLS0tLS0tLS0tLQogcGFja2FnZS9saWJz
L2xpYm5sLXRpbnkvc3JjL2NhY2hlLmMgICAgICAgICAgIHwgMzc2IC0tLS0tLS0tLQogcGFja2Fn
ZS9saWJzL2xpYm5sLXRpbnkvc3JjL2NhY2hlX21uZ3QuYyAgICAgIHwgMTMxIC0tLS0KIHBhY2th
Z2UvbGlicy9saWJubC10aW55L3NyYy9lcnJvci5jICAgICAgICAgICB8IDExNiAtLS0KIHBhY2th
Z2UvbGlicy9saWJubC10aW55L3NyYy9nZW5sLmMgICAgICAgICAgICB8IDI2OCAtLS0tLS0tCiBw
YWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvZ2VubF9jdHJsLmMgICAgICAgfCAzODAgLS0tLS0t
LS0tCiBwYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvZ2VubF9mYW1pbHkuYyAgICAgfCAxNjkg
LS0tLQogcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2dlbmxfbW5ndC5jICAgICAgIHwgMTkz
IC0tLS0tCiBwYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaGFuZGxlcnMuYyAgICAgICAgfCAx
NjIgLS0tLQogLi4uL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay1nZW5lcmljLmggIHwg
IDIwIC0KIC4uLi9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmstbG9jYWwuaCAgICB8IDE2
MCAtLS0tCiAuLi4vbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rLXR5cGVzLmggICAgfCAg
ODggLS0tCiAuLi4vbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL2FkZHIuaCAgICAgfCAg
NjkgLS0KIC4uLi9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvYXR0ci5oICAgICB8IDcy
NiAtLS0tLS0tLS0tLS0tLS0tLS0KIC4uLi9zcmMvaW5jbHVkZS9uZXRsaW5rL2NhY2hlLWFwaS5o
ICAgICAgICAgICB8IDE5OSAtLS0tLQogLi4uL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGlu
ay9jYWNoZS5oICAgIHwgMTI4IC0tLQogLi4uL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGlu
ay9kYXRhLmggICAgIHwgIDQxIC0KIC4uLi9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsv
ZXJybm8uaCAgICB8ICA2NCAtLQogLi4uL3NyYy9pbmNsdWRlL25ldGxpbmsvZ2VubC9jdHJsLmgg
ICAgICAgICAgIHwgIDQwIC0KIC4uLi9zcmMvaW5jbHVkZS9uZXRsaW5rL2dlbmwvZmFtaWx5Lmgg
ICAgICAgICB8IDEzNCAtLS0tCiAuLi4vc3JjL2luY2x1ZGUvbmV0bGluay9nZW5sL2dlbmwuaCAg
ICAgICAgICAgfCAgNDcgLS0KIC4uLi9zcmMvaW5jbHVkZS9uZXRsaW5rL2dlbmwvbW5ndC5oICAg
ICAgICAgICB8ICA4NyAtLS0KIC4uLi9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvaGFu
ZGxlcnMuaCB8IDIzMSAtLS0tLS0KIC4uLi9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsv
bGlzdC5oICAgICB8ICA4OCAtLS0KIC4uLi9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0
bGluay9tc2cuaCB8IDMwOCAtLS0tLS0tLQogLi4uL3NyYy9pbmNsdWRlL25ldGxpbmsvbmV0bGlu
ay1jb21wYXQuaCAgICAgIHwgIDUwIC0tCiAuLi4vc3JjL2luY2x1ZGUvbmV0bGluay9uZXRsaW5r
LWtlcm5lbC5oICAgICAgfCAxOTYgLS0tLS0KIC4uLi9saWJubC10aW55L3NyYy9pbmNsdWRlL25l
dGxpbmsvbmV0bGluay5oICB8ICA4MiAtLQogLi4uL3NyYy9pbmNsdWRlL25ldGxpbmsvb2JqZWN0
LWFwaS5oICAgICAgICAgIHwgMzMxIC0tLS0tLS0tCiAuLi4vbGlibmwtdGlueS9zcmMvaW5jbHVk
ZS9uZXRsaW5rL29iamVjdC5oICAgfCAxNjQgLS0tLQogLi4uL2xpYm5sLXRpbnkvc3JjL2luY2x1
ZGUvbmV0bGluay9zb2NrZXQuaCAgIHwgMjMxIC0tLS0tLQogLi4uL2xpYm5sLXRpbnkvc3JjL2lu
Y2x1ZGUvbmV0bGluay90eXBlcy5oICAgIHwgMTIxIC0tLQogLi4uL2xpYm5sLXRpbnkvc3JjL2lu
Y2x1ZGUvbmV0bGluay91dGlscy5oICAgIHwgIDc4IC0tCiAuLi4vbGlibmwtdGlueS9zcmMvaW5j
bHVkZS9uZXRsaW5rL3ZlcnNpb24uaCAgfCAgMTggLQogcGFja2FnZS9saWJzL2xpYm5sLXRpbnkv
c3JjL2luY2x1ZGUvdW5sLmggICAgIHwgIDQ3IC0tCiBwYWNrYWdlL2xpYnMvbGlibmwtdGlueS9z
cmMvbXNnLmMgICAgICAgICAgICAgfCA1NjEgLS0tLS0tLS0tLS0tLS0KIHBhY2thZ2UvbGlicy9s
aWJubC10aW55L3NyYy9ubC5jICAgICAgICAgICAgICB8IDcyMCAtLS0tLS0tLS0tLS0tLS0tLQog
cGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL29iamVjdC5jICAgICAgICAgIHwgMTQ3IC0tLS0K
IHBhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9zb2NrZXQuYyAgICAgICAgICB8IDQwNiAtLS0t
LS0tLS0tCiBwYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvdW5sLmMgICAgICAgICAgICAgfCAy
ODcgLS0tLS0tLQogNDMgZmlsZXMgY2hhbmdlZCwgMTIgaW5zZXJ0aW9ucygrKSwgODM2NiBkZWxl
dGlvbnMoLSkKIGRlbGV0ZSBtb2RlIDEwMDY0NCBwYWNrYWdlL2xpYnMvbGlibmwtdGlueS9maWxl
cy9saWJubC10aW55LnBjCiBkZWxldGUgbW9kZSAxMDA2NDQgcGFja2FnZS9saWJzL2xpYm5sLXRp
bnkvc3JjL01ha2VmaWxlCiBkZWxldGUgbW9kZSAxMDA2NDQgcGFja2FnZS9saWJzL2xpYm5sLXRp
bnkvc3JjL2F0dHIuYwogZGVsZXRlIG1vZGUgMTAwNjQ0IHBhY2thZ2UvbGlicy9saWJubC10aW55
L3NyYy9jYWNoZS5jCiBkZWxldGUgbW9kZSAxMDA2NDQgcGFja2FnZS9saWJzL2xpYm5sLXRpbnkv
c3JjL2NhY2hlX21uZ3QuYwogZGVsZXRlIG1vZGUgMTAwNjQ0IHBhY2thZ2UvbGlicy9saWJubC10
aW55L3NyYy9lcnJvci5jCiBkZWxldGUgbW9kZSAxMDA2NDQgcGFja2FnZS9saWJzL2xpYm5sLXRp
bnkvc3JjL2dlbmwuYwogZGVsZXRlIG1vZGUgMTAwNjQ0IHBhY2thZ2UvbGlicy9saWJubC10aW55
L3NyYy9nZW5sX2N0cmwuYwogZGVsZXRlIG1vZGUgMTAwNjQ0IHBhY2thZ2UvbGlicy9saWJubC10
aW55L3NyYy9nZW5sX2ZhbWlseS5jCiBkZWxldGUgbW9kZSAxMDA2NDQgcGFja2FnZS9saWJzL2xp
Ym5sLXRpbnkvc3JjL2dlbmxfbW5ndC5jCiBkZWxldGUgbW9kZSAxMDA2NDQgcGFja2FnZS9saWJz
L2xpYm5sLXRpbnkvc3JjL2hhbmRsZXJzLmMKIGRlbGV0ZSBtb2RlIDEwMDY0NCBwYWNrYWdlL2xp
YnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rLWdlbmVyaWMuaAogZGVsZXRlIG1vZGUg
MTAwNjQ0IHBhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmstbG9jYWwu
aAogZGVsZXRlIG1vZGUgMTAwNjQ0IHBhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRl
L25ldGxpbmstdHlwZXMuaAogZGVsZXRlIG1vZGUgMTAwNjQ0IHBhY2thZ2UvbGlicy9saWJubC10
aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvYWRkci5oCiBkZWxldGUgbW9kZSAxMDA2NDQgcGFja2Fn
ZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay9hdHRyLmgKIGRlbGV0ZSBtb2Rl
IDEwMDY0NCBwYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL2NhY2hl
LWFwaS5oCiBkZWxldGUgbW9kZSAxMDA2NDQgcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2lu
Y2x1ZGUvbmV0bGluay9jYWNoZS5oCiBkZWxldGUgbW9kZSAxMDA2NDQgcGFja2FnZS9saWJzL2xp
Ym5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay9kYXRhLmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBw
YWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL2Vycm5vLmgKIGRlbGV0
ZSBtb2RlIDEwMDY0NCBwYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5r
L2dlbmwvY3RybC5oCiBkZWxldGUgbW9kZSAxMDA2NDQgcGFja2FnZS9saWJzL2xpYm5sLXRpbnkv
c3JjL2luY2x1ZGUvbmV0bGluay9nZW5sL2ZhbWlseS5oCiBkZWxldGUgbW9kZSAxMDA2NDQgcGFj
a2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay9nZW5sL2dlbmwuaAogZGVs
ZXRlIG1vZGUgMTAwNjQ0IHBhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxp
bmsvZ2VubC9tbmd0LmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBwYWNrYWdlL2xpYnMvbGlibmwtdGlu
eS9zcmMvaW5jbHVkZS9uZXRsaW5rL2hhbmRsZXJzLmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBwYWNr
YWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL2xpc3QuaAogZGVsZXRlIG1v
ZGUgMTAwNjQ0IHBhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvbXNn
LmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBwYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVk
ZS9uZXRsaW5rL25ldGxpbmstY29tcGF0LmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBwYWNrYWdlL2xp
YnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL25ldGxpbmsta2VybmVsLmgKIGRlbGV0
ZSBtb2RlIDEwMDY0NCBwYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5r
L25ldGxpbmsuaAogZGVsZXRlIG1vZGUgMTAwNjQ0IHBhY2thZ2UvbGlicy9saWJubC10aW55L3Ny
Yy9pbmNsdWRlL25ldGxpbmsvb2JqZWN0LWFwaS5oCiBkZWxldGUgbW9kZSAxMDA2NDQgcGFja2Fn
ZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay9vYmplY3QuaAogZGVsZXRlIG1v
ZGUgMTAwNjQ0IHBhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvc29j
a2V0LmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBwYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5j
bHVkZS9uZXRsaW5rL3R5cGVzLmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBwYWNrYWdlL2xpYnMvbGli
bmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL3V0aWxzLmgKIGRlbGV0ZSBtb2RlIDEwMDY0NCBw
YWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL3ZlcnNpb24uaAogZGVs
ZXRlIG1vZGUgMTAwNjQ0IHBhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL3VubC5o
CiBkZWxldGUgbW9kZSAxMDA2NDQgcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL21zZy5jCiBk
ZWxldGUgbW9kZSAxMDA2NDQgcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL25sLmMKIGRlbGV0
ZSBtb2RlIDEwMDY0NCBwYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvb2JqZWN0LmMKIGRlbGV0
ZSBtb2RlIDEwMDY0NCBwYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvc29ja2V0LmMKIGRlbGV0
ZSBtb2RlIDEwMDY0NCBwYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvdW5sLmMKCmRpZmYgLS1n
aXQgYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9NYWtlZmlsZSBiL3BhY2thZ2UvbGlicy9saWJu
bC10aW55L01ha2VmaWxlCmluZGV4IGNhYmJiMDg0MjE4Zi4uMDUzNmM2YjczZWM3IDEwMDY0NAot
LS0gYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9NYWtlZmlsZQorKysgYi9wYWNrYWdlL2xpYnMv
bGlibmwtdGlueS9NYWtlZmlsZQpAQCAtOCw4ICs4LDEzIEBACiBpbmNsdWRlICQoVE9QRElSKS9y
dWxlcy5tawogCiBQS0dfTkFNRTo9bGlibmwtdGlueQotUEtHX1ZFUlNJT046PTAuMQotUEtHX1JF
TEVBU0U6PTUKK1BLR19SRUxFQVNFOj0xCisKK1BLR19TT1VSQ0VfUFJPVE86PWdpdAorUEtHX1NP
VVJDRV9VUkw9JChQUk9KRUNUX0dJVCkvcHJvamVjdC9saWJubC10aW55LmdpdAorUEtHX1NPVVJD
RV9EQVRFOj0yMDE3LTExLTE2CitQS0dfU09VUkNFX1ZFUlNJT046PThlZTVmM2E0MDIzZjgyMmQx
YzkxNmJiMmI1ZTg0NWQzNTk3YWM2NzQKK1BLR19NSVJST1JfSEFTSDo9ZTNkZDEzN2Q2OTg0OGI4
Y2YyZGJjNThkNzA0NTI1ODZkZDQxNzhiNTU5Nzc4OTZlYTNhOWRlZGFmNjJjNzY4YwogCiBQS0df
TElDRU5TRTo9TEdQTC0yLjEKIFBLR19NQUlOVEFJTkVSOj1GZWxpeCBGaWV0a2F1IDxuYmRAbmJk
Lm5hbWU+CkBAIC0yOSw3ICszNCw3IEBAIGVuZGVmCiBUQVJHRVRfQ0ZMQUdTICs9ICQoRlBJQykK
IAogZGVmaW5lIEJ1aWxkL0NvbXBpbGUKLQkkKE1BS0UpIC1DICQoUEtHX0JVSUxEX0RJUikgXAor
CSQoTUFLRSkgLUMgJChQS0dfQlVJTERfRElSKS9zcmMgXAogCQkkKFRBUkdFVF9DT05GSUdVUkVf
T1BUUykgXAogCQlDRkxBR1M9IiQoVEFSR0VUX0NGTEFHUykiIFwKIAkJYWxsCkBAIC0zNywxNCAr
NDIsMTQgQEAgZW5kZWYKIAogZGVmaW5lIEJ1aWxkL0luc3RhbGxEZXYKIAkkKElOU1RBTExfRElS
KSAkKDEpL3Vzci9saWIvcGtnY29uZmlnICQoMSkvdXNyL2luY2x1ZGUvbGlibmwtdGlueQotCSQo
Q1ApICQoUEtHX0JVSUxEX0RJUikvaW5jbHVkZS8qICQoMSkvdXNyL2luY2x1ZGUvbGlibmwtdGlu
eQotCSQoQ1ApICQoUEtHX0JVSUxEX0RJUikvbGlibmwtdGlueS5zbyAkKDEpL3Vzci9saWIvCi0J
JChDUCkgLi9maWxlcy9saWJubC10aW55LnBjICQoMSkvdXNyL2xpYi9wa2djb25maWcKKwkkKENQ
KSAkKFBLR19CVUlMRF9ESVIpL3NyYy9pbmNsdWRlLyogJCgxKS91c3IvaW5jbHVkZS9saWJubC10
aW55CisJJChDUCkgJChQS0dfQlVJTERfRElSKS9zcmMvbGlibmwtdGlueS5zbyAkKDEpL3Vzci9s
aWIvCisJJChDUCkgJChQS0dfQlVJTERfRElSKS9maWxlcy9saWJubC10aW55LnBjICQoMSkvdXNy
L2xpYi9wa2djb25maWcKIGVuZGVmCiAKIGRlZmluZSBQYWNrYWdlL2xpYm5sLXRpbnkvaW5zdGFs
bAogCSQoSU5TVEFMTF9ESVIpICQoMSkvdXNyL2xpYgotCSQoQ1ApICQoUEtHX0JVSUxEX0RJUikv
bGlibmwtdGlueS5zbyAkKDEpL3Vzci9saWIvCisJJChDUCkgJChQS0dfQlVJTERfRElSKS9zcmMv
bGlibmwtdGlueS5zbyAkKDEpL3Vzci9saWIvCiBlbmRlZgogCiAkKGV2YWwgJChjYWxsIEJ1aWxk
UGFja2FnZSxsaWJubC10aW55KSkKZGlmZiAtLWdpdCBhL3BhY2thZ2UvbGlicy9saWJubC10aW55
L2ZpbGVzL2xpYm5sLXRpbnkucGMgYi9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9maWxlcy9saWJu
bC10aW55LnBjCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCBhZjc5Y2QzMDFlMjMuLjAw
MDAwMDAwMDAwMAotLS0gYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9maWxlcy9saWJubC10aW55
LnBjCisrKyAvZGV2L251bGwKQEAgLTEsMTAgKzAsMCBAQAotcHJlZml4PS91c3IKLWV4ZWNfcHJl
Zml4PS91c3IKLWxpYmRpcj0ke2V4ZWNfcHJlZml4fS9saWIKLWluY2x1ZGVkaXI9JHtwcmVmaXh9
L2luY2x1ZGUvbGlibmwtdGlueQotCi1OYW1lOiBsaWJubC10aW55Ci1EZXNjcmlwdGlvbjogQ29u
dmVuaWVuY2UgbGlicmFyeSBmb3IgbmV0bGluayBzb2NrZXRzCi1WZXJzaW9uOiAyLjAKLUxpYnM6
IC1MJHtsaWJkaXJ9IC1sbmwtdGlueQotQ2ZsYWdzOiAtSSR7aW5jbHVkZWRpcn0KZGlmZiAtLWdp
dCBhL3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9NYWtlZmlsZSBiL3BhY2thZ2UvbGlicy9s
aWJubC10aW55L3NyYy9NYWtlZmlsZQpkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggNmYz
NzE2MGE4YzM1Li4wMDAwMDAwMDAwMDAKLS0tIGEvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3Jj
L01ha2VmaWxlCisrKyAvZGV2L251bGwKQEAgLTEsMTcgKzAsMCBAQAotQ0M9Z2NjCi1XRkxBR1M9
LVdhbGwKLUNGTEFHUz0tTzIKLUlOQ0xVREVTPS1JaW5jbHVkZQotCi1MSUJOQU1FPWxpYm5sLXRp
bnkuc28KLQotYWxsOiAkKExJQk5BTUUpCi0KLSUubzogJS5jCi0JJChDQykgJChXRkxBR1MpIC1j
IC1vICRAICQoSU5DTFVERVMpICQoQ0ZMQUdTKSAkPAotCi1MSUJOTF9PQko9bmwubyBoYW5kbGVy
cy5vIG1zZy5vIGF0dHIubyBjYWNoZS5vIGNhY2hlX21uZ3QubyBvYmplY3QubyBzb2NrZXQubyBl
cnJvci5vCi1HRU5MX09CSj1nZW5sLm8gZ2VubF9mYW1pbHkubyBnZW5sX2N0cmwubyBnZW5sX21u
Z3QubyB1bmwubwotCi0kKExJQk5BTUUpOiAkKExJQk5MX09CSikgJChHRU5MX09CSikKLQkkKEND
KSAkKENGTEFHUykgLVdsLC1Cc3ltYm9saWMtZnVuY3Rpb25zIC1zaGFyZWQgLW8gJEAgJF4KZGlm
ZiAtLWdpdCBhL3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9hdHRyLmMgYi9wYWNrYWdlL2xp
YnMvbGlibmwtdGlueS9zcmMvYXR0ci5jCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCBl
MGY1MDYxMWNmZjkuLjAwMDAwMDAwMDAwMAotLS0gYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9z
cmMvYXR0ci5jCisrKyAvZGV2L251bGwKQEAgLTEsNjY4ICswLDAgQEAKLS8qCi0gKiBsaWIvYXR0
ci5jCQlOZXRsaW5rIEF0dHJpYnV0ZXMKLSAqCi0gKglUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0
d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCi0gKgltb2RpZnkgaXQgdW5kZXIg
dGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCi0gKglMaWNlbnNlIGFz
IHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIHZlcnNpb24gMi4xCi0g
KglvZiB0aGUgTGljZW5zZS4KLSAqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMDMtMjAwOCBUaG9tYXMg
R3JhZiA8dGdyYWZAc3V1Zy5jaD4KLSAqLwotCi0jaW5jbHVkZSA8bmV0bGluay1sb2NhbC5oPgot
I2luY2x1ZGUgPG5ldGxpbmsvbmV0bGluay5oPgotI2luY2x1ZGUgPG5ldGxpbmsvdXRpbHMuaD4K
LSNpbmNsdWRlIDxuZXRsaW5rL2FkZHIuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL2F0dHIuaD4KLSNp
bmNsdWRlIDxuZXRsaW5rL21zZy5oPgotI2luY2x1ZGUgPGxpbnV4L3NvY2tldC5oPgotCi0vKioK
LSAqIEBpbmdyb3VwIG1zZwotICogQGRlZmdyb3VwIGF0dHIgQXR0cmlidXRlcwotICogTmV0bGlu
ayBBdHRyaWJ1dGVzIENvbnN0cnVjdGlvbi9QYXJzaW5nIEludGVyZmFjZQotICoKLSAqIFxzZWN0
aW9uIGF0dHJfc2VjIE5ldGxpbmsgQXR0cmlidXRlcwotICogTmV0bGluayBhdHRyaWJ1dGVzIGFs
bG93IGZvciBkYXRhIGNodW5rcyBvZiBhcmJpdGFyeSBsZW5ndGggdG8gYmUKLSAqIGF0dGFjaGVk
IHRvIGEgbmV0bGluayBtZXNzYWdlLiBFYWNoIGF0dHJpYnV0ZSBpcyBlbmNvZGVkIHdpdGggYQot
ICogdHlwZSBhbmQgbGVuZ3RoIGZpZWxkLCBib3RoIDE2IGJpdHMsIHN0b3JlZCBpbiB0aGUgYXR0
cmlidXRlIGhlYWRlcgotICogcHJlY2VkaW5nIHRoZSBhdHRyaWJ1dGUgZGF0YS4gVGhlIG1haW4g
YWR2YW50YWdlIG9mIHVzaW5nIGF0dHJpYnV0ZXMKLSAqIG92ZXIgcGFja2luZyBldmVyeXRoaW5n
IGludG8gdGhlIGZhbWlseSBoZWFkZXIgaXMgdGhhdCB0aGUgaW50ZXJmYWNlCi0gKiBzdGF5cyBl
eHRlbmRhYmxlIGFzIG5ldyBhdHRyaWJ1dGVzIGNhbiBzdXBlcnNlZGUgb2xkIGF0dHJpYnV0ZXMg
d2hpbGUKLSAqIHJlbWFpbmluZyBiYWNrd2FyZHMgY29tcGF0aWJsZS4gQWxzbyBhdHRyaWJ1dGVz
IGNhbiBiZSBkZWZpbmVkIG9wdGlvbmFsCi0gKiB0aHVzIGF2b2lkaW5nIHRoZSB0cmFuc21pc3Np
b24gb2YgdW5uZWNlc3NhcnkgZW1wdHkgZGF0YSBibG9ja3MuCi0gKiBTcGVjaWFsIG5lc3RlZCBh
dHRyaWJ1dGVzIGFsbG93IGZvciBtb3JlIGNvbXBsZXggZGF0YSBzdHJ1Y3R1cmVzIHRvCi0gKiBi
ZSB0cmFuc21pdHRlZCwgZS5nLiB0cmVlcywgbGlzdHMsIGV0Yy4KLSAqCi0gKiBXaGlsZSBub3Qg
cmVxdWlyZWQsIG5ldGxpbmsgYXR0cmlidXRlcyB0eXBpY2FsbHkgZm9sbG93IHRoZSBmYW1pbHkK
LSAqIGhlYWRlciBvZiBhIG5ldGxpbmsgbWVzc2FnZSBhbmQgbXVzdCBiZSBwcm9wZXJseSBhbGln
bmVkIHRvIE5MQV9BTElHTlRPOgotICogQGNvZGUKLSAqICAgKy0tLS0tLS0tLS0tLS0tLS0rLSAt
IC0rLS0tLS0tLS0tLS0tLS0tKy0gLSAtKy0tLS0tLS0tLS0tLSstIC0gLSsKLSAqICAgfCBOZXRs
aW5rIEhlYWRlciB8IFBhZCB8IEZhbWlseSBIZWFkZXIgfCBQYWQgfCBBdHRyaWJ1dGVzIHwgUGFk
IHwKLSAqICAgKy0tLS0tLS0tLS0tLS0tLS0rLSAtIC0rLS0tLS0tLS0tLS0tLS0tKy0gLSAtKy0t
LS0tLS0tLS0tLSstIC0gLSsKLSAqIEBlbmRjb2RlCi0gKgotICogVGhlIGFjdHVhbCBhdHRyaWJ1
dGVzIGFyZSBjaGFpbmVkIHRvZ2V0aGVyIGVhY2ggc2VwYXJhdGVseSBhbGlnbmVkIHRvCi0gKiBO
TEFfQUxJR05UTy4gVGhlIHBvc2l0aW9uIG9mIGFuIGF0dHJpYnV0ZSBpcyBkZWZpbmVkIGJhc2Vk
IG9uIHRoZQotICogbGVuZ3RoIGZpZWxkIG9mIHRoZSBwcmVjZWRpbmcgYXR0cmlidXRlczoKLSAq
IEBjb2RlCi0gKiAgICstLS0tLS0tLS0tLS0tKy0gLSAtKy0tLS0tLS0tLS0tLS0rLSAtIC0rLS0t
LS0tCi0gKiAgIHwgQXR0cmlidXRlIDEgfCBQYWQgfCBBdHRyaWJ1dGUgMiB8IFBhZCB8IC4uLgot
ICogICArLS0tLS0tLS0tLS0tLSstIC0gLSstLS0tLS0tLS0tLS0tKy0gLSAtKy0tLS0tLQotICog
ICBubGFfbmV4dChhdHRyMSktLS0tLS1eCi0gKiBAZW5kY29kZQotICoKLSAqIFRoZSBhdHRyaWJ1
dGUgaXRzZWxmIGNvbnNpc3RzIG9mIHRoZSBhdHRyaWJ1dGUgaGVhZGVyIGZvbGxvd2VkIGJ5Ci0g
KiB0aGUgYWN0dWFsIHBheWxvYWQgYWxzbyBhbGlnbmVkIHRvIE5MQV9BTElHTlRPLiBUaGUgZnVu
Y3Rpb24gbmxhX2RhdGEoKQotICogcmV0dXJucyBhIHBvaW50ZXIgdG8gdGhlIHN0YXJ0IG9mIHRo
ZSBwYXlsb2FkIHdoaWxlIG5sYV9sZW4oKSByZXR1cm5zCi0gKiB0aGUgbGVuZ3RoIG9mIHRoZSBw
YXlsb2FkIGluIGJ5dGVzLgotICoKLSAqIFxiIE5vdGU6IEJlIGF3YXJlLCBOTEFfQUxJR05UTyBl
cXVhbHMgdG8gNCBieXRlcywgdGhlcmVmb3JlIGl0IGlzIG5vdAotICogc2FmZSB0byBkZXJlZmVy
ZW5jZSBhbnkgNjQgYml0IGRhdGEgdHlwZXMgZGlyZWN0bHkuCi0gKgotICogQGNvZGUKLSAqICAg
IDwtLS0tLS0tLS0tLSBubGFfdG90YWxfc2l6ZShwYXlsb2FkKSAtLS0tLS0tLS0tLT4KLSAqICAg
IDwtLS0tLS0tLSBubGFfYXR0cl9zaXplKHBheWxvYWQpIC0tLS0tLS0tLT4KLSAqICAgKy0tLS0t
LS0tLS0tLS0tLS0tLSstIC0gLSstIC0gLSAtIC0gLSAtIC0gLSArLSAtIC0rCi0gKiAgIHwgQXR0
cmlidXRlIEhlYWRlciB8IFBhZCB8ICAgICBQYXlsb2FkICAgICAgfCBQYWQgfAotICogICArLS0t
LS0tLS0tLS0tLS0tLS0tKy0gLSAtKy0gLSAtIC0gLSAtIC0gLSAtICstIC0gLSsKLSAqICAgbmxh
X2RhdGEobmxhKS0tLS0tLS0tLS0tLS1eCi0gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
PC0gbmxhX2xlbihubGEpIC0+Ci0gKiBAZW5kY29kZQotICoKLSAqIEBzdWJzZWN0aW9uIGF0dHJf
ZGF0YXR5cGVzIEF0dHJpYnV0ZSBEYXRhIFR5cGVzCi0gKiBBIG51bWJlciBvZiBiYXNpYyBkYXRh
IHR5cGVzIGFyZSBzdXBwb3J0ZWQgdG8gc2ltcGxpZnkgYWNjZXNzIGFuZAotICogdmFsaWRhdGlv
biBvZiBuZXRsaW5rIGF0dHJpYnV0ZXMuIFRoaXMgZGF0YSB0eXBlIGluZm9ybWF0aW9uIGlzCi0g
KiBub3QgZW5jb2RlZCBpbiB0aGUgYXR0cmlidXRlLCBib3RoIHRoZSBrZXJuZWwgYW5kIHVzZXJz
cGFjZSBwYXJ0Ci0gKiBhcmUgcmVxdWlyZWQgdG8gc2hhcmUgdGhpcyBpbmZvcm1hdGlvbiBvbiB0
aGVpciBvd24uCi0gKgotICogT25lIG9mIHRoZSBtYWpvciBhZHZhbnRhZ2VzIG9mIHRoZXNlIGJh
c2ljIHR5cGVzIGlzIHRoZSBhdXRvbWF0aWMKLSAqIHZhbGlkYXRpb24gb2YgZWFjaCBhdHRyaWJ1
dGUgYmFzZWQgb24gYW4gYXR0cmlidXRlIHBvbGljeS4gVGhlCi0gKiB2YWxpZGF0aW9uIGNvdmVy
cyBtb3N0IG9mIHRoZSBjaGVja3MgcmVxdWlyZWQgdG8gc2FmZWx5IHVzZQotICogYXR0cmlidXRl
cyBhbmQgdGh1cyBrZWVwcyB0aGUgaW5kaXZpZHVhbCBzYW5pdHkgY2hlY2sgdG8gYSBtaW5pbXVt
LgotICoKLSAqIE5ldmVyIGFjY2VzcyBhdHRyaWJ1dGUgcGF5bG9hZCB3aXRob3V0IGVuc3VyaW5n
IGJhc2ljIHZhbGlkYXRpb24KLSAqIGZpcnN0LCBhdHRyaWJ1dGVzIG1heToKLSAqIC0gbm90IGJl
IHByZXNlbnQgZXZlbiB0aG91Z2ggcmVxdWlyZWQKLSAqIC0gY29udGFpbiBsZXNzIGFjdHVhbCBw
YXlsb2FkIHRoYW4gZXhwZWN0ZWQKLSAqIC0gZmFrZSBhIGF0dHJpYnV0ZSBsZW5ndGggd2hpY2gg
ZXhjZWVkcyB0aGUgZW5kIG9mIHRoZSBtZXNzYWdlCi0gKiAtIGNvbnRhaW4gdW50ZXJtaW5hdGVk
IGNoYXJhY3RlciBzdHJpbmdzCi0gKgotICogUG9saWNpZXMgYXJlIGRlZmluZWQgYXMgYXJyYXkg
b2YgdGhlIHN0cnVjdCBubGFfcG9saWN5LiBUaGUgYXJyYXkgaXMKLSAqIGluZGV4ZWQgd2l0aCB0
aGUgYXR0cmlidXRlIHR5cGUsIHRoZXJlZm9yZSB0aGUgYXJyYXkgbXVzdCBiZSBzaXplZAotICog
YWNjb3JkaW5nbHkuCi0gKiBAY29kZQotICogc3RhdGljIHN0cnVjdCBubGFfcG9saWN5IG15X3Bv
bGljeVtBVFRSX01BWCsxXSA9IHsKLSAqIAlbQVRUUl9GT09dID0geyAudHlwZSA9IC4uLiwgLm1p
bmxlbiA9IC4uLiwgLm1heGxlbiA9IC4uLiB9LAotICogfTsKLSAqCi0gKiBlcnIgPSBubGFfdmFs
aWRhdGUoYXR0cnMsIGF0dHJsZW4sIEFUVFJfTUFYLCAmbXlfcG9saWN5KTsKLSAqIEBlbmRjb2Rl
Ci0gKgotICogU29tZSBiYXNpYyB2YWxpZGF0aW9ucyBhcmUgcGVyZm9ybWVkIG9uIGV2ZXJ5IGF0
dHJpYnV0ZSwgcmVnYXJkbGVzcyBvZiB0eXBlLgotICogLSBJZiB0aGUgYXR0cmlidXRlIHR5cGUg
ZXhjZWVkcyB0aGUgbWF4aW11bSBhdHRyaWJ1dGUgdHlwZSBzcGVjaWZpZWQgb3IKLSAqICAgdGhl
IGF0dHJpYnV0ZSB0eXBlIGlzIGxlc3Nlci1vci1lcXVhbCB0aGFuIHplcm8sIHRoZSBhdHRyaWJ1
dGUgd2lsbAotICogICBiZSBzaWxlbnRseSBpZ25vcmVkLgotICogLSBJZiB0aGUgcGF5bG9hZCBs
ZW5ndGggZmFsbHMgYmVsb3cgdGhlIFxhIG1pbmxlbiB2YWx1ZSB0aGUgYXR0cmlidXRlCi0gKiAg
IHdpbGwgYmUgcmVqZWN0ZWQuCi0gKiAtIElmIFxhIG1heGxlbiBpcyBub24temVybyBhbmQgdGhl
IHBheWxvYWQgbGVuZ3RoIGV4Y2VlZHMgdGhlIFxhIG1heGxlbgotICogICB2YWx1ZSB0aGUgYXR0
cmlidXRlIHdpbGwgYmUgcmVqZWN0ZWQuCi0gKgotICoKLSAqIEBwYXIgVW5zcGVjaWZpYyBBdHRy
aWJ1dGUgKE5MQV9VTlNQRUMpCi0gKiBUaGlzIGlzIHRoZSBzdGFuZGFyZCB0eXBlIGlmIG5vIHR5
cGUgaXMgc3BlY2lmaWVkLiBJdCBpcyB1c2VkIGZvcgotICogYmluYXJ5IGRhdGEgb2YgYXJiaXRh
cnkgbGVuZ3RoLiBUeXBpY2FsbHkgdGhpcyBhdHRyaWJ1dGUgY2FycmllcwotICogYSBiaW5hcnkg
c3RydWN0dXJlIG9yIGEgc3RyZWFtIG9mIGJ5dGVzLgotICogQHBhcgotICogQGNvZGUKLSAqIC8v
IEluIHRoaXMgZXhhbXBsZSwgd2Ugd2lsbCBhc3N1bWUgYSBiaW5hcnkgc3RydWN0dXJlIHJlcXVp
cmVzIHRvCi0gKiAvLyBiZSB0cmFuc21pdHRlZC4gVGhlIGRlZmluaXRpb24gb2YgdGhlIHN0cnVj
dHVyZSB3aWxsIHR5cGljYWxseQotICogLy8gZ28gaW50byBhIGhlYWRlciBmaWxlIGF2YWlsYWJs
ZSB0byBib3RoIHRoZSBrZXJuZWwgYW5kIHVzZXJzcGFjZQotICogLy8gc2lkZS4KLSAqIC8vCi0g
KiAvLyBOb3RlOiBCZSBjYXJlZnVsIHdoZW4gcHV0dGluZyA2NCBiaXQgZGF0YSB0eXBlcyBpbnRv
IGEgc3RydWN0dXJlLgotICogLy8gVGhlIGF0dHJpYnV0ZSBwYXlsb2FkIGlzIG9ubHkgYWxpZ25l
ZCB0byA0IGJ5dGVzLCBkZXJlZmVyZW5jaW5nCi0gKiAvLyB0aGUgbWVtYmVyIG1heSBmYWlsLgot
ICogc3RydWN0IG15X3N0cnVjdCB7Ci0gKiAgICAgaW50IGE7Ci0gKiAgICAgaW50IGI7Ci0gKiB9
OwotICoKLSAqIC8vIFRoZSB2YWxpZGF0aW9uIGZ1bmN0aW9uIHdpbGwgbm90IGVuZm9yY2UgYW4g
ZXhhY3QgbGVuZ3RoIG1hdGNoIHRvCi0gKiAvLyBhbGxvdyBzdHJ1Y3R1cmVzIHRvIGdyb3cgYXMg
cmVxdWlyZWQuIE5vdGU6IFdoaWxlIGl0IGlzIGFsbG93ZWQKLSAqIC8vIHRvIGFkZCBtZW1iZXJz
IHRvIHRoZSBlbmQgb2YgdGhlIHN0cnVjdHVyZSwgY2hhbmdpbmcgdGhlIG9yZGVyIG9yCi0gKiAv
LyBpbnNlcnRpbmcgbWVtYmVycyBpbiB0aGUgbWlkZGxlIG9mIHRoZSBzdHJ1Y3R1cmUgd2lsbCBi
cmVhayB5b3VyCi0gKiAvLyBiaW5hcnkgaW50ZXJmYWNlLgotICogc3RhdGljIHN0cnVjdCBubGFf
cG9saWN5IG15X3BvbGljeVtBVFRSX01BWCsxXSA9IHsKLSAqICAgICBbQVRUUl9NWV9TVFJJQ1Rd
ID0geyAudHlwZSA9IE5MQV9VTlNQRUMsCi0gKiAgICAgICAgICAgICAgICAgICAgICAgICAgLm1p
bmxlbiA9IHNpemVvZihzdHJ1Y3QgbXlfc3RydWN0KSB9LAotICoKLSAqIC8vIFRoZSBiaW5hcnkg
c3RydWN0dXJlIGlzIGFwcGVuZWQgdG8gdGhlIG1lc3NhZ2UgdXNpbmcgbmxhX3B1dCgpCi0gKiBz
dHJ1Y3QgbXlfc3RydWN0IGZvbyA9IHsgLmEgPSAxLCAuYiA9IDIgfTsKLSAqIG5sYV9wdXQobXNn
LCBBVFRSX01ZX1NUUlVDVCwgc2l6ZW9mKGZvbyksICZmb28pOwotICoKLSAqIC8vIE9uIHRoZSBy
ZWNlaXZpbmcgc2lkZSwgYSBwb2ludGVyIHRvIHRoZSBzdHJ1Y3R1cmUgcG9pbnRpbmcgaW5zaWRl
Ci0gKiAvLyB0aGUgbWVzc2FnZSBwYXlsb2FkIGlzIHJldHVybmVkIGJ5IG5sYV9nZXQoKS4KLSAq
IGlmIChhdHRyc1tBVFRSX01ZX1NUUlVDVF0pCi0gKiAgICAgc3RydWN0IG15X3N0cnVjdCAqZm9v
ID0gbmxhX2dldChhdHRyc1tBVFRSX01ZX1NUUlVDVF0pOwotICogQGVuZGNvZGUKLSAqCi0gKiBA
cGFyIEludGVnZXJzIChOTEFfVTgsIE5MQV9VMTYsIE5MQV9VMzIsIE5MQV9VNjQpCi0gKiBJbnRl
Z2VycyBjb21lIGluIGRpZmZlcmVudCBzaXplcyBmcm9tIDggYml0IHRvIDY0IGJpdC4gSG93ZXZl
ciwgc2luY2UgdGhlCi0gKiBwYXlsb2FkIGxlbmd0aCBpcyBhbGlnbmVkIHRvIDQgYnl0ZXMsIGlu
dGVnZXJzIHNtYWxsZXIgdGhhbiAzMiBiaXQgYXJlCi0gKiBvbmx5IHVzZWZ1bCB0byBlbmZvcmNl
IHRoZSBtYXhpbXVtIHJhbmdlIG9mIHZhbHVlcy4KLSAqIEBwYXIKLSAqIFxiIE5vdGU6IFRoZXJl
IGlzIG5vIGRpZmZlcmVuY2UgbWFkZSBiZXR3ZWVuIHNpZ25lZCBhbmQgdW5zaWduZWQgaW50ZWdl
cnMuCi0gKiBUaGUgdmFsaWRhdGlvbiBvbmx5IGVuZm9yY2VzIHRoZSBtaW5pbWFsIHBheWxvYWQg
bGVuZ3RoIHJlcXVpcmVkIHRvIHN0b3JlCi0gKiBhbiBpbnRlZ2VyIG9mIHNwZWNpZmllZCB0eXBl
LgotICogQHBhcgotICogQGNvZGUKLSAqIC8vIEV2ZW4gdGhvdWdoIHBvc3NpYmxlLCBpdCBkb2Vz
IG5vdCBtYWtlIHNlbnNlIHRvIHNwZWNpZnkgLm1pbmxlbiBvcgotICogLy8gLm1heGxlbiBmb3Ig
aW50ZWdlciB0eXBlcy4gVGhlIGRhdGEgdHlwZXMgaW1wbGllcyB0aGUgY29ycmVzcG9uZGluZwot
ICogLy8gbWluaW1hbCBwYXlsb2FkIGxlbmd0aC4KLSAqIHN0YXRpYyBzdHJ1Y3QgbmxhX3BvbGlj
eSBteV9wb2xpY3lbQVRUUl9NQVgrMV0gPSB7Ci0gKiAgICAgW0FUVFJfRk9PXSA9IHsgLnR5cGUg
PSBOTEFfVTMyIH0sCi0gKgotICogLy8gTnVtZXJpYyB2YWx1ZXMgY2FuIGJlIGFwcGVuZGVkIGRp
cmVjdGx5IHVzaW5nIHRoZSByZXNwZWN0aXZlCi0gKiAvLyBubGFfcHV0X3V4eHgoKSBmdW5jdGlv
bgotICogbmxhX3B1dF91MzIobXNnLCBBVFRSX0ZPTywgMTIzKTsKLSAqCi0gKiAvLyBTYW1lIGZv
ciB0aGUgcmVjZWl2aW5nIHNpZGUuCi0gKiBpZiAoYXR0cnNbQVRUUl9GT09dKQotICogICAgIHVp
bnQzMl90IGZvbyA9IG5sYV9nZXRfdTMyKGF0dHJzW0FUVFJfRk9PXSk7Ci0gKiBAZW5kY29kZQot
ICoKLSAqIEBwYXIgQ2hhcmFjdGVyIHN0cmluZyAoTkxBX1NUUklORykKLSAqIFRoaXMgZGF0YSB0
eXBlIHJlcHJlc2VudHMgYSBOVUwgdGVybWluYXRlZCBjaGFyYWN0ZXIgc3RyaW5nIG9mIHZhcmlh
YmxlCi0gKiBsZW5ndGguIEZvciBiaW5hcnkgZGF0YSBzdHJlYW1zIHRoZSB0eXBlIE5MQV9VTlNQ
RUMgaXMgcmVjb21tZW5kZWQuCi0gKiBAcGFyCi0gKiBAY29kZQotICogLy8gRW5mb3JjZSBhIE5V
TCB0ZXJtaW5hdGVkIGNoYXJhY3RlciBzdHJpbmcgb2YgYXQgbW9zdCA0IGNoYXJhY3RlcnMKLSAq
IC8vIGluY2x1ZGluZyB0aGUgTlVMIHRlcm1pbmF0aW9uLgotICogc3RhdGljIHN0cnVjdCBubGFf
cG9saWN5IG15X3BvbGljeVtBVFRSX01BWCsxXSA9IHsKLSAqICAgICBbQVRUUl9CQVJdID0geyAu
dHlwZSA9IE5MQV9TVFJJTkcsIG1heGxlbiA9IDQgfSwKLSAqCi0gKiAvLyBubGFfcHV0X3N0cmlu
ZygpIGNyZWF0ZXMgYSBzdHJpbmcgYXR0cmlidXRlIG9mIHRoZSBuZWNlc3NhcnkgbGVuZ3RoCi0g
KiAvLyBhbmQgYXBwZW5kcyBpdCB0byB0aGUgbWVzc2FnZSBpbmNsdWRpbmcgdGhlIE5VTCB0ZXJt
aW5hdGlvbi4KLSAqIG5sYV9wdXRfc3RyaW5nKG1zZywgQVRUUl9CQVIsICJzb21lIHRleHQiKTsK
LSAqCi0gKiAvLyBJdCBpcyBzYWZlIHRvIHVzZSB0aGUgcmV0dXJuZWQgY2hhcmFjdGVyIHN0cmlu
ZyBkaXJlY3RseSBpZiB0aGUKLSAqIC8vIGF0dHJpYnV0ZSBoYXMgYmVlbiB2YWxpZGF0ZWQgYXMg
dGhlIHZhbGlkYXRpb24gZW5mb3JjZXMgdGhlIHByb3BlcgotICogLy8gdGVybWluYXRpb24gb2Yg
dGhlIHN0cmluZy4KLSAqIGlmIChhdHRyc1tBVFRSX0JBUl0pCi0gKiAgICAgY2hhciAqdGV4dCA9
IG5sYV9nZXRfc3RyaW5nKGF0dHJzW0FUVFJfQkFSXSk7Ci0gKiBAZW5kY29kZQotICoKLSAqIEBw
YXIgRmxhZyAoTkxBX0ZMQUcpCi0gKiBUaGlzIGF0dHJpYnV0ZSB0eXBlIG1heSBiZSB1c2VkIHRv
IGluZGljYXRlIHRoZSBwcmVzZW5jZSBvZiBhIGZsYWcuIFRoZQotICogYXR0cmlidXRlIGlzIG9u
bHkgdmFsaWQgaWYgdGhlIHBheWxvYWQgbGVuZ3RoIGlzIHplcm8uIFRoZSBwcmVzZW5jZSBvZgot
ICogdGhlIGF0dHJpYnV0ZSBoZWFkZXIgaW5kaWNhdGVzIHRoZSBwcmVzZW5jZSBvZiB0aGUgZmxh
Zy4KLSAqIEBwYXIKLSAqIEBjb2RlCi0gKiAvLyBUaGlzIGF0dHJpYnV0ZSB0eXBlIGlzIHNwZWNp
YWwgYXMgLm1pbmxlbiBhbmQgLm1heGxlbiBoYXZlIG5vIGVmZmVjdC4KLSAqIHN0YXRpYyBzdHJ1
Y3QgbmxhX3BvbGljeSBteV9wb2xpY3lbQVRUUl9NQVgrMV0gPSB7Ci0gKiAgICAgW0FUVFJfRkxB
R10gPSB7IC50eXBlID0gTkxBX0ZMQUcgfSwKLSAqCi0gKiAvLyBubGFfcHV0X2ZsYWcoKSBhcHBl
bmRzIGEgemVybyBzaXplZCBhdHRyaWJ1dGUgdG8gdGhlIG1lc3NhZ2UuCi0gKiBubGFfcHV0X2Zs
YWcobXNnLCBBVFRSX0ZMQUcpOwotICoKLSAqIC8vIFRoZXJlIGlzIG5vIG5lZWQgZm9yIGEgcmVj
ZWl2YWwgZnVuY3Rpb24sIHRoZSBwcmVzZW5jZSBpcyB0aGUgdmFsdWUuCi0gKiBpZiAoYXR0cnNb
QVRUUl9GTEFHXSkKLSAqICAgICAvLyBmbGFnIGlzIHByZXNlbnQKLSAqIEBlbmRjb2RlCi0gKgot
ICogQHBhciBNaWNybyBTZWNvbmRzIChOTEFfTVNFQ1MpCi0gKgotICogQHBhciBOZXN0ZWQgQXR0
cmlidXRlIChOTEFfTkVTVEVEKQotICogQXR0cmlidXRlcyBjYW4gYmUgbmVzdGVkIGFuZCBwdXQg
aW50byBhIGNvbnRhaW5lciB0byBjcmVhdGUgZ3JvdXBzLCBsaXN0cwotICogb3IgdG8gY29uc3Ry
dWN0IHRyZWVzIG9mIGF0dHJpYnV0ZXMuIE5lc3RlZCBhdHRyaWJ1dGVzIGFyZSBvZnRlbiB1c2Vk
IHRvCi0gKiBwYXNzIGF0dHJpYnV0ZXMgdG8gYSBzdWJzeXN0ZW0gd2hlcmUgdGhlIHRvcCBsYXll
ciBoYXMgbm8ga25vd2xlZGdlIG9mIHRoZQotICogY29uZmlndXJhdGlvbiBwb3NzaWJpbGl0aWVz
IG9mIGVhY2ggc3Vic3lzdGVtLgotICogQHBhcgotICogXGIgTm90ZTogV2hlbiB2YWxpZGF0aW5n
IHRoZSBhdHRyaWJ1dGVzIHVzaW5nIG5sbXNnX3ZhbGlkYXRlKCkgb3IKLSAqIG5sbXNnX3BhcnNl
KCkgaXQgd2lsbCBvbmx5IGFmZmVjdCB0aGUgdG9wIGxldmVsIGF0dHJpYnV0ZXMuIEVhY2gKLSAq
IGxldmVsIG9mIG5lc3RlZCBhdHRyaWJ1dGVzIG11c3QgYmUgdmFsaWRhdGVkIHNlcGVyYXRlbHkg
dXNpbmcKLSAqIG5sYV9wYXJzZV9uZXN0ZWQoKSBvciBubGFfdmFsaWRhdGUoKS4KLSAqIEBwYXIK
LSAqIEBjb2RlCi0gKiAvLyBUaGUgbWluaW1hbCBsZW5ndGggcG9saWN5IG1heSBiZSB1c2VkIHRv
IGVuZm9yY2UgdGhlIHByZXNlbmNlIG9mIGF0Ci0gKiAvLyBsZWFzdCBvbmUgYXR0cmlidXRlLgot
ICogc3RhdGljIHN0cnVjdCBubGFfcG9saWN5IG15X3BvbGljeVtBVFRSX01BWCsxXSA9IHsKLSAq
ICAgICBbQVRUUl9PUFRTXSA9IHsgLnR5cGUgPSBOTEFfTkVTVEVELCBtaW5sZW4gPSBOTEFfSERS
TEVOIH0sCi0gKgotICogLy8gTmVzdGVkIGF0dHJpYnV0ZXMgYXJlIGNvbnN0cnVjdGVkIGJ5IGVu
Y2xvc2luZyB0aGUgYXR0cmlidXRlcwotICogLy8gdG8gYmUgbmVzdGVkIHdpdGggY2FsbHMgdG8g
bmxhX25lc3Rfc3RhcnQoKSByZXNwZXRpdmVseSBubGFfbmVzdF9lbmQoKS4KLSAqIHN0cnVjdCBu
bGF0dHIgKm9wdHMgPSBubGFfbmVzdF9zdGFydChtc2csIEFUVFJfT1BUUyk7Ci0gKiBubGFfcHV0
X3UzMihtc2csIEFUVFJfRk9PLCAxMjMpOwotICogbmxhX3B1dF9zdHJpbmcobXNnLCBBVFRSX0JB
UiwgInNvbWUgdGV4dCIpOwotICogbmxhX25lc3RfZW5kKG1zZywgb3B0cyk7Ci0gKgotICogLy8g
VmFyaW91cyBtZXRob2RzIGV4aXN0IHRvIHBhcnNlIG5lc3RlZCBhdHRyaWJ1dGVzLCB0aGUgZWFz
aWVzdCBiZWluZwotICogLy8gbmxhX3BhcnNlX25lc3RlZCgpIHdoaWNoIGFsc28gYWxsb3dzIHZh
bGlkYXRpb24gaW4gdGhlIHNhbWUgc3RlcC4KLSAqIGlmIChhdHRyc1tBVFRSX09QVFNdKSB7Ci0g
KiAgICAgc3RydWN0IG5sYXR0ciAqbmVzdGVkW0FUVFJfTUFYKzFdOwotICoKLSAqICAgICBubGFf
cGFyc2VfbmVzdGVkKG5lc3RlZCwgQVRUUl9NQVgsIGF0dHJzW0FUVFJfT1BUU10sICZwb2xpY3kp
OwotICoKLSAqICAgICBpZiAobmVzdGVkW0FUVFJfRk9PXSkKLSAqICAgICAgICAgdWludDMyX3Qg
Zm9vID0gbmxhX2dldF91MzIobmVzdGVkW0FUVFJfRk9PXSk7Ci0gKiB9Ci0gKiBAZW5kY29kZQot
ICoKLSAqIEBzdWJzZWN0aW9uIGF0dHJfZXhjZXB0aW9ucyBFeGNlcHRpb24gQmFzZWQgQXR0cmli
dXRlIENvbnN0cnVjdGlvbgotICogT2Z0ZW4gYSBsYXJnZSBudW1iZXIgb2YgYXR0cmlidXRlcyBh
cmUgYWRkZWQgdG8gYSBtZXNzYWdlIGluIGEgc2luZ2xlCi0gKiBmdW5jdGlvbi4gSW4gb3JkZXIg
dG8gc2ltcGxpZnkgZXJyb3IgaGFuZGxpbmcsIGEgc2Vjb25kIHNldCBvZgotICogY29uc3RydWN0
aW9uIGZ1bmN0aW9ucyBleGlzdCB3aGljaCBqdW1wIHRvIGEgZXJyb3IgbGFiZWwgd2hlbiB0aGV5
Ci0gKiBmYWlsIGluc3RlYWQgb2YgcmV0dXJuaW5nIGFuIGVycm9yIGNvZGUuIFRoaXMgc2Vjb25k
IHNldCBjb25zaXN0cwotICogb2YgbWFjcm9zIHdoaWNoIGFyZSBuYW1lZCBhZnRlciB0aGVpciBl
cnJvciBjb2RlIGJhc2VkIGNvdW50ZXJwYXJ0Ci0gKiBleGNlcHQgdGhhdCB0aGUgbmFtZSBpcyB3
cml0dGVuIGFsbCB1cHBlcmNhc2UuCi0gKgotICogQWxsIG9mIHRoZSBtYWNyb3MganVtcCB0byB0
aGUgdGFyZ2V0IFxjIG5sYV9wdXRfZmFpbHVyZSBpZiB0aGV5IGZhaWwuCi0gKiBAY29kZQotICog
dm9pZCBteV9mdW5jKHN0cnVjdCBubF9tc2cgKm1zZykKLSAqIHsKLSAqICAgICBOTEFfUFVUX1Uz
Mihtc2csIEFUVFJfRk9PLCAxMCk7Ci0gKiAgICAgTkxBX1BVVF9TVFJJTkcobXNnLCBBVFRSX0JB
UiwgImJhciIpOwotICoKLSAqICAgICByZXR1cm4gMDsKLSAqCi0gKiBubGFfcHV0X2ZhaWx1cmU6
Ci0gKiAgICAgcmV0dXJuIC1OTEVfTk9NRU07Ci0gKiB9Ci0gKiBAZW5kY29kZQotICoKLSAqIEBz
dWJzZWN0aW9uIGF0dHJfZXhhbXBsZXMgRXhhbXBsZXMKLSAqIEBwYXIgRXhhbXBsZSAxLjEgQ29u
c3RydWN0aW5nIGEgbmV0bGluayBtZXNzYWdlIHdpdGggYXR0cmlidXRlcy4KLSAqIEBjb2RlCi0g
KiBzdHJ1Y3QgbmxfbXNnICpidWlsZF9tc2coaW50IGlmaW5kZXgsIHN0cnVjdCBubF9hZGRyICps
bGFkZHIsIGludCBtdHUpCi0gKiB7Ci0gKiAgICAgc3RydWN0IG5sX21zZyAqbXNnOwotICogICAg
IHN0cnVjdCBubGF0dHIgKmluZm8sICp2bGFuOwotICogICAgIHN0cnVjdCBpZmluZm9tc2cgaWZp
ID0gewotICogICAgICAgICAuaWZpX2ZhbWlseSA9IEFGX0lORVQsCi0gKiAgICAgICAgIC5pZmlf
aW5kZXggPSBpZmluZGV4LAotICogICAgIH07Ci0gKgotICogICAgIC8vIEFsbG9jYXRlIGEgbmV3
IG5ldGxpbmsgbWVzc2FnZSwgdHlwZT1SVE1fU0VUTElOSywgZmxhZ3M9TkxNX0ZfRUNITwotICog
ICAgIGlmICghKG1zZyA9IG5sbXNnX2FsbG9jX3NpbXBsZShSVE1fU0VUTElOSywgTkxNX0ZfRUNI
TykpKQotICogICAgICAgICByZXR1cm4gTlVMTDsKLSAqCi0gKiAgICAgLy8gQXBwZW5kIHRoZSBm
YW1pbHkgc3BlY2lmaWMgaGVhZGVyIChzdHJ1Y3QgaWZpbmZvbXNnKQotICogICAgIGlmIChubG1z
Z19hcHBlbmQobXNnLCAmaWZpLCBzaXplb2YoaWZpKSwgTkxNU0dfQUxJR05UTykgPCAwKQotICog
ICAgICAgICBnb3RvIG5sYV9wdXRfZmFpbHVyZQotICoKLSAqICAgICAvLyBBcHBlbmQgYSAzMiBi
aXQgaW50ZWdlciBhdHRyaWJ1dGUgdG8gY2FycnkgdGhlIE1UVQotICogICAgIE5MQV9QVVRfVTMy
KG1zZywgSUZMQV9NVFUsIG10dSk7Ci0gKgotICogICAgIC8vIEFwcGVuZCBhIHVuc3BlY2lmaWMg
YXR0cmlidXRlIHRvIGNhcnJ5IHRoZSBsaW5rIGxheWVyIGFkZHJlc3MKLSAqICAgICBOTEFfUFVU
X0FERFIobXNnLCBJRkxBX0FERFJFU1MsIGxsYWRkcik7Ci0gKgotICogICAgIC8vIEFwcGVuZCBh
IGNvbnRhaW5lciBmb3IgbmVzdGVkIGF0dHJpYnV0ZXMgdG8gY2FycnkgbGluayBpbmZvcm1hdGlv
bgotICogICAgIGlmICghKGluZm8gPSBubGFfbmVzdF9zdGFydChtc2csIElGTEFfTElOS0lORk8p
KSkKLSAqICAgICAgICAgZ290byBubGFfcHV0X2ZhaWx1cmU7Ci0gKgotICogICAgIC8vIFB1dCBh
IHN0cmluZyBhdHRyaWJ1dGUgaW50byB0aGUgY29udGFpbmVyCi0gKiAgICAgTkxBX1BVVF9TVFJJ
TkcobXNnLCBJRkxBX0lORk9fS0lORCwgInZsYW4iKTsKLSAqCi0gKiAgICAgLy8gQXBwZW5kIGFu
b3RoZXIgY29udGFpbmVyIGluc2lkZSB0aGUgb3BlbiBjb250YWluZXIgdG8gY2FycnkKLSAqICAg
ICAvLyB2bGFuIHNwZWNpZmljIGF0dHJpYnV0ZXMKLSAqICAgICBpZiAoISh2bGFuID0gbmxhX25l
c3Rfc3RhcnQobXNnLCBJRkxBX0lORk9fREFUQSkpKQotICogICAgICAgICBnb3RvIG5sYV9wdXRf
ZmFpbHVyZTsKLSAqCi0gKiAgICAgLy8gYWRkIHZsYW4gc3BlY2lmaWMgaW5mbyBhdHRyaWJ1dGVz
IGhlcmUuLi4KLSAqCi0gKiAgICAgLy8gRmluaXNoIG5lc3RpbmcgdGhlIHZsYW4gYXR0cmlidXRl
cyBhbmQgY2xvc2UgdGhlIHNlY29uZCBjb250YWluZXIuCi0gKiAgICAgbmxhX25lc3RfZW5kKG1z
Zywgdmxhbik7Ci0gKgotICogICAgIC8vIEZpbmlzaCBuZXN0aW5nIHRoZSBsaW5rIGluZm8gYXR0
cmlidXRlIGFuZCBjbG9zZSB0aGUgZmlyc3QgY29udGFpbmVyLgotICogICAgIG5sYV9uZXN0X2Vu
ZChtc2csIGluZm8pOwotICoKLSAqICAgICByZXR1cm4gbXNnOwotICoKLSAqIC8vIElmIGFueSBv
ZiB0aGUgY29uc3RydWN0aW9uIG1hY3JvcyBmYWlscywgd2UgZW5kIHVwIGhlcmUuCi0gKiBubGFf
cHV0X2ZhaWx1cmU6Ci0gKiAgICAgbmxtc2dfZnJlZShtc2cpOwotICogICAgIHJldHVybiBOVUxM
OwotICogfQotICogQGVuZGNvZGUKLSAqCi0gKiBAcGFyIEV4YW1wbGUgMi4xIFBhcnNpbmcgYSBu
ZXRsaW5rIG1lc3NhZ2Ugd2l0aCBhdHRyaWJ1dGVzLgotICogQGNvZGUKLSAqIGludCBwYXJzZV9t
ZXNzYWdlKHN0cnVjdCBubF9tc2cgKm1zZykKLSAqIHsKLSAqICAgICAvLyBUaGUgcG9saWN5IGRl
ZmluZXMgdHdvIGF0dHJpYnV0ZXM6IGEgMzIgYml0IGludGVnZXIgYW5kIGEgY29udGFpbmVyCi0g
KiAgICAgLy8gZm9yIG5lc3RlZCBhdHRyaWJ1dGVzLgotICogICAgIHN0cnVjdCBubGFfcG9saWN5
IGF0dHJfcG9saWN5W0FUVFJfTUFYKzFdID0gewotICogICAgICAgICBbQVRUUl9GT09dID0geyAu
dHlwZSA9IE5MQV9VMzIgfSwKLSAqICAgICAgICAgW0FUVFJfQkFSXSA9IHsgLnR5cGUgPSBOTEFf
TkVTVEVEIH0sCi0gKiAgICAgfTsKLSAqICAgICBzdHJ1Y3QgbmxhdHRyICphdHRyc1tBVFRSX01B
WCsxXTsKLSAqICAgICBpbnQgZXJyOwotICoKLSAqICAgICAvLyBUaGUgbmxtc2dfcGFyc2UoKSBm
dW5jdGlvbiB3aWxsIG1ha2Ugc3VyZSB0aGF0IHRoZSBtZXNzYWdlIGNvbnRhaW5zCi0gKiAgICAg
Ly8gZW5vdWdoIHBheWxvYWQgdG8gaG9sZCB0aGUgaGVhZGVyIChzdHJ1Y3QgbXlfaGRyKSwgdmFs
aWRhdGVzIGFueQotICogICAgIC8vIGF0dHJpYnV0ZXMgYXR0YWNoZWQgdG8gdGhlIG1lc3NhZ2Vz
IGFuZCBzdG9yZXMgYSBwb2ludGVyIHRvIGVhY2gKLSAqICAgICAvLyBhdHRyaWJ1dGUgaW4gdGhl
IGF0dHJzW10gYXJyYXkgYWNjZXNzYWJsZSBieSBhdHRyaWJ1dGUgdHlwZS4KLSAqICAgICBpZiAo
KGVyciA9IG5sbXNnX3BhcnNlKG5sbXNnX2hkcihtc2cpLCBzaXplb2Yoc3RydWN0IG15X2hkciks
IGF0dHJzLAotICogICAgICAgICAgICAgICAgICAgICAgICAgICAgQVRUUl9NQVgsIGF0dHJfcG9s
aWN5KSkgPCAwKQotICogICAgICAgICBnb3RvIGVycm91dDsKLSAqCi0gKiAgICAgaWYgKGF0dHJz
W0FUVFJfRk9PXSkgewotICogICAgICAgICAvLyBJdCBpcyBzYWZlIHRvIGRpcmVjdGx5IGFjY2Vz
cyB0aGUgYXR0cmlidXRlIHBheWxvYWQgd2l0aG91dAotICogICAgICAgICAvLyBhbnkgZnVydGhl
ciBjaGVja3Mgc2luY2Ugbmxtc2dfcGFyc2UoKSBlbmZvcmNlZCB0aGUgcG9saWN5LgotICogICAg
ICAgICB1aW50MzJfdCBmb28gPSBubGFfZ2V0X3UzMihhdHRyc1tBVFRSX0ZPT10pOwotICogICAg
IH0KLSAqCi0gKiAgICAgaWYgKGF0dHJzW0FUVFJfQkFSXSkgewotICogICAgICAgICBzdHJ1Y3Qg
bmxhdHRyICpuZXN0ZWRbTkVTVEVEX01BWCsxXTsKLSAqCi0gKiAgICAgICAgIC8vIEF0dHJpYnV0
ZXMgbmVzdGVkIGluIGEgY29udGFpbmVyIGNhbiBiZSBwYXJzZWQgdGhlIHNhbWUgd2F5Ci0gKiAg
ICAgICAgIC8vIGFzIHRvcCBsZXZlbCBhdHRyaWJ1dGVzLgotICogICAgICAgICBpZiAoKGVyciA9
IG5sYV9wYXJzZV9uZXN0ZWQobmVzdGVkLCBORVNURURfTUFYLCBhdHRyc1tBVFRSX0JBUl0sCi0g
KiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXN0ZWRfcG9saWN5KSkgPCAw
KQotICogICAgICAgICAgICAgZ290byBlcnJvdXQ7Ci0gKgotICogICAgICAgICAvLyBQcm9jZXNz
IG5lc3RlZCBhdHRyaWJ1dGVzIGhlcmUuCi0gKiAgICAgfQotICoKLSAqICAgICBlcnIgPSAwOwot
ICogZXJyb3V0OgotICogICAgIHJldHVybiBlcnI7Ci0gKiB9Ci0gKiBAZW5kY29kZQotICoKLSAq
IEB7Ci0gKi8KLQotLyoqCi0gKiBAbmFtZSBBdHRyaWJ1dGUgU2l6ZSBDYWxjdWxhdGlvbgotICog
QHsKLSAqLwotCi0vKiogQH0gKi8KLQotLyoqCi0gKiBAbmFtZSBQYXJzaW5nIEF0dHJpYnV0ZXMK
LSAqIEB7Ci0gKi8KLQotLyoqCi0gKiBDaGVjayBpZiB0aGUgYXR0cmlidXRlIGhlYWRlciBhbmQg
cGF5bG9hZCBjYW4gYmUgYWNjZXNzZWQgc2FmZWx5LgotICogQGFyZyBubGEJCUF0dHJpYnV0ZSBv
ZiBhbnkga2luZC4KLSAqIEBhcmcgcmVtYWluaW5nCU51bWJlciBvZiBieXRlcyByZW1haW5pbmcg
aW4gYXR0cmlidXRlIHN0cmVhbS4KLSAqCi0gKiBWZXJpZmllcyB0aGF0IHRoZSBoZWFkZXIgYW5k
IHBheWxvYWQgZG8gbm90IGV4Y2VlZCB0aGUgbnVtYmVyIG9mCi0gKiBieXRlcyBsZWZ0IGluIHRo
ZSBhdHRyaWJ1dGUgc3RyZWFtLiBUaGlzIGZ1bmN0aW9uIG11c3QgYmUgY2FsbGVkCi0gKiBiZWZv
cmUgYWNjZXNzIHRoZSBhdHRyaWJ1dGUgaGVhZGVyIG9yIHBheWxvYWQgd2hlbiBpdGVyYXRpbmcg
b3ZlcgotICogdGhlIGF0dHJpYnV0ZSBzdHJlYW0gdXNpbmcgbmxhX25leHQoKS4KLSAqCi0gKiBA
cmV0dXJuIFRydWUgaWYgdGhlIGF0dHJpYnV0ZSBjYW4gYmUgYWNjZXNzZWQgc2FmZWx5LCBmYWxz
ZSBvdGhlcndpc2UuCi0gKi8KLWludCBubGFfb2soY29uc3Qgc3RydWN0IG5sYXR0ciAqbmxhLCBp
bnQgcmVtYWluaW5nKQotewotCXJldHVybiByZW1haW5pbmcgPj0gc2l6ZW9mKCpubGEpICYmCi0J
ICAgICAgIG5sYS0+bmxhX2xlbiA+PSBzaXplb2YoKm5sYSkgJiYKLQkgICAgICAgbmxhLT5ubGFf
bGVuIDw9IHJlbWFpbmluZzsKLX0KLQotLyoqCi0gKiBSZXR1cm4gbmV4dCBhdHRyaWJ1dGUgaW4g
YSBzdHJlYW0gb2YgYXR0cmlidXRlcy4KLSAqIEBhcmcgbmxhCQlBdHRyaWJ1dGUgb2YgYW55IGtp
bmQuCi0gKiBAYXJnIHJlbWFpbmluZwlWYXJpYWJsZSB0byBjb3VudCByZW1haW5pbmcgYnl0ZXMg
aW4gc3RyZWFtLgotICoKLSAqIENhbGN1bGF0ZXMgdGhlIG9mZnNldCB0byB0aGUgbmV4dCBhdHRy
aWJ1dGUgYmFzZWQgb24gdGhlIGF0dHJpYnV0ZQotICogZ2l2ZW4uIFRoZSBhdHRyaWJ1dGUgcHJv
dmlkZWQgaXMgYXNzdW1lZCB0byBiZSBhY2Nlc3NpYmxlLCB0aGUKLSAqIGNhbGxlciBpcyByZXNw
b25zaWJsZSB0byB1c2UgbmxhX29rKCkgYmVmb3JlaGFuZC4gVGhlIG9mZnNldCAobGVuZ3RoCi0g
KiBvZiBzcGVjaWZpZWQgYXR0cmlidXRlIGluY2x1ZGluZyBwYWRkaW5nKSBpcyB0aGVuIHN1YnRy
YWN0ZWQgZnJvbQotICogdGhlIHJlbWFpbmluZyBieXRlcyB2YXJpYWJsZSBhbmQgYSBwb2ludGVy
IHRvIHRoZSBuZXh0IGF0dHJpYnV0ZSBpcwotICogcmV0dXJuZWQuCi0gKgotICogbmxhX25leHQo
KSBjYW4gYmUgY2FsbGVkIGFzIGxvbmcgYXMgcmVtYWluaWcgaXMgPjAuCi0gKgotICogQHJldHVy
biBQb2ludGVyIHRvIG5leHQgYXR0cmlidXRlLgotICovCi1zdHJ1Y3QgbmxhdHRyICpubGFfbmV4
dChjb25zdCBzdHJ1Y3QgbmxhdHRyICpubGEsIGludCAqcmVtYWluaW5nKQotewotCWludCB0b3Rs
ZW4gPSBOTEFfQUxJR04obmxhLT5ubGFfbGVuKTsKLQotCSpyZW1haW5pbmcgLT0gdG90bGVuOwot
CXJldHVybiAoc3RydWN0IG5sYXR0ciAqKSAoKGNoYXIgKikgbmxhICsgdG90bGVuKTsKLX0KLQot
c3RhdGljIHVpbnQxNl90IG5sYV9hdHRyX21pbmxlbltOTEFfVFlQRV9NQVgrMV0gPSB7Ci0JW05M
QV9VOF0JPSBzaXplb2YodWludDhfdCksCi0JW05MQV9VMTZdCT0gc2l6ZW9mKHVpbnQxNl90KSwK
LQlbTkxBX1UzMl0JPSBzaXplb2YodWludDMyX3QpLAotCVtOTEFfVTY0XQk9IHNpemVvZih1aW50
NjRfdCksCi0JW05MQV9TVFJJTkddCT0gMSwKLX07Ci0KLXN0YXRpYyBpbnQgdmFsaWRhdGVfbmxh
KHN0cnVjdCBubGF0dHIgKm5sYSwgaW50IG1heHR5cGUsCi0JCQlzdHJ1Y3QgbmxhX3BvbGljeSAq
cG9saWN5KQotewotCXN0cnVjdCBubGFfcG9saWN5ICpwdDsKLQlpbnQgbWlubGVuID0gMCwgdHlw
ZSA9IG5sYV90eXBlKG5sYSk7Ci0KLQlpZiAodHlwZSA8PSAwIHx8IHR5cGUgPiBtYXh0eXBlKQot
CQlyZXR1cm4gMDsKLQotCXB0ID0gJnBvbGljeVt0eXBlXTsKLQotCWlmIChwdC0+dHlwZSA+IE5M
QV9UWVBFX01BWCkKLQkJQlVHKCk7Ci0KLQlpZiAocHQtPm1pbmxlbikKLQkJbWlubGVuID0gcHQt
Pm1pbmxlbjsKLQllbHNlIGlmIChwdC0+dHlwZSAhPSBOTEFfVU5TUEVDKQotCQltaW5sZW4gPSBu
bGFfYXR0cl9taW5sZW5bcHQtPnR5cGVdOwotCi0JaWYgKHB0LT50eXBlID09IE5MQV9GTEFHICYm
IG5sYV9sZW4obmxhKSA+IDApCi0JCXJldHVybiAtTkxFX1JBTkdFOwotCi0JaWYgKG5sYV9sZW4o
bmxhKSA8IG1pbmxlbikKLQkJcmV0dXJuIC1OTEVfUkFOR0U7Ci0KLQlpZiAocHQtPm1heGxlbiAm
JiBubGFfbGVuKG5sYSkgPiBwdC0+bWF4bGVuKQotCQlyZXR1cm4gLU5MRV9SQU5HRTsKLQotCWlm
IChwdC0+dHlwZSA9PSBOTEFfU1RSSU5HKSB7Ci0JCWNoYXIgKmRhdGEgPSBubGFfZGF0YShubGEp
OwotCQlpZiAoZGF0YVtubGFfbGVuKG5sYSkgLSAxXSAhPSAnXDAnKQotCQkJcmV0dXJuIC1OTEVf
SU5WQUw7Ci0JfQotCi0JcmV0dXJuIDA7Ci19Ci0KLQotLyoqCi0gKiBDcmVhdGUgYXR0cmlidXRl
IGluZGV4IGJhc2VkIG9uIGEgc3RyZWFtIG9mIGF0dHJpYnV0ZXMuCi0gKiBAYXJnIHRiCQlJbmRl
eCBhcnJheSB0byBiZSBmaWxsZWQgKG1heHR5cGUrMSBlbGVtZW50cykuCi0gKiBAYXJnIG1heHR5
cGUJCU1heGltdW0gYXR0cmlidXRlIHR5cGUgZXhwZWN0ZWQgYW5kIGFjY2VwdGVkLgotICogQGFy
ZyBoZWFkCQlIZWFkIG9mIGF0dHJpYnV0ZSBzdHJlYW0uCi0gKiBAYXJnIGxlbgkJTGVuZ3RoIG9m
IGF0dHJpYnV0ZSBzdHJlYW0uCi0gKiBAYXJnIHBvbGljeQkJQXR0cmlidXRlIHZhbGlkYXRpb24g
cG9saWN5LgotICoKLSAqIEl0ZXJhdGVzIG92ZXIgdGhlIHN0cmVhbSBvZiBhdHRyaWJ1dGVzIGFu
ZCBzdG9yZXMgYSBwb2ludGVyIHRvIGVhY2gKLSAqIGF0dHJpYnV0ZSBpbiB0aGUgaW5kZXggYXJy
YXkgdXNpbmcgdGhlIGF0dHJpYnV0ZSB0eXBlIGFzIGluZGV4IHRvCi0gKiB0aGUgYXJyYXkuIEF0
dHJpYnV0ZSB3aXRoIGEgdHlwZSBncmVhdGVyIHRoYW4gdGhlIG1heGltdW0gdHlwZQotICogc3Bl
Y2lmaWVkIHdpbGwgYmUgc2lsZW50bHkgaWdub3JlZCBpbiBvcmRlciB0byBtYWludGFpbiBiYWNr
d2FyZHMKLSAqIGNvbXBhdGliaWxpdHkuIElmIFxhIHBvbGljeSBpcyBub3QgTlVMTCwgdGhlIGF0
dHJpYnV0ZSB3aWxsIGJlCi0gKiB2YWxpZGF0ZWQgdXNpbmcgdGhlIHNwZWNpZmllZCBwb2xpY3ku
Ci0gKgotICogQHNlZSBubGFfdmFsaWRhdGUKLSAqIEByZXR1cm4gMCBvbiBzdWNjZXNzIG9yIGEg
bmVnYXRpdmUgZXJyb3IgY29kZS4KLSAqLwotaW50IG5sYV9wYXJzZShzdHJ1Y3QgbmxhdHRyICp0
YltdLCBpbnQgbWF4dHlwZSwgc3RydWN0IG5sYXR0ciAqaGVhZCwgaW50IGxlbiwKLQkgICAgICBz
dHJ1Y3QgbmxhX3BvbGljeSAqcG9saWN5KQotewotCXN0cnVjdCBubGF0dHIgKm5sYTsKLQlpbnQg
cmVtLCBlcnI7Ci0KLQltZW1zZXQodGIsIDAsIHNpemVvZihzdHJ1Y3QgbmxhdHRyICopICogKG1h
eHR5cGUgKyAxKSk7Ci0KLQlubGFfZm9yX2VhY2hfYXR0cihubGEsIGhlYWQsIGxlbiwgcmVtKSB7
Ci0JCWludCB0eXBlID0gbmxhX3R5cGUobmxhKTsKLQotCQlpZiAodHlwZSA9PSAwKSB7Ci0JCQlm
cHJpbnRmKHN0ZGVyciwgIklsbGVnYWwgbmxhLT5ubGFfdHlwZSA9PSAwXG4iKTsKLQkJCWNvbnRp
bnVlOwotCQl9Ci0KLQkJaWYgKHR5cGUgPD0gbWF4dHlwZSkgewotCQkJaWYgKHBvbGljeSkgewot
CQkJCWVyciA9IHZhbGlkYXRlX25sYShubGEsIG1heHR5cGUsIHBvbGljeSk7Ci0JCQkJaWYgKGVy
ciA8IDApCi0JCQkJCWdvdG8gZXJyb3V0OwotCQkJfQotCi0JCQl0Ylt0eXBlXSA9IG5sYTsKLQkJ
fQotCX0KLQotCWlmIChyZW0gPiAwKQotCQlmcHJpbnRmKHN0ZGVyciwgIm5ldGxpbms6ICVkIGJ5
dGVzIGxlZnRvdmVyIGFmdGVyIHBhcnNpbmcgIgotCQkgICAgICAgImF0dHJpYnV0ZXMuXG4iLCBy
ZW0pOwotCi0JZXJyID0gMDsKLWVycm91dDoKLQlyZXR1cm4gZXJyOwotfQotCi0vKioKLSAqIFZh
bGlkYXRlIGEgc3RyZWFtIG9mIGF0dHJpYnV0ZXMuCi0gKiBAYXJnIGhlYWQJCUhlYWQgb2YgYXR0
cmlidXRlcyBzdHJlYW0uCi0gKiBAYXJnIGxlbgkJTGVuZ3RoIG9mIGF0dHJpYnV0ZXMgc3RyZWFt
LgotICogQGFyZyBtYXh0eXBlCQlNYXhpbXVtIGF0dHJpYnV0ZSB0eXBlIGV4cGVjdGVkIGFuZCBh
Y2NlcHRlZC4KLSAqIEBhcmcgcG9saWN5CQlWYWxpZGF0aW9uIHBvbGljeS4KLSAqCi0gKiBJdGVy
YXRlcyBvdmVyIHRoZSBzdHJlYW0gb2YgYXR0cmlidXRlcyBhbmQgdmFsaWRhdGVzIGVhY2ggYXR0
cmlidXRlCi0gKiBvbmUgYnkgb25lIHVzaW5nIHRoZSBzcGVjaWZpZWQgcG9saWN5LiBBdHRyaWJ1
dGVzIHdpdGggYSB0eXBlIGdyZWF0ZXIKLSAqIHRoYW4gdGhlIG1heGltdW0gdHlwZSBzcGVjaWZp
ZWQgd2lsbCBiZSBzaWxlbnRseSBpZ25vcmVkIGluIG9yZGVyIHRvCi0gKiBtYWludGFpbiBiYWNr
d2FyZHMgY29tcGF0aWJpbGl0eS4KLSAqCi0gKiBTZWUgXHJlZiBhdHRyX2RhdGF0eXBlcyBmb3Ig
bW9yZSBkZXRhaWxzIG9uIHdoYXQga2luZCBvZiB2YWxpZGF0aW9uCi0gKiBjaGVja3MgYXJlIHBl
cmZvcm1lZCBvbiBlYWNoIGF0dHJpYnV0ZSBkYXRhIHR5cGUuCi0gKgotICogQHJldHVybiAwIG9u
IHN1Y2Nlc3Mgb3IgYSBuZWdhdGl2ZSBlcnJvciBjb2RlLgotICovCi1pbnQgbmxhX3ZhbGlkYXRl
KHN0cnVjdCBubGF0dHIgKmhlYWQsIGludCBsZW4sIGludCBtYXh0eXBlLAotCQkgc3RydWN0IG5s
YV9wb2xpY3kgKnBvbGljeSkKLXsKLQlzdHJ1Y3QgbmxhdHRyICpubGE7Ci0JaW50IHJlbSwgZXJy
OwotCi0JbmxhX2Zvcl9lYWNoX2F0dHIobmxhLCBoZWFkLCBsZW4sIHJlbSkgewotCQllcnIgPSB2
YWxpZGF0ZV9ubGEobmxhLCBtYXh0eXBlLCBwb2xpY3kpOwotCQlpZiAoZXJyIDwgMCkKLQkJCWdv
dG8gZXJyb3V0OwotCX0KLQotCWVyciA9IDA7Ci1lcnJvdXQ6Ci0JcmV0dXJuIGVycjsKLX0KLQot
LyoqCi0gKiBGaW5kIGEgc2luZ2xlIGF0dHJpYnV0ZSBpbiBhIHN0cmVhbSBvZiBhdHRyaWJ1dGVz
LgotICogQGFyZyBoZWFkCQlIZWFkIG9mIGF0dHJpYnV0ZXMgc3RyZWFtLgotICogQGFyZyBsZW4J
CUxlbmd0aCBvZiBhdHRyaWJ1dGVzIHN0cmVhbS4KLSAqIEBhcmcgYXR0cnR5cGUJQXR0cmlidXRl
IHR5cGUgdG8gbG9vayBmb3IuCi0gKgotICogSXRlcmF0ZXMgb3ZlciB0aGUgc3RyZWFtIG9mIGF0
dHJpYnV0ZXMgYW5kIGNvbXBhcmVzIGVhY2ggdHlwZSB3aXRoCi0gKiB0aGUgdHlwZSBzcGVjaWZp
ZWQuIFJldHVybnMgdGhlIGZpcnN0IGF0dHJpYnV0ZSB3aGljaCBtYXRjaGVzIHRoZQotICogdHlw
ZS4KLSAqCi0gKiBAcmV0dXJuIFBvaW50ZXIgdG8gYXR0cmlidXRlIGZvdW5kIG9yIE5VTEwuCi0g
Ki8KLXN0cnVjdCBubGF0dHIgKm5sYV9maW5kKHN0cnVjdCBubGF0dHIgKmhlYWQsIGludCBsZW4s
IGludCBhdHRydHlwZSkKLXsKLQlzdHJ1Y3QgbmxhdHRyICpubGE7Ci0JaW50IHJlbTsKLQotCW5s
YV9mb3JfZWFjaF9hdHRyKG5sYSwgaGVhZCwgbGVuLCByZW0pCi0JCWlmIChubGFfdHlwZShubGEp
ID09IGF0dHJ0eXBlKQotCQkJcmV0dXJuIG5sYTsKLQotCXJldHVybiBOVUxMOwotfQotCi0vKiog
QH0gKi8KLQotLyoqCi0gKiBAbmFtZSBVbnNwZWNpZmljIEF0dHJpYnV0ZQotICogQHsKLSAqLwot
Ci0vKioKLSAqIFJlc2VydmUgc3BhY2UgZm9yIGEgYXR0cmlidXRlLgotICogQGFyZyBtc2cJCU5l
dGxpbmsgTWVzc2FnZS4KLSAqIEBhcmcgYXR0cnR5cGUJQXR0cmlidXRlIFR5cGUuCi0gKiBAYXJn
IGF0dHJsZW4JCUxlbmd0aCBvZiBwYXlsb2FkLgotICoKLSAqIFJlc2VydmVzIHJvb20gZm9yIGEg
YXR0cmlidXRlIGluIHRoZSBzcGVjaWZpZWQgbmV0bGluayBtZXNzYWdlIGFuZAotICogZmlsbHMg
aW4gdGhlIGF0dHJpYnV0ZSBoZWFkZXIgKHR5cGUsIGxlbmd0aCkuIFJldHVybnMgTlVMTCBpZiB0
aGVyZQotICogaXMgdW5zdWZpY2llbnQgc3BhY2UgZm9yIHRoZSBhdHRyaWJ1dGUuCi0gKgotICog
QW55IHBhZGRpbmcgYmV0d2VlbiBwYXlsb2FkIGFuZCB0aGUgc3RhcnQgb2YgdGhlIG5leHQgYXR0
cmlidXRlIGlzCi0gKiB6ZXJvZWQgb3V0LgotICoKLSAqIEByZXR1cm4gUG9pbnRlciB0byBzdGFy
dCBvZiBhdHRyaWJ1dGUgb3IgTlVMTCBvbiBmYWlsdXJlLgotICovCi1zdHJ1Y3QgbmxhdHRyICpu
bGFfcmVzZXJ2ZShzdHJ1Y3QgbmxfbXNnICptc2csIGludCBhdHRydHlwZSwgaW50IGF0dHJsZW4p
Ci17Ci0Jc3RydWN0IG5sYXR0ciAqbmxhOwotCWludCB0bGVuOwotCQotCXRsZW4gPSBOTE1TR19B
TElHTihtc2ctPm5tX25saC0+bmxtc2dfbGVuKSArIG5sYV90b3RhbF9zaXplKGF0dHJsZW4pOwot
Ci0JaWYgKCh0bGVuICsgbXNnLT5ubV9ubGgtPm5sbXNnX2xlbikgPiBtc2ctPm5tX3NpemUpCi0J
CXJldHVybiBOVUxMOwotCi0JbmxhID0gKHN0cnVjdCBubGF0dHIgKikgbmxtc2dfdGFpbChtc2ct
Pm5tX25saCk7Ci0JbmxhLT5ubGFfdHlwZSA9IGF0dHJ0eXBlOwotCW5sYS0+bmxhX2xlbiA9IG5s
YV9hdHRyX3NpemUoYXR0cmxlbik7Ci0KLQltZW1zZXQoKHVuc2lnbmVkIGNoYXIgKikgbmxhICsg
bmxhLT5ubGFfbGVuLCAwLCBubGFfcGFkbGVuKGF0dHJsZW4pKTsKLQltc2ctPm5tX25saC0+bmxt
c2dfbGVuID0gdGxlbjsKLQotCU5MX0RCRygyLCAibXNnICVwOiBSZXNlcnZlZCAlZCBieXRlcyBh
dCBvZmZzZXQgKyV0ZCBmb3IgYXR0ciAlZCAiCi0JCSAgIm5sbXNnX2xlbj0lZFxuIiwgbXNnLCBh
dHRybGVuLAotCQkgICh2b2lkICopIG5sYSAtIG5sbXNnX2RhdGEobXNnLT5ubV9ubGgpLAotCQkg
IGF0dHJ0eXBlLCBtc2ctPm5tX25saC0+bmxtc2dfbGVuKTsKLQotCXJldHVybiBubGE7Ci19Ci0K
LS8qKgotICogQWRkIGEgdW5zcGVjaWZpYyBhdHRyaWJ1dGUgdG8gbmV0bGluayBtZXNzYWdlLgot
ICogQGFyZyBtc2cJCU5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgYXR0cnR5cGUJQXR0cmlidXRl
IHR5cGUuCi0gKiBAYXJnIGRhdGFsZW4JCUxlbmd0aCBvZiBkYXRhIHRvIGJlIHVzZWQgYXMgcGF5
bG9hZC4KLSAqIEBhcmcgZGF0YQkJUG9pbnRlciB0byBkYXRhIHRvIGJlIHVzZWQgYXMgYXR0cmli
dXRlIHBheWxvYWQuCi0gKgotICogUmVzZXJ2ZXMgcm9vbSBmb3IgYSB1bnNwZWNpZmljIGF0dHJp
YnV0ZSBhbmQgY29waWVzIHRoZSBwcm92aWRlZCBkYXRhCi0gKiBpbnRvIHRoZSBtZXNzYWdlIGFz
IHBheWxvYWQgb2YgdGhlIGF0dHJpYnV0ZS4gUmV0dXJucyBhbiBlcnJvciBpZiB0aGVyZQotICog
aXMgaW5zdWZmaWNpZW50IHNwYWNlIGZvciB0aGUgYXR0cmlidXRlLgotICoKLSAqIEBzZWUgbmxh
X3Jlc2VydmUKLSAqIEByZXR1cm4gMCBvbiBzdWNjZXNzIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29k
ZS4KLSAqLwotaW50IG5sYV9wdXQoc3RydWN0IG5sX21zZyAqbXNnLCBpbnQgYXR0cnR5cGUsIGlu
dCBkYXRhbGVuLCBjb25zdCB2b2lkICpkYXRhKQotewotCXN0cnVjdCBubGF0dHIgKm5sYTsKLQot
CW5sYSA9IG5sYV9yZXNlcnZlKG1zZywgYXR0cnR5cGUsIGRhdGFsZW4pOwotCWlmICghbmxhKQot
CQlyZXR1cm4gLU5MRV9OT01FTTsKLQotCW1lbWNweShubGFfZGF0YShubGEpLCBkYXRhLCBkYXRh
bGVuKTsKLQlOTF9EQkcoMiwgIm1zZyAlcDogV3JvdGUgJWQgYnl0ZXMgYXQgb2Zmc2V0ICsldGQg
Zm9yIGF0dHIgJWRcbiIsCi0JICAgICAgIG1zZywgZGF0YWxlbiwgKHZvaWQgKikgbmxhIC0gbmxt
c2dfZGF0YShtc2ctPm5tX25saCksIGF0dHJ0eXBlKTsKLQotCXJldHVybiAwOwotfQotCi0KLQot
LyoqIEB9ICovCmRpZmYgLS1naXQgYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvY2FjaGUu
YyBiL3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9jYWNoZS5jCmRlbGV0ZWQgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCA1NmExMjgwYjUzYmIuLjAwMDAwMDAwMDAwMAotLS0gYS9wYWNrYWdlL2xp
YnMvbGlibmwtdGlueS9zcmMvY2FjaGUuYworKysgL2Rldi9udWxsCkBAIC0xLDM3NiArMCwwIEBA
Ci0vKgotICogbGliL2NhY2hlLmMJCUNhY2hpbmcgTW9kdWxlCi0gKgotICoJVGhpcyBsaWJyYXJ5
IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgotICoJbW9k
aWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwot
ICoJTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiB2
ZXJzaW9uIDIuMQotICoJb2YgdGhlIExpY2Vuc2UuCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDAz
LTIwMDggVGhvbWFzIEdyYWYgPHRncmFmQHN1dWcuY2g+Ci0gKi8KLQotLyoqCi0gKiBAaW5ncm91
cCBjYWNoZV9tbmd0Ci0gKiBAZGVmZ3JvdXAgY2FjaGUgQ2FjaGUKLSAqCi0gKiBAY29kZQotICog
ICBDYWNoZSBNYW5hZ2VtZW50ICAgICAgICAgICAgIHwgICAgfCBUeXBlIFNwZWNpZmljIENhY2hl
IE9wZXJhdGlvbnMKLSAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKLSAq
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgIHwgKy0tLS0tLS0tLS0tLS0tLS0r
ICstLS0tLS0tLS0tLS0rCi0gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHwgcmVxdWVzdCB1cGRhdGUgfCB8IG1zZ19wYXJzZXIgfAotICogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHwgICAgfCArLS0tLS0tLS0tLS0tLS0tLSsgKy0tLS0tLS0tLS0tLSsKLSAq
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICstIC0gLSAtIC1eLSAtIC0gLSAt
IC0gLSAtXi0gLXwtIC0gLSAtCi0gKiAgICBubF9jYWNoZV91cGRhdGU6ICAgICAgICAgICAgfCAg
ICAgICAgICAgICAgfCAgICAgICAgICAgICAgIHwgICB8Ci0gKiAgICAgICAgICAxKSAtLS0tLS0t
LS0gY29fcmVxdWVzdF91cGRhdGUgLS0tLS0tKyAgICAgICAgICAgICAgIHwgICB8Ci0gKiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHwgICB8Ci0gKiAgICAgICAgICAyKSBkZXN0cm95IG9sZCBjYWNoZSAgICAgKy0tLS0tLS0tLS0t
IHBwX2NiIC0tLS0tLS0tLXwtLS0rCi0gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
fCAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKLSAqICAgICAgICAgIDMpIC0tLS0tLS0t
LS0gbmxfcmVjdm1zZ3MgLS0tLS0tLS0tLSsgICArLSBjYl92YWxpZCAtKwotICogICAgICAgICAg
ICAgKy0tLS0tLS0tLS0tLS0tKyAgIHwgIHwgICAgICAgICAgfCAgIHwKLSAqICAgICAgICAgICAg
IHwgbmxfY2FjaGVfYWRkIHw8LS0tLS0rICAgKyAtIC0gLXYtIC18LSAtIC0gLSAtIC0gLSAtIC0g
LSAtCi0gKiAgICAgICAgICAgICArLS0tLS0tLS0tLS0tLS0rICAgfCAgICAgIHwgKy0tLS0tLS0t
LS0tLS0rCi0gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBubF9y
ZWN2bXNncyB8Ci0gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgIHwgKy0t
LS0tfC1eLS0tLS0rCi0gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICArLS0tdi18LS0tKwotICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICB8
ICAgfCBubF9yZWN2IHwKLSAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICstLS0tLS0tLS0rCi0gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAg
IHwgICAgICAgICAgICAgICAgIENvcmUgTmV0bGluawotICogQGVuZGNvZGUKLSAqIAotICogQHsK
LSAqLwotCi0jaW5jbHVkZSA8bmV0bGluay1sb2NhbC5oPgotI2luY2x1ZGUgPG5ldGxpbmsvbmV0
bGluay5oPgotI2luY2x1ZGUgPG5ldGxpbmsvY2FjaGUuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL29i
amVjdC5oPgotI2luY2x1ZGUgPG5ldGxpbmsvdXRpbHMuaD4KLQotLyoqCi0gKiBAbmFtZSBDYWNo
ZSBDcmVhdGlvbi9EZWxldGlvbgotICogQHsKLSAqLwotCi0vKioKLSAqIEFsbG9jYXRlIGFuIGVt
cHR5IGNhY2hlCi0gKiBAYXJnIG9wcwkJY2FjaGUgb3BlcmF0aW9ucyB0byBiYXNlIHRoZSBjYWNo
ZSBvbgotICogCi0gKiBAcmV0dXJuIEEgbmV3bHkgYWxsb2NhdGVkIGFuZCBpbml0aWFsaXplZCBj
YWNoZS4KLSAqLwotc3RydWN0IG5sX2NhY2hlICpubF9jYWNoZV9hbGxvYyhzdHJ1Y3QgbmxfY2Fj
aGVfb3BzICpvcHMpCi17Ci0Jc3RydWN0IG5sX2NhY2hlICpjYWNoZTsKLQotCWNhY2hlID0gY2Fs
bG9jKDEsIHNpemVvZigqY2FjaGUpKTsKLQlpZiAoIWNhY2hlKQotCQlyZXR1cm4gTlVMTDsKLQot
CW5sX2luaXRfbGlzdF9oZWFkKCZjYWNoZS0+Y19pdGVtcyk7Ci0JY2FjaGUtPmNfb3BzID0gb3Bz
OwotCi0JTkxfREJHKDIsICJBbGxvY2F0ZWQgY2FjaGUgJXAgPCVzPi5cbiIsIGNhY2hlLCBubF9j
YWNoZV9uYW1lKGNhY2hlKSk7Ci0KLQlyZXR1cm4gY2FjaGU7Ci19Ci0KLWludCBubF9jYWNoZV9h
bGxvY19hbmRfZmlsbChzdHJ1Y3QgbmxfY2FjaGVfb3BzICpvcHMsIHN0cnVjdCBubF9zb2NrICpz
b2NrLAotCQkJICAgIHN0cnVjdCBubF9jYWNoZSAqKnJlc3VsdCkKLXsKLQlzdHJ1Y3QgbmxfY2Fj
aGUgKmNhY2hlOwotCWludCBlcnI7Ci0JCi0JaWYgKCEoY2FjaGUgPSBubF9jYWNoZV9hbGxvYyhv
cHMpKSkKLQkJcmV0dXJuIC1OTEVfTk9NRU07Ci0KLQlpZiAoc29jayAmJiAoZXJyID0gbmxfY2Fj
aGVfcmVmaWxsKHNvY2ssIGNhY2hlKSkgPCAwKSB7Ci0JCW5sX2NhY2hlX2ZyZWUoY2FjaGUpOwot
CQlyZXR1cm4gZXJyOwotCX0KLQotCSpyZXN1bHQgPSBjYWNoZTsKLQlyZXR1cm4gMDsKLX0KLQot
LyoqCi0gKiBDbGVhciBhIGNhY2hlLgotICogQGFyZyBjYWNoZQkJY2FjaGUgdG8gY2xlYXIKLSAq
Ci0gKiBSZW1vdmVzIGFsbCBlbGVtZW50cyBvZiBhIGNhY2hlLgotICovCi12b2lkIG5sX2NhY2hl
X2NsZWFyKHN0cnVjdCBubF9jYWNoZSAqY2FjaGUpCi17Ci0Jc3RydWN0IG5sX29iamVjdCAqb2Jq
LCAqdG1wOwotCi0JTkxfREJHKDEsICJDbGVhcmluZyBjYWNoZSAlcCA8JXM+Li4uXG4iLCBjYWNo
ZSwgbmxfY2FjaGVfbmFtZShjYWNoZSkpOwotCi0JbmxfbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZl
KG9iaiwgdG1wLCAmY2FjaGUtPmNfaXRlbXMsIGNlX2xpc3QpCi0JCW5sX2NhY2hlX3JlbW92ZShv
YmopOwotfQotCi0vKioKLSAqIEZyZWUgYSBjYWNoZS4KLSAqIEBhcmcgY2FjaGUJCUNhY2hlIHRv
IGZyZWUuCi0gKgotICogUmVtb3ZlcyBhbGwgZWxlbWVudHMgb2YgYSBjYWNoZSBhbmQgZnJlZXMg
YWxsIG1lbW9yeS4KLSAqCi0gKiBAbm90ZSBVc2UgdGhpcyBmdW5jdGlvbiBpZiB5b3UgYXJlIHdv
cmtpbmcgd2l0aCBhbGxvY2F0ZWQgY2FjaGVzLgotICovCi12b2lkIG5sX2NhY2hlX2ZyZWUoc3Ry
dWN0IG5sX2NhY2hlICpjYWNoZSkKLXsKLQlpZiAoIWNhY2hlKQotCQlyZXR1cm47Ci0KLQlubF9j
YWNoZV9jbGVhcihjYWNoZSk7Ci0JTkxfREJHKDEsICJGcmVlaW5nIGNhY2hlICVwIDwlcz4uLi5c
biIsIGNhY2hlLCBubF9jYWNoZV9uYW1lKGNhY2hlKSk7Ci0JZnJlZShjYWNoZSk7Ci19Ci0KLS8q
KiBAfSAqLwotCi0vKioKLSAqIEBuYW1lIENhY2hlIE1vZGlmaWNhdGlvbnMKLSAqIEB7Ci0gKi8K
LQotc3RhdGljIGludCBfX2NhY2hlX2FkZChzdHJ1Y3QgbmxfY2FjaGUgKmNhY2hlLCBzdHJ1Y3Qg
bmxfb2JqZWN0ICpvYmopCi17Ci0Jb2JqLT5jZV9jYWNoZSA9IGNhY2hlOwotCi0JbmxfbGlzdF9h
ZGRfdGFpbCgmb2JqLT5jZV9saXN0LCAmY2FjaGUtPmNfaXRlbXMpOwotCWNhY2hlLT5jX25pdGVt
cysrOwotCi0JTkxfREJHKDEsICJBZGRlZCAlcCB0byBjYWNoZSAlcCA8JXM+LlxuIiwKLQkgICAg
ICAgb2JqLCBjYWNoZSwgbmxfY2FjaGVfbmFtZShjYWNoZSkpOwotCi0JcmV0dXJuIDA7Ci19Ci0K
LS8qKgotICogQWRkIG9iamVjdCB0byBhIGNhY2hlLgotICogQGFyZyBjYWNoZQkJQ2FjaGUgdG8g
YWRkIG9iamVjdCB0bwotICogQGFyZyBvYmoJCU9iamVjdCB0byBiZSBhZGRlZCB0byB0aGUgY2Fj
aGUKLSAqCi0gKiBBZGRzIHRoZSBnaXZlbiBvYmplY3QgdG8gdGhlIHNwZWNpZmllZCBjYWNoZS4g
VGhlIG9iamVjdCBpcyBjbG9uZWQKLSAqIGlmIGl0IGhhcyBiZWVuIGFkZGVkIHRvIGFub3RoZXIg
Y2FjaGUgYWxyZWFkeS4KLSAqCi0gKiBAcmV0dXJuIDAgb3IgYSBuZWdhdGl2ZSBlcnJvciBjb2Rl
LgotICovCi1pbnQgbmxfY2FjaGVfYWRkKHN0cnVjdCBubF9jYWNoZSAqY2FjaGUsIHN0cnVjdCBu
bF9vYmplY3QgKm9iaikKLXsKLQlzdHJ1Y3Qgbmxfb2JqZWN0ICpuZXc7Ci0KLQlpZiAoY2FjaGUt
PmNfb3BzLT5jb19vYmpfb3BzICE9IG9iai0+Y2Vfb3BzKQotCQlyZXR1cm4gLU5MRV9PQkpfTUlT
TUFUQ0g7Ci0KLQlpZiAoIW5sX2xpc3RfZW1wdHkoJm9iai0+Y2VfbGlzdCkpIHsKLQkJbmV3ID0g
bmxfb2JqZWN0X2Nsb25lKG9iaik7Ci0JCWlmICghbmV3KQotCQkJcmV0dXJuIC1OTEVfTk9NRU07
Ci0JfSBlbHNlIHsKLQkJbmxfb2JqZWN0X2dldChvYmopOwotCQluZXcgPSBvYmo7Ci0JfQotCi0J
cmV0dXJuIF9fY2FjaGVfYWRkKGNhY2hlLCBuZXcpOwotfQotCi0vKioKLSAqIFJlbW92ZXMgYW4g
b2JqZWN0IGZyb20gYSBjYWNoZS4KLSAqIEBhcmcgb2JqCQlPYmplY3QgdG8gcmVtb3ZlIGZyb20g
aXRzIGNhY2hlCi0gKgotICogUmVtb3ZlcyB0aGUgb2JqZWN0IFxjIG9iaiBmcm9tIHRoZSBjYWNo
ZSBpdCBpcyBhc3NpZ25lZCB0bywgc2luY2UKLSAqIGFuIG9iamVjdCBjYW4gb25seSBiZSBhc3Np
Z25lZCB0byBvbmUgY2FjaGUgYXQgYSB0aW1lLCB0aGUgY2FjaGUKLSAqIG11c3QgbmUgYmUgcGFz
c2VkIGFsb25nIHdpdGggaXQuCi0gKi8KLXZvaWQgbmxfY2FjaGVfcmVtb3ZlKHN0cnVjdCBubF9v
YmplY3QgKm9iaikKLXsKLQlzdHJ1Y3QgbmxfY2FjaGUgKmNhY2hlID0gb2JqLT5jZV9jYWNoZTsK
LQotCWlmIChjYWNoZSA9PSBOVUxMKQotCQlyZXR1cm47Ci0KLQlubF9saXN0X2RlbCgmb2JqLT5j
ZV9saXN0KTsKLQlvYmotPmNlX2NhY2hlID0gTlVMTDsKLQlubF9vYmplY3RfcHV0KG9iaik7Ci0J
Y2FjaGUtPmNfbml0ZW1zLS07Ci0KLQlOTF9EQkcoMSwgIkRlbGV0ZWQgJXAgZnJvbSBjYWNoZSAl
cCA8JXM+LlxuIiwKLQkgICAgICAgb2JqLCBjYWNoZSwgbmxfY2FjaGVfbmFtZShjYWNoZSkpOwot
fQotCi0vKiogQH0gKi8KLQotLyoqCi0gKiBAbmFtZSBTeW5jaHJvbml6YXRpb24KLSAqIEB7Ci0g
Ki8KLQotLyoqCi0gKiBSZXF1ZXN0IGEgZnVsbCBkdW1wIGZyb20gdGhlIGtlcm5lbCB0byBmaWxs
IGEgY2FjaGUKLSAqIEBhcmcgc2sJCU5ldGxpbmsgc29ja2V0LgotICogQGFyZyBjYWNoZQkJQ2Fj
aGUgc3ViamVjdGVkIHRvIGJlIGZpbGxlZC4KLSAqCi0gKiBTZW5kIGEgZHVtcGluZyByZXF1ZXN0
IHRvIHRoZSBrZXJuZWwgY2F1c2luZyBpdCB0byBkdW1wIGFsbCBvYmplY3RzCi0gKiByZWxhdGVk
IHRvIHRoZSBzcGVjaWZpZWQgY2FjaGUgdG8gdGhlIG5ldGxpbmsgc29ja2V0LgotICoKLSAqIFVz
ZSBubF9jYWNoZV9waWNrdXAoKSB0byByZWFkIHRoZSBvYmplY3RzIGZyb20gdGhlIHNvY2tldCBh
bmQgZmlsbCB0aGVtCi0gKiBpbnRvIGEgY2FjaGUuCi0gKi8KLWludCBubF9jYWNoZV9yZXF1ZXN0
X2Z1bGxfZHVtcChzdHJ1Y3Qgbmxfc29jayAqc2ssIHN0cnVjdCBubF9jYWNoZSAqY2FjaGUpCi17
Ci0JTkxfREJHKDIsICJSZXF1ZXN0aW5nIGR1bXAgZnJvbSBrZXJuZWwgZm9yIGNhY2hlICVwIDwl
cz4uLi5cbiIsCi0JICAgICAgICAgIGNhY2hlLCBubF9jYWNoZV9uYW1lKGNhY2hlKSk7Ci0KLQlp
ZiAoY2FjaGUtPmNfb3BzLT5jb19yZXF1ZXN0X3VwZGF0ZSA9PSBOVUxMKQotCQlyZXR1cm4gLU5M
RV9PUE5PVFNVUFA7Ci0KLQlyZXR1cm4gY2FjaGUtPmNfb3BzLT5jb19yZXF1ZXN0X3VwZGF0ZShj
YWNoZSwgc2spOwotfQotCi0vKiogQGNvbmQgU0tJUCAqLwotc3RydWN0IHVwZGF0ZV94ZGF0YSB7
Ci0Jc3RydWN0IG5sX2NhY2hlX29wcyAqb3BzOwotCXN0cnVjdCBubF9wYXJzZXJfcGFyYW0gKnBh
cmFtczsKLX07Ci0KLXN0YXRpYyBpbnQgdXBkYXRlX21zZ19wYXJzZXIoc3RydWN0IG5sX21zZyAq
bXNnLCB2b2lkICphcmcpCi17Ci0Jc3RydWN0IHVwZGF0ZV94ZGF0YSAqeCA9IGFyZzsKLQkKLQly
ZXR1cm4gbmxfY2FjaGVfcGFyc2UoeC0+b3BzLCAmbXNnLT5ubV9zcmMsIG1zZy0+bm1fbmxoLCB4
LT5wYXJhbXMpOwotfQotLyoqIEBlbmRjb25kICovCi0KLWludCBfX2NhY2hlX3BpY2t1cChzdHJ1
Y3Qgbmxfc29jayAqc2ssIHN0cnVjdCBubF9jYWNoZSAqY2FjaGUsCi0JCSAgIHN0cnVjdCBubF9w
YXJzZXJfcGFyYW0gKnBhcmFtKQotewotCWludCBlcnI7Ci0Jc3RydWN0IG5sX2NiICpjYjsKLQlz
dHJ1Y3QgdXBkYXRlX3hkYXRhIHggPSB7Ci0JCS5vcHMgPSBjYWNoZS0+Y19vcHMsCi0JCS5wYXJh
bXMgPSBwYXJhbSwKLQl9OwotCi0JTkxfREJHKDEsICJQaWNraW5nIHVwIGFuc3dlciBmb3IgY2Fj
aGUgJXAgPCVzPi4uLlxuIiwKLQkJICBjYWNoZSwgbmxfY2FjaGVfbmFtZShjYWNoZSkpOwotCi0J
Y2IgPSBubF9jYl9jbG9uZShzay0+c19jYik7Ci0JaWYgKGNiID09IE5VTEwpCi0JCXJldHVybiAt
TkxFX05PTUVNOwotCi0JbmxfY2Jfc2V0KGNiLCBOTF9DQl9WQUxJRCwgTkxfQ0JfQ1VTVE9NLCB1
cGRhdGVfbXNnX3BhcnNlciwgJngpOwotCi0JZXJyID0gbmxfcmVjdm1zZ3Moc2ssIGNiKTsKLQlp
ZiAoZXJyIDwgMCkKLQkJTkxfREJHKDIsICJXaGlsZSBwaWNraW5nIHVwIGZvciAlcCA8JXM+LCBy
ZWN2bXNncygpIHJldHVybmVkICIgXAotCQkgICAgICAgIiVkOiAlcyIsIGNhY2hlLCBubF9jYWNo
ZV9uYW1lKGNhY2hlKSwKLQkJICAgICAgIGVyciwgbmxfZ2V0ZXJyb3IoZXJyKSk7Ci0KLQlubF9j
Yl9wdXQoY2IpOwotCi0JcmV0dXJuIGVycjsKLX0KLQotc3RhdGljIGludCBwaWNrdXBfY2Ioc3Ry
dWN0IG5sX29iamVjdCAqYywgc3RydWN0IG5sX3BhcnNlcl9wYXJhbSAqcCkKLXsKLQlyZXR1cm4g
bmxfY2FjaGVfYWRkKChzdHJ1Y3QgbmxfY2FjaGUgKikgcC0+cHBfYXJnLCBjKTsKLX0KLQotLyoq
Ci0gKiBQaWNrdXAgYSBuZXRsaW5rIGR1bXAgcmVzcG9uc2UgYW5kIHB1dCBpdCBpbnRvIGEgY2Fj
aGUuCi0gKiBAYXJnIHNrCQlOZXRsaW5rIHNvY2tldC4KLSAqIEBhcmcgY2FjaGUJCUNhY2hlIHRv
IHB1dCBpdGVtcyBpbnRvLgotICoKLSAqIFdhaXRzIGZvciBuZXRsaW5rIG1lc3NhZ2VzIHRvIGFy
cml2ZSwgcGFyc2VzIHRoZW0gYW5kIHB1dHMgdGhlbSBpbnRvCi0gKiB0aGUgc3BlY2lmaWVkIGNh
Y2hlLgotICoKLSAqIEByZXR1cm4gMCBvbiBzdWNjZXNzIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29k
ZS4KLSAqLwotaW50IG5sX2NhY2hlX3BpY2t1cChzdHJ1Y3Qgbmxfc29jayAqc2ssIHN0cnVjdCBu
bF9jYWNoZSAqY2FjaGUpCi17Ci0Jc3RydWN0IG5sX3BhcnNlcl9wYXJhbSBwID0gewotCQkucHBf
Y2IgPSBwaWNrdXBfY2IsCi0JCS5wcF9hcmcgPSBjYWNoZSwKLQl9OwotCi0JcmV0dXJuIF9fY2Fj
aGVfcGlja3VwKHNrLCBjYWNoZSwgJnApOwotfQotCi0KLS8qKiBAfSAqLwotCi0vKioKLSAqIEBu
YW1lIFBhcnNpbmcKLSAqIEB7Ci0gKi8KLQotLyoqIEBjb25kIFNLSVAgKi8KLWludCBubF9jYWNo
ZV9wYXJzZShzdHJ1Y3QgbmxfY2FjaGVfb3BzICpvcHMsIHN0cnVjdCBzb2NrYWRkcl9ubCAqd2hv
LAotCQkgICBzdHJ1Y3Qgbmxtc2doZHIgKm5saCwgc3RydWN0IG5sX3BhcnNlcl9wYXJhbSAqcGFy
YW1zKQotewotCWludCBpLCBlcnI7Ci0KLQlpZiAoIW5sbXNnX3ZhbGlkX2hkcihubGgsIG9wcy0+
Y29faGRyc2l6ZSkpCi0JCXJldHVybiAtTkxFX01TR19UT09TSE9SVDsKLQotCWZvciAoaSA9IDA7
IG9wcy0+Y29fbXNndHlwZXNbaV0ubXRfaWQgPj0gMDsgaSsrKSB7Ci0JCWlmIChvcHMtPmNvX21z
Z3R5cGVzW2ldLm10X2lkID09IG5saC0+bmxtc2dfdHlwZSkgewotCQkJZXJyID0gb3BzLT5jb19t
c2dfcGFyc2VyKG9wcywgd2hvLCBubGgsIHBhcmFtcyk7Ci0JCQlpZiAoZXJyICE9IC1OTEVfT1BO
T1RTVVBQKQotCQkJCWdvdG8gZXJyb3V0OwotCQl9Ci0JfQotCi0KLQllcnIgPSAtTkxFX01TR1RZ
UEVfTk9TVVBQT1JUOwotZXJyb3V0OgotCXJldHVybiBlcnI7Ci19Ci0vKiogQGVuZGNvbmQgKi8K
LQotLyoqCi0gKiBQYXJzZSBhIG5ldGxpbmsgbWVzc2FnZSBhbmQgYWRkIGl0IHRvIHRoZSBjYWNo
ZS4KLSAqIEBhcmcgY2FjaGUJCWNhY2hlIHRvIGFkZCBlbGVtZW50IHRvCi0gKiBAYXJnIG1zZwkJ
bmV0bGluayBtZXNzYWdlCi0gKgotICogUGFyc2VzIGEgbmV0bGluayBtZXNzYWdlIGJ5IGNhbGxp
bmcgdGhlIGNhY2hlIHNwZWNpZmljIG1lc3NhZ2UgcGFyc2VyCi0gKiBhbmQgYWRkcyB0aGUgbmV3
IGVsZW1lbnQgdG8gdGhlIGNhY2hlLgotICoKLSAqIEByZXR1cm4gMCBvciBhIG5lZ2F0aXZlIGVy
cm9yIGNvZGUuCi0gKi8KLWludCBubF9jYWNoZV9wYXJzZV9hbmRfYWRkKHN0cnVjdCBubF9jYWNo
ZSAqY2FjaGUsIHN0cnVjdCBubF9tc2cgKm1zZykKLXsKLQlzdHJ1Y3QgbmxfcGFyc2VyX3BhcmFt
IHAgPSB7Ci0JCS5wcF9jYiA9IHBpY2t1cF9jYiwKLQkJLnBwX2FyZyA9IGNhY2hlLAotCX07Ci0K
LQlyZXR1cm4gbmxfY2FjaGVfcGFyc2UoY2FjaGUtPmNfb3BzLCBOVUxMLCBubG1zZ19oZHIobXNn
KSwgJnApOwotfQotCi0vKioKLSAqIChSZSlmaWxsIGEgY2FjaGUgd2l0aCB0aGUgY29udGVudHMg
aW4gdGhlIGtlcm5lbC4KLSAqIEBhcmcgc2sJCU5ldGxpbmsgc29ja2V0LgotICogQGFyZyBjYWNo
ZQkJY2FjaGUgdG8gdXBkYXRlCi0gKgotICogQ2xlYXJzIHRoZSBzcGVjaWZpZWQgY2FjaGUgYW5k
IGZpbGxzIGl0IHdpdGggdGhlIGN1cnJlbnQgc3RhdGUgaW4KLSAqIHRoZSBrZXJuZWwuCi0gKgot
ICogQHJldHVybiAwIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29kZS4KLSAqLwotaW50IG5sX2NhY2hl
X3JlZmlsbChzdHJ1Y3Qgbmxfc29jayAqc2ssIHN0cnVjdCBubF9jYWNoZSAqY2FjaGUpCi17Ci0J
aW50IGVycjsKLQotCWVyciA9IG5sX2NhY2hlX3JlcXVlc3RfZnVsbF9kdW1wKHNrLCBjYWNoZSk7
Ci0JaWYgKGVyciA8IDApCi0JCXJldHVybiBlcnI7Ci0KLQlOTF9EQkcoMiwgIlVwYWRpbmcgY2Fj
aGUgJXAgPCVzPiwgcmVxdWVzdCBzZW50LCB3YWl0aW5nIGZvciBkdW1wLi4uXG4iLAotCSAgICAg
ICBjYWNoZSwgbmxfY2FjaGVfbmFtZShjYWNoZSkpOwotCW5sX2NhY2hlX2NsZWFyKGNhY2hlKTsK
LQotCXJldHVybiBubF9jYWNoZV9waWNrdXAoc2ssIGNhY2hlKTsKLX0KLQotLyoqIEB9ICovCmRp
ZmYgLS1naXQgYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvY2FjaGVfbW5ndC5jIGIvcGFj
a2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2NhY2hlX21uZ3QuYwpkZWxldGVkIGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggOGFkYmU1MWIwYTExLi4wMDAwMDAwMDAwMDAKLS0tIGEvcGFja2FnZS9saWJz
L2xpYm5sLXRpbnkvc3JjL2NhY2hlX21uZ3QuYworKysgL2Rldi9udWxsCkBAIC0xLDEzMSArMCww
IEBACi0vKgotICogbGliL2NhY2hlX21uZ3QuYwlDYWNoZSBNYW5hZ2VtZW50Ci0gKgotICoJVGhp
cyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9v
cgotICoJbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFs
IFB1YmxpYwotICoJTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91
bmRhdGlvbiB2ZXJzaW9uIDIuMQotICoJb2YgdGhlIExpY2Vuc2UuCi0gKgotICogQ29weXJpZ2h0
IChjKSAyMDAzLTIwMDggVGhvbWFzIEdyYWYgPHRncmFmQHN1dWcuY2g+Ci0gKi8KLQotLyoqCi0g
KiBAaW5ncm91cCBjb3JlCi0gKiBAZGVmZ3JvdXAgY2FjaGVfbW5ndCBDYWNoaW5nCi0gKiBAewot
ICovCi0KLSNpbmNsdWRlIDxuZXRsaW5rLWxvY2FsLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9uZXRs
aW5rLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9jYWNoZS5oPgotI2luY2x1ZGUgPG5ldGxpbmsvdXRp
bHMuaD4KLQotc3RhdGljIHN0cnVjdCBubF9jYWNoZV9vcHMgKmNhY2hlX29wczsKLQotLyoqCi0g
KiBAbmFtZSBDYWNoZSBPcGVyYXRpb25zIFNldHMKLSAqIEB7Ci0gKi8KLQotLyoqCi0gKiBMb29r
dXAgdGhlIHNldCBjYWNoZSBvcGVyYXRpb25zIG9mIGEgY2VydGFpbiBjYWNoZSB0eXBlCi0gKiBA
YXJnIG5hbWUJCW5hbWUgb2YgdGhlIGNhY2hlIHR5cGUKLSAqCi0gKiBAcmV0dXJuIFRoZSBjYWNo
ZSBvcGVyYXRpb25zIG9yIE5VTEwgaWYgbm8gb3BlcmF0aW9ucwotICogICAgICAgICBoYXZlIGJl
ZW4gcmVnaXN0ZXJlZCB1bmRlciB0aGUgc3BlY2lmaWVkIG5hbWUuCi0gKi8KLXN0cnVjdCBubF9j
YWNoZV9vcHMgKm5sX2NhY2hlX29wc19sb29rdXAoY29uc3QgY2hhciAqbmFtZSkKLXsKLQlzdHJ1
Y3QgbmxfY2FjaGVfb3BzICpvcHM7Ci0KLQlmb3IgKG9wcyA9IGNhY2hlX29wczsgb3BzOyBvcHMg
PSBvcHMtPmNvX25leHQpCi0JCWlmICghc3RyY21wKG9wcy0+Y29fbmFtZSwgbmFtZSkpCi0JCQly
ZXR1cm4gb3BzOwotCi0JcmV0dXJuIE5VTEw7Ci19Ci0KLS8qKgotICogQXNzb2NpYXRlIGEgbWVz
c2FnZSB0eXBlIHRvIGEgc2V0IG9mIGNhY2hlIG9wZXJhdGlvbnMKLSAqIEBhcmcgcHJvdG9jb2wJ
CW5ldGxpbmsgcHJvdG9jb2wKLSAqIEBhcmcgbXNndHlwZQkJCW5ldGxpbmsgbWVzc2FnZSB0eXBl
Ci0gKgotICogQXNzb2NpYXRlcyB0aGUgc3BlY2lmaWVkIG5ldGxpbmsgbWVzc2FnZSB0eXBlIHdp
dGgKLSAqIGEgcmVnaXN0ZXJlZCBzZXQgb2YgY2FjaGUgb3BlcmF0aW9ucy4KLSAqCi0gKiBAcmV0
dXJuIFRoZSBjYWNoZSBvcGVyYXRpb25zIG9yIE5VTEwgaWYgbm8gYXNzb2NpYXRpb24KLSAqICAg
ICAgICAgY291bGQgYmUgbWFkZS4KLSAqLwotc3RydWN0IG5sX2NhY2hlX29wcyAqbmxfY2FjaGVf
b3BzX2Fzc29jaWF0ZShpbnQgcHJvdG9jb2wsIGludCBtc2d0eXBlKQotewotCWludCBpOwotCXN0
cnVjdCBubF9jYWNoZV9vcHMgKm9wczsKLQotCWZvciAob3BzID0gY2FjaGVfb3BzOyBvcHM7IG9w
cyA9IG9wcy0+Y29fbmV4dCkgewotCQlpZiAob3BzLT5jb19wcm90b2NvbCAhPSBwcm90b2NvbCkK
LQkJCWNvbnRpbnVlOwotCi0JCWZvciAoaSA9IDA7IG9wcy0+Y29fbXNndHlwZXNbaV0ubXRfaWQg
Pj0gMDsgaSsrKQotCQkJaWYgKG9wcy0+Y29fbXNndHlwZXNbaV0ubXRfaWQgPT0gbXNndHlwZSkK
LQkJCQlyZXR1cm4gb3BzOwotCX0KLQotCXJldHVybiBOVUxMOwotfQotCi0vKioKLSAqIFJlZ2lz
dGVyIGEgc2V0IG9mIGNhY2hlIG9wZXJhdGlvbnMKLSAqIEBhcmcgb3BzCQljYWNoZSBvcGVyYXRp
b25zCi0gKgotICogQ2FsbGVkIGJ5IHVzZXJzIG9mIGNhY2hlcyB0byBhbm5vdW5jZSB0aGUgYXZh
aWJpbGl0eSBvZgotICogYSBjZXJ0YWluIGNhY2hlIHR5cGUuCi0gKgotICogQHJldHVybiAwIG9u
IHN1Y2Nlc3Mgb3IgYSBuZWdhdGl2ZSBlcnJvciBjb2RlLgotICovCi1pbnQgbmxfY2FjaGVfbW5n
dF9yZWdpc3RlcihzdHJ1Y3QgbmxfY2FjaGVfb3BzICpvcHMpCi17Ci0JaWYgKCFvcHMtPmNvX25h
bWUgfHwgIW9wcy0+Y29fb2JqX29wcykKLQkJcmV0dXJuIC1OTEVfSU5WQUw7Ci0KLQlpZiAobmxf
Y2FjaGVfb3BzX2xvb2t1cChvcHMtPmNvX25hbWUpKQotCQlyZXR1cm4gLU5MRV9FWElTVDsKLQot
CW9wcy0+Y29fbmV4dCA9IGNhY2hlX29wczsKLQljYWNoZV9vcHMgPSBvcHM7Ci0KLQlOTF9EQkco
MSwgIlJlZ2lzdGVyZWQgY2FjaGUgb3BlcmF0aW9ucyAlc1xuIiwgb3BzLT5jb19uYW1lKTsKLQot
CXJldHVybiAwOwotfQotCi0vKioKLSAqIFVucmVnaXN0ZXIgYSBzZXQgb2YgY2FjaGUgb3BlcmF0
aW9ucwotICogQGFyZyBvcHMJCWNhY2hlIG9wZXJhdGlvbnMKLSAqCi0gKiBDYWxsZWQgYnkgdXNl
cnMgb2YgY2FjaGVzIHRvIGFubm91bmNlIGEgc2V0IG9mCi0gKiBjYWNoZSBvcGVyYXRpb25zIGlz
IG5vIGxvbmdlciBhdmFpbGFibGUuIFRoZQotICogc3BlY2lmaWVkIGNhY2hlIG9wZXJhdGlvbnMg
bXVzdCBoYXZlIGJlZW4gcmVnaXN0ZXJlZAotICogcHJldmlvdXNseSB1c2luZyBubF9jYWNoZV9t
bmd0X3JlZ2lzdGVyKCkKLSAqCi0gKiBAcmV0dXJuIDAgb24gc3VjY2VzcyBvciBhIG5lZ2F0aXZl
IGVycm9yIGNvZGUKLSAqLwotaW50IG5sX2NhY2hlX21uZ3RfdW5yZWdpc3RlcihzdHJ1Y3Qgbmxf
Y2FjaGVfb3BzICpvcHMpCi17Ci0Jc3RydWN0IG5sX2NhY2hlX29wcyAqdCwgKip0cDsKLQotCWZv
ciAodHAgPSAmY2FjaGVfb3BzOyAodD0qdHApICE9IE5VTEw7IHRwID0gJnQtPmNvX25leHQpCi0J
CWlmICh0ID09IG9wcykKLQkJCWJyZWFrOwotCi0JaWYgKCF0KQotCQlyZXR1cm4gLU5MRV9OT0NB
Q0hFOwotCi0JTkxfREJHKDEsICJVbnJlZ2lzdGVyZWQgY2FjaGUgb3BlcmF0aW9ucyAlc1xuIiwg
b3BzLT5jb19uYW1lKTsKLQotCSp0cCA9IHQtPmNvX25leHQ7Ci0JcmV0dXJuIDA7Ci19Ci0KLS8q
KiBAfSAqLwotCi0vKiogQH0gKi8KZGlmZiAtLWdpdCBhL3BhY2thZ2UvbGlicy9saWJubC10aW55
L3NyYy9lcnJvci5jIGIvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2Vycm9yLmMKZGVsZXRl
ZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IGU4ZWU0NzQ1OWVlNy4uMDAwMDAwMDAwMDAwCi0tLSBh
L3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9lcnJvci5jCisrKyAvZGV2L251bGwKQEAgLTEs
MTE2ICswLDAgQEAKLS8qCi0gKiBsaWIvZXJyb3IuYwkJRXJyb3IgSGFuZGxpbmcKLSAqCi0gKglU
aGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5k
L29yCi0gKgltb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVy
YWwgUHVibGljCi0gKglMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBG
b3VuZGF0aW9uIHZlcnNpb24gMi4xCi0gKglvZiB0aGUgTGljZW5zZS4KLSAqCi0gKiBDb3B5cmln
aHQgKGMpIDIwMDggVGhvbWFzIEdyYWYgPHRncmFmQHN1dWcuY2g+Ci0gKi8KLQotI2luY2x1ZGUg
PG5ldGxpbmstbG9jYWwuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL25ldGxpbmsuaD4KLQotc3RhdGlj
IGNvbnN0IGNoYXIgKmVycm1zZ1tOTEVfTUFYKzFdID0gewotW05MRV9TVUNDRVNTXQkJPSAiU3Vj
Y2VzcyIsCi1bTkxFX0ZBSUxVUkVdCQk9ICJVbnNwZWNpZmljIGZhaWx1cmUiLAotW05MRV9JTlRS
XQkJPSAiSW50ZXJydXB0ZWQgc3lzdGVtIGNhbGwiLAotW05MRV9CQURfU09DS10JCT0gIkJhZCBz
b2NrZXQiLAotW05MRV9BR0FJTl0JCT0gIlRyeSBhZ2FpbiIsCi1bTkxFX05PTUVNXQkJPSAiT3V0
IG9mIG1lbW9yeSIsCi1bTkxFX0VYSVNUXQkJPSAiT2JqZWN0IGV4aXN0cyIsCi1bTkxFX0lOVkFM
XQkJPSAiSW52YWxpZCBpbnB1dCBkYXRhIG9yIHBhcmFtZXRlciIsCi1bTkxFX1JBTkdFXQkJPSAi
SW5wdXQgZGF0YSBvdXQgb2YgcmFuZ2UiLAotW05MRV9NU0dTSVpFXQkJPSAiTWVzc2FnZSBzaXpl
IG5vdCBzdWZmaWNpZW50IiwKLVtOTEVfT1BOT1RTVVBQXQkJPSAiT3BlcmF0aW9uIG5vdCBzdXBw
b3J0ZWQiLAotW05MRV9BRl9OT1NVUFBPUlRdCT0gIkFkZHJlc3MgZmFtaWx5IG5vdCBzdXBwb3J0
ZWQiLAotW05MRV9PQkpfTk9URk9VTkRdCT0gIk9iamVjdCBub3QgZm91bmQiLAotW05MRV9OT0FU
VFJdCQk9ICJBdHRyaWJ1dGUgbm90IGF2YWlsYWJsZSIsCi1bTkxFX01JU1NJTkdfQVRUUl0JPSAi
TWlzc2luZyBhdHRyaWJ1dGUiLAotW05MRV9BRl9NSVNNQVRDSF0JPSAiQWRkcmVzcyBmYW1pbHkg
bWlzbWF0Y2giLAotW05MRV9TRVFfTUlTTUFUQ0hdCT0gIk1lc3NhZ2Ugc2VxdWVuY2UgbnVtYmVy
IG1pc21hdGNoIiwKLVtOTEVfTVNHX09WRVJGTE9XXQk9ICJLZXJuZWwgcmVwb3J0ZWQgbWVzc2Fn
ZSBvdmVyZmxvdyIsCi1bTkxFX01TR19UUlVOQ10JCT0gIktlcm5lbCByZXBvcnRlZCB0cnVuY2F0
ZWQgbWVzc2FnZSIsCi1bTkxFX05PQUREUl0JCT0gIkludmFsaWQgYWRkcmVzcyBmb3Igc3BlY2lm
aWVkIGFkZHJlc3MgZmFtaWx5IiwKLVtOTEVfU1JDUlRfTk9TVVBQT1JUXQk9ICJTb3VyY2UgYmFz
ZWQgcm91dGluZyBub3Qgc3VwcG9ydGVkIiwKLVtOTEVfTVNHX1RPT1NIT1JUXQk9ICJOZXRsaW5r
IG1lc3NhZ2UgaXMgdG9vIHNob3J0IiwKLVtOTEVfTVNHVFlQRV9OT1NVUFBPUlRdCT0gIk5ldGxp
bmsgbWVzc2FnZSB0eXBlIGlzIG5vdCBzdXBwb3J0ZWQiLAotW05MRV9PQkpfTUlTTUFUQ0hdCT0g
Ik9iamVjdCB0eXBlIGRvZXMgbm90IG1hdGNoIGNhY2hlIiwKLVtOTEVfTk9DQUNIRV0JCT0gIlVu
a25vd24gb3IgaW52YWxpZCBjYWNoZSB0eXBlIiwKLVtOTEVfQlVTWV0JCT0gIk9iamVjdCBidXN5
IiwKLVtOTEVfUFJPVE9fTUlTTUFUQ0hdCT0gIlByb3RvY29sIG1pc21hdGNoIiwKLVtOTEVfTk9B
Q0NFU1NdCQk9ICJObyBBY2Nlc3MiLAotW05MRV9QRVJNXQkJPSAiT3BlcmF0aW9uIG5vdCBwZXJt
aXR0ZWQiLAotW05MRV9QS1RMT0NfRklMRV0JPSAiVW5hYmxlIHRvIG9wZW4gcGFja2V0IGxvY2F0
aW9uIGZpbGUiLAotW05MRV9QQVJTRV9FUlJdCQk9ICJVbmFibGUgdG8gcGFyc2Ugb2JqZWN0IiwK
LVtOTEVfTk9ERVZdCQk9ICJObyBzdWNoIGRldmljZSIsCi1bTkxFX0lNTVVUQUJMRV0JCT0gIklt
bXV0YWJsZSBhdHRyaWJ1dGUiLAotW05MRV9EVU1QX0lOVFJdCQk9ICJEdW1wIGluY29uc2lzdGVu
Y3kgZGV0ZWN0ZWQsIGludGVycnVwdGVkIiwKLX07Ci0KLS8qKgotICogUmV0dXJuIGVycm9yIG1l
c3NhZ2UgZm9yIGFuIGVycm9yIGNvZGUKLSAqIEByZXR1cm4gZXJyb3IgbWVzc2FnZQotICovCi1j
b25zdCBjaGFyICpubF9nZXRlcnJvcihpbnQgZXJyb3IpCi17Ci0JZXJyb3IgPSBhYnMoZXJyb3Ip
OwotCi0JaWYgKGVycm9yID4gTkxFX01BWCkKLQkJZXJyb3IgPSBOTEVfRkFJTFVSRTsKLQotCXJl
dHVybiBlcnJtc2dbZXJyb3JdOwotfQotCi0vKioKLSAqIFByaW50IGEgbGlibmwgZXJyb3IgbWVz
c2FnZQotICogQGFyZyBzCQllcnJvciBtZXNzYWdlIHByZWZpeAotICoKLSAqIFByaW50cyB0aGUg
ZXJyb3IgbWVzc2FnZSBvZiB0aGUgY2FsbCB0aGF0IGZhaWxlZCBsYXN0LgotICoKLSAqIElmIHMg
aXMgbm90IE5VTEwgYW5kICpzIGlzIG5vdCBhIG51bGwgYnl0ZSB0aGUgYXJndW1lbnQKLSAqIHN0
cmluZyBpcyBwcmludGVkLCBmb2xsb3dlZCBieSBhIGNvbG9uIGFuZCBhIGJsYW5rLiBUaGVuCi0g
KiB0aGUgZXJyb3IgbWVzc2FnZSBhbmQgYSBuZXctbGluZS4KLSAqLwotdm9pZCBubF9wZXJyb3Io
aW50IGVycm9yLCBjb25zdCBjaGFyICpzKQotewotCWlmIChzICYmICpzKQotCQlmcHJpbnRmKHN0
ZGVyciwgIiVzOiAlc1xuIiwgcywgbmxfZ2V0ZXJyb3IoZXJyb3IpKTsKLQllbHNlCi0JCWZwcmlu
dGYoc3RkZXJyLCAiJXNcbiIsIG5sX2dldGVycm9yKGVycm9yKSk7Ci19Ci0KLWludCBubF9zeXNl
cnIybmxlcnIoaW50IGVycm9yKQotewotCWVycm9yID0gYWJzKGVycm9yKTsKLQotCXN3aXRjaCAo
ZXJyb3IpIHsKLQljYXNlIEVCQURGOgkJcmV0dXJuIE5MRV9CQURfU09DSzsKLQljYXNlIEVBRERS
SU5VU0U6CXJldHVybiBOTEVfRVhJU1Q7Ci0JY2FzZSBFRVhJU1Q6CQlyZXR1cm4gTkxFX0VYSVNU
OwotCWNhc2UgRUFERFJOT1RBVkFJTDoJcmV0dXJuIE5MRV9OT0FERFI7Ci0JY2FzZSBFU1JDSDoJ
CS8qIGZhbGwgdGhyb3VnaCAqLwotCWNhc2UgRU5PRU5UOgkJcmV0dXJuIE5MRV9PQkpfTk9URk9V
TkQ7Ci0JY2FzZSBFSU5UUjoJCXJldHVybiBOTEVfSU5UUjsKLQljYXNlIEVBR0FJTjoJCXJldHVy
biBOTEVfQUdBSU47Ci0JY2FzZSBFTk9UU09DSzoJCXJldHVybiBOTEVfQkFEX1NPQ0s7Ci0JY2Fz
ZSBFTk9QUk9UT09QVDoJcmV0dXJuIE5MRV9JTlZBTDsKLQljYXNlIEVGQVVMVDoJCXJldHVybiBO
TEVfSU5WQUw7Ci0JY2FzZSBFQUNDRVM6CQlyZXR1cm4gTkxFX05PQUNDRVNTOwotCWNhc2UgRUlO
VkFMOgkJcmV0dXJuIE5MRV9JTlZBTDsKLQljYXNlIEVOT0JVRlM6CQlyZXR1cm4gTkxFX05PTUVN
OwotCWNhc2UgRU5PTUVNOgkJcmV0dXJuIE5MRV9OT01FTTsKLQljYXNlIEVBRk5PU1VQUE9SVDoJ
cmV0dXJuIE5MRV9BRl9OT1NVUFBPUlQ7Ci0JY2FzZSBFUFJPVE9OT1NVUFBPUlQ6CXJldHVybiBO
TEVfUFJPVE9fTUlTTUFUQ0g7Ci0JY2FzZSBFT1BOT1RTVVBQOglyZXR1cm4gTkxFX09QTk9UU1VQ
UDsKLQljYXNlIEVQRVJNOgkJcmV0dXJuIE5MRV9QRVJNOwotCWNhc2UgRUJVU1k6CQlyZXR1cm4g
TkxFX0JVU1k7Ci0JY2FzZSBFUkFOR0U6CQlyZXR1cm4gTkxFX1JBTkdFOwotCWNhc2UgRU5PREVW
OgkJcmV0dXJuIE5MRV9OT0RFVjsKLQlkZWZhdWx0OgkJcmV0dXJuIE5MRV9GQUlMVVJFOwotCX0K
LX0KLQotLyoqIEB9ICovCi0KZGlmZiAtLWdpdCBhL3BhY2thZ2UvbGlicy9saWJubC10aW55L3Ny
Yy9nZW5sLmMgYi9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvZ2VubC5jCmRlbGV0ZWQgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwNTViZTkxOWUxZDMuLjAwMDAwMDAwMDAwMAotLS0gYS9wYWNr
YWdlL2xpYnMvbGlibmwtdGlueS9zcmMvZ2VubC5jCisrKyAvZGV2L251bGwKQEAgLTEsMjY4ICsw
LDAgQEAKLS8qCi0gKiBsaWIvZ2VubC9nZW5sLmMJCUdlbmVyaWMgTmV0bGluawotICoKLSAqCVRo
aXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQv
b3IKLSAqCW1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJh
bCBQdWJsaWMKLSAqCUxpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZv
dW5kYXRpb24gdmVyc2lvbiAyLjEKLSAqCW9mIHRoZSBMaWNlbnNlLgotICoKLSAqIENvcHlyaWdo
dCAoYykgMjAwMy0yMDA4IFRob21hcyBHcmFmIDx0Z3JhZkBzdXVnLmNoPgotICovCi0KLS8qKgot
ICogQGRlZmdyb3VwIGdlbmwgR2VuZXJpYyBOZXRsaW5rCi0gKgotICogQHBhciBNZXNzYWdlIEZv
cm1hdAotICogQGNvZGUKLSAqICA8LS0tLS0tLSBOTE1TR19BTElHTihobGVuKSAtLS0tLS0+IDwt
LS0tIE5MTVNHX0FMSUdOKGxlbikgLS0tPgotICogKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0rLSAtIC0rLSAtIC0gLSAtIC0gLSAtIC0gLSAtKy0gLSAtKwotICogfCAgICAgICAgICAgSGVh
ZGVyICAgICAgICAgICB8IFBhZCB8ICAgICAgIFBheWxvYWQgICAgICAgfCBQYWQgfAotICogfCAg
ICAgIHN0cnVjdCBubG1zZ2hkciAgICAgICB8ICAgICB8ICAgICAgICAgICAgICAgICAgICAgfCAg
ICAgfAotICogKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLSAtIC0rLSAtIC0gLSAtIC0g
LSAtIC0gLSAtKy0gLSAtKwotICogQGVuZGNvZGUKLSAqIEBjb2RlCi0gKiAgPC0tLS0tLS0tIEdF
TkxfSERSTEVOIC0tLS0tLS0+IDwtLS0gaGRybGVuIC0tPgotICogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICA8LS0tLS0tLSBnZW5sbXNnX2xlbihnaGRyKSAtLS0tLS0+Ci0gKiArLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0gLSAtKy0tLS0tLS0tLS0tLS0tLSstIC0gLSstLS0tLS0t
LS0tLS0rCi0gKiB8IEdlbmVyaWMgTmV0bGluayBIZWFkZXIgfCBQYWQgfCBGYW1pbHkgSGVhZGVy
IHwgUGFkIHwgQXR0cmlidXRlcyB8Ci0gKiB8ICAgIHN0cnVjdCBnZW5sbXNnaGRyICAgfCAgICAg
fCAgICAgICAgICAgICAgIHwgICAgIHwgICAgICAgICAgICB8Ci0gKiArLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tKy0gLSAtKy0tLS0tLS0tLS0tLS0tLSstIC0gLSstLS0tLS0tLS0tLS0rCi0gKiBn
ZW5sbXNnX2RhdGEoZ2hkciktLS0tLS0tLS0tLS0tLV4gICAgICAgICAgICAgICAgICAgICBeCi0g
KiBnZW5sbXNnX2F0dHJkYXRhKGdoZHIsIGhkcmxlbiktLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
Ci0gKiBAZW5kY29kZQotICoKLSAqIEBwYXIgRXhhbXBsZQotICogQGNvZGUKLSAqICNpbmNsdWRl
IDxuZXRsaW5rL25ldGxpbmsuaD4KLSAqICNpbmNsdWRlIDxuZXRsaW5rL2dlbmwvZ2VubC5oPgot
ICogI2luY2x1ZGUgPG5ldGxpbmsvZ2VubC9jdHJsLmg+Ci0gKgotICogc3RydWN0IG5sX3NvY2sg
KnNvY2s7Ci0gKiBzdHJ1Y3QgbmxfbXNnICptc2c7Ci0gKiBpbnQgZmFtaWx5OwotICoKLSAqIC8v
IEFsbG9jYXRlIGEgbmV3IG5ldGxpbmsgc29ja2V0Ci0gKiBzb2NrID0gbmxfc29ja2V0X2FsbG9j
KCk7Ci0gKgotICogLy8gQ29ubmVjdCB0byBnZW5lcmljIG5ldGxpbmsgc29ja2V0IG9uIGtlcm5l
bCBzaWRlCi0gKiBnZW5sX2Nvbm5lY3Qoc29jayk7Ci0gKgotICogLy8gQXNrIGtlcm5lbCB0byBy
ZXNvbHZlIGZhbWlseSBuYW1lIHRvIGZhbWlseSBpZAotICogZmFtaWx5ID0gZ2VubF9jdHJsX3Jl
c29sdmUoc29jaywgImdlbmVyaWNfbmV0bGlua19mYW1pbHlfbmFtZSIpOwotICoKLSAqIC8vIENv
bnN0cnVjdCBhIGdlbmVyaWMgbmV0bGluayBieSBhbGxvY2F0aW5nIGEgbmV3IG1lc3NhZ2UsIGZp
bGwgaW4KLSAqIC8vIHRoZSBoZWFkZXIgYW5kIGFwcGVuZCBhIHNpbXBsZSBpbnRlZ2VyIGF0dHJp
YnV0ZS4KLSAqIG1zZyA9IG5sbXNnX2FsbG9jKCk7Ci0gKiBnZW5sbXNnX3B1dChtc2csIE5MX0FV
VE9fUElELCBOTF9BVVRPX1NFUSwgZmFtaWx5LCAwLCBOTE1fRl9FQ0hPLAotICogICAgICAgICAg
ICAgQ01EX0ZPT19HRVQsIEZPT19WRVJTSU9OKTsKLSAqIG5sYV9wdXRfdTMyKG1zZywgQVRUUl9G
T08sIDEyMyk7Ci0gKgotICogLy8gU2VuZCBtZXNzYWdlIG92ZXIgbmV0bGluayBzb2NrZXQKLSAq
IG5sX3NlbmRfYXV0b19jb21wbGV0ZShzb2NrLCBtc2cpOwotICoKLSAqIC8vIEZyZWUgbWVzc2Fn
ZQotICogbmxtc2dfZnJlZShtc2cpOwotICoKLSAqIC8vIFByZXBhcmUgc29ja2V0IHRvIHJlY2Vp
dmUgdGhlIGFuc3dlciBieSBzcGVjaWZ5aW5nIHRoZSBjYWxsYmFjawotICogLy8gZnVuY3Rpb24g
dG8gYmUgY2FsbGVkIGZvciB2YWxpZCBtZXNzYWdlcy4KLSAqIG5sX3NvY2tldF9tb2RpZnlfY2Io
c29jaywgTkxfQ0JfVkFMSUQsIE5MX0NCX0NVU1RPTSwgcGFyc2VfY2IsIE5VTEwpOwotICoKLSAq
IC8vIFdhaXQgZm9yIHRoZSBhbnN3ZXIgYW5kIHJlY2VpdmUgaXQKLSAqIG5sX3JlY3Ztc2dzX2Rl
ZmF1bHQoc29jayk7Ci0gKgotICogc3RhdGljIGludCBwYXJzZV9jYihzdHJ1Y3QgbmxfbXNnICpt
c2csIHZvaWQgKmFyZykKLSAqIHsKLSAqICAgICBzdHJ1Y3Qgbmxtc2doZHIgKm5saCA9IG5sbXNn
X2hkcihtc2cpOwotICogICAgIHN0cnVjdCBubGF0dHIgKmF0dHJzW0FUVFJfTUFYKzFdOwotICoK
LSAqICAgICAvLyBWYWxpZGF0ZSBtZXNzYWdlIGFuZCBwYXJzZSBhdHRyaWJ1dGVzCi0gKiAgICAg
Z2VubG1zZ19wYXJzZShubGgsIDAsIGF0dHJzLCBBVFRSX01BWCwgcG9saWN5KTsKLSAqCi0gKiAg
ICAgaWYgKGF0dHJzW0FUVFJfRk9PXSkgewotICogICAgICAgICB1aW50MzJfdCB2YWx1ZSA9IG5s
YV9nZXRfdTMyKGF0dHJzW0FUVFJfRk9PXSk7Ci0gKiAgICAgICAgIC4uLgotICogICAgIH0KLSAq
Ci0gKiAgICAgcmV0dXJuIDA7Ci0gKiB9Ci0gKiBAZW5kY29kZQotICogQHsKLSAqLwotCi0jaW5j
bHVkZSA8bmV0bGluay1nZW5lcmljLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9uZXRsaW5rLmg+Ci0j
aW5jbHVkZSA8bmV0bGluay9nZW5sL2dlbmwuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL3V0aWxzLmg+
Ci0KLS8qKgotICogQG5hbWUgU29ja2V0IENyZWF0aW5nCi0gKiBAewotICovCi0KLWludCBnZW5s
X2Nvbm5lY3Qoc3RydWN0IG5sX3NvY2sgKnNrKQotewotCXJldHVybiBubF9jb25uZWN0KHNrLCBO
RVRMSU5LX0dFTkVSSUMpOwotfQotCi0vKiogQH0gKi8KLQotLyoqCi0gKiBAbmFtZSBTZW5kaW5n
Ci0gKiBAewotICovCi0KLS8qKgotICogU2VuZCB0cml2aWFsIGdlbmVyaWMgbmV0bGluayBtZXNz
YWdlCi0gKiBAYXJnIHNrCQlOZXRsaW5rIHNvY2tldC4KLSAqIEBhcmcgZmFtaWx5CQlHZW5lcmlj
IG5ldGxpbmsgZmFtaWx5Ci0gKiBAYXJnIGNtZAkJQ29tbWFuZAotICogQGFyZyB2ZXJzaW9uCQlW
ZXJzaW9uCi0gKiBAYXJnIGZsYWdzCQlBZGRpdGlvbmFsIG5ldGxpbmsgbWVzc2FnZSBmbGFncy4K
LSAqCi0gKiBGaWxscyBvdXQgYSByb3V0aW5nIG5ldGxpbmsgcmVxdWVzdCBtZXNzYWdlIGFuZCBz
ZW5kcyBpdCBvdXQKLSAqIHVzaW5nIG5sX3NlbmRfc2ltcGxlKCkuCi0gKgotICogQHJldHVybiAw
IG9uIHN1Y2Nlc3Mgb3IgYSBuZWdhdGl2ZSBlcnJvciBjb2RlLgotICovCi1pbnQgZ2VubF9zZW5k
X3NpbXBsZShzdHJ1Y3Qgbmxfc29jayAqc2ssIGludCBmYW1pbHksIGludCBjbWQsCi0JCSAgICAg
aW50IHZlcnNpb24sIGludCBmbGFncykKLXsKLQlzdHJ1Y3QgZ2VubG1zZ2hkciBoZHIgPSB7Ci0J
CS5jbWQgPSBjbWQsCi0JCS52ZXJzaW9uID0gdmVyc2lvbiwKLQl9OwotCi0JcmV0dXJuIG5sX3Nl
bmRfc2ltcGxlKHNrLCBmYW1pbHksIGZsYWdzLCAmaGRyLCBzaXplb2YoaGRyKSk7Ci19Ci0KLS8q
KiBAfSAqLwotCi0KLS8qKgotICogQG5hbWUgTWVzc2FnZSBQYXJzaW5nCi0gKiBAewotICovCi0K
LWludCBnZW5sbXNnX3ZhbGlkX2hkcihzdHJ1Y3Qgbmxtc2doZHIgKm5saCwgaW50IGhkcmxlbikK
LXsKLQlzdHJ1Y3QgZ2VubG1zZ2hkciAqZ2hkcjsKLQotCWlmICghbmxtc2dfdmFsaWRfaGRyKG5s
aCwgR0VOTF9IRFJMRU4pKQotCQlyZXR1cm4gMDsKLQotCWdoZHIgPSBubG1zZ19kYXRhKG5saCk7
Ci0JaWYgKGdlbmxtc2dfbGVuKGdoZHIpIDwgTkxNU0dfQUxJR04oaGRybGVuKSkKLQkJcmV0dXJu
IDA7Ci0KLQlyZXR1cm4gMTsKLX0KLQotaW50IGdlbmxtc2dfdmFsaWRhdGUoc3RydWN0IG5sbXNn
aGRyICpubGgsIGludCBoZHJsZW4sIGludCBtYXh0eXBlLAotCQkgICBzdHJ1Y3QgbmxhX3BvbGlj
eSAqcG9saWN5KQotewotCXN0cnVjdCBnZW5sbXNnaGRyICpnaGRyOwotCi0JaWYgKCFnZW5sbXNn
X3ZhbGlkX2hkcihubGgsIGhkcmxlbikpCi0JCXJldHVybiAtTkxFX01TR19UT09TSE9SVDsKLQot
CWdoZHIgPSBubG1zZ19kYXRhKG5saCk7Ci0JcmV0dXJuIG5sYV92YWxpZGF0ZShnZW5sbXNnX2F0
dHJkYXRhKGdoZHIsIGhkcmxlbiksCi0JCQkgICAgZ2VubG1zZ19hdHRybGVuKGdoZHIsIGhkcmxl
biksIG1heHR5cGUsIHBvbGljeSk7Ci19Ci0KLWludCBnZW5sbXNnX3BhcnNlKHN0cnVjdCBubG1z
Z2hkciAqbmxoLCBpbnQgaGRybGVuLCBzdHJ1Y3QgbmxhdHRyICp0YltdLAotCQkgIGludCBtYXh0
eXBlLCBzdHJ1Y3QgbmxhX3BvbGljeSAqcG9saWN5KQotewotCXN0cnVjdCBnZW5sbXNnaGRyICpn
aGRyOwotCi0JaWYgKCFnZW5sbXNnX3ZhbGlkX2hkcihubGgsIGhkcmxlbikpCi0JCXJldHVybiAt
TkxFX01TR19UT09TSE9SVDsKLQotCWdoZHIgPSBubG1zZ19kYXRhKG5saCk7Ci0JcmV0dXJuIG5s
YV9wYXJzZSh0YiwgbWF4dHlwZSwgZ2VubG1zZ19hdHRyZGF0YShnaGRyLCBoZHJsZW4pLAotCQkJ
IGdlbmxtc2dfYXR0cmxlbihnaGRyLCBoZHJsZW4pLCBwb2xpY3kpOwotfQotCi0vKioKLSAqIEdl
dCBoZWFkIG9mIG1lc3NhZ2UgcGF5bG9hZAotICogQGFyZyBnbmxoCWdlbmV0bGluayBtZXNzc2Fn
ZSBoZWFkZXIKLSAqLwotdm9pZCAqZ2VubG1zZ19kYXRhKGNvbnN0IHN0cnVjdCBnZW5sbXNnaGRy
ICpnbmxoKQotewotCXJldHVybiAoKHVuc2lnbmVkIGNoYXIgKikgZ25saCArIEdFTkxfSERSTEVO
KTsKLX0KLQotLyoqCi0gKiBHZXQgbGVuZ2h0IG9mIG1lc3NhZ2UgcGF5bG9hZAotICogQGFyZyBn
bmxoCWdlbmV0bGluayBtZXNzYWdlIGhlYWRlcgotICovCi1pbnQgZ2VubG1zZ19sZW4oY29uc3Qg
c3RydWN0IGdlbmxtc2doZHIgKmdubGgpCi17Ci0Jc3RydWN0IG5sbXNnaGRyICpubGggPSAoc3Ry
dWN0IG5sbXNnaGRyICopKCh1bnNpZ25lZCBjaGFyICopZ25saCAtCi0JCQkJCQkJTkxNU0dfSERS
TEVOKTsKLQlyZXR1cm4gKG5saC0+bmxtc2dfbGVuIC0gR0VOTF9IRFJMRU4gLSBOTE1TR19IRFJM
RU4pOwotfQotCi0vKioKLSAqIEdldCBoZWFkIG9mIGF0dHJpYnV0ZSBkYXRhCi0gKiBAYXJnIGdu
bGgJZ2VuZXJpYyBuZXRsaW5rIG1lc3NhZ2UgaGVhZGVyCi0gKiBAYXJnIGhkcmxlbglsZW5ndGgg
b2YgZmFtaWx5IHNwZWNpZmljIGhlYWRlcgotICovCi1zdHJ1Y3QgbmxhdHRyICpnZW5sbXNnX2F0
dHJkYXRhKGNvbnN0IHN0cnVjdCBnZW5sbXNnaGRyICpnbmxoLCBpbnQgaGRybGVuKQotewotCXJl
dHVybiBnZW5sbXNnX2RhdGEoZ25saCkgKyBOTE1TR19BTElHTihoZHJsZW4pOwotfQotCi0vKioK
LSAqIEdldCBsZW5ndGggb2YgYXR0cmlidXRlIGRhdGEKLSAqIEBhcmcgZ25saAlnZW5lcmljIG5l
dGxpbmsgbWVzc2FnZSBoZWFkZXIKLSAqIEBhcmcgaGRybGVuCWxlbmd0aCBvZiBmYW1pbHkgc3Bl
Y2lmaWMgaGVhZGVyCi0gKi8KLWludCBnZW5sbXNnX2F0dHJsZW4oY29uc3Qgc3RydWN0IGdlbmxt
c2doZHIgKmdubGgsIGludCBoZHJsZW4pCi17Ci0JcmV0dXJuIGdlbmxtc2dfbGVuKGdubGgpIC0g
TkxNU0dfQUxJR04oaGRybGVuKTsKLX0KLQotLyoqIEB9ICovCi0KLS8qKgotICogQG5hbWUgTWVz
c2FnZSBCdWlsZGluZwotICogQHsKLSAqLwotCi0vKioKLSAqIEFkZCBnZW5lcmljIG5ldGxpbmsg
aGVhZGVyIHRvIG5ldGxpbmsgbWVzc2FnZQotICogQGFyZyBtc2cJCW5ldGxpbmsgbWVzc2FnZQot
ICogQGFyZyBwaWQJCW5ldGxpbmsgcHJvY2VzcyBpZCBvciBOTF9BVVRPX1BJRAotICogQGFyZyBz
ZXEJCXNlcXVlbmNlIG51bWJlciBvZiBtZXNzYWdlIG9yIE5MX0FVVE9fU0VRCi0gKiBAYXJnIGZh
bWlseQkJZ2VuZXJpYyBuZXRsaW5rIGZhbWlseQotICogQGFyZyBoZHJsZW4JCWxlbmd0aCBvZiB1
c2VyIHNwZWNpZmljIGhlYWRlcgotICogQGFyZyBmbGFncwkJbWVzc2FnZSBmbGFncwotICogQGFy
ZyBjbWQJCWdlbmVyaWMgbmV0bGluayBjb21tYW5kCi0gKiBAYXJnIHZlcnNpb24JCXByb3RvY29s
IHZlcnNpb24KLSAqCi0gKiBSZXR1cm5zIHBvaW50ZXIgdG8gdXNlciBzcGVjaWZpYyBoZWFkZXIu
Ci0gKi8KLXZvaWQgKmdlbmxtc2dfcHV0KHN0cnVjdCBubF9tc2cgKm1zZywgdWludDMyX3QgcGlk
LCB1aW50MzJfdCBzZXEsIGludCBmYW1pbHksCi0JCSAgaW50IGhkcmxlbiwgaW50IGZsYWdzLCB1
aW50OF90IGNtZCwgdWludDhfdCB2ZXJzaW9uKQotewotCXN0cnVjdCBubG1zZ2hkciAqbmxoOwot
CXN0cnVjdCBnZW5sbXNnaGRyIGhkciA9IHsKLQkJLmNtZCA9IGNtZCwKLQkJLnZlcnNpb24gPSB2
ZXJzaW9uLAotCX07Ci0KLQlubGggPSBubG1zZ19wdXQobXNnLCBwaWQsIHNlcSwgZmFtaWx5LCBH
RU5MX0hEUkxFTiArIGhkcmxlbiwgZmxhZ3MpOwotCWlmIChubGggPT0gTlVMTCkKLQkJcmV0dXJu
IE5VTEw7Ci0KLQltZW1jcHkobmxtc2dfZGF0YShubGgpLCAmaGRyLCBzaXplb2YoaGRyKSk7Ci0J
TkxfREJHKDIsICJtc2cgJXA6IEFkZGVkIGdlbmVyaWMgbmV0bGluayBoZWFkZXIgY21kPSVkIHZl
cnNpb249JWRcbiIsCi0JICAgICAgIG1zZywgY21kLCB2ZXJzaW9uKTsKLQotCXJldHVybiBubG1z
Z19kYXRhKG5saCkgKyBHRU5MX0hEUkxFTjsKLX0KLQotLyoqIEB9ICovCi0KLS8qKiBAfSAqLwpk
aWZmIC0tZ2l0IGEvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2dlbmxfY3RybC5jIGIvcGFj
a2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2dlbmxfY3RybC5jCmRlbGV0ZWQgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCAwMDQ1NDU5YjJmMWEuLjAwMDAwMDAwMDAwMAotLS0gYS9wYWNrYWdlL2xpYnMv
bGlibmwtdGlueS9zcmMvZ2VubF9jdHJsLmMKKysrIC9kZXYvbnVsbApAQCAtMSwzODAgKzAsMCBA
QAotLyoKLSAqIGxpYi9nZW5sL2N0cmwuYwkJR2VuZXJpYyBOZXRsaW5rIENvbnRyb2xsZXIKLSAq
Ci0gKglUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUg
aXQgYW5kL29yCi0gKgltb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2Vy
IEdlbmVyYWwgUHVibGljCi0gKglMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0
d2FyZSBGb3VuZGF0aW9uIHZlcnNpb24gMi4xCi0gKglvZiB0aGUgTGljZW5zZS4KLSAqCi0gKiBD
b3B5cmlnaHQgKGMpIDIwMDMtMjAwOCBUaG9tYXMgR3JhZiA8dGdyYWZAc3V1Zy5jaD4KLSAqLwot
Ci0vKioKLSAqIEBpbmdyb3VwIGdlbmxfbW5ndAotICogQGRlZmdyb3VwIGN0cmwgQ29udHJvbGxl
cgotICogQGJyaWVmCi0gKgotICogQHsKLSAqLwotCi0jaW5jbHVkZSA8bmV0bGluay1nZW5lcmlj
Lmg+Ci0jaW5jbHVkZSA8bmV0bGluay9uZXRsaW5rLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9nZW5s
L2dlbmwuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL2dlbmwvZmFtaWx5Lmg+Ci0jaW5jbHVkZSA8bmV0
bGluay9nZW5sL21uZ3QuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL2dlbmwvY3RybC5oPgotI2luY2x1
ZGUgPG5ldGxpbmsvdXRpbHMuaD4KLQotLyoqIEBjb25kIFNLSVAgKi8KLSNkZWZpbmUgQ1RSTF9W
RVJTSU9OCQkweDAwMDEKLQotc3RhdGljIHN0cnVjdCBubF9jYWNoZV9vcHMgZ2VubF9jdHJsX29w
czsKLS8qKiBAZW5kY29uZCAqLwotCi1zdGF0aWMgaW50IGN0cmxfcmVxdWVzdF91cGRhdGUoc3Ry
dWN0IG5sX2NhY2hlICpjLCBzdHJ1Y3Qgbmxfc29jayAqaCkKLXsKLQlyZXR1cm4gZ2VubF9zZW5k
X3NpbXBsZShoLCBHRU5MX0lEX0NUUkwsIENUUkxfQ01EX0dFVEZBTUlMWSwKLQkJCQlDVFJMX1ZF
UlNJT04sIE5MTV9GX0RVTVApOwotfQotCi1zdGF0aWMgc3RydWN0IG5sYV9wb2xpY3kgY3RybF9w
b2xpY3lbQ1RSTF9BVFRSX01BWCsxXSA9IHsKLQlbQ1RSTF9BVFRSX0ZBTUlMWV9JRF0JPSB7IC50
eXBlID0gTkxBX1UxNiB9LAotCVtDVFJMX0FUVFJfRkFNSUxZX05BTUVdCT0geyAudHlwZSA9IE5M
QV9TVFJJTkcsCi0JCQkJICAgIC5tYXhsZW4gPSBHRU5MX05BTVNJWiB9LAotCVtDVFJMX0FUVFJf
VkVSU0lPTl0JPSB7IC50eXBlID0gTkxBX1UzMiB9LAotCVtDVFJMX0FUVFJfSERSU0laRV0JPSB7
IC50eXBlID0gTkxBX1UzMiB9LAotCVtDVFJMX0FUVFJfTUFYQVRUUl0JPSB7IC50eXBlID0gTkxB
X1UzMiB9LAotCVtDVFJMX0FUVFJfT1BTXQkJPSB7IC50eXBlID0gTkxBX05FU1RFRCB9LAotCVtD
VFJMX0FUVFJfTUNBU1RfR1JPVVBTXSA9IHsgLnR5cGUgPSBOTEFfTkVTVEVEIH0sCi19OwotCi1z
dGF0aWMgc3RydWN0IG5sYV9wb2xpY3kgZmFtaWx5X29wX3BvbGljeVtDVFJMX0FUVFJfT1BfTUFY
KzFdID0gewotCVtDVFJMX0FUVFJfT1BfSURdCT0geyAudHlwZSA9IE5MQV9VMzIgfSwKLQlbQ1RS
TF9BVFRSX09QX0ZMQUdTXQk9IHsgLnR5cGUgPSBOTEFfVTMyIH0sCi19OwotCi1zdGF0aWMgc3Ry
dWN0IG5sYV9wb2xpY3kgZmFtaWx5X2dycF9wb2xpY3lbQ1RSTF9BVFRSX01DQVNUX0dSUF9NQVgr
MV0gPSB7Ci0JW0NUUkxfQVRUUl9NQ0FTVF9HUlBfTkFNRV0gPSB7IC50eXBlID0gTkxBX1NUUklO
RyB9LAotCVtDVFJMX0FUVFJfTUNBU1RfR1JQX0lEXSAgID0geyAudHlwZSA9IE5MQV9VMzIgfSwK
LX07Ci0KLXN0YXRpYyBpbnQgY3RybF9tc2dfcGFyc2VyKHN0cnVjdCBubF9jYWNoZV9vcHMgKm9w
cywgc3RydWN0IGdlbmxfY21kICpjbWQsCi0JCQkgICBzdHJ1Y3QgZ2VubF9pbmZvICppbmZvLCB2
b2lkICphcmcpCi17Ci0Jc3RydWN0IGdlbmxfZmFtaWx5ICpmYW1pbHk7Ci0Jc3RydWN0IG5sX3Bh
cnNlcl9wYXJhbSAqcHAgPSBhcmc7Ci0JaW50IGVycjsKLQotCWZhbWlseSA9IGdlbmxfZmFtaWx5
X2FsbG9jKCk7Ci0JaWYgKGZhbWlseSA9PSBOVUxMKSB7Ci0JCWVyciA9IC1OTEVfTk9NRU07Ci0J
CWdvdG8gZXJyb3V0OwotCX0KLQotCWlmIChpbmZvLT5hdHRyc1tDVFJMX0FUVFJfRkFNSUxZX05B
TUVdID09IE5VTEwpIHsKLQkJZXJyID0gLU5MRV9NSVNTSU5HX0FUVFI7Ci0JCWdvdG8gZXJyb3V0
OwotCX0KLQotCWlmIChpbmZvLT5hdHRyc1tDVFJMX0FUVFJfRkFNSUxZX0lEXSA9PSBOVUxMKSB7
Ci0JCWVyciA9IC1OTEVfTUlTU0lOR19BVFRSOwotCQlnb3RvIGVycm91dDsKLQl9Ci0KLQlmYW1p
bHktPmNlX21zZ3R5cGUgPSBpbmZvLT5ubGgtPm5sbXNnX3R5cGU7Ci0JZ2VubF9mYW1pbHlfc2V0
X2lkKGZhbWlseSwKLQkJCSAgIG5sYV9nZXRfdTE2KGluZm8tPmF0dHJzW0NUUkxfQVRUUl9GQU1J
TFlfSURdKSk7Ci0JZ2VubF9mYW1pbHlfc2V0X25hbWUoZmFtaWx5LAotCQkgICAgIG5sYV9nZXRf
c3RyaW5nKGluZm8tPmF0dHJzW0NUUkxfQVRUUl9GQU1JTFlfTkFNRV0pKTsKLQotCWlmIChpbmZv
LT5hdHRyc1tDVFJMX0FUVFJfVkVSU0lPTl0pIHsKLQkJdWludDMyX3QgdmVyc2lvbiA9IG5sYV9n
ZXRfdTMyKGluZm8tPmF0dHJzW0NUUkxfQVRUUl9WRVJTSU9OXSk7Ci0JCWdlbmxfZmFtaWx5X3Nl
dF92ZXJzaW9uKGZhbWlseSwgdmVyc2lvbik7Ci0JfQotCi0JaWYgKGluZm8tPmF0dHJzW0NUUkxf
QVRUUl9IRFJTSVpFXSkgewotCQl1aW50MzJfdCBoZHJzaXplID0gbmxhX2dldF91MzIoaW5mby0+
YXR0cnNbQ1RSTF9BVFRSX0hEUlNJWkVdKTsKLQkJZ2VubF9mYW1pbHlfc2V0X2hkcnNpemUoZmFt
aWx5LCBoZHJzaXplKTsKLQl9Ci0KLQlpZiAoaW5mby0+YXR0cnNbQ1RSTF9BVFRSX01BWEFUVFJd
KSB7Ci0JCXVpbnQzMl90IG1heGF0dHIgPSBubGFfZ2V0X3UzMihpbmZvLT5hdHRyc1tDVFJMX0FU
VFJfTUFYQVRUUl0pOwotCQlnZW5sX2ZhbWlseV9zZXRfbWF4YXR0cihmYW1pbHksIG1heGF0dHIp
OwotCX0KLQotCWlmIChpbmZvLT5hdHRyc1tDVFJMX0FUVFJfT1BTXSkgewotCQlzdHJ1Y3Qgbmxh
dHRyICpubGEsICpubGFfb3BzOwotCQlpbnQgcmVtYWluaW5nOwotCi0JCW5sYV9vcHMgPSBpbmZv
LT5hdHRyc1tDVFJMX0FUVFJfT1BTXTsKLQkJbmxhX2Zvcl9lYWNoX25lc3RlZChubGEsIG5sYV9v
cHMsIHJlbWFpbmluZykgewotCQkJc3RydWN0IG5sYXR0ciAqdGJbQ1RSTF9BVFRSX09QX01BWCsx
XTsKLQkJCWludCBmbGFncyA9IDAsIGlkOwotCi0JCQllcnIgPSBubGFfcGFyc2VfbmVzdGVkKHRi
LCBDVFJMX0FUVFJfT1BfTUFYLCBubGEsCi0JCQkJCSAgICAgICBmYW1pbHlfb3BfcG9saWN5KTsK
LQkJCWlmIChlcnIgPCAwKQotCQkJCWdvdG8gZXJyb3V0OwotCi0JCQlpZiAodGJbQ1RSTF9BVFRS
X09QX0lEXSA9PSBOVUxMKSB7Ci0JCQkJZXJyID0gLU5MRV9NSVNTSU5HX0FUVFI7Ci0JCQkJZ290
byBlcnJvdXQ7Ci0JCQl9Ci0JCQkKLQkJCWlkID0gbmxhX2dldF91MzIodGJbQ1RSTF9BVFRSX09Q
X0lEXSk7Ci0KLQkJCWlmICh0YltDVFJMX0FUVFJfT1BfRkxBR1NdKQotCQkJCWZsYWdzID0gbmxh
X2dldF91MzIodGJbQ1RSTF9BVFRSX09QX0ZMQUdTXSk7Ci0KLQkJCWVyciA9IGdlbmxfZmFtaWx5
X2FkZF9vcChmYW1pbHksIGlkLCBmbGFncyk7Ci0JCQlpZiAoZXJyIDwgMCkKLQkJCQlnb3RvIGVy
cm91dDsKLQotCQl9Ci0JfQotCi0JaWYgKGluZm8tPmF0dHJzW0NUUkxfQVRUUl9NQ0FTVF9HUk9V
UFNdKSB7Ci0JCXN0cnVjdCBubGF0dHIgKm5sYSwgKm5sYV9ncnBzOwotCQlpbnQgcmVtYWluaW5n
OwotCi0JCW5sYV9ncnBzID0gaW5mby0+YXR0cnNbQ1RSTF9BVFRSX01DQVNUX0dST1VQU107Ci0J
CW5sYV9mb3JfZWFjaF9uZXN0ZWQobmxhLCBubGFfZ3JwcywgcmVtYWluaW5nKSB7Ci0JCQlzdHJ1
Y3QgbmxhdHRyICp0YltDVFJMX0FUVFJfTUNBU1RfR1JQX01BWCsxXTsKLQkJCWludCBpZDsKLQkJ
CWNvbnN0IGNoYXIgKiBuYW1lOwotCi0JCQllcnIgPSBubGFfcGFyc2VfbmVzdGVkKHRiLCBDVFJM
X0FUVFJfTUNBU1RfR1JQX01BWCwgbmxhLAotCQkJCQkgICAgICAgZmFtaWx5X2dycF9wb2xpY3kp
OwotCQkJaWYgKGVyciA8IDApCi0JCQkJZ290byBlcnJvdXQ7Ci0KLQkJCWlmICh0YltDVFJMX0FU
VFJfTUNBU1RfR1JQX0lEXSA9PSBOVUxMKSB7Ci0JCQkJZXJyID0gLU5MRV9NSVNTSU5HX0FUVFI7
Ci0JCQkJZ290byBlcnJvdXQ7Ci0JCQl9Ci0JCQlpZCA9IG5sYV9nZXRfdTMyKHRiW0NUUkxfQVRU
Ul9NQ0FTVF9HUlBfSURdKTsKLQotCQkJaWYgKHRiW0NUUkxfQVRUUl9NQ0FTVF9HUlBfTkFNRV0g
PT0gTlVMTCkgewotCQkJCWVyciA9IC1OTEVfTUlTU0lOR19BVFRSOwotCQkJCWdvdG8gZXJyb3V0
OwotCQkJfQotCQkJbmFtZSA9IG5sYV9nZXRfc3RyaW5nKHRiW0NUUkxfQVRUUl9NQ0FTVF9HUlBf
TkFNRV0pOwotCi0JCQllcnIgPSBnZW5sX2ZhbWlseV9hZGRfZ3JwKGZhbWlseSwgaWQsIG5hbWUp
OwotCQkJaWYgKGVyciA8IDApCi0JCQkJZ290byBlcnJvdXQ7Ci0JCX0KLQotCX0KLQotCWVyciA9
IHBwLT5wcF9jYigoc3RydWN0IG5sX29iamVjdCAqKSBmYW1pbHksIHBwKTsKLWVycm91dDoKLQln
ZW5sX2ZhbWlseV9wdXQoZmFtaWx5KTsKLQlyZXR1cm4gZXJyOwotfQotCi0vKioKLSAqIEBuYW1l
IENhY2hlIE1hbmFnZW1lbnQKLSAqIEB7Ci0gKi8KLQotaW50IGdlbmxfY3RybF9hbGxvY19jYWNo
ZShzdHJ1Y3Qgbmxfc29jayAqc29jaywgc3RydWN0IG5sX2NhY2hlICoqcmVzdWx0KQotewotCXJl
dHVybiBubF9jYWNoZV9hbGxvY19hbmRfZmlsbCgmZ2VubF9jdHJsX29wcywgc29jaywgcmVzdWx0
KTsKLX0KLQotLyoqCi0gKiBMb29rIHVwIGdlbmVyaWMgbmV0bGluayBmYW1pbHkgYnkgaWQgaW4g
dGhlIHByb3ZpZGVkIGNhY2hlLgotICogQGFyZyBjYWNoZQkJR2VuZXJpYyBuZXRsaW5rIGZhbWls
eSBjYWNoZS4KLSAqIEBhcmcgaWQJCUZhbWlseSBpZGVudGlmaWVyLgotICoKLSAqIFNlYXJjaGVz
IHRocm91Z2ggdGhlIGNhY2hlIGxvb2tpbmcgZm9yIGEgcmVnaXN0ZXJlZCBmYW1pbHkKLSAqIG1h
dGNoaW5nIHRoZSBzcGVjaWZpZWQgaWRlbnRpZmllci4gVGhlIGNhbGxlciB3aWxsIG93biBhCi0g
KiByZWZlcmVuY2Ugb24gdGhlIHJldHVybmVkIG9iamVjdCB3aGljaCBuZWVkcyB0byBiZSBnaXZl
bgotICogYmFjayBhZnRlciB1c2FnZSB1c2luZyBnZW5sX2ZhbWlseV9wdXQoKS4KLSAqCi0gKiBA
cmV0dXJuIEdlbmVyaWMgbmV0bGluayBmYW1pbHkgb2JqZWN0IG9yIE5VTEwgaWYgbm8gbWF0Y2gg
d2FzIGZvdW5kLgotICovCi1zdHJ1Y3QgZ2VubF9mYW1pbHkgKmdlbmxfY3RybF9zZWFyY2goc3Ry
dWN0IG5sX2NhY2hlICpjYWNoZSwgaW50IGlkKQotewotCXN0cnVjdCBnZW5sX2ZhbWlseSAqZmFt
OwotCi0JaWYgKGNhY2hlLT5jX29wcyAhPSAmZ2VubF9jdHJsX29wcykKLQkJQlVHKCk7Ci0KLQlu
bF9saXN0X2Zvcl9lYWNoX2VudHJ5KGZhbSwgJmNhY2hlLT5jX2l0ZW1zLCBjZV9saXN0KSB7Ci0J
CWlmIChmYW0tPmdmX2lkID09IGlkKSB7Ci0JCQlubF9vYmplY3RfZ2V0KChzdHJ1Y3Qgbmxfb2Jq
ZWN0ICopIGZhbSk7Ci0JCQlyZXR1cm4gZmFtOwotCQl9Ci0JfQotCi0JcmV0dXJuIE5VTEw7Ci19
Ci0KLS8qKgotICogQG5hbWUgUmVzb2x2ZXIKLSAqIEB7Ci0gKi8KLQotLyoqCi0gKiBMb29rIHVw
IGdlbmVyaWMgbmV0bGluayBmYW1pbHkgYnkgZmFtaWx5IG5hbWUgaW4gdGhlIHByb3ZpZGVkIGNh
Y2hlLgotICogQGFyZyBjYWNoZQkJR2VuZXJpYyBuZXRsaW5rIGZhbWlseSBjYWNoZS4KLSAqIEBh
cmcgbmFtZQkJRmFtaWx5IG5hbWUuCi0gKgotICogU2VhcmNoZXMgdGhyb3VnaCB0aGUgY2FjaGUg
bG9va2luZyBmb3IgYSByZWdpc3RlcmVkIGZhbWlseQotICogbWF0Y2hpbmcgdGhlIHNwZWNpZmll
ZCBuYW1lLiBUaGUgY2FsbGVyIHdpbGwgb3duIGEgcmVmZXJlbmNlCi0gKiBvbiB0aGUgcmV0dXJu
ZWQgb2JqZWN0IHdoaWNoIG5lZWRzIHRvIGJlIGdpdmVuIGJhY2sgYWZ0ZXIKLSAqIHVzYWdlIHVz
aW5nIGdlbmxfZmFtaWx5X3B1dCgpLgotICoKLSAqIEByZXR1cm4gR2VuZXJpYyBuZXRsaW5rIGZh
bWlseSBvYmplY3Qgb3IgTlVMTCBpZiBubyBtYXRjaCB3YXMgZm91bmQuCi0gKi8KLXN0cnVjdCBn
ZW5sX2ZhbWlseSAqZ2VubF9jdHJsX3NlYXJjaF9ieV9uYW1lKHN0cnVjdCBubF9jYWNoZSAqY2Fj
aGUsCi0JCQkJCSAgICBjb25zdCBjaGFyICpuYW1lKQotewotCXN0cnVjdCBnZW5sX2ZhbWlseSAq
ZmFtOwotCi0JaWYgKGNhY2hlLT5jX29wcyAhPSAmZ2VubF9jdHJsX29wcykKLQkJQlVHKCk7Ci0K
LQlubF9saXN0X2Zvcl9lYWNoX2VudHJ5KGZhbSwgJmNhY2hlLT5jX2l0ZW1zLCBjZV9saXN0KSB7
Ci0JCWlmICghc3RyY21wKG5hbWUsIGZhbS0+Z2ZfbmFtZSkpIHsKLQkJCW5sX29iamVjdF9nZXQo
KHN0cnVjdCBubF9vYmplY3QgKikgZmFtKTsKLQkJCXJldHVybiBmYW07Ci0JCX0KLQl9Ci0KLQly
ZXR1cm4gTlVMTDsKLX0KLQotLyoqIEB9ICovCi0KLS8qKgotICogUmVzb2x2ZSBnZW5lcmljIG5l
dGxpbmsgZmFtaWx5IG5hbWUgdG8gaXRzIGlkZW50aWZpZXIKLSAqIEBhcmcgc2sJCU5ldGxpbmsg
c29ja2V0LgotICogQGFyZyBuYW1lCQlOYW1lIG9mIGdlbmVyaWMgbmV0bGluayBmYW1pbHkKLSAq
Ci0gKiBSZXNvbHZlcyB0aGUgZ2VuZXJpYyBuZXRsaW5rIGZhbWlseSBuYW1lIHRvIGl0cyBpZGVu
dGlmZXIgYW5kIHJldHVybnMKLSAqIGl0LgotICoKLSAqIEByZXR1cm4gQSBwb3NpdGl2ZSBpZGVu
dGlmaWVyIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29kZS4KLSAqLwotaW50IGdlbmxfY3RybF9yZXNv
bHZlKHN0cnVjdCBubF9zb2NrICpzaywgY29uc3QgY2hhciAqbmFtZSkKLXsKLQlzdHJ1Y3Qgbmxf
Y2FjaGUgKmNhY2hlOwotCXN0cnVjdCBnZW5sX2ZhbWlseSAqZmFtaWx5OwotCWludCBlcnI7Ci0K
LQlpZiAoKGVyciA9IGdlbmxfY3RybF9hbGxvY19jYWNoZShzaywgJmNhY2hlKSkgPCAwKQotCQly
ZXR1cm4gZXJyOwotCi0JZmFtaWx5ID0gZ2VubF9jdHJsX3NlYXJjaF9ieV9uYW1lKGNhY2hlLCBu
YW1lKTsKLQlpZiAoZmFtaWx5ID09IE5VTEwpIHsKLQkJZXJyID0gLU5MRV9PQkpfTk9URk9VTkQ7
Ci0JCWdvdG8gZXJyb3V0OwotCX0KLQotCWVyciA9IGdlbmxfZmFtaWx5X2dldF9pZChmYW1pbHkp
OwotCWdlbmxfZmFtaWx5X3B1dChmYW1pbHkpOwotZXJyb3V0OgotCW5sX2NhY2hlX2ZyZWUoY2Fj
aGUpOwotCi0JcmV0dXJuIGVycjsKLX0KLQotc3RhdGljIGludCBnZW5sX2N0cmxfZ3JwX2J5X25h
bWUoY29uc3Qgc3RydWN0IGdlbmxfZmFtaWx5ICpmYW1pbHksCi0JCQkJY29uc3QgY2hhciAqZ3Jw
X25hbWUpCi17Ci0Jc3RydWN0IGdlbmxfZmFtaWx5X2dycCAqZ3JwOwotCi0JbmxfbGlzdF9mb3Jf
ZWFjaF9lbnRyeShncnAsICZmYW1pbHktPmdmX21jX2dycHMsIGxpc3QpIHsKLQkJaWYgKCFzdHJj
bXAoZ3JwLT5uYW1lLCBncnBfbmFtZSkpIHsKLQkJCXJldHVybiBncnAtPmlkOwotCQl9Ci0JfQot
Ci0JcmV0dXJuIC1OTEVfT0JKX05PVEZPVU5EOwotfQotCi1pbnQgZ2VubF9jdHJsX3Jlc29sdmVf
Z3JwKHN0cnVjdCBubF9zb2NrICpzaywgY29uc3QgY2hhciAqZmFtaWx5X25hbWUsCi0JY29uc3Qg
Y2hhciAqZ3JwX25hbWUpCi17Ci0Jc3RydWN0IG5sX2NhY2hlICpjYWNoZTsKLQlzdHJ1Y3QgZ2Vu
bF9mYW1pbHkgKmZhbWlseTsKLQlpbnQgZXJyOwotCi0JaWYgKChlcnIgPSBnZW5sX2N0cmxfYWxs
b2NfY2FjaGUoc2ssICZjYWNoZSkpIDwgMCkKLQkJcmV0dXJuIGVycjsKLQotCWZhbWlseSA9IGdl
bmxfY3RybF9zZWFyY2hfYnlfbmFtZShjYWNoZSwgZmFtaWx5X25hbWUpOwotCWlmIChmYW1pbHkg
PT0gTlVMTCkgewotCQllcnIgPSAtTkxFX09CSl9OT1RGT1VORDsKLQkJZ290byBlcnJvdXQ7Ci0J
fQotCi0JZXJyID0gZ2VubF9jdHJsX2dycF9ieV9uYW1lKGZhbWlseSwgZ3JwX25hbWUpOwotCWdl
bmxfZmFtaWx5X3B1dChmYW1pbHkpOwotZXJyb3V0OgotCW5sX2NhY2hlX2ZyZWUoY2FjaGUpOwot
Ci0JcmV0dXJuIGVycjsKLX0KLQotLyoqIEB9ICovCi0KLXN0YXRpYyBzdHJ1Y3QgZ2VubF9jbWQg
Z2VubF9jbWRzW10gPSB7Ci0JewotCQkuY19pZAkJPSBDVFJMX0NNRF9ORVdGQU1JTFksCi0JCS5j
X25hbWUJCT0gIk5FV0ZBTUlMWSIgLAotCQkuY19tYXhhdHRyCT0gQ1RSTF9BVFRSX01BWCwKLQkJ
LmNfYXR0cl9wb2xpY3kJPSBjdHJsX3BvbGljeSwKLQkJLmNfbXNnX3BhcnNlcgk9IGN0cmxfbXNn
X3BhcnNlciwKLQl9LAotCXsKLQkJLmNfaWQJCT0gQ1RSTF9DTURfREVMRkFNSUxZLAotCQkuY19u
YW1lCQk9ICJERUxGQU1JTFkiICwKLQl9LAotCXsKLQkJLmNfaWQJCT0gQ1RSTF9DTURfR0VURkFN
SUxZLAotCQkuY19uYW1lCQk9ICJHRVRGQU1JTFkiICwKLQl9LAotCXsKLQkJLmNfaWQJCT0gQ1RS
TF9DTURfTkVXT1BTLAotCQkuY19uYW1lCQk9ICJORVdPUFMiICwKLQl9LAotCXsKLQkJLmNfaWQJ
CT0gQ1RSTF9DTURfREVMT1BTLAotCQkuY19uYW1lCQk9ICJERUxPUFMiICwKLQl9LAotfTsKLQot
c3RhdGljIHN0cnVjdCBnZW5sX29wcyBnZW5sX29wcyA9IHsKLQkub19jbWRzCQkJPSBnZW5sX2Nt
ZHMsCi0JLm9fbmNtZHMJCT0gQVJSQVlfU0laRShnZW5sX2NtZHMpLAotfTsKLQotLyoqIEBjb25k
IFNLSVAgKi8KLWV4dGVybiBzdHJ1Y3Qgbmxfb2JqZWN0X29wcyBnZW5sX2ZhbWlseV9vcHM7Ci0v
KiogQGVuZGNvbmQgKi8KLQotc3RhdGljIHN0cnVjdCBubF9jYWNoZV9vcHMgZ2VubF9jdHJsX29w
cyA9IHsKLQkuY29fbmFtZQkJPSAiZ2VubC9mYW1pbHkiLAotCS5jb19oZHJzaXplCQk9IEdFTkxf
SERSU0laRSgwKSwKLQkuY29fbXNndHlwZXMJCT0gR0VOTF9GQU1JTFkoR0VOTF9JRF9DVFJMLCAi
bmxjdHJsIiksCi0JLmNvX2dlbmwJCT0gJmdlbmxfb3BzLAotCS5jb19wcm90b2NvbAkJPSBORVRM
SU5LX0dFTkVSSUMsCi0JLmNvX3JlcXVlc3RfdXBkYXRlICAgICAgPSBjdHJsX3JlcXVlc3RfdXBk
YXRlLAotCS5jb19vYmpfb3BzCQk9ICZnZW5sX2ZhbWlseV9vcHMsCi19OwotCi1zdGF0aWMgdm9p
ZCBfX2luaXQgY3RybF9pbml0KHZvaWQpCi17Ci0JZ2VubF9yZWdpc3RlcigmZ2VubF9jdHJsX29w
cyk7Ci19Ci0KLXN0YXRpYyB2b2lkIF9fZXhpdCBjdHJsX2V4aXQodm9pZCkKLXsKLQlnZW5sX3Vu
cmVnaXN0ZXIoJmdlbmxfY3RybF9vcHMpOwotfQotCi0vKiogQH0gKi8KZGlmZiAtLWdpdCBhL3Bh
Y2thZ2UvbGlicy9saWJubC10aW55L3NyYy9nZW5sX2ZhbWlseS5jIGIvcGFja2FnZS9saWJzL2xp
Ym5sLXRpbnkvc3JjL2dlbmxfZmFtaWx5LmMKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4
IDIyMWFjZmExYTdmZi4uMDAwMDAwMDAwMDAwCi0tLSBhL3BhY2thZ2UvbGlicy9saWJubC10aW55
L3NyYy9nZW5sX2ZhbWlseS5jCisrKyAvZGV2L251bGwKQEAgLTEsMTY5ICswLDAgQEAKLS8qCi0g
KiBsaWIvZ2VubC9mYW1pbHkuYwkJR2VuZXJpYyBOZXRsaW5rIEZhbWlseQotICoKLSAqCVRoaXMg
bGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IK
LSAqCW1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQ
dWJsaWMKLSAqCUxpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5k
YXRpb24gdmVyc2lvbiAyLjEKLSAqCW9mIHRoZSBMaWNlbnNlLgotICoKLSAqIENvcHlyaWdodCAo
YykgMjAwMy0yMDA2IFRob21hcyBHcmFmIDx0Z3JhZkBzdXVnLmNoPgotICovCi0KLS8qKgotICog
QGluZ3JvdXAgZ2VubAotICogQGRlZmdyb3VwIGdlbmxfZmFtaWx5IEdlbmVyaWMgTmV0bGluayBG
YW1pbHkKLSAqIEBicmllZgotICoKLSAqIEB7Ci0gKi8KLQotI2luY2x1ZGUgPG5ldGxpbmstZ2Vu
ZXJpYy5oPgotI2luY2x1ZGUgPG5ldGxpbmsvbmV0bGluay5oPgotI2luY2x1ZGUgPG5ldGxpbmsv
Z2VubC9nZW5sLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9nZW5sL2ZhbWlseS5oPgotI2luY2x1ZGUg
PG5ldGxpbmsvdXRpbHMuaD4KLQotc3RydWN0IG5sX29iamVjdF9vcHMgZ2VubF9mYW1pbHlfb3Bz
OwotLyoqIEBlbmRjb25kICovCi0KLXN0YXRpYyB2b2lkIGZhbWlseV9jb25zdHJ1Y3RvcihzdHJ1
Y3Qgbmxfb2JqZWN0ICpjKQotewotCXN0cnVjdCBnZW5sX2ZhbWlseSAqZmFtaWx5ID0gKHN0cnVj
dCBnZW5sX2ZhbWlseSAqKSBjOwotCi0JbmxfaW5pdF9saXN0X2hlYWQoJmZhbWlseS0+Z2Zfb3Bz
KTsKLQlubF9pbml0X2xpc3RfaGVhZCgmZmFtaWx5LT5nZl9tY19ncnBzKTsKLX0KLQotc3RhdGlj
IHZvaWQgZmFtaWx5X2ZyZWVfZGF0YShzdHJ1Y3Qgbmxfb2JqZWN0ICpjKQotewotCXN0cnVjdCBn
ZW5sX2ZhbWlseSAqZmFtaWx5ID0gKHN0cnVjdCBnZW5sX2ZhbWlseSAqKSBjOwotCXN0cnVjdCBn
ZW5sX2ZhbWlseV9vcCAqb3BzLCAqdG1wOwotCXN0cnVjdCBnZW5sX2ZhbWlseV9ncnAgKmdycCwg
KnRfZ3JwOwotCi0JaWYgKGZhbWlseSA9PSBOVUxMKQotCQlyZXR1cm47Ci0KLQlubF9saXN0X2Zv
cl9lYWNoX2VudHJ5X3NhZmUob3BzLCB0bXAsICZmYW1pbHktPmdmX29wcywgb19saXN0KSB7Ci0J
CW5sX2xpc3RfZGVsKCZvcHMtPm9fbGlzdCk7Ci0JCWZyZWUob3BzKTsKLQl9Ci0KLQlubF9saXN0
X2Zvcl9lYWNoX2VudHJ5X3NhZmUoZ3JwLCB0X2dycCwgJmZhbWlseS0+Z2ZfbWNfZ3JwcywgbGlz
dCkgewotCQlubF9saXN0X2RlbCgmZ3JwLT5saXN0KTsKLQkJZnJlZShncnApOwotCX0KLQotfQot
Ci1zdGF0aWMgaW50IGZhbWlseV9jbG9uZShzdHJ1Y3Qgbmxfb2JqZWN0ICpfZHN0LCBzdHJ1Y3Qg
bmxfb2JqZWN0ICpfc3JjKQotewotCXN0cnVjdCBnZW5sX2ZhbWlseSAqZHN0ID0gbmxfb2JqZWN0
X3ByaXYoX2RzdCk7Ci0Jc3RydWN0IGdlbmxfZmFtaWx5ICpzcmMgPSBubF9vYmplY3RfcHJpdihf
c3JjKTsKLQlzdHJ1Y3QgZ2VubF9mYW1pbHlfb3AgKm9wczsKLQlzdHJ1Y3QgZ2VubF9mYW1pbHlf
Z3JwICpncnA7Ci0JaW50IGVycjsKLQotCW5sX2xpc3RfZm9yX2VhY2hfZW50cnkob3BzLCAmc3Jj
LT5nZl9vcHMsIG9fbGlzdCkgewotCQllcnIgPSBnZW5sX2ZhbWlseV9hZGRfb3AoZHN0LCBvcHMt
Pm9faWQsIG9wcy0+b19mbGFncyk7Ci0JCWlmIChlcnIgPCAwKQotCQkJcmV0dXJuIGVycjsKLQl9
Ci0KLQlubF9saXN0X2Zvcl9lYWNoX2VudHJ5KGdycCwgJnNyYy0+Z2ZfbWNfZ3JwcywgbGlzdCkg
ewotCQllcnIgPSBnZW5sX2ZhbWlseV9hZGRfZ3JwKGRzdCwgZ3JwLT5pZCwgZ3JwLT5uYW1lKTsK
LQkJaWYgKGVyciA8IDApCi0JCQlyZXR1cm4gZXJyOwotCX0KLQotCQotCXJldHVybiAwOwotfQot
Ci1zdGF0aWMgaW50IGZhbWlseV9jb21wYXJlKHN0cnVjdCBubF9vYmplY3QgKl9hLCBzdHJ1Y3Qg
bmxfb2JqZWN0ICpfYiwKLQkJCSAgdWludDMyX3QgYXR0cnMsIGludCBmbGFncykKLXsKLQlzdHJ1
Y3QgZ2VubF9mYW1pbHkgKmEgPSAoc3RydWN0IGdlbmxfZmFtaWx5ICopIF9hOwotCXN0cnVjdCBn
ZW5sX2ZhbWlseSAqYiA9IChzdHJ1Y3QgZ2VubF9mYW1pbHkgKikgX2I7Ci0JaW50IGRpZmYgPSAw
OwotCi0jZGVmaW5lIEZBTV9ESUZGKEFUVFIsIEVYUFIpIEFUVFJfRElGRihhdHRycywgRkFNSUxZ
X0FUVFJfIyNBVFRSLCBhLCBiLCBFWFBSKQotCi0JZGlmZiB8PSBGQU1fRElGRihJRCwJCWEtPmdm
X2lkICE9IGItPmdmX2lkKTsKLQlkaWZmIHw9IEZBTV9ESUZGKFZFUlNJT04sCWEtPmdmX3ZlcnNp
b24gIT0gYi0+Z2ZfdmVyc2lvbik7Ci0JZGlmZiB8PSBGQU1fRElGRihIRFJTSVpFLAlhLT5nZl9o
ZHJzaXplICE9IGItPmdmX2hkcnNpemUpOwotCWRpZmYgfD0gRkFNX0RJRkYoTUFYQVRUUiwJYS0+
Z2ZfbWF4YXR0ciAhPSBiLT5nZl9tYXhhdHRyKTsKLQlkaWZmIHw9IEZBTV9ESUZGKE5BTUUsCQlz
dHJjbXAoYS0+Z2ZfbmFtZSwgYi0+Z2ZfbmFtZSkpOwotCi0jdW5kZWYgRkFNX0RJRkYKLQotCXJl
dHVybiBkaWZmOwotfQotCi0KLS8qKgotICogQG5hbWUgRmFtaWx5IE9iamVjdAotICogQHsKLSAq
LwotCi1zdHJ1Y3QgZ2VubF9mYW1pbHkgKmdlbmxfZmFtaWx5X2FsbG9jKHZvaWQpCi17Ci0JcmV0
dXJuIChzdHJ1Y3QgZ2VubF9mYW1pbHkgKikgbmxfb2JqZWN0X2FsbG9jKCZnZW5sX2ZhbWlseV9v
cHMpOwotfQotCi12b2lkIGdlbmxfZmFtaWx5X3B1dChzdHJ1Y3QgZ2VubF9mYW1pbHkgKmZhbWls
eSkKLXsKLQlubF9vYmplY3RfcHV0KChzdHJ1Y3Qgbmxfb2JqZWN0ICopIGZhbWlseSk7Ci19Ci0K
LS8qKiBAfSAqLwotCi0KLWludCBnZW5sX2ZhbWlseV9hZGRfb3Aoc3RydWN0IGdlbmxfZmFtaWx5
ICpmYW1pbHksIGludCBpZCwgaW50IGZsYWdzKQotewotCXN0cnVjdCBnZW5sX2ZhbWlseV9vcCAq
b3A7Ci0KLQlvcCA9IGNhbGxvYygxLCBzaXplb2YoKm9wKSk7Ci0JaWYgKG9wID09IE5VTEwpCi0J
CXJldHVybiAtTkxFX05PTUVNOwotCi0Jb3AtPm9faWQgPSBpZDsKLQlvcC0+b19mbGFncyA9IGZs
YWdzOwotCi0JbmxfbGlzdF9hZGRfdGFpbCgmb3AtPm9fbGlzdCwgJmZhbWlseS0+Z2Zfb3BzKTsK
LQlmYW1pbHktPmNlX21hc2sgfD0gRkFNSUxZX0FUVFJfT1BTOwotCi0JcmV0dXJuIDA7Ci19Ci0K
LWludCBnZW5sX2ZhbWlseV9hZGRfZ3JwKHN0cnVjdCBnZW5sX2ZhbWlseSAqZmFtaWx5LCB1aW50
MzJfdCBpZCwKLQkJCWNvbnN0IGNoYXIgKm5hbWUpCi17Ci0Jc3RydWN0IGdlbmxfZmFtaWx5X2dy
cCAqZ3JwOwotCi0JZ3JwID0gY2FsbG9jKDEsIHNpemVvZigqZ3JwKSk7Ci0JaWYgKGdycCA9PSBO
VUxMKQotCQlyZXR1cm4gLU5MRV9OT01FTTsKLQotCWdycC0+aWQgPSBpZDsKLQlzdHJuY3B5KGdy
cC0+bmFtZSwgbmFtZSwgR0VOTF9OQU1TSVogLSAxKTsKLQotCW5sX2xpc3RfYWRkX3RhaWwoJmdy
cC0+bGlzdCwgJmZhbWlseS0+Z2ZfbWNfZ3Jwcyk7Ci0KLQlyZXR1cm4gMDsKLX0KLQotLyoqIEB9
ICovCi0KLS8qKiBAY29uZCBTS0lQICovCi1zdHJ1Y3Qgbmxfb2JqZWN0X29wcyBnZW5sX2ZhbWls
eV9vcHMgPSB7Ci0JLm9vX25hbWUJCT0gImdlbmwvZmFtaWx5IiwKLQkub29fc2l6ZQkJPSBzaXpl
b2Yoc3RydWN0IGdlbmxfZmFtaWx5KSwKLQkub29fY29uc3RydWN0b3IJCT0gZmFtaWx5X2NvbnN0
cnVjdG9yLAotCS5vb19mcmVlX2RhdGEJCT0gZmFtaWx5X2ZyZWVfZGF0YSwKLQkub29fY2xvbmUJ
CT0gZmFtaWx5X2Nsb25lLAotCS5vb19jb21wYXJlCQk9IGZhbWlseV9jb21wYXJlLAotCS5vb19p
ZF9hdHRycwkJPSBGQU1JTFlfQVRUUl9JRCwKLX07Ci0vKiogQGVuZGNvbmQgKi8KLQotLyoqIEB9
ICovCmRpZmYgLS1naXQgYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvZ2VubF9tbmd0LmMg
Yi9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvZ2VubF9tbmd0LmMKZGVsZXRlZCBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDI0NjUyMWY2OTZhMi4uMDAwMDAwMDAwMDAwCi0tLSBhL3BhY2thZ2Uv
bGlicy9saWJubC10aW55L3NyYy9nZW5sX21uZ3QuYworKysgL2Rldi9udWxsCkBAIC0xLDE5MyAr
MCwwIEBACi0vKgotICogbGliL2dlbmwvbW5ndC5jCQlHZW5lcmljIE5ldGxpbmsgTWFuYWdlbWVu
dAotICoKLSAqCVRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJp
YnV0ZSBpdCBhbmQvb3IKLSAqCW1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBM
ZXNzZXIgR2VuZXJhbCBQdWJsaWMKLSAqCUxpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVl
IFNvZnR3YXJlIEZvdW5kYXRpb24gdmVyc2lvbiAyLjEKLSAqCW9mIHRoZSBMaWNlbnNlLgotICoK
LSAqIENvcHlyaWdodCAoYykgMjAwMy0yMDA4IFRob21hcyBHcmFmIDx0Z3JhZkBzdXVnLmNoPgot
ICovCi0KLS8qKgotICogQGluZ3JvdXAgZ2VubAotICogQGRlZmdyb3VwIGdlbmxfbW5ndCBNYW5h
Z2VtZW50Ci0gKgotICogQHBhciAxKSBSZWdpc3RlcmluZyBhIGdlbmVyaWMgbmV0bGluayBtb2R1
bGUKLSAqIEBjb2RlCi0gKiAjaW5jbHVkZSA8bmV0bGluay9nZW5sL21uZ3QuaD4KLSAqCi0gKiAv
LyBGaXJzdCBzdGVwIGlzIHRvIGRlZmluZSBhbGwgdGhlIGNvbW1hbmRzIGJlaW5nIHVzZWQgaW4K
LSAqIC8vIHBhcnRpY3VsYXIgZ2VuZXJpYyBuZXRsaW5rIGZhbWlseS4gVGhlIElEIGFuZCBuYW1l
IGFyZQotICogLy8gbWFuZGF0b3J5IHRvIGJlIGZpbGxlZCBvdXQuIEEgY2FsbGJhY2sgZnVuY3Rp
b24gYW5kCi0gKiAvLyBtb3N0IHRoZSBhdHRyaWJ1dGUgcG9saWN5IHRoYXQgY29tZXMgd2l0aCBp
dCBtdXN0IGJlCi0gKiAvLyBkZWZpbmVkIGZvciBjb21tYW5kcyBleHBlY3RlZCB0byBiZSBpc3N1
ZWQgdG93YXJkcwotICogLy8gdXNlcnNwYWNlLgotICogc3RhdGljIHN0cnVjdCBnZW5sX2NtZCBm
b29fY21kc1tdID0gewotICogCXsKLSAqIAkJLmNfaWQJCT0gRk9PX0NNRF9ORVcsCi0gKiAJCS5j
X25hbWUJCT0gIk5FV0ZPTyIgLAotICogCQkuY19tYXhhdHRyCT0gRk9PX0FUVFJfTUFYLAotICog
CQkuY19hdHRyX3BvbGljeQk9IGZvb19wb2xpY3ksCi0gKiAJCS5jX21zZ19wYXJzZXIJPSBmb29f
bXNnX3BhcnNlciwKLSAqIAl9LAotICogCXsKLSAqIAkJLmNfaWQJCT0gRk9PX0NNRF9ERUwsCi0g
KiAJCS5jX25hbWUJCT0gIkRFTEZPTyIgLAotICogCX0sCi0gKiB9OwotICoKLSAqIC8vIFRoZSBs
aXN0IG9mIGNvbW1hbmRzIG11c3QgdGhlbiBiZSBpbnRlZ3JhdGVkIGludG8gYQotICogLy8gc3Ry
dWN0IGdlbmxfb3BzIHNlcnZpbmcgYXMgaGFuZGxlIGZvciB0aGlzIHBhcnRpY3VsYXIKLSAqIC8v
IGZhbWlseS4KLSAqIHN0YXRpYyBzdHJ1Y3QgZ2VubF9vcHMgbXlfZ2VubF9vcHMgPSB7Ci0gKiAJ
Lm9fY21kcwkJCT0gZm9vX2NtZHMsCi0gKiAJLm9fbmNtZHMJCT0gQVJSQVlfU0laRShmb29fY21k
cyksCi0gKiB9OwotICoKLSAqIC8vIFVzaW5nIHRoZSBhYm92ZSBzdHJ1Y3QgZ2VubF9vcHMgYW4g
YXJiaXRhcnkgbnVtYmVyIG9mCi0gKiAvLyBjYWNoZSBoYW5kbGVzIGNhbiBiZSBhc3NvY2lhdGVk
IHRvIGl0LgotICogLy8KLSAqIC8vIFRoZSBtYWNybyBHRU5MX0hEUlNJWkUoKSBtdXN0IGJlIHVz
ZWQgdG8gc3BlY2lmeSB0aGUKLSAqIC8vIGxlbmd0aCBvZiB0aGUgaGVhZGVyIHRvIGF1dG9tYXRp
Y2FsbHkgdGFrZSBoZWFkZXJzIG9uCi0gKiAvLyBnZW5lcmljIGxheWVycyBpbnRvIGFjY291bnQu
Ci0gKiAvLwotICogLy8gVGhlIG1hY3JvIEdFTkxfRkFNSUxZKCkgaXMgdXNlZCB0byByZXByZXNl
bnQgdGhlIGdlbmVyaWMKLSAqIC8vIG5ldGxpbmsgZmFtaWx5IGlkLgotICogc3RhdGljIHN0cnVj
dCBubF9jYWNoZV9vcHMgZ2VubF9mb29fb3BzID0gewotICogCS5jb19uYW1lCQk9ICJnZW5sL2Zv
byIsCi0gKiAJLmNvX2hkcnNpemUJCT0gR0VOTF9IRFJTSVpFKHNpemVvZihzdHJ1Y3QgbXlfaGRy
KSksCi0gKiAJLmNvX21zZ3R5cGVzCQk9IEdFTkxfRkFNSUxZKEdFTkxfSURfR0VORVJBVEUsICJm
b28iKSwKLSAqIAkuY29fZ2VubAkJPSAmbXlfZ2VubF9vcHMsCi0gKiAJLmNvX3Byb3RvY29sCQk9
IE5FVExJTktfR0VORVJJQywKLSAqIAkuY29fcmVxdWVzdF91cGRhdGUgICAgICA9IGZvb19yZXF1
ZXN0X3VwZGF0ZSwKLSAqIAkuY29fb2JqX29wcwkJPSAmZ2VubF9mb29fb3BzLAotICogfTsKLSAq
Ci0gKiAvLyBGaW5hbGx5IGVhY2ggY2FjaGUgaGFuZGxlIGZvciBhIGdlbmVyaWMgbmV0bGluayBm
YW1pbHkKLSAqIC8vIG11c3QgYmUgcmVnaXN0ZXJlZCB1c2luZyBnZW5sX3JlZ2lzdGVyKCkuCi0g
KiBzdGF0aWMgdm9pZCBfX2luaXQgZm9vX2luaXQodm9pZCkKLSAqIHsKLSAqIAlnZW5sX3JlZ2lz
dGVyKCZnZW5sX2Zvb19vcHMpOwotICogfQotICoKLSAqIC8vIC4uLiByZXNwZWN0aXZlbHkgdW5y
ZWdzdGVkIGFnYWluLgotICogc3RhdGljIHZvaWQgX19leGl0IGZvb19leGl0KHZvaWQpCi0gKiB7
Ci0gKiAJZ2VubF91bnJlZ2lzdGVyKCZnZW5sX2Zvb19vcHMpOwotICogfQotICogQGVuZGNvZGUK
LSAqIEB7Ci0gKi8KLQotI2luY2x1ZGUgPG5ldGxpbmstZ2VuZXJpYy5oPgotI2luY2x1ZGUgPG5l
dGxpbmsvbmV0bGluay5oPgotI2luY2x1ZGUgPG5ldGxpbmsvZ2VubC9nZW5sLmg+Ci0jaW5jbHVk
ZSA8bmV0bGluay9nZW5sL21uZ3QuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL2dlbmwvZmFtaWx5Lmg+
Ci0jaW5jbHVkZSA8bmV0bGluay9nZW5sL2N0cmwuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL3V0aWxz
Lmg+Ci0KLXN0YXRpYyBOTF9MSVNUX0hFQUQoZ2VubF9vcHNfbGlzdCk7Ci0KLXN0YXRpYyBpbnQg
Z2VubF9tc2dfcGFyc2VyKHN0cnVjdCBubF9jYWNoZV9vcHMgKm9wcywgc3RydWN0IHNvY2thZGRy
X25sICp3aG8sCi0JCQkgICBzdHJ1Y3Qgbmxtc2doZHIgKm5saCwgc3RydWN0IG5sX3BhcnNlcl9w
YXJhbSAqcHApCi17Ci0JaW50IGksIGVycjsKLQlzdHJ1Y3QgZ2VubG1zZ2hkciAqZ2hkcjsKLQlz
dHJ1Y3QgZ2VubF9jbWQgKmNtZDsKLQotCWdoZHIgPSBubG1zZ19kYXRhKG5saCk7Ci0KLQlpZiAo
b3BzLT5jb19nZW5sID09IE5VTEwpCi0JCUJVRygpOwotCi0JZm9yIChpID0gMDsgaSA8IG9wcy0+
Y29fZ2VubC0+b19uY21kczsgaSsrKSB7Ci0JCWNtZCA9ICZvcHMtPmNvX2dlbmwtPm9fY21kc1tp
XTsKLQkJaWYgKGNtZC0+Y19pZCA9PSBnaGRyLT5jbWQpCi0JCQlnb3RvIGZvdW5kOwotCX0KLQot
CWVyciA9IC1OTEVfTVNHVFlQRV9OT1NVUFBPUlQ7Ci0JZ290byBlcnJvdXQ7Ci0KLWZvdW5kOgot
CWlmIChjbWQtPmNfbXNnX3BhcnNlciA9PSBOVUxMKQotCQllcnIgPSAtTkxFX09QTk9UU1VQUDsK
LQllbHNlIHsKLQkJc3RydWN0IG5sYXR0ciAqdGJbY21kLT5jX21heGF0dHIgKyAxXTsKLQkJc3Ry
dWN0IGdlbmxfaW5mbyBpbmZvID0gewotCQkJLndobyA9IHdobywKLQkJCS5ubGggPSBubGgsCi0J
CQkuZ2VubGhkciA9IGdoZHIsCi0JCQkudXNlcmhkciA9IGdlbmxtc2dfZGF0YShnaGRyKSwKLQkJ
CS5hdHRycyA9IHRiLAotCQl9OwotCi0JCWVyciA9IG5sbXNnX3BhcnNlKG5saCwgb3BzLT5jb19o
ZHJzaXplLCB0YiwgY21kLT5jX21heGF0dHIsCi0JCQkJICBjbWQtPmNfYXR0cl9wb2xpY3kpOwot
CQlpZiAoZXJyIDwgMCkKLQkJCWdvdG8gZXJyb3V0OwotCi0JCWVyciA9IGNtZC0+Y19tc2dfcGFy
c2VyKG9wcywgY21kLCAmaW5mbywgcHApOwotCX0KLWVycm91dDoKLQlyZXR1cm4gZXJyOwotCi19
Ci0KLS8qKgotICogQG5hbWUgUmVnaXN0ZXIvVW5yZWdpc3RlcgotICogQHsKLSAqLwotCi0vKioK
LSAqIFJlZ2lzdGVyIGdlbmVyaWMgbmV0bGluayBvcGVyYXRpb25zCi0gKiBAYXJnIG9wcwkJY2Fj
aGUgb3BlcmF0aW9ucwotICovCi1pbnQgZ2VubF9yZWdpc3RlcihzdHJ1Y3QgbmxfY2FjaGVfb3Bz
ICpvcHMpCi17Ci0JaW50IGVycjsKLQotCWlmIChvcHMtPmNvX3Byb3RvY29sICE9IE5FVExJTktf
R0VORVJJQykgewotCQllcnIgPSAtTkxFX1BST1RPX01JU01BVENIOwotCQlnb3RvIGVycm91dDsK
LQl9Ci0KLQlpZiAob3BzLT5jb19oZHJzaXplIDwgR0VOTF9IRFJTSVpFKDApKSB7Ci0JCWVyciA9
IC1OTEVfSU5WQUw7Ci0JCWdvdG8gZXJyb3V0OwotCX0KLQotCWlmIChvcHMtPmNvX2dlbmwgPT0g
TlVMTCkgewotCQllcnIgPSAtTkxFX0lOVkFMOwotCQlnb3RvIGVycm91dDsKLQl9Ci0KLQlvcHMt
PmNvX2dlbmwtPm9fY2FjaGVfb3BzID0gb3BzOwotCW9wcy0+Y29fZ2VubC0+b19uYW1lID0gb3Bz
LT5jb19tc2d0eXBlc1swXS5tdF9uYW1lOwotCW9wcy0+Y29fZ2VubC0+b19mYW1pbHkgPSBvcHMt
PmNvX21zZ3R5cGVzWzBdLm10X2lkOwotCW9wcy0+Y29fbXNnX3BhcnNlciA9IGdlbmxfbXNnX3Bh
cnNlcjsKLQotCS8qIEZJWE1FOiBjaGVjayBmb3IgZHVwICovCi0KLQlubF9saXN0X2FkZF90YWls
KCZvcHMtPmNvX2dlbmwtPm9fbGlzdCwgJmdlbmxfb3BzX2xpc3QpOwotCi0JZXJyID0gbmxfY2Fj
aGVfbW5ndF9yZWdpc3RlcihvcHMpOwotZXJyb3V0OgotCXJldHVybiBlcnI7Ci19Ci0KLS8qKgot
ICogVW5yZWdpc3RlciBnZW5lcmljIG5ldGxpbmsgb3BlcmF0aW9ucwotICogQGFyZyBvcHMJCWNh
Y2hlIG9wZXJhdGlvbnMKLSAqLwotdm9pZCBnZW5sX3VucmVnaXN0ZXIoc3RydWN0IG5sX2NhY2hl
X29wcyAqb3BzKQotewotCW5sX2NhY2hlX21uZ3RfdW5yZWdpc3RlcihvcHMpOwotCW5sX2xpc3Rf
ZGVsKCZvcHMtPmNvX2dlbmwtPm9fbGlzdCk7Ci19Ci0KLS8qKiBAfSAqLwotCi0vKiogQH0gKi8K
ZGlmZiAtLWdpdCBhL3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9oYW5kbGVycy5jIGIvcGFj
a2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2hhbmRsZXJzLmMKZGVsZXRlZCBmaWxlIG1vZGUgMTAw
NjQ0CmluZGV4IDEyZWJkYTUyMDdlZS4uMDAwMDAwMDAwMDAwCi0tLSBhL3BhY2thZ2UvbGlicy9s
aWJubC10aW55L3NyYy9oYW5kbGVycy5jCisrKyAvZGV2L251bGwKQEAgLTEsMTYyICswLDAgQEAK
LS8qCi0gKiBsaWIvaGFuZGxlcnMuYwlkZWZhdWx0IG5ldGxpbmsgbWVzc2FnZSBoYW5kbGVycwot
ICoKLSAqCVRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0
ZSBpdCBhbmQvb3IKLSAqCW1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNz
ZXIgR2VuZXJhbCBQdWJsaWMKLSAqCUxpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNv
ZnR3YXJlIEZvdW5kYXRpb24gdmVyc2lvbiAyLjEKLSAqCW9mIHRoZSBMaWNlbnNlLgotICoKLSAq
IENvcHlyaWdodCAoYykgMjAwMy0yMDA4IFRob21hcyBHcmFmIDx0Z3JhZkBzdXVnLmNoPgotICov
Ci0KLS8qKgotICogQGluZ3JvdXAgY29yZQotICogQGRlZmdyb3VwIGNiIENhbGxiYWNrcy9DdXN0
b21pemF0aW9uCi0gKgotICogQGRldGFpbHMKLSAqIEBwYXIgMSkgU2V0dGluZyB1cCBhIGNhbGxi
YWNrIHNldAotICogQGNvZGUKLSAqIC8vIEFsbG9jYXRlIGEgY2FsbGJhY2sgc2V0IGFuZCBpbml0
aWFsaXplIGl0IHRvIHRoZSB2ZXJib3NlIGRlZmF1bHQgc2V0Ci0gKiBzdHJ1Y3QgbmxfY2IgKmNi
ID0gbmxfY2JfYWxsb2MoTkxfQ0JfVkVSQk9TRSk7Ci0gKgotICogLy8gTW9kaWZ5IHRoZSBzZXQg
dG8gY2FsbCBteV9mdW5jKCkgZm9yIGFsbCB2YWxpZCBtZXNzYWdlcwotICogbmxfY2Jfc2V0KGNi
LCBOTF9DQl9WQUxJRCwgTkxfQ0JfQ1VTVE9NLCBteV9mdW5jLCBOVUxMKTsKLSAqCi0gKiAvLyBT
ZXQgdGhlIGVycm9yIG1lc3NhZ2UgaGFuZGxlciB0byB0aGUgdmVyYm9zZSBkZWZhdWx0IGltcGxl
bWVudGF0aW9uCi0gKiAvLyBhbmQgZGlyZWN0IGl0IHRvIHByaW50IGFsbCBlcnJvcnMgdG8gdGhl
IGdpdmVuIGZpbGUgZGVzY3JpcHRvci4KLSAqIEZJTEUgKmZpbGUgPSBmb3BlbiguLi4pOwotICog
bmxfY2JfZXJyKGNiLCBOTF9DQl9WRVJCT1NFLCBOVUxMLCBmaWxlKTsKLSAqIEBlbmRjb2RlCi0g
KiBAewotICovCi0KLSNpbmNsdWRlIDxuZXRsaW5rLWxvY2FsLmg+Ci0jaW5jbHVkZSA8bmV0bGlu
ay9uZXRsaW5rLmg+Ci0jaW5jbHVkZSA8bmV0bGluay91dGlscy5oPgotI2luY2x1ZGUgPG5ldGxp
bmsvbXNnLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9oYW5kbGVycy5oPgotCi0vKioKLSAqIEBuYW1l
IENhbGxiYWNrIEhhbmRsZSBNYW5hZ2VtZW50Ci0gKiBAewotICovCi0KLS8qKgotICogQWxsb2Nh
dGUgYSBuZXcgY2FsbGJhY2sgaGFuZGxlCi0gKiBAYXJnIGtpbmQJCWNhbGxiYWNrIGtpbmQgdG8g
YmUgdXNlZCBmb3IgaW5pdGlhbGl6YXRpb24KLSAqIEByZXR1cm4gTmV3bHkgYWxsb2NhdGVkIGNh
bGxiYWNrIGhhbmRsZSBvciBOVUxMCi0gKi8KLXN0cnVjdCBubF9jYiAqbmxfY2JfYWxsb2MoZW51
bSBubF9jYl9raW5kIGtpbmQpCi17Ci0JaW50IGk7Ci0Jc3RydWN0IG5sX2NiICpjYjsKLQotCWlm
IChraW5kIDwgMCB8fCBraW5kID4gTkxfQ0JfS0lORF9NQVgpCi0JCXJldHVybiBOVUxMOwotCi0J
Y2IgPSBjYWxsb2MoMSwgc2l6ZW9mKCpjYikpOwotCWlmICghY2IpCi0JCXJldHVybiBOVUxMOwot
Ci0JY2ItPmNiX3JlZmNudCA9IDE7Ci0KLQlmb3IgKGkgPSAwOyBpIDw9IE5MX0NCX1RZUEVfTUFY
OyBpKyspCi0JCW5sX2NiX3NldChjYiwgaSwga2luZCwgTlVMTCwgTlVMTCk7Ci0KLQlubF9jYl9l
cnIoY2IsIGtpbmQsIE5VTEwsIE5VTEwpOwotCi0JcmV0dXJuIGNiOwotfQotCi0vKioKLSAqIENs
b25lIGFuIGV4aXN0aW5nIGNhbGxiYWNrIGhhbmRsZQotICogQGFyZyBvcmlnCQlvcmlnaW5hbCBj
YWxsYmFjayBoYW5kbGUKLSAqIEByZXR1cm4gTmV3bHkgYWxsb2NhdGVkIGNhbGxiYWNrIGhhbmRs
ZSBiZWluZyBhIGR1cGxpY2F0ZSBvZgotICogICAgICAgICBvcmlnIG9yIE5VTEwKLSAqLwotc3Ry
dWN0IG5sX2NiICpubF9jYl9jbG9uZShzdHJ1Y3QgbmxfY2IgKm9yaWcpCi17Ci0Jc3RydWN0IG5s
X2NiICpjYjsKLQkKLQljYiA9IG5sX2NiX2FsbG9jKE5MX0NCX0RFRkFVTFQpOwotCWlmICghY2Ip
Ci0JCXJldHVybiBOVUxMOwotCi0JbWVtY3B5KGNiLCBvcmlnLCBzaXplb2YoKm9yaWcpKTsKLQlj
Yi0+Y2JfcmVmY250ID0gMTsKLQotCXJldHVybiBjYjsKLX0KLQotdm9pZCBubF9jYl9wdXQoc3Ry
dWN0IG5sX2NiICpjYikKLXsKLQlpZiAoIWNiKQotCQlyZXR1cm47Ci0KLQljYi0+Y2JfcmVmY250
LS07Ci0KLQlpZiAoY2ItPmNiX3JlZmNudCA8IDApCi0JCUJVRygpOwotCi0JaWYgKGNiLT5jYl9y
ZWZjbnQgPD0gMCkKLQkJZnJlZShjYik7Ci19Ci0KLS8qKiBAfSAqLwotCi0vKioKLSAqIEBuYW1l
IENhbGxiYWNrIFNldHVwCi0gKiBAewotICovCi0KLS8qKgotICogU2V0IHVwIGEgY2FsbGJhY2sg
Ci0gKiBAYXJnIGNiCQljYWxsYmFjayBzZXQKLSAqIEBhcmcgdHlwZQkJY2FsbGJhY2sgdG8gbW9k
aWZ5Ci0gKiBAYXJnIGtpbmQJCWtpbmQgb2YgaW1wbGVtZW50YXRpb24KLSAqIEBhcmcgZnVuYwkJ
Y2FsbGJhY2sgZnVuY3Rpb24gKE5MX0NCX0NVU1RPTSkKLSAqIEBhcmcgYXJnCQlhcmd1bWVudCBw
YXNzZWQgdG8gY2FsbGJhY2sKLSAqCi0gKiBAcmV0dXJuIDAgb24gc3VjY2VzcyBvciBhIG5lZ2F0
aXZlIGVycm9yIGNvZGUKLSAqLwotaW50IG5sX2NiX3NldChzdHJ1Y3QgbmxfY2IgKmNiLCBlbnVt
IG5sX2NiX3R5cGUgdHlwZSwgZW51bSBubF9jYl9raW5kIGtpbmQsCi0JICAgICAgbmxfcmVjdm1z
Z19tc2dfY2JfdCBmdW5jLCB2b2lkICphcmcpCi17Ci0JaWYgKHR5cGUgPCAwIHx8IHR5cGUgPiBO
TF9DQl9UWVBFX01BWCkKLQkJcmV0dXJuIC1OTEVfUkFOR0U7Ci0KLQlpZiAoa2luZCA8IDAgfHwg
a2luZCA+IE5MX0NCX0tJTkRfTUFYKQotCQlyZXR1cm4gLU5MRV9SQU5HRTsKLQotCWlmIChraW5k
ID09IE5MX0NCX0NVU1RPTSkgewotCQljYi0+Y2Jfc2V0W3R5cGVdID0gZnVuYzsKLQkJY2ItPmNi
X2FyZ3NbdHlwZV0gPSBhcmc7Ci0JfQotCi0JcmV0dXJuIDA7Ci19Ci0KLS8qKgotICogU2V0IHVw
IGFuIGVycm9yIGNhbGxiYWNrCi0gKiBAYXJnIGNiCQljYWxsYmFjayBzZXQKLSAqIEBhcmcga2lu
ZAkJa2luZCBvZiBjYWxsYmFjawotICogQGFyZyBmdW5jCQljYWxsYmFjayBmdW5jdGlvbgotICog
QGFyZyBhcmcJCWFyZ3VtZW50IHRvIGJlIHBhc3NlZCB0byBjYWxsYmFjayBmdW5jdGlvbgotICov
Ci1pbnQgbmxfY2JfZXJyKHN0cnVjdCBubF9jYiAqY2IsIGVudW0gbmxfY2Jfa2luZCBraW5kLAot
CSAgICAgIG5sX3JlY3Ztc2dfZXJyX2NiX3QgZnVuYywgdm9pZCAqYXJnKQotewotCWlmIChraW5k
IDwgMCB8fCBraW5kID4gTkxfQ0JfS0lORF9NQVgpCi0JCXJldHVybiAtTkxFX1JBTkdFOwotCi0J
aWYgKGtpbmQgPT0gTkxfQ0JfQ1VTVE9NKSB7Ci0JCWNiLT5jYl9lcnIgPSBmdW5jOwotCQljYi0+
Y2JfZXJyX2FyZyA9IGFyZzsKLQl9Ci0KLQlyZXR1cm4gMDsKLX0KLQotLyoqIEB9ICovCi0KLS8q
KiBAfSAqLwpkaWZmIC0tZ2l0IGEvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUv
bmV0bGluay1nZW5lcmljLmggYi9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9u
ZXRsaW5rLWdlbmVyaWMuaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMTBhYTJmMDFi
YjFhLi4wMDAwMDAwMDAwMDAKLS0tIGEvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1
ZGUvbmV0bGluay1nZW5lcmljLmgKKysrIC9kZXYvbnVsbApAQCAtMSwyMCArMCwwIEBACi0vKgot
ICogbmV0bGluay1nZW5lcmljLmgJTG9jYWwgR2VuZXJpYyBOZXRsaW5rIEludGVyZmFjZQotICoK
LSAqCVRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBp
dCBhbmQvb3IKLSAqCW1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIg
R2VuZXJhbCBQdWJsaWMKLSAqCUxpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3
YXJlIEZvdW5kYXRpb24gdmVyc2lvbiAyLjEKLSAqCW9mIHRoZSBMaWNlbnNlLgotICoKLSAqIENv
cHlyaWdodCAoYykgMjAwMy0yMDA2IFRob21hcyBHcmFmIDx0Z3JhZkBzdXVnLmNoPgotICovCi0K
LSNpZm5kZWYgTkVUTElOS19HRU5MX1BSSVZfSF8KLSNkZWZpbmUgTkVUTElOS19HRU5MX1BSSVZf
SF8KLQotI2luY2x1ZGUgPG5ldGxpbmstbG9jYWwuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL25ldGxp
bmsuaD4KLQotI2RlZmluZSBHRU5MX0hEUlNJWkUoaGRybGVuKSAoR0VOTF9IRFJMRU4gKyAoaGRy
bGVuKSkKLQotI2VuZGlmCmRpZmYgLS1naXQgYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMv
aW5jbHVkZS9uZXRsaW5rLWxvY2FsLmggYi9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5j
bHVkZS9uZXRsaW5rLWxvY2FsLmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDUzZGE4
Y2E5N2U0MC4uMDAwMDAwMDAwMDAwCi0tLSBhL3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9p
bmNsdWRlL25ldGxpbmstbG9jYWwuaAorKysgL2Rldi9udWxsCkBAIC0xLDE2MCArMCwwIEBACi0v
KgotICogbmV0bGluay1sb2NhbC5oCQlMb2NhbCBOZXRsaW5rIEludGVyZmFjZQotICoKLSAqCVRo
aXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQv
b3IKLSAqCW1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJh
bCBQdWJsaWMKLSAqCUxpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZv
dW5kYXRpb24gdmVyc2lvbiAyLjEKLSAqCW9mIHRoZSBMaWNlbnNlLgotICoKLSAqIENvcHlyaWdo
dCAoYykgMjAwMy0yMDA4IFRob21hcyBHcmFmIDx0Z3JhZkBzdXVnLmNoPgotICovCi0KLSNpZm5k
ZWYgTkVUTElOS19MT0NBTF9IXwotI2RlZmluZSBORVRMSU5LX0xPQ0FMX0hfCi0jaWZuZGVmIF9H
TlVfU09VUkNFCi0jZGVmaW5lIF9HTlVfU09VUkNFCi0jZW5kaWYKLQotI2luY2x1ZGUgPHN0ZGlv
Lmg+Ci0jaW5jbHVkZSA8ZXJybm8uaD4KLSNpbmNsdWRlIDxzdGRsaWIuaD4KLSNpbmNsdWRlIDxz
dHJpbmcuaD4KLSNpbmNsdWRlIDx1bmlzdGQuaD4KLSNpbmNsdWRlIDxmY250bC5oPgotI2luY2x1
ZGUgPG1hdGguaD4KLSNpbmNsdWRlIDx0aW1lLmg+Ci0jaW5jbHVkZSA8c3RkYXJnLmg+Ci0jaW5j
bHVkZSA8Y3R5cGUuaD4KLSNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KLSNpbmNsdWRlIDxzeXMvc29j
a2V0Lmg+Ci0jaW5jbHVkZSA8aW50dHlwZXMuaD4KLSNpbmNsdWRlIDxhc3NlcnQuaD4KLSNpbmNs
dWRlIDxsaW1pdHMuaD4KLQotI2luY2x1ZGUgPGFycGEvaW5ldC5oPgotI2luY2x1ZGUgPG5ldGRi
Lmg+Ci0KLSNpZm5kZWYgU09MX05FVExJTksKLSNkZWZpbmUgU09MX05FVExJTksgMjcwCi0jZW5k
aWYKLQotI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+Ci0KLS8qIGxvY2FsIGhlYWRlciBjb3BpZXMg
Ki8KLSNpbmNsdWRlIDxsaW51eC9pZi5oPgotI2luY2x1ZGUgPGxpbnV4L2lmX2FycC5oPgotI2lu
Y2x1ZGUgPGxpbnV4L2lmX2V0aGVyLmg+Ci0jaW5jbHVkZSA8bGludXgvcGt0X3NjaGVkLmg+Ci0j
aW5jbHVkZSA8bGludXgvcGt0X2Nscy5oPgotI2luY2x1ZGUgPGxpbnV4L2dlbl9zdGF0cy5oPgot
Ci0jaW5jbHVkZSA8bmV0bGluay9uZXRsaW5rLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9oYW5kbGVy
cy5oPgotI2luY2x1ZGUgPG5ldGxpbmsvY2FjaGUuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL29iamVj
dC1hcGkuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL2NhY2hlLWFwaS5oPgotI2luY2x1ZGUgPG5ldGxp
bmstdHlwZXMuaD4KLQotc3RydWN0IHRyYW5zX3RibCB7Ci0JaW50IGk7Ci0JY29uc3QgY2hhciAq
YTsKLX07Ci0KLSNkZWZpbmUgX19BREQoaWQsIG5hbWUpIHsgLmkgPSBpZCwgLmEgPSAjbmFtZSB9
LAotCi1zdHJ1Y3QgdHJhbnNfbGlzdCB7Ci0JaW50IGk7Ci0JY2hhciAqYTsKLQlzdHJ1Y3Qgbmxf
bGlzdF9oZWFkIGxpc3Q7Ci19OwotCi0jZGVmaW5lIE5MX0RFQlVHCTEKLQotI2RlZmluZSBOTF9E
QkcoTFZMLEZNVCxBUkcuLi4pIFwKLQlkbyB7fSB3aGlsZSAoMCkKLQotI2RlZmluZSBCVUcoKSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBcCi0JZG8geyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFwKLQkJZnByaW50ZihzdGRlcnIsICJCVUc6ICVzOiVkXG4iLCAgXAotCQkJX19G
SUxFX18sIF9fTElORV9fKTsgICAgICAgICBcCi0JCWFzc2VydCgwKTsJXAotCX0gd2hpbGUgKDAp
Ci0KLWV4dGVybiBpbnQgX19ubF9yZWFkX251bV9zdHJfZmlsZShjb25zdCBjaGFyICpwYXRoLAot
CQkJCSAgaW50ICgqY2IpKGxvbmcsIGNvbnN0IGNoYXIgKikpOwotCi1leHRlcm4gaW50IF9fdHJh
bnNfbGlzdF9hZGQoaW50LCBjb25zdCBjaGFyICosIHN0cnVjdCBubF9saXN0X2hlYWQgKik7Ci1l
eHRlcm4gdm9pZCBfX3RyYW5zX2xpc3RfY2xlYXIoc3RydWN0IG5sX2xpc3RfaGVhZCAqKTsKLQot
ZXh0ZXJuIGNoYXIgKl9fdHlwZTJzdHIoaW50LCBjaGFyICosIHNpemVfdCwgc3RydWN0IHRyYW5z
X3RibCAqLCBzaXplX3QpOwotZXh0ZXJuIGludCBfX3N0cjJ0eXBlKGNvbnN0IGNoYXIgKiwgc3Ry
dWN0IHRyYW5zX3RibCAqLCBzaXplX3QpOwotCi1leHRlcm4gY2hhciAqX19saXN0X3R5cGUyc3Ry
KGludCwgY2hhciAqLCBzaXplX3QsIHN0cnVjdCBubF9saXN0X2hlYWQgKik7Ci1leHRlcm4gaW50
IF9fbGlzdF9zdHIydHlwZShjb25zdCBjaGFyICosIHN0cnVjdCBubF9saXN0X2hlYWQgKik7Ci0K
LWV4dGVybiBjaGFyICpfX2ZsYWdzMnN0cihpbnQsIGNoYXIgKiwgc2l6ZV90LCBzdHJ1Y3QgdHJh
bnNfdGJsICosIHNpemVfdCk7Ci1leHRlcm4gaW50IF9fc3RyMmZsYWdzKGNvbnN0IGNoYXIgKiwg
c3RydWN0IHRyYW5zX3RibCAqLCBzaXplX3QpOwotCi1leHRlcm4gdm9pZCBkdW1wX2Zyb21fb3Bz
KHN0cnVjdCBubF9vYmplY3QgKiwgc3RydWN0IG5sX2R1bXBfcGFyYW1zICopOwotCi0jaWZkZWYg
ZGlzYWJsZWQKLXN0YXRpYyBpbmxpbmUgc3RydWN0IG5sX2NhY2hlICpkcF9jYWNoZShzdHJ1Y3Qg
bmxfb2JqZWN0ICpvYmopCi17Ci0JaWYgKG9iai0+Y2VfY2FjaGUgPT0gTlVMTCkKLQkJcmV0dXJu
IG5sX2NhY2hlX21uZ3RfcmVxdWlyZShvYmotPmNlX29wcy0+b29fbmFtZSk7Ci0KLQlyZXR1cm4g
b2JqLT5jZV9jYWNoZTsKLX0KLSNlbmRpZgotCi1zdGF0aWMgaW5saW5lIGludCBubF9jYl9jYWxs
KHN0cnVjdCBubF9jYiAqY2IsIGludCB0eXBlLCBzdHJ1Y3QgbmxfbXNnICptc2cpCi17Ci0JcmV0
dXJuIGNiLT5jYl9zZXRbdHlwZV0obXNnLCBjYi0+Y2JfYXJnc1t0eXBlXSk7Ci19Ci0KLSNkZWZp
bmUgQVJSQVlfU0laRShYKSAoc2l6ZW9mKFgpIC8gc2l6ZW9mKChYKVswXSkpCi0jaWZuZGVmIG9m
ZnNldG9mCi0jZGVmaW5lIG9mZnNldG9mKFRZUEUsIE1FTUJFUikgKChzaXplX3QpICYoKFRZUEUg
KikwKS0+TUVNQkVSKQotI2VuZGlmCi0KLSNkZWZpbmUgX19pbml0IF9fYXR0cmlidXRlX18gKChj
b25zdHJ1Y3RvcikpCi0jZGVmaW5lIF9fZXhpdCBfX2F0dHJpYnV0ZV9fICgoZGVzdHJ1Y3Rvcikp
Ci0jdW5kZWYgX19kZXByZWNhdGVkCi0jZGVmaW5lIF9fZGVwcmVjYXRlZCBfX2F0dHJpYnV0ZV9f
ICgoZGVwcmVjYXRlZCkpCi0KLSNkZWZpbmUgbWluKHgseSkgKHsgXAotCXR5cGVvZih4KSBfeCA9
ICh4KTsJXAotCXR5cGVvZih5KSBfeSA9ICh5KTsJXAotCSh2b2lkKSAoJl94ID09ICZfeSk7CQlc
Ci0JX3ggPCBfeSA/IF94IDogX3k7IH0pCi0KLSNkZWZpbmUgbWF4KHgseSkgKHsgXAotCXR5cGVv
Zih4KSBfeCA9ICh4KTsJXAotCXR5cGVvZih5KSBfeSA9ICh5KTsJXAotCSh2b2lkKSAoJl94ID09
ICZfeSk7CQlcCi0JX3ggPiBfeSA/IF94IDogX3k7IH0pCi0KLWV4dGVybiBpbnQgbmxfY2FjaGVf
cGFyc2Uoc3RydWN0IG5sX2NhY2hlX29wcyAqLCBzdHJ1Y3Qgc29ja2FkZHJfbmwgKiwKLQkJCSAg
c3RydWN0IG5sbXNnaGRyICosIHN0cnVjdCBubF9wYXJzZXJfcGFyYW0gKik7Ci0KLQotc3RhdGlj
IGlubGluZSBjaGFyICpubF9jYWNoZV9uYW1lKHN0cnVjdCBubF9jYWNoZSAqY2FjaGUpCi17Ci0J
cmV0dXJuIGNhY2hlLT5jX29wcyA/IGNhY2hlLT5jX29wcy0+Y29fbmFtZSA6ICJ1bmtub3duIjsK
LX0KLQotI2RlZmluZSBHRU5MX0ZBTUlMWShpZCwgbmFtZSkgXAotCXsgXAotCQl7IGlkLCBOTF9B
Q1RfVU5TUEVDLCBuYW1lIH0sIFwKLQkJRU5EX09GX01TR1RZUEVTX0xJU1QsIFwKLQl9Ci0KLXN0
YXRpYyBpbmxpbmUgaW50IHdhaXRfZm9yX2FjayhzdHJ1Y3Qgbmxfc29jayAqc2spCi17Ci0JaWYg
KHNrLT5zX2ZsYWdzICYgTkxfTk9fQVVUT19BQ0spCi0JCXJldHVybiAwOwotCWVsc2UKLQkJcmV0
dXJuIG5sX3dhaXRfZm9yX2Fjayhzayk7Ci19Ci0KLSNlbmRpZgpkaWZmIC0tZ2l0IGEvcGFja2Fn
ZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay10eXBlcy5oIGIvcGFja2FnZS9s
aWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay10eXBlcy5oCmRlbGV0ZWQgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCA2NWY3ZjZjMGI4NTguLjAwMDAwMDAwMDAwMAotLS0gYS9wYWNrYWdl
L2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rLXR5cGVzLmgKKysrIC9kZXYvbnVs
bApAQCAtMSw4OCArMCwwIEBACi0vKgotICogbmV0bGluay10eXBlcy5oCU5ldGxpbmsgVHlwZXMg
KFByaXZhdGUpCi0gKgotICoJVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4g
cmVkaXN0cmlidXRlIGl0IGFuZC9vcgotICoJbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0
aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwotICoJTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkg
dGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiB2ZXJzaW9uIDIuMQotICoJb2YgdGhlIExpY2Vu
c2UuCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDAzLTIwMDggVGhvbWFzIEdyYWYgPHRncmFmQHN1
dWcuY2g+Ci0gKi8KLQotI2lmbmRlZiBORVRMSU5LX0xPQ0FMX1RZUEVTX0hfCi0jZGVmaW5lIE5F
VExJTktfTE9DQUxfVFlQRVNfSF8KLQotI2luY2x1ZGUgPG5ldGxpbmsvbGlzdC5oPgotCi1zdHJ1
Y3QgbmxfY2FjaGVfb3BzOwotc3RydWN0IG5sX3NvY2s7Ci1zdHJ1Y3Qgbmxfb2JqZWN0OwotCi1z
dHJ1Y3QgbmxfY2FjaGUKLXsKLQlzdHJ1Y3QgbmxfbGlzdF9oZWFkCWNfaXRlbXM7Ci0JaW50CQkJ
Y19uaXRlbXM7Ci0JaW50ICAgICAgICAgICAgICAgICAgICAgY19pYXJnMTsKLQlpbnQgICAgICAg
ICAgICAgICAgICAgICBjX2lhcmcyOwotCXN0cnVjdCBubF9jYWNoZV9vcHMgKiAgIGNfb3BzOwot
fTsKLQotc3RydWN0IG5sX2NhY2hlX2Fzc29jCi17Ci0Jc3RydWN0IG5sX2NhY2hlICoJY2FfY2Fj
aGU7Ci0JY2hhbmdlX2Z1bmNfdAkJY2FfY2hhbmdlOwotfTsKLQotc3RydWN0IG5sX2NhY2hlX21u
Z3IKLXsKLQlpbnQJCQljbV9wcm90b2NvbDsKLQlpbnQJCQljbV9mbGFnczsKLQlpbnQJCQljbV9u
YXNzb2NzOwotCXN0cnVjdCBubF9zb2NrICoJY21faGFuZGxlOwotCXN0cnVjdCBubF9jYWNoZV9h
c3NvYyAqCWNtX2Fzc29jczsKLX07Ci0KLXN0cnVjdCBubF9wYXJzZXJfcGFyYW07Ci0KLSNkZWZp
bmUgTE9PU0VfQ09NUEFSSVNPTgkxCi0KLQotc3RydWN0IG5sX2RhdGEKLXsKLQlzaXplX3QJCQlk
X3NpemU7Ci0Jdm9pZCAqCQkJZF9kYXRhOwotfTsKLQotc3RydWN0IG5sX2FkZHIKLXsKLQlpbnQJ
CQlhX2ZhbWlseTsKLQl1bnNpZ25lZCBpbnQJCWFfbWF4c2l6ZTsKLQl1bnNpZ25lZCBpbnQJCWFf
bGVuOwotCWludAkJCWFfcHJlZml4bGVuOwotCWludAkJCWFfcmVmY250OwotCWNoYXIJCQlhX2Fk
ZHJbMF07Ci19OwotCi0jZGVmaW5lIElGUURJU0NTSVoJMzIKLQotI2RlZmluZSBHRU5MX09QX0hB
U19QT0xJQ1kJMQotI2RlZmluZSBHRU5MX09QX0hBU19ET0lUCTIKLSNkZWZpbmUgR0VOTF9PUF9I
QVNfRFVNUElUCTQKLQotc3RydWN0IGdlbmxfZmFtaWx5X2dycCB7Ci0Jc3RydWN0IGdlbmxfZmFt
aWx5CSpmYW1pbHk7CS8qIHByaXZhdGUgKi8KLQlzdHJ1Y3QgbmxfbGlzdF9oZWFkCWxpc3Q7CQkv
KiBwcml2YXRlICovCi0JY2hhcgkJCW5hbWVbR0VOTF9OQU1TSVpdOwotCXVfaW50MzJfdAkJaWQ7
Ci19OwotCi1zdHJ1Y3QgZ2VubF9mYW1pbHlfb3AKLXsKLQl1aW50MzJfdAkJb19pZDsKLQl1aW50
MzJfdAkJb19mbGFnczsKLQotCXN0cnVjdCBubF9saXN0X2hlYWQJb19saXN0OwotfTsKLQotCi0j
ZW5kaWYKZGlmZiAtLWdpdCBhL3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25l
dGxpbmsvYWRkci5oIGIvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGlu
ay9hZGRyLmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IGNjM2QyMDFmOTc4MS4uMDAw
MDAwMDAwMDAwCi0tLSBhL3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxp
bmsvYWRkci5oCisrKyAvZGV2L251bGwKQEAgLTEsNjkgKzAsMCBAQAotLyoKLSAqIG5ldGxpbmsv
YWRkci5oCQlBYnN0cmFjdCBBZGRyZXNzCi0gKgotICoJVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29m
dHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgotICoJbW9kaWZ5IGl0IHVuZGVy
IHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwotICoJTGljZW5zZSBh
cyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiB2ZXJzaW9uIDIuMQot
ICoJb2YgdGhlIExpY2Vuc2UuCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDAzLTIwMDggVGhvbWFz
IEdyYWYgPHRncmFmQHN1dWcuY2g+Ci0gKi8KLQotI2lmbmRlZiBORVRMSU5LX0FERFJfSF8KLSNk
ZWZpbmUgTkVUTElOS19BRERSX0hfCi0KLSNpbmNsdWRlIDxuZXRsaW5rL25ldGxpbmsuaD4KLQot
I2lmZGVmIF9fY3BsdXNwbHVzCi1leHRlcm4gIkMiIHsKLSNlbmRpZgotCi1zdHJ1Y3QgbmxfYWRk
cjsKLQotLyogQ3JlYXRpb24gKi8KLWV4dGVybiBzdHJ1Y3QgbmxfYWRkciAqCW5sX2FkZHJfYWxs
b2Moc2l6ZV90KTsKLWV4dGVybiBzdHJ1Y3QgbmxfYWRkciAqCW5sX2FkZHJfYWxsb2NfYXR0cihz
dHJ1Y3QgbmxhdHRyICosIGludCk7Ci1leHRlcm4gc3RydWN0IG5sX2FkZHIgKglubF9hZGRyX2J1
aWxkKGludCwgdm9pZCAqLCBzaXplX3QpOwotZXh0ZXJuIGludAkJbmxfYWRkcl9wYXJzZShjb25z
dCBjaGFyICosIGludCwgc3RydWN0IG5sX2FkZHIgKiopOwotZXh0ZXJuIHN0cnVjdCBubF9hZGRy
ICoJbmxfYWRkcl9jbG9uZShzdHJ1Y3QgbmxfYWRkciAqKTsKLQotLyogRGVzdHJveWFnZSAqLwot
ZXh0ZXJuIHZvaWQJCW5sX2FkZHJfZGVzdHJveShzdHJ1Y3QgbmxfYWRkciAqKTsKLQotLyogVXNh
Z2UgTWFuYWdlbWVudCAqLwotZXh0ZXJuIHN0cnVjdCBubF9hZGRyICoJbmxfYWRkcl9nZXQoc3Ry
dWN0IG5sX2FkZHIgKik7Ci1leHRlcm4gdm9pZAkJbmxfYWRkcl9wdXQoc3RydWN0IG5sX2FkZHIg
Kik7Ci1leHRlcm4gaW50CQlubF9hZGRyX3NoYXJlZChzdHJ1Y3QgbmxfYWRkciAqKTsKLQotZXh0
ZXJuIGludAkJbmxfYWRkcl9jbXAoc3RydWN0IG5sX2FkZHIgKiwgc3RydWN0IG5sX2FkZHIgKik7
Ci1leHRlcm4gaW50CQlubF9hZGRyX2NtcF9wcmVmaXgoc3RydWN0IG5sX2FkZHIgKiwgc3RydWN0
IG5sX2FkZHIgKik7Ci1leHRlcm4gaW50CQlubF9hZGRyX2lzemVybyhzdHJ1Y3QgbmxfYWRkciAq
KTsKLWV4dGVybiBpbnQJCW5sX2FkZHJfdmFsaWQoY2hhciAqLCBpbnQpOwotZXh0ZXJuIGludCAg
ICAgIAlubF9hZGRyX2d1ZXNzX2ZhbWlseShzdHJ1Y3QgbmxfYWRkciAqKTsKLWV4dGVybiBpbnQJ
CW5sX2FkZHJfZmlsbF9zb2NrYWRkcihzdHJ1Y3QgbmxfYWRkciAqLAotCQkJCQkgICAgICBzdHJ1
Y3Qgc29ja2FkZHIgKiwgc29ja2xlbl90ICopOwotZXh0ZXJuIGludAkJbmxfYWRkcl9pbmZvKHN0
cnVjdCBubF9hZGRyICosIHN0cnVjdCBhZGRyaW5mbyAqKik7Ci1leHRlcm4gaW50CQlubF9hZGRy
X3Jlc29sdmUoc3RydWN0IG5sX2FkZHIgKmFkZHIsIGNoYXIgKmhvc3QsIHNpemVfdCBob3N0bGVu
KTsKLQotLyogQWNjZXNzIEZ1bmN0aW9ucyAqLwotZXh0ZXJuIHZvaWQJCW5sX2FkZHJfc2V0X2Zh
bWlseShzdHJ1Y3QgbmxfYWRkciAqLCBpbnQpOwotZXh0ZXJuIGludAkJbmxfYWRkcl9nZXRfZmFt
aWx5KHN0cnVjdCBubF9hZGRyICopOwotZXh0ZXJuIGludAkJbmxfYWRkcl9zZXRfYmluYXJ5X2Fk
ZHIoc3RydWN0IG5sX2FkZHIgKiwgdm9pZCAqLAotCQkJCQkJc2l6ZV90KTsKLWV4dGVybiB2b2lk
ICoJCW5sX2FkZHJfZ2V0X2JpbmFyeV9hZGRyKHN0cnVjdCBubF9hZGRyICopOwotZXh0ZXJuIHVu
c2lnbmVkIGludAlubF9hZGRyX2dldF9sZW4oc3RydWN0IG5sX2FkZHIgKik7Ci1leHRlcm4gdm9p
ZAkJbmxfYWRkcl9zZXRfcHJlZml4bGVuKHN0cnVjdCBubF9hZGRyICosIGludCk7Ci1leHRlcm4g
dW5zaWduZWQgaW50CW5sX2FkZHJfZ2V0X3ByZWZpeGxlbihzdHJ1Y3QgbmxfYWRkciAqKTsKLQot
LyogQWRkcmVzcyBGYW1pbHkgVHJhbnNsYXRpb25zICovCi1leHRlcm4gY2hhciAqCQlubF9hZjJz
dHIoaW50LCBjaGFyICosIHNpemVfdCk7Ci1leHRlcm4gaW50CQlubF9zdHIyYWYoY29uc3QgY2hh
ciAqKTsKLQotLyogVHJhbnNsYXRpb25zIHRvIFN0cmluZ3MgKi8KLWV4dGVybiBjaGFyICoJCW5s
X2FkZHIyc3RyKHN0cnVjdCBubF9hZGRyICosIGNoYXIgKiwgc2l6ZV90KTsKLQotI2lmZGVmIF9f
Y3BsdXNwbHVzCi19Ci0jZW5kaWYKLQotI2VuZGlmCmRpZmYgLS1naXQgYS9wYWNrYWdlL2xpYnMv
bGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL2F0dHIuaCBiL3BhY2thZ2UvbGlicy9saWJu
bC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvYXR0ci5oCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0
NAppbmRleCAzYjU2YTgyZGM2NmUuLjAwMDAwMDAwMDAwMAotLS0gYS9wYWNrYWdlL2xpYnMvbGli
bmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL2F0dHIuaAorKysgL2Rldi9udWxsCkBAIC0xLDcy
NiArMCwwIEBACi0vKgotICogbmV0bGluay9hdHRyLmgJCU5ldGxpbmsgQXR0cmlidXRlcwotICoK
LSAqCVRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBp
dCBhbmQvb3IKLSAqCW1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIg
R2VuZXJhbCBQdWJsaWMKLSAqCUxpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3
YXJlIEZvdW5kYXRpb24gdmVyc2lvbiAyLjEKLSAqCW9mIHRoZSBMaWNlbnNlLgotICoKLSAqIENv
cHlyaWdodCAoYykgMjAwMy0yMDA4IFRob21hcyBHcmFmIDx0Z3JhZkBzdXVnLmNoPgotICovCi0K
LSNpZm5kZWYgTkVUTElOS19BVFRSX0hfCi0jZGVmaW5lIE5FVExJTktfQVRUUl9IXwotCi0jaW5j
bHVkZSA8bmV0bGluay9uZXRsaW5rLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9vYmplY3QuaD4KLSNp
bmNsdWRlIDxuZXRsaW5rL2FkZHIuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL2RhdGEuaD4KLSNpbmNs
dWRlIDxuZXRsaW5rL21zZy5oPgotCi0jaWZkZWYgX19jcGx1c3BsdXMKLWV4dGVybiAiQyIgewot
I2VuZGlmCi0KLXN0cnVjdCBubF9tc2c7Ci0KLS8qKgotICogQG5hbWUgQmFzaWMgQXR0cmlidXRl
IERhdGEgVHlwZXMKLSAqIEB7Ci0gKi8KLQotIC8qKgotICAqIEBpbmdyb3VwIGF0dHIKLSAgKiBC
YXNpYyBhdHRyaWJ1dGUgZGF0YSB0eXBlcwotICAqCi0gICogU2VlIFxyZWYgYXR0cl9kYXRhdHlw
ZXMgZm9yIG1vcmUgZGV0YWlscy4KLSAgKi8KLWVudW0gewotCU5MQV9VTlNQRUMsCS8qKjwgVW5z
cGVjaWZpZWQgdHlwZSwgYmluYXJ5IGRhdGEgY2h1bmsgKi8KLQlOTEFfVTgsCQkvKio8IDggYml0
IGludGVnZXIgKi8KLQlOTEFfVTE2LAkvKio8IDE2IGJpdCBpbnRlZ2VyICovCi0JTkxBX1UzMiwJ
LyoqPCAzMiBiaXQgaW50ZWdlciAqLwotCU5MQV9VNjQsCS8qKjwgNjQgYml0IGludGVnZXIgKi8K
LQlOTEFfU1RSSU5HLAkvKio8IE5VTCB0ZXJtaW5hdGVkIGNoYXJhY3RlciBzdHJpbmcgKi8KLQlO
TEFfRkxBRywJLyoqPCBGbGFnICovCi0JTkxBX01TRUNTLAkvKio8IE1pY3JvIHNlY29uZHMgKDY0
Yml0KSAqLwotCU5MQV9ORVNURUQsCS8qKjwgTmVzdGVkIGF0dHJpYnV0ZXMgKi8KLQlfX05MQV9U
WVBFX01BWCwKLX07Ci0KLSNkZWZpbmUgTkxBX1RZUEVfTUFYIChfX05MQV9UWVBFX01BWCAtIDEp
Ci0KLS8qKiBAfSAqLwotCi0vKioKLSAqIEBpbmdyb3VwIGF0dHIKLSAqIEF0dHJpYnV0ZSB2YWxp
ZGF0aW9uIHBvbGljeS4KLSAqCi0gKiBTZWUgXHJlZiBhdHRyX2RhdGF0eXBlcyBmb3IgbW9yZSBk
ZXRhaWxzLgotICovCi1zdHJ1Y3QgbmxhX3BvbGljeSB7Ci0JLyoqIFR5cGUgb2YgYXR0cmlidXRl
IG9yIE5MQV9VTlNQRUMgKi8KLQl1aW50MTZfdAl0eXBlOwotCi0JLyoqIE1pbmltYWwgbGVuZ3Ro
IG9mIHBheWxvYWQgcmVxdWlyZWQgKi8KLQl1aW50MTZfdAltaW5sZW47Ci0KLQkvKiogTWF4aW1h
bCBsZW5ndGggb2YgcGF5bG9hZCBhbGxvd2VkICovCi0JdWludDE2X3QJbWF4bGVuOwotfTsKLQot
LyogQXR0cmlidXRlIHBhcnNpbmcgKi8KLWV4dGVybiBpbnQJCW5sYV9vayhjb25zdCBzdHJ1Y3Qg
bmxhdHRyICosIGludCk7Ci1leHRlcm4gc3RydWN0IG5sYXR0ciAqCW5sYV9uZXh0KGNvbnN0IHN0
cnVjdCBubGF0dHIgKiwgaW50ICopOwotZXh0ZXJuIGludAkJbmxhX3BhcnNlKHN0cnVjdCBubGF0
dHIgKiosIGludCwgc3RydWN0IG5sYXR0ciAqLAotCQkJCSAgaW50LCBzdHJ1Y3QgbmxhX3BvbGlj
eSAqKTsKLWV4dGVybiBpbnQJCW5sYV92YWxpZGF0ZShzdHJ1Y3QgbmxhdHRyICosIGludCwgaW50
LAotCQkJCSAgICAgc3RydWN0IG5sYV9wb2xpY3kgKik7Ci1leHRlcm4gc3RydWN0IG5sYXR0ciAq
CW5sYV9maW5kKHN0cnVjdCBubGF0dHIgKiwgaW50LCBpbnQpOwotCi0vKiBVbnNwZWNpZmljIGF0
dHJpYnV0ZSAqLwotZXh0ZXJuIHN0cnVjdCBubGF0dHIgKglubGFfcmVzZXJ2ZShzdHJ1Y3Qgbmxf
bXNnICosIGludCwgaW50KTsKLWV4dGVybiBpbnQJCW5sYV9wdXQoc3RydWN0IG5sX21zZyAqLCBp
bnQsIGludCwgY29uc3Qgdm9pZCAqKTsKLQotLyoqCi0gKiBubG1zZ19maW5kX2F0dHIgLSBmaW5k
IGEgc3BlY2lmaWMgYXR0cmlidXRlIGluIGEgbmV0bGluayBtZXNzYWdlCi0gKiBAYXJnIG5saAkJ
bmV0bGluayBtZXNzYWdlIGhlYWRlcgotICogQGFyZyBoZHJsZW4JCWxlbmd0aCBvZiBmYW1pbGl5
IHNwZWNpZmljIGhlYWRlcgotICogQGFyZyBhdHRydHlwZQl0eXBlIG9mIGF0dHJpYnV0ZSB0byBs
b29rIGZvcgotICoKLSAqIFJldHVybnMgdGhlIGZpcnN0IGF0dHJpYnV0ZSB3aGljaCBtYXRjaGVz
IHRoZSBzcGVjaWZpZWQgdHlwZS4KLSAqLwotc3RhdGljIGlubGluZSBzdHJ1Y3QgbmxhdHRyICpu
bG1zZ19maW5kX2F0dHIoc3RydWN0IG5sbXNnaGRyICpubGgsIGludCBoZHJsZW4sIGludCBhdHRy
dHlwZSkKLXsKLQlyZXR1cm4gbmxhX2ZpbmQobmxtc2dfYXR0cmRhdGEobmxoLCBoZHJsZW4pLAot
CQkJbmxtc2dfYXR0cmxlbihubGgsIGhkcmxlbiksIGF0dHJ0eXBlKTsKLX0KLQotCi0vKioKLSAq
IFJldHVybiBzaXplIG9mIGF0dHJpYnV0ZSB3aGl0aG91dCBwYWRkaW5nLgotICogQGFyZyBwYXls
b2FkCQlQYXlsb2FkIGxlbmd0aCBvZiBhdHRyaWJ1dGUuCi0gKgotICogQGNvZGUKLSAqICAgIDwt
LS0tLS0tLSBubGFfYXR0cl9zaXplKHBheWxvYWQpIC0tLS0tLS0tLT4KLSAqICAgKy0tLS0tLS0t
LS0tLS0tLS0tLSstIC0gLSstIC0gLSAtIC0gLSAtIC0gLSArLSAtIC0rCi0gKiAgIHwgQXR0cmli
dXRlIEhlYWRlciB8IFBhZCB8ICAgICBQYXlsb2FkICAgICAgfCBQYWQgfAotICogICArLS0tLS0t
LS0tLS0tLS0tLS0tKy0gLSAtKy0gLSAtIC0gLSAtIC0gLSAtICstIC0gLSsKLSAqIEBlbmRjb2Rl
Ci0gKgotICogQHJldHVybiBTaXplIG9mIGF0dHJpYnV0ZSBpbiBieXRlcyB3aXRob3V0IHBhZGRp
bmcuCi0gKi8KLXN0YXRpYyBpbmxpbmUgaW50IG5sYV9hdHRyX3NpemUoaW50IHBheWxvYWQpCi17
Ci0JcmV0dXJuIE5MQV9IRFJMRU4gKyBwYXlsb2FkOwotfQotCi0vKioKLSAqIFJldHVybiBzaXpl
IG9mIGF0dHJpYnV0ZSBpbmNsdWRpbmcgcGFkZGluZy4KLSAqIEBhcmcgcGF5bG9hZAkJUGF5bG9h
ZCBsZW5ndGggb2YgYXR0cmlidXRlLgotICoKLSAqIEBjb2RlCi0gKiAgICA8LS0tLS0tLS0tLS0g
bmxhX3RvdGFsX3NpemUocGF5bG9hZCkgLS0tLS0tLS0tLS0+Ci0gKiAgICstLS0tLS0tLS0tLS0t
LS0tLS0rLSAtIC0rLSAtIC0gLSAtIC0gLSAtIC0gKy0gLSAtKwotICogICB8IEF0dHJpYnV0ZSBI
ZWFkZXIgfCBQYWQgfCAgICAgUGF5bG9hZCAgICAgIHwgUGFkIHwKLSAqICAgKy0tLS0tLS0tLS0t
LS0tLS0tLSstIC0gLSstIC0gLSAtIC0gLSAtIC0gLSArLSAtIC0rCi0gKiBAZW5kY29kZQotICoK
LSAqIEByZXR1cm4gU2l6ZSBvZiBhdHRyaWJ1dGUgaW4gYnl0ZXMuCi0gKi8KLXN0YXRpYyBpbmxp
bmUgaW50IG5sYV90b3RhbF9zaXplKGludCBwYXlsb2FkKQotewotCXJldHVybiBOTEFfQUxJR04o
bmxhX2F0dHJfc2l6ZShwYXlsb2FkKSk7Ci19Ci0KLS8qKgotICogUmV0dXJuIGxlbmd0aCBvZiBw
YWRkaW5nIGF0IHRoZSB0YWlsIG9mIHRoZSBhdHRyaWJ1dGUuCi0gKiBAYXJnIHBheWxvYWQJCVBh
eWxvYWQgbGVuZ3RoIG9mIGF0dHJpYnV0ZS4KLSAqCi0gKiBAY29kZQotICogICArLS0tLS0tLS0t
LS0tLS0tLS0tKy0gLSAtKy0gLSAtIC0gLSAtIC0gLSAtICstIC0gLSsKLSAqICAgfCBBdHRyaWJ1
dGUgSGVhZGVyIHwgUGFkIHwgICAgIFBheWxvYWQgICAgICB8IFBhZCB8Ci0gKiAgICstLS0tLS0t
LS0tLS0tLS0tLS0rLSAtIC0rLSAtIC0gLSAtIC0gLSAtIC0gKy0gLSAtKwotICogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8LS0tPiAgCi0gKiBAZW5kY29k
ZQotICoKLSAqIEByZXR1cm4gTGVuZ3RoIG9mIHBhZGRpbmcgaW4gYnl0ZXMuCi0gKi8KLXN0YXRp
YyBpbmxpbmUgaW50IG5sYV9wYWRsZW4oaW50IHBheWxvYWQpCi17Ci0JcmV0dXJuIG5sYV90b3Rh
bF9zaXplKHBheWxvYWQpIC0gbmxhX2F0dHJfc2l6ZShwYXlsb2FkKTsKLX0KLQotLyoqCi0gKiBS
ZXR1cm4gdHlwZSBvZiB0aGUgYXR0cmlidXRlLgotICogQGFyZyBubGEJCUF0dHJpYnV0ZS4KLSAq
Ci0gKiBAcmV0dXJuIFR5cGUgb2YgYXR0cmlidXRlLgotICovCi1zdGF0aWMgaW5saW5lIGludCBu
bGFfdHlwZShjb25zdCBzdHJ1Y3QgbmxhdHRyICpubGEpCi17Ci0JcmV0dXJuIG5sYS0+bmxhX3R5
cGUgJiBOTEFfVFlQRV9NQVNLOwotfQotCi0vKioKLSAqIFJldHVybiBwb2ludGVyIHRvIHRoZSBw
YXlsb2FkIHNlY3Rpb24uCi0gKiBAYXJnIG5sYQkJQXR0cmlidXRlLgotICoKLSAqIEByZXR1cm4g
UG9pbnRlciB0byBzdGFydCBvZiBwYXlsb2FkIHNlY3Rpb24uCi0gKi8KLXN0YXRpYyBpbmxpbmUg
dm9pZCAqbmxhX2RhdGEoY29uc3Qgc3RydWN0IG5sYXR0ciAqbmxhKQotewotCXJldHVybiAoY2hh
ciAqKSBubGEgKyBOTEFfSERSTEVOOwotfQotCi0vKioKLSAqIFJldHVybiBsZW5ndGggb2YgdGhl
IHBheWxvYWQgLgotICogQGFyZyBubGEJCUF0dHJpYnV0ZQotICoKLSAqIEByZXR1cm4gTGVuZ3Ro
IG9mIHBheWxvYWQgaW4gYnl0ZXMuCi0gKi8KLXN0YXRpYyBpbmxpbmUgaW50IG5sYV9sZW4oY29u
c3Qgc3RydWN0IG5sYXR0ciAqbmxhKQotewotCXJldHVybiBubGEtPm5sYV9sZW4gLSBOTEFfSERS
TEVOOwotfQotCi0vKioKLSAqIENvcHkgYXR0cmlidXRlIHBheWxvYWQgdG8gYW5vdGhlciBtZW1v
cnkgYXJlYS4KLSAqIEBhcmcgZGVzdAkJUG9pbnRlciB0byBkZXN0aW5hdGlvbiBtZW1vcnkgYXJl
YS4KLSAqIEBhcmcgc3JjCQlBdHRyaWJ1dGUKLSAqIEBhcmcgY291bnQJCU51bWJlciBvZiBieXRl
cyB0byBjb3B5IGF0IG1vc3QuCi0gKgotICogTm90ZTogVGhlIG51bWJlciBvZiBieXRlcyBjb3Bp
ZWQgaXMgbGltaXRlZCBieSB0aGUgbGVuZ3RoIG9mCi0gKiAgICAgICB0aGUgYXR0cmlidXRlIHBh
eWxvYWQuCi0gKgotICogQHJldHVybiBUaGUgbnVtYmVyIG9mIGJ5dGVzIGNvcGllZCB0byBkZXN0
LgotICovCi1zdGF0aWMgaW5saW5lIGludCBubGFfbWVtY3B5KHZvaWQgKmRlc3QsIHN0cnVjdCBu
bGF0dHIgKnNyYywgaW50IGNvdW50KQotewotCWludCBtaW5sZW47Ci0KLQlpZiAoIXNyYykKLQkJ
cmV0dXJuIDA7Ci0JCi0JbWlubGVuID0gbWluX3QoaW50LCBjb3VudCwgbmxhX2xlbihzcmMpKTsK
LQltZW1jcHkoZGVzdCwgbmxhX2RhdGEoc3JjKSwgbWlubGVuKTsKLQotCXJldHVybiBtaW5sZW47
Ci19Ci0KLQotLyoqCi0gKiBBZGQgYWJzdHJhY3QgZGF0YSBhcyB1bnNwZWNpZmljIGF0dHJpYnV0
ZSB0byBuZXRsaW5rIG1lc3NhZ2UuCi0gKiBAYXJnIG1zZwkJTmV0bGluayBtZXNzYWdlLgotICog
QGFyZyBhdHRydHlwZQlBdHRyaWJ1dGUgdHlwZS4KLSAqIEBhcmcgZGF0YQkJQWJzdHJhY3QgZGF0
YSBvYmplY3QuCi0gKgotICogRXF1aXZhbGVudCB0byBubGFfcHV0KCkgZXhjZXB0IHRoYXQgdGhl
IGxlbmd0aCBvZiB0aGUgcGF5bG9hZCBpcwotICogZGVyaXZlZCBmcm9tIHRoZSBhYnN0cmFjdCBk
YXRhIG9iamVjdC4KLSAqCi0gKiBAc2VlIG5sYV9wdXQKLSAqIEByZXR1cm4gMCBvbiBzdWNjZXNz
IG9yIGEgbmVnYXRpdmUgZXJyb3IgY29kZS4KLSAqLwotc3RhdGljIGlubGluZSBpbnQgbmxhX3B1
dF9kYXRhKHN0cnVjdCBubF9tc2cgKm1zZywgaW50IGF0dHJ0eXBlLCBzdHJ1Y3QgbmxfZGF0YSAq
ZGF0YSkKLXsKLQlyZXR1cm4gbmxhX3B1dChtc2csIGF0dHJ0eXBlLCBubF9kYXRhX2dldF9zaXpl
KGRhdGEpLAotCQkgICAgICAgbmxfZGF0YV9nZXQoZGF0YSkpOwotfQotCi0vKioKLSAqIEFkZCBh
YnN0cmFjdCBhZGRyZXNzIGFzIHVuc3BlY2lmaWMgYXR0cmlidXRlIHRvIG5ldGxpbmsgbWVzc2Fn
ZS4KLSAqIEBhcmcgbXNnCQlOZXRsaW5rIG1lc3NhZ2UuCi0gKiBAYXJnIGF0dHJ0eXBlCUF0dHJp
YnV0ZSB0eXBlLgotICogQGFyZyBhZGRyCQlBYnN0cmFjdCBhZGRyZXNzIG9iamVjdC4KLSAqCi0g
KiBAc2VlIG5sYV9wdXQKLSAqIEByZXR1cm4gMCBvbiBzdWNjZXNzIG9yIGEgbmVnYXRpdmUgZXJy
b3IgY29kZS4KLSAqLwotc3RhdGljIGlubGluZSBpbnQgbmxhX3B1dF9hZGRyKHN0cnVjdCBubF9t
c2cgKm1zZywgaW50IGF0dHJ0eXBlLCBzdHJ1Y3QgbmxfYWRkciAqYWRkcikKLXsKLQlyZXR1cm4g
bmxhX3B1dChtc2csIGF0dHJ0eXBlLCBubF9hZGRyX2dldF9sZW4oYWRkciksCi0JCSAgICAgICBu
bF9hZGRyX2dldF9iaW5hcnlfYWRkcihhZGRyKSk7Ci19Ci0KLS8qKiBAfSAqLwotCi0vKioKLSAq
IEBuYW1lIEludGVnZXIgQXR0cmlidXRlcwotICovCi0KLS8qKgotICogQWRkIDggYml0IGludGVn
ZXIgYXR0cmlidXRlIHRvIG5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgbXNnCQlOZXRsaW5rIG1l
c3NhZ2UuCi0gKiBAYXJnIGF0dHJ0eXBlCUF0dHJpYnV0ZSB0eXBlLgotICogQGFyZyB2YWx1ZQkJ
TnVtZXJpYyB2YWx1ZSB0byBzdG9yZSBhcyBwYXlsb2FkLgotICoKLSAqIEBzZWUgbmxhX3B1dAot
ICogQHJldHVybiAwIG9uIHN1Y2Nlc3Mgb3IgYSBuZWdhdGl2ZSBlcnJvciBjb2RlLgotICovCi1z
dGF0aWMgaW5saW5lIGludCBubGFfcHV0X3U4KHN0cnVjdCBubF9tc2cgKm1zZywgaW50IGF0dHJ0
eXBlLCB1aW50OF90IHZhbHVlKQotewotCXJldHVybiBubGFfcHV0KG1zZywgYXR0cnR5cGUsIHNp
emVvZih1aW50OF90KSwgJnZhbHVlKTsKLX0KLQotLyoqCi0gKiBSZXR1cm4gdmFsdWUgb2YgOCBi
aXQgaW50ZWdlciBhdHRyaWJ1dGUuCi0gKiBAYXJnIG5sYQkJOCBiaXQgaW50ZWdlciBhdHRyaWJ1
dGUKLSAqCi0gKiBAcmV0dXJuIFBheWxvYWQgYXMgOCBiaXQgaW50ZWdlci4KLSAqLwotc3RhdGlj
IGlubGluZSB1aW50OF90IG5sYV9nZXRfdTgoc3RydWN0IG5sYXR0ciAqbmxhKQotewotCXJldHVy
biAqKHVpbnQ4X3QgKikgbmxhX2RhdGEobmxhKTsKLX0KLQotLyoqCi0gKiBBZGQgMTYgYml0IGlu
dGVnZXIgYXR0cmlidXRlIHRvIG5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgbXNnCQlOZXRsaW5r
IG1lc3NhZ2UuCi0gKiBAYXJnIGF0dHJ0eXBlCUF0dHJpYnV0ZSB0eXBlLgotICogQGFyZyB2YWx1
ZQkJTnVtZXJpYyB2YWx1ZSB0byBzdG9yZSBhcyBwYXlsb2FkLgotICoKLSAqIEBzZWUgbmxhX3B1
dAotICogQHJldHVybiAwIG9uIHN1Y2Nlc3Mgb3IgYSBuZWdhdGl2ZSBlcnJvciBjb2RlLgotICov
Ci1zdGF0aWMgaW5saW5lIGludCBubGFfcHV0X3UxNihzdHJ1Y3QgbmxfbXNnICptc2csIGludCBh
dHRydHlwZSwgdWludDE2X3QgdmFsdWUpCi17Ci0JcmV0dXJuIG5sYV9wdXQobXNnLCBhdHRydHlw
ZSwgc2l6ZW9mKHVpbnQxNl90KSwgJnZhbHVlKTsKLX0KLQotLyoqCi0gKiBSZXR1cm4gcGF5bG9h
ZCBvZiAxNiBiaXQgaW50ZWdlciBhdHRyaWJ1dGUuCi0gKiBAYXJnIG5sYQkJMTYgYml0IGludGVn
ZXIgYXR0cmlidXRlCi0gKgotICogQHJldHVybiBQYXlsb2FkIGFzIDE2IGJpdCBpbnRlZ2VyLgot
ICovCi1zdGF0aWMgaW5saW5lIHVpbnQxNl90IG5sYV9nZXRfdTE2KHN0cnVjdCBubGF0dHIgKm5s
YSkKLXsKLQlyZXR1cm4gKih1aW50MTZfdCAqKSBubGFfZGF0YShubGEpOwotfQotCi0vKioKLSAq
IEFkZCAzMiBiaXQgaW50ZWdlciBhdHRyaWJ1dGUgdG8gbmV0bGluayBtZXNzYWdlLgotICogQGFy
ZyBtc2cJCU5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgYXR0cnR5cGUJQXR0cmlidXRlIHR5cGUu
Ci0gKiBAYXJnIHZhbHVlCQlOdW1lcmljIHZhbHVlIHRvIHN0b3JlIGFzIHBheWxvYWQuCi0gKgot
ICogQHNlZSBubGFfcHV0Ci0gKiBAcmV0dXJuIDAgb24gc3VjY2VzcyBvciBhIG5lZ2F0aXZlIGVy
cm9yIGNvZGUuCi0gKi8KLXN0YXRpYyBpbmxpbmUgaW50IG5sYV9wdXRfdTMyKHN0cnVjdCBubF9t
c2cgKm1zZywgaW50IGF0dHJ0eXBlLCB1aW50MzJfdCB2YWx1ZSkKLXsKLQlyZXR1cm4gbmxhX3B1
dChtc2csIGF0dHJ0eXBlLCBzaXplb2YodWludDMyX3QpLCAmdmFsdWUpOwotfQotCi0vKioKLSAq
IFJldHVybiBwYXlsb2FkIG9mIDMyIGJpdCBpbnRlZ2VyIGF0dHJpYnV0ZS4KLSAqIEBhcmcgbmxh
CQkzMiBiaXQgaW50ZWdlciBhdHRyaWJ1dGUuCi0gKgotICogQHJldHVybiBQYXlsb2FkIGFzIDMy
IGJpdCBpbnRlZ2VyLgotICovCi1zdGF0aWMgaW5saW5lIHVpbnQzMl90IG5sYV9nZXRfdTMyKHN0
cnVjdCBubGF0dHIgKm5sYSkKLXsKLQlyZXR1cm4gKih1aW50MzJfdCAqKSBubGFfZGF0YShubGEp
OwotfQotCi0vKioKLSAqIEFkZCA2NCBiaXQgaW50ZWdlciBhdHRyaWJ1dGUgdG8gbmV0bGluayBt
ZXNzYWdlLgotICogQGFyZyBtc2cJCU5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgYXR0cnR5cGUJ
QXR0cmlidXRlIHR5cGUuCi0gKiBAYXJnIHZhbHVlCQlOdW1lcmljIHZhbHVlIHRvIHN0b3JlIGFz
IHBheWxvYWQuCi0gKgotICogQHNlZSBubGFfcHV0Ci0gKiBAcmV0dXJuIDAgb24gc3VjY2VzcyBv
ciBhIG5lZ2F0aXZlIGVycm9yIGNvZGUuCi0gKi8KLXN0YXRpYyBpbmxpbmUgaW50IG5sYV9wdXRf
dTY0KHN0cnVjdCBubF9tc2cgKm1zZywgaW50IGF0dHJ0eXBlLCB1aW50NjRfdCB2YWx1ZSkKLXsK
LQlyZXR1cm4gbmxhX3B1dChtc2csIGF0dHJ0eXBlLCBzaXplb2YodWludDY0X3QpLCAmdmFsdWUp
OwotfQotCi0vKioKLSAqIFJldHVybiBwYXlsb2FkIG9mIHU2NCBhdHRyaWJ1dGUKLSAqIEBhcmcg
bmxhCQl1NjQgbmV0bGluayBhdHRyaWJ1dGUKLSAqCi0gKiBAcmV0dXJuIFBheWxvYWQgYXMgNjQg
Yml0IGludGVnZXIuCi0gKi8KLXN0YXRpYyBpbmxpbmUgdWludDY0X3QgbmxhX2dldF91NjQoc3Ry
dWN0IG5sYXR0ciAqbmxhKQotewotCXVpbnQ2NF90IHRtcDsKLQotCW5sYV9tZW1jcHkoJnRtcCwg
bmxhLCBzaXplb2YodG1wKSk7Ci0KLQlyZXR1cm4gdG1wOwotfQotCi0vKioKLSAqIEFkZCBzdHJp
bmcgYXR0cmlidXRlIHRvIG5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgbXNnCQlOZXRsaW5rIG1l
c3NhZ2UuCi0gKiBAYXJnIGF0dHJ0eXBlCUF0dHJpYnV0ZSB0eXBlLgotICogQGFyZyBzdHIJCU5V
TCB0ZXJtaW5hdGVkIHN0cmluZy4KLSAqCi0gKiBAc2VlIG5sYV9wdXQKLSAqIEByZXR1cm4gMCBv
biBzdWNjZXNzIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29kZS4KLSAqLwotc3RhdGljIGlubGluZSBp
bnQgbmxhX3B1dF9zdHJpbmcoc3RydWN0IG5sX21zZyAqbXNnLCBpbnQgYXR0cnR5cGUsIGNvbnN0
IGNoYXIgKnN0cikKLXsKLQlyZXR1cm4gbmxhX3B1dChtc2csIGF0dHJ0eXBlLCBzdHJsZW4oc3Ry
KSArIDEsIHN0cik7Ci19Ci0KLS8qKgotICogUmV0dXJuIHBheWxvYWQgb2Ygc3RyaW5nIGF0dHJp
YnV0ZS4KLSAqIEBhcmcgbmxhCQlTdHJpbmcgYXR0cmlidXRlLgotICoKLSAqIEByZXR1cm4gUG9p
bnRlciB0byBhdHRyaWJ1dGUgcGF5bG9hZC4KLSAqLwotc3RhdGljIGlubGluZSBjaGFyICpubGFf
Z2V0X3N0cmluZyhzdHJ1Y3QgbmxhdHRyICpubGEpCi17Ci0JcmV0dXJuIChjaGFyICopIG5sYV9k
YXRhKG5sYSk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgY2hhciAqbmxhX3N0cmR1cChzdHJ1Y3Qgbmxh
dHRyICpubGEpCi17Ci0JcmV0dXJuIHN0cmR1cChubGFfZ2V0X3N0cmluZyhubGEpKTsKLX0KLQot
LyoqIEB9ICovCi0KLS8qKgotICogQG5hbWUgRmxhZyBBdHRyaWJ1dGUKLSAqLwotCi0vKioKLSAq
IEFkZCBmbGFnIG5ldGxpbmsgYXR0cmlidXRlIHRvIG5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcg
bXNnCQlOZXRsaW5rIG1lc3NhZ2UuCi0gKiBAYXJnIGF0dHJ0eXBlCUF0dHJpYnV0ZSB0eXBlLgot
ICoKLSAqIEBzZWUgbmxhX3B1dAotICogQHJldHVybiAwIG9uIHN1Y2Nlc3Mgb3IgYSBuZWdhdGl2
ZSBlcnJvciBjb2RlLgotICovCi1zdGF0aWMgaW5saW5lIGludCBubGFfcHV0X2ZsYWcoc3RydWN0
IG5sX21zZyAqbXNnLCBpbnQgYXR0cnR5cGUpCi17Ci0JcmV0dXJuIG5sYV9wdXQobXNnLCBhdHRy
dHlwZSwgMCwgTlVMTCk7Ci19Ci0KLS8qKgotICogUmV0dXJuIHRydWUgaWYgZmxhZyBhdHRyaWJ1
dGUgaXMgc2V0LgotICogQGFyZyBubGEJCUZsYWcgbmV0bGluayBhdHRyaWJ1dGUuCi0gKgotICog
QHJldHVybiBUcnVlIGlmIGZsYWcgaXMgc2V0LCBvdGhlcndpc2UgZmFsc2UuCi0gKi8KLXN0YXRp
YyBpbmxpbmUgaW50IG5sYV9nZXRfZmxhZyhzdHJ1Y3QgbmxhdHRyICpubGEpCi17Ci0JcmV0dXJu
ICEhbmxhOwotfQotCi0vKiogQH0gKi8KLQotLyoqCi0gKiBAbmFtZSBNaWNyb3NlY29uZHMgQXR0
cmlidXRlCi0gKi8KLQotLyoqCi0gKiBBZGQgYSBtc2VjcyBuZXRsaW5rIGF0dHJpYnV0ZSB0byBh
IG5ldGxpbmsgbWVzc2FnZQotICogQGFyZyBuCQluZXRsaW5rIG1lc3NhZ2UKLSAqIEBhcmcgYXR0
cnR5cGUJYXR0cmlidXRlIHR5cGUKLSAqIEBhcmcgbXNlY3MgCQludW1iZXIgb2YgbXNlY3MKLSAq
Lwotc3RhdGljIGlubGluZSBpbnQgbmxhX3B1dF9tc2VjcyhzdHJ1Y3QgbmxfbXNnICpuLCBpbnQg
YXR0cnR5cGUsIHVuc2lnbmVkIGxvbmcgbXNlY3MpCi17Ci0JcmV0dXJuIG5sYV9wdXRfdTY0KG4s
IGF0dHJ0eXBlLCBtc2Vjcyk7Ci19Ci0KLS8qKgotICogUmV0dXJuIHBheWxvYWQgb2YgbXNlY3Mg
YXR0cmlidXRlCi0gKiBAYXJnIG5sYQkJbXNlY3MgbmV0bGluayBhdHRyaWJ1dGUKLSAqCi0gKiBA
cmV0dXJuIHRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzLgotICovCi1zdGF0aWMgaW5saW5lIHVu
c2lnbmVkIGxvbmcgbmxhX2dldF9tc2VjcyhzdHJ1Y3QgbmxhdHRyICpubGEpCi17Ci0JcmV0dXJu
IG5sYV9nZXRfdTY0KG5sYSk7Ci19Ci0KLS8qKgotICogQWRkIG5lc3RlZCBhdHRyaWJ1dGVzIHRv
IG5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgbXNnCQlOZXRsaW5rIG1lc3NhZ2UuCi0gKiBAYXJn
IGF0dHJ0eXBlCUF0dHJpYnV0ZSB0eXBlLgotICogQGFyZyBuZXN0ZWQJCU1lc3NhZ2UgY29udGFp
bmluZyBhdHRyaWJ1dGVzIHRvIGJlIG5lc3RlZC4KLSAqCi0gKiBUYWtlcyB0aGUgYXR0cmlidXRl
cyBmb3VuZCBpbiB0aGUgXGEgbmVzdGVkIG1lc3NhZ2UgYW5kIGFwcGVuZHMgdGhlbQotICogdG8g
dGhlIG1lc3NhZ2UgXGEgbXNnIG5lc3RlZCBpbiBhIGNvbnRhaW5lciBvZiB0aGUgdHlwZSBcYSBh
dHRydHlwZS4KLSAqIFRoZSBcYSBuZXN0ZWQgbWVzc2FnZSBtYXkgbm90IGhhdmUgYSBmYW1pbHkg
c3BlY2lmaWMgaGVhZGVyLgotICoKLSAqIEBzZWUgbmxhX3B1dAotICogQHJldHVybiAwIG9uIHN1
Y2Nlc3Mgb3IgYSBuZWdhdGl2ZSBlcnJvciBjb2RlLgotICovCi1zdGF0aWMgaW5saW5lIGludCBu
bGFfcHV0X25lc3RlZChzdHJ1Y3QgbmxfbXNnICptc2csIGludCBhdHRydHlwZSwgc3RydWN0IG5s
X21zZyAqbmVzdGVkKQotewotCXJldHVybiBubGFfcHV0KG1zZywgYXR0cnR5cGUsIG5sbXNnX2xl
bihuZXN0ZWQtPm5tX25saCksCi0JCSAgICAgICBubG1zZ19kYXRhKG5lc3RlZC0+bm1fbmxoKSk7
Ci19Ci0KLS8qKgotICogU3RhcnQgYSBuZXcgbGV2ZWwgb2YgbmVzdGVkIGF0dHJpYnV0ZXMuCi0g
KiBAYXJnIG1zZwkJTmV0bGluayBtZXNzYWdlLgotICogQGFyZyBhdHRydHlwZQlBdHRyaWJ1dGUg
dHlwZSBvZiBjb250YWluZXIuCi0gKgotICogQHJldHVybiBQb2ludGVyIHRvIGNvbnRhaW5lciBh
dHRyaWJ1dGUuCi0gKi8KLXN0YXRpYyBpbmxpbmUgc3RydWN0IG5sYXR0ciAqbmxhX25lc3Rfc3Rh
cnQoc3RydWN0IG5sX21zZyAqbXNnLCBpbnQgYXR0cnR5cGUpCi17Ci0Jc3RydWN0IG5sYXR0ciAq
c3RhcnQgPSAoc3RydWN0IG5sYXR0ciAqKSBubG1zZ190YWlsKG1zZy0+bm1fbmxoKTsKLQotCWlm
IChubGFfcHV0KG1zZywgYXR0cnR5cGUsIDAsIE5VTEwpIDwgMCkKLQkJcmV0dXJuIE5VTEw7Ci0K
LQlyZXR1cm4gc3RhcnQ7Ci19Ci0KLS8qKgotICogRmluYWxpemUgbmVzdGluZyBvZiBhdHRyaWJ1
dGVzLgotICogQGFyZyBtc2cJCU5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgc3RhcnQJCUNvbnRh
aW5lciBhdHRyaWJ1dGUgYXMgcmV0dXJuZWQgZnJvbSBubGFfbmVzdF9zdGFydCgpLgotICoKLSAq
IENvcnJlY3RzIHRoZSBjb250YWluZXIgYXR0cmlidXRlIGhlYWRlciB0byBpbmNsdWRlIHRoZSBh
cHBlbmVkZWQgYXR0cmlidXRlcy4KLSAqCi0gKiBAcmV0dXJuIDAKLSAqLwotc3RhdGljIGlubGlu
ZSBpbnQgbmxhX25lc3RfZW5kKHN0cnVjdCBubF9tc2cgKm1zZywgc3RydWN0IG5sYXR0ciAqc3Rh
cnQpCi17Ci0Jc3RhcnQtPm5sYV9sZW4gPSAodW5zaWduZWQgY2hhciAqKSBubG1zZ190YWlsKG1z
Zy0+bm1fbmxoKSAtCi0JCQkJKHVuc2lnbmVkIGNoYXIgKikgc3RhcnQ7Ci0JcmV0dXJuIDA7Ci19
Ci0KLS8qKgotICogQ3JlYXRlIGF0dHJpYnV0ZSBpbmRleCBiYXNlZCBvbiBuZXN0ZWQgYXR0cmli
dXRlCi0gKiBAYXJnIHRiCQlJbmRleCBhcnJheSB0byBiZSBmaWxsZWQgKG1heHR5cGUrMSBlbGVt
ZW50cykuCi0gKiBAYXJnIG1heHR5cGUJCU1heGltdW0gYXR0cmlidXRlIHR5cGUgZXhwZWN0ZWQg
YW5kIGFjY2VwdGVkLgotICogQGFyZyBubGEJCU5lc3RlZCBBdHRyaWJ1dGUuCi0gKiBAYXJnIHBv
bGljeQkJQXR0cmlidXRlIHZhbGlkYXRpb24gcG9saWN5LgotICoKLSAqIEZlZWRzIHRoZSBzdHJl
YW0gb2YgYXR0cmlidXRlcyBuZXN0ZWQgaW50byB0aGUgc3BlY2lmaWVkIGF0dHJpYnV0ZQotICog
dG8gbmxhX3BhcnNlKCkuCi0gKgotICogQHNlZSBubGFfcGFyc2UKLSAqIEByZXR1cm4gMCBvbiBz
dWNjZXNzIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29kZS4KLSAqLwotc3RhdGljIGlubGluZSBpbnQg
bmxhX3BhcnNlX25lc3RlZChzdHJ1Y3QgbmxhdHRyICp0YltdLCBpbnQgbWF4dHlwZSwgc3RydWN0
IG5sYXR0ciAqbmxhLAotCQkgICAgIHN0cnVjdCBubGFfcG9saWN5ICpwb2xpY3kpCi17Ci0JcmV0
dXJuIG5sYV9wYXJzZSh0YiwgbWF4dHlwZSwgKHN0cnVjdCBubGF0dHIgKilubGFfZGF0YShubGEp
LCBubGFfbGVuKG5sYSksIHBvbGljeSk7Ci19Ci0KLS8qKgotICogQ29tcGFyZSBhdHRyaWJ1dGUg
cGF5bG9hZCB3aXRoIG1lbW9yeSBhcmVhLgotICogQGFyZyBubGEJCUF0dHJpYnV0ZS4KLSAqIEBh
cmcgZGF0YQkJTWVtb3J5IGFyZWEgdG8gY29tcGFyZSB0by4KLSAqIEBhcmcgc2l6ZQkJTnVtYmVy
IG9mIGJ5dGVzIHRvIGNvbXBhcmUuCi0gKgotICogQHNlZSBtZW1jbXAoMykKLSAqIEByZXR1cm4g
QW4gaW50ZWdlciBsZXNzIHRoYW4sIGVxdWFsIHRvLCBvciBncmVhdGVyIHRoYW4gemVyby4KLSAq
Lwotc3RhdGljIGlubGluZSBpbnQgbmxhX21lbWNtcChjb25zdCBzdHJ1Y3QgbmxhdHRyICpubGEs
IGNvbnN0IHZvaWQgKmRhdGEsIHNpemVfdCBzaXplKQotewotCWludCBkID0gbmxhX2xlbihubGEp
IC0gc2l6ZTsKLQotCWlmIChkID09IDApCi0JCWQgPSBtZW1jbXAobmxhX2RhdGEobmxhKSwgZGF0
YSwgc2l6ZSk7Ci0KLQlyZXR1cm4gZDsKLX0KLQotLyoqCi0gKiBDb21wYXJlIHN0cmluZyBhdHRy
aWJ1dGUgcGF5bG9hZCB3aXRoIHN0cmluZwotICogQGFyZyBubGEJCUF0dHJpYnV0ZSBvZiB0eXBl
IE5MQV9TVFJJTkcuCi0gKiBAYXJnIHN0cgkJTlVMIHRlcm1pbmF0ZWQgc3RyaW5nLgotICoKLSAq
IEBzZWUgc3RyY21wKDMpCi0gKiBAcmV0dXJuIEFuIGludGVnZXIgbGVzcyB0aGFuLCBlcXVhbCB0
bywgb3IgZ3JlYXRlciB0aGFuIHplcm8uCi0gKi8KLXN0YXRpYyBpbmxpbmUgaW50IG5sYV9zdHJj
bXAoY29uc3Qgc3RydWN0IG5sYXR0ciAqbmxhLCBjb25zdCBjaGFyICpzdHIpCi17Ci0JaW50IGxl
biA9IHN0cmxlbihzdHIpICsgMTsKLQlpbnQgZCA9IG5sYV9sZW4obmxhKSAtIGxlbjsKLQotCWlm
IChkID09IDApCi0JCWQgPSBtZW1jbXAobmxhX2RhdGEobmxhKSwgc3RyLCBsZW4pOwotCi0JcmV0
dXJuIGQ7Ci19Ci0KLS8qKgotICogQ29weSBzdHJpbmcgYXR0cmlidXRlIHBheWxvYWQgdG8gYSBi
dWZmZXIuCi0gKiBAYXJnIGRzdAkJUG9pbnRlciB0byBkZXN0aW5hdGlvbiBidWZmZXIuCi0gKiBA
YXJnIG5sYQkJQXR0cmlidXRlIG9mIHR5cGUgTkxBX1NUUklORy4KLSAqIEBhcmcgZHN0c2l6ZQkJ
U2l6ZSBvZiBkZXN0aW5hdGlvbiBidWZmZXIgaW4gYnl0ZXMuCi0gKgotICogQ29waWVzIGF0IG1v
c3QgZHN0c2l6ZSAtIDEgYnl0ZXMgdG8gdGhlIGRlc3RpbmF0aW9uIGJ1ZmZlci4KLSAqIFRoZSBy
ZXN1bHQgaXMgYWx3YXlzIGEgdmFsaWQgTlVMIHRlcm1pbmF0ZWQgc3RyaW5nLiBVbmxpa2UKLSAq
IHN0cmxjcHkgdGhlIGRlc3RpbmF0aW9uIGJ1ZmZlciBpcyBhbHdheXMgcGFkZGVkIG91dC4KLSAq
Ci0gKiBAcmV0dXJuIFRoZSBsZW5ndGggb2Ygc3RyaW5nIGF0dHJpYnV0ZSB3aXRob3V0IHRoZSB0
ZXJtaW5hdGluZyBOVUwuCi0gKi8KLXN0YXRpYyBpbmxpbmUgc2l6ZV90IG5sYV9zdHJsY3B5KGNo
YXIgKmRzdCwgY29uc3Qgc3RydWN0IG5sYXR0ciAqbmxhLCBzaXplX3QgZHN0c2l6ZSkKLXsKLQlz
aXplX3Qgc3JjbGVuID0gKHNpemVfdClubGFfbGVuKG5sYSk7Ci0JY2hhciAqc3JjID0gKGNoYXIq
KW5sYV9kYXRhKG5sYSk7Ci0KLQlpZiAoc3JjbGVuID4gMCAmJiBzcmNbc3JjbGVuIC0gMV0gPT0g
J1wwJykKLQkJc3JjbGVuLS07Ci0KLQlpZiAoZHN0c2l6ZSA+IDApIHsKLQkJc2l6ZV90IGxlbiA9
IChzcmNsZW4gPj0gZHN0c2l6ZSkgPyBkc3RzaXplIC0gMSA6IHNyY2xlbjsKLQotCQltZW1zZXQo
ZHN0LCAwLCBkc3RzaXplKTsKLQkJbWVtY3B5KGRzdCwgc3JjLCBsZW4pOwotCX0KLQotCXJldHVy
biBzcmNsZW47Ci19Ci0KLQotLyoqCi0gKiBAbmFtZSBBdHRyaWJ1dGUgQ29uc3RydWN0aW9uIChF
eGNlcHRpb24gQmFzZWQpCi0gKiBAewotICovCi0KLS8qKgotICogQGluZ3JvdXAgYXR0cgotICog
QWRkIHVuc3BlY2lmaWMgYXR0cmlidXRlIHRvIG5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgbXNn
CQlOZXRsaW5rIG1lc3NhZ2UuCi0gKiBAYXJnIGF0dHJ0eXBlCUF0dHJpYnV0ZSB0eXBlLgotICog
QGFyZyBhdHRybGVuCQlMZW5ndGggb2YgYXR0cmlidXRlIHBheWxvYWQuCi0gKiBAYXJnIGRhdGEJ
CUhlYWQgb2YgYXR0cmlidXRlIHBheWxvYWQuCi0gKi8KLSNkZWZpbmUgTkxBX1BVVChtc2csIGF0
dHJ0eXBlLCBhdHRybGVuLCBkYXRhKSBcCi0JZG8geyBcCi0JCWlmIChubGFfcHV0KG1zZywgYXR0
cnR5cGUsIGF0dHJsZW4sIGRhdGEpIDwgMCkgXAotCQkJZ290byBubGFfcHV0X2ZhaWx1cmU7IFwK
LQl9IHdoaWxlKDApCi0KLS8qKgotICogQGluZ3JvdXAgYXR0cgotICogQWRkIGF0b21pYyB0eXBl
IGF0dHJpYnV0ZSB0byBuZXRsaW5rIG1lc3NhZ2UuCi0gKiBAYXJnIG1zZwkJTmV0bGluayBtZXNz
YWdlLgotICogQGFyZyB0eXBlCQlBdG9taWMgdHlwZS4KLSAqIEBhcmcgYXR0cnR5cGUJQXR0cmli
dXRlIHR5cGUuCi0gKiBAYXJnIHZhbHVlCQlIZWFkIG9mIGF0dHJpYnV0ZSBwYXlsb2FkLgotICov
Ci0jZGVmaW5lIE5MQV9QVVRfVFlQRShtc2csIHR5cGUsIGF0dHJ0eXBlLCB2YWx1ZSkgXAotCWRv
IHsgXAotCQl0eXBlIF9fdG1wID0gdmFsdWU7IFwKLQkJTkxBX1BVVChtc2csIGF0dHJ0eXBlLCBz
aXplb2YodHlwZSksICZfX3RtcCk7IFwKLQl9IHdoaWxlKDApCi0KLS8qKgotICogQWRkIDggYml0
IGludGVnZXIgYXR0cmlidXRlIHRvIG5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgbXNnCQlOZXRs
aW5rIG1lc3NhZ2UuCi0gKiBAYXJnIGF0dHJ0eXBlCUF0dHJpYnV0ZSB0eXBlLgotICogQGFyZyB2
YWx1ZQkJTnVtZXJpYyB2YWx1ZS4KLSAqLwotI2RlZmluZSBOTEFfUFVUX1U4KG1zZywgYXR0cnR5
cGUsIHZhbHVlKSBcCi0JTkxBX1BVVF9UWVBFKG1zZywgdWludDhfdCwgYXR0cnR5cGUsIHZhbHVl
KQotCi0vKioKLSAqIEFkZCAxNiBiaXQgaW50ZWdlciBhdHRyaWJ1dGUgdG8gbmV0bGluayBtZXNz
YWdlLgotICogQGFyZyBtc2cJCU5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgYXR0cnR5cGUJQXR0
cmlidXRlIHR5cGUuCi0gKiBAYXJnIHZhbHVlCQlOdW1lcmljIHZhbHVlLgotICovCi0jZGVmaW5l
IE5MQV9QVVRfVTE2KG1zZywgYXR0cnR5cGUsIHZhbHVlKSBcCi0JTkxBX1BVVF9UWVBFKG1zZywg
dWludDE2X3QsIGF0dHJ0eXBlLCB2YWx1ZSkKLQotLyoqCi0gKiBBZGQgMzIgYml0IGludGVnZXIg
YXR0cmlidXRlIHRvIG5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgbXNnCQlOZXRsaW5rIG1lc3Nh
Z2UuCi0gKiBAYXJnIGF0dHJ0eXBlCUF0dHJpYnV0ZSB0eXBlLgotICogQGFyZyB2YWx1ZQkJTnVt
ZXJpYyB2YWx1ZS4KLSAqLwotI2RlZmluZSBOTEFfUFVUX1UzMihtc2csIGF0dHJ0eXBlLCB2YWx1
ZSkgXAotCU5MQV9QVVRfVFlQRShtc2csIHVpbnQzMl90LCBhdHRydHlwZSwgdmFsdWUpCi0KLS8q
KgotICogQWRkIDY0IGJpdCBpbnRlZ2VyIGF0dHJpYnV0ZSB0byBuZXRsaW5rIG1lc3NhZ2UuCi0g
KiBAYXJnIG1zZwkJTmV0bGluayBtZXNzYWdlLgotICogQGFyZyBhdHRydHlwZQlBdHRyaWJ1dGUg
dHlwZS4KLSAqIEBhcmcgdmFsdWUJCU51bWVyaWMgdmFsdWUuCi0gKi8KLSNkZWZpbmUgTkxBX1BV
VF9VNjQobXNnLCBhdHRydHlwZSwgdmFsdWUpIFwKLQlOTEFfUFVUX1RZUEUobXNnLCB1aW50NjRf
dCwgYXR0cnR5cGUsIHZhbHVlKQotCi0vKioKLSAqIEFkZCBzdHJpbmcgYXR0cmlidXRlIHRvIG5l
dGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgbXNnCQlOZXRsaW5rIG1lc3NhZ2UuCi0gKiBAYXJnIGF0
dHJ0eXBlCUF0dHJpYnV0ZSB0eXBlLgotICogQGFyZyB2YWx1ZQkJTlVMIHRlcm1pbmF0ZWQgY2hh
cmFjdGVyIHN0cmluZy4KLSAqLwotI2RlZmluZSBOTEFfUFVUX1NUUklORyhtc2csIGF0dHJ0eXBl
LCB2YWx1ZSkgXAotCU5MQV9QVVQobXNnLCBhdHRydHlwZSwgc3RybGVuKHZhbHVlKSArIDEsIHZh
bHVlKQotCi0vKioKLSAqIEFkZCBmbGFnIGF0dHJpYnV0ZSB0byBuZXRsaW5rIG1lc3NhZ2UuCi0g
KiBAYXJnIG1zZwkJTmV0bGluayBtZXNzYWdlLgotICogQGFyZyBhdHRydHlwZQlBdHRyaWJ1dGUg
dHlwZS4KLSAqLwotI2RlZmluZSBOTEFfUFVUX0ZMQUcobXNnLCBhdHRydHlwZSkgXAotCU5MQV9Q
VVQobXNnLCBhdHRydHlwZSwgMCwgTlVMTCkKLQotLyoqCi0gKiBBZGQgbXNlY3MgYXR0cmlidXRl
IHRvIG5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgbXNnCQlOZXRsaW5rIG1lc3NhZ2UuCi0gKiBA
YXJnIGF0dHJ0eXBlCUF0dHJpYnV0ZSB0eXBlLgotICogQGFyZyBtc2VjcwkJTnVtZXJpYyB2YWx1
ZSBpbiBtaWNybyBzZWNvbmRzLgotICovCi0jZGVmaW5lIE5MQV9QVVRfTVNFQ1MobXNnLCBhdHRy
dHlwZSwgbXNlY3MpIFwKLQlOTEFfUFVUX1U2NChtc2csIGF0dHJ0eXBlLCBtc2VjcykKLQotLyoq
Ci0gKiBBZGQgYWRkcmVzcyBhdHRyaWJ1dGUgdG8gbmV0bGluayBtZXNzYWdlLgotICogQGFyZyBt
c2cJCU5ldGxpbmsgbWVzc2FnZS4KLSAqIEBhcmcgYXR0cnR5cGUJQXR0cmlidXRlIHR5cGUuCi0g
KiBAYXJnIGFkZHIJCUFic3RyYWN0IGFkZHJlc3Mgb2JqZWN0LgotICovCi0jZGVmaW5lIE5MQV9Q
VVRfQUREUihtc2csIGF0dHJ0eXBlLCBhZGRyKSBcCi0JTkxBX1BVVChtc2csIGF0dHJ0eXBlLCBu
bF9hZGRyX2dldF9sZW4oYWRkciksIFwKLQkJbmxfYWRkcl9nZXRfYmluYXJ5X2FkZHIoYWRkcikp
Ci0KLS8qKiBAfSAqLwotCi0vKioKLSAqIEBuYW1lIEl0ZXJhdG9ycwotICogQHsKLSAqLwotCi0v
KioKLSAqIEBpbmdyb3VwIGF0dHIKLSAqIEl0ZXJhdGUgb3ZlciBhIHN0cmVhbSBvZiBhdHRyaWJ1
dGVzCi0gKiBAYXJnIHBvcwlsb29wIGNvdW50ZXIsIHNldCB0byBjdXJyZW50IGF0dHJpYnV0ZQot
ICogQGFyZyBoZWFkCWhlYWQgb2YgYXR0cmlidXRlIHN0cmVhbQotICogQGFyZyBsZW4JbGVuZ3Ro
IG9mIGF0dHJpYnV0ZSBzdHJlYW0KLSAqIEBhcmcgcmVtCWluaXRpYWxpemVkIHRvIGxlbiwgaG9s
ZHMgYnl0ZXMgY3VycmVudGx5IHJlbWFpbmluZyBpbiBzdHJlYW0KLSAqLwotI2RlZmluZSBubGFf
Zm9yX2VhY2hfYXR0cihwb3MsIGhlYWQsIGxlbiwgcmVtKSBcCi0JZm9yIChwb3MgPSBoZWFkLCBy
ZW0gPSBsZW47IFwKLQkgICAgIG5sYV9vayhwb3MsIHJlbSk7IFwKLQkgICAgIHBvcyA9IG5sYV9u
ZXh0KHBvcywgJihyZW0pKSkKLQotLyoqCi0gKiBAaW5ncm91cCBhdHRyCi0gKiBJdGVyYXRlIG92
ZXIgYSBzdHJlYW0gb2YgbmVzdGVkIGF0dHJpYnV0ZXMKLSAqIEBhcmcgcG9zCWxvb3AgY291bnRl
ciwgc2V0IHRvIGN1cnJlbnQgYXR0cmlidXRlCi0gKiBAYXJnIG5sYQlhdHRyaWJ1dGUgY29udGFp
bmluZyB0aGUgbmVzdGVkIGF0dHJpYnV0ZXMKLSAqIEBhcmcgcmVtCWluaXRpYWxpemVkIHRvIGxl
biwgaG9sZHMgYnl0ZXMgY3VycmVudGx5IHJlbWFpbmluZyBpbiBzdHJlYW0KLSAqLwotI2RlZmlu
ZSBubGFfZm9yX2VhY2hfbmVzdGVkKHBvcywgbmxhLCByZW0pIFwKLQlmb3IgKHBvcyA9IChzdHJ1
Y3QgbmxhdHRyICopbmxhX2RhdGEobmxhKSwgcmVtID0gbmxhX2xlbihubGEpOyBcCi0JICAgICBu
bGFfb2socG9zLCByZW0pOyBcCi0JICAgICBwb3MgPSBubGFfbmV4dChwb3MsICYocmVtKSkpCi0K
LS8qKiBAfSAqLwotCi0jaWZkZWYgX19jcGx1c3BsdXMKLX0KLSNlbmRpZgotCi0jZW5kaWYKZGlm
ZiAtLWdpdCBhL3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvY2Fj
aGUtYXBpLmggYi9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL2Nh
Y2hlLWFwaS5oCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAyMmZjNDQ5ZDFiOTEuLjAw
MDAwMDAwMDAwMAotLS0gYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRs
aW5rL2NhY2hlLWFwaS5oCisrKyAvZGV2L251bGwKQEAgLTEsMTk5ICswLDAgQEAKLS8qCi0gKiBu
ZXRsaW5rL2NhY2hlLWFwaS5oCQlDYWNoaW5nIEFQSQotICoKLSAqCVRoaXMgbGlicmFyeSBpcyBm
cmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKLSAqCW1vZGlmeSBp
dCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKLSAqCUxp
Y2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24gdmVyc2lv
biAyLjEKLSAqCW9mIHRoZSBMaWNlbnNlLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAwMy0yMDA2
IFRob21hcyBHcmFmIDx0Z3JhZkBzdXVnLmNoPgotICovCi0KLSNpZm5kZWYgTkVUTElOS19DQUNI
RV9BUElfSF8KLSNkZWZpbmUgTkVUTElOS19DQUNIRV9BUElfSF8KLQotI2luY2x1ZGUgPG5ldGxp
bmsvbmV0bGluay5oPgotCi0jaWZkZWYgX19jcGx1c3BsdXMKLWV4dGVybiAiQyIgewotI2VuZGlm
Ci0KLS8qKgotICogQGluZ3JvdXAgY2FjaGUKLSAqIEBkZWZncm91cCBjYWNoZV9hcGkgQ2FjaGUg
SW1wbGVtZW50YXRpb24KLSAqIEBicmllZgotICoKLSAqIEBwYXIgMSkgQ2FjaGUgRGVmaW5pdGlv
bgotICogQGNvZGUKLSAqIHN0cnVjdCBubF9jYWNoZV9vcHMgbXlfY2FjaGVfb3BzID0gewotICog
CS5jb19uYW1lCQk9ICJyb3V0ZS9saW5rIiwKLSAqIAkuY29fcHJvdG9jb2wJCT0gTkVUTElOS19S
T1VURSwKLSAqIAkuY29faGRyc2l6ZQkJPSBzaXplb2Yoc3RydWN0IGlmaW5mb21zZyksCi0gKiAJ
LmNvX29ial9vcHMJCT0gJm15X29ial9vcHMsCi0gKiB9OwotICogQGVuZGNvZGUKLSAqCi0gKiBA
cGFyIDIpIAotICogQGNvZGUKLSAqIC8vIFRoZSBzaW1wbGVzdCB3YXkgdG8gZmlsbCBhIGNhY2hl
IGlzIGJ5IHByb3ZpZGluZyBhIHJlcXVlc3QtdXBkYXRlCi0gKiAvLyBmdW5jdGlvbiB3aGljaCBt
dXN0IHRyaWdnZXIgYSBjb21wbGV0ZSBkdW1wIG9uIHRoZSBrZXJuZWwtc2lkZSBvZgotICogLy8g
d2hhdGV2ZXIgdGhlIGNhY2hlIGNvdmVycy4KLSAqIHN0YXRpYyBpbnQgbXlfcmVxdWVzdF91cGRh
dGUoc3RydWN0IG5sX2NhY2hlICpjYWNoZSwKLSAqIAkJCQlzdHJ1Y3Qgbmxfc29jayAqc29ja2V0
KQotICogewotICogCS8vIEluIHRoaXMgZXhhbXBsZSwgd2UgcmVxdWVzdCBhIGZ1bGwgZHVtcCBv
ZiB0aGUgaW50ZXJmYWNlIHRhYmxlCi0gKiAJcmV0dXJuIG5sX3J0Z2VuX3JlcXVlc3Qoc29ja2V0
LCBSVE1fR0VUTElOSywgQUZfVU5TUEVDLCBOTE1fRl9EVU1QKTsKLSAqIH0KLSAqCi0gKiAvLyBU
aGUgcmVzdWx0aW5nIG5ldGxpbmsgbWVzc2FnZXMgc2VudCBiYWNrIHdpbGwgYmUgZmVkIGludG8g
YSBtZXNzYWdlCi0gKiAvLyBwYXJzZXIgb25lIGF0IGEgdGltZS4gVGhlIG1lc3NhZ2UgcGFyc2Vy
IGhhcyB0byBleHRyYWN0IGFsbCByZWxldmFudAotICogLy8gaW5mb3JtYXRpb24gZnJvbSB0aGUg
bWVzc2FnZSBhbmQgY3JlYXRlIGFuIG9iamVjdCByZWZsZWN0aW5nIHRoZQotICogLy8gY29udGVu
dHMgb2YgdGhlIG1lc3NhZ2UgYW5kIHBhc3MgaXQgb24gdG8gdGhlIHBhcnNlciBjYWxsYmFjayBm
dW5jdGlvbgotICogLy8gcHJvdmlkZSB3aGljaCB3aWxsIGFkZCB0aGUgb2JqZWN0IHRvIHRoZSBj
YWNoZS4KLSAqIHN0YXRpYyBpbnQgbXlfbXNnX3BhcnNlcihzdHJ1Y3QgbmxfY2FjaGVfb3BzICpv
cHMsIHN0cnVjdCBzb2NrYWRkcl9ubCAqd2hvLAotICogCQkJICAgIHN0cnVjdCBubG1zZ2hkciAq
bmxoLCBzdHJ1Y3QgbmxfcGFyc2VyX3BhcmFtICpwcCkKLSAqIHsKLSAqIAlzdHJ1Y3QgbXlfb2Jq
ICpvYmo7Ci0gKgotICogCW9iaiA9IG15X29ial9hbGxvYygpOwotICogCW9iai0+Y2VfbXNndHlw
ZSA9IG5saC0+bmxtc2dfdHlwZTsKLSAqCi0gKiAJLy8gUGFyc2UgdGhlIG5ldGxpbmsgbWVzc2Fn
ZSBhbmQgY29udGludWUgY3JlYXRpbmcgdGhlIG9iamVjdC4KLSAqCi0gKiAJZXJyID0gcHAtPnBw
X2NiKChzdHJ1Y3Qgbmxfb2JqZWN0ICopIG9iaiwgcHApOwotICogCWlmIChlcnIgPCAwKQotICog
CQlnb3RvIGVycm91dDsKLSAqIH0KLSAqCi0gKiBzdHJ1Y3QgbmxfY2FjaGVfb3BzIG15X2NhY2hl
X29wcyA9IHsKLSAqIAkuLi4KLSAqIAkuY29fcmVxdWVzdF91cGRhdGUJPSBteV9yZXF1ZXN0X3Vw
ZGF0ZSwKLSAqIAkuY29fbXNnX3BhcnNlcgkJPSBteV9tc2dfcGFyc2VyLAotICogfTsKLSAqIEBl
bmRjb2RlCi0gKgotICogQHBhciAzKSBOb3RpZmljYXRpb24gYmFzZWQgVXBkYXRlcwotICogQGNv
ZGUKLSAqIC8vIENhY2hlcyBjYW4gYmUga2VwdCB1cC10by1kYXRlIGJhc2VkIG9uIG5vdGlmaWNh
dGlvbnMgaWYgdGhlIGtlcm5lbAotICogLy8gc2VuZHMgb3V0IG5vdGlmaWNhdGlvbnMgd2hlbmV2
ZXIgYW4gb2JqZWN0IGlzIGFkZGVkL3JlbW92ZWQvY2hhbmdlZC4KLSAqIC8vCi0gKiAvLyBJdCBp
cyB0cml2aWFsIHRvIHN1cHBvcnQgdGhpcywgZmlyc3QgYSBsaXN0IG9mIGdyb3VwcyBuZWVkcyB0
byBiZQotICogLy8gZGVmaW5lZCB3aGljaCBhcmUgcmVxdWlyZWQgdG8gam9pbiBpbiBvcmRlciB0
byByZWNlaXZlIGFsbCBuZWNlc3NhcnkKLSAqIC8vIG5vdGlmaWNhdGlvbnMuIFRoZSBncm91cHMg
YXJlIHNlcGFyYXRlZCBieSBhZGRyZXNzIGZhbWlseSB0byBzdXBwb3J0Ci0gKiAvLyB0aGUgY29t
bW9uIHNpdHVhdGlvbiB3aGVyZSBhIHNlcGFyYXRlIGdyb3VwIGlzIHVzZWQgZm9yIGVhY2ggYWRk
cmVzcwotICogLy8gZmFtaWx5LiBJZiB0aGVyZSBpcyBvbmx5IG9uZSBncm91cCwgc2ltcGx5IHNw
ZWNpZnkgQUZfVU5TUEVDLgotICogc3RhdGljIHN0cnVjdCBubF9hZl9ncm91cCBhZGRyX2dyb3Vw
c1tdID0gewotICogCXsgQUZfSU5FVCwJUlROTEdSUF9JUFY0X0lGQUREUiB9LAotICogCXsgQUZf
SU5FVDYsCVJUTkxHUlBfSVBWNl9JRkFERFIgfSwKLSAqIAl7IEVORF9PRl9HUk9VUF9MSVNUIH0s
Ci0gKiB9OwotICoKLSAqIC8vIEluIG9yZGVyIGZvciB0aGUgY2FjaGluZyBzeXN0ZW0gdG8ga25v
dyB0aGUgbWVhbmluZyBvZiBlYWNoIG1lc3NhZ2UKLSAqIC8vIHR5cGUgaXQgcmVxdWlyZXMgYSB0
YWJsZSB3aGljaCBtYXBzIGVhY2ggc3VwcG9ydGVkIG1lc3NhZ2UgdHlwZSB0bwotICogLy8gYSBj
YWNoZSBhY3Rpb24sIGUuZy4gUlRNX05FV0FERFIgbWVhbnMgYWRkcmVzcyBoYXMgYmVlbiBhZGRl
ZCBvcgotICogLy8gdXBkYXRlZCwgUlRNX0RFTEFERFIgbWVhbnMgYWRkcmVzcyBoYXMgYmVlbiBy
ZW1vdmVkLgotICogc3RhdGljIHN0cnVjdCBubF9jYWNoZV9vcHMgcnRubF9hZGRyX29wcyA9IHsK
LSAqIAkuLi4KLSAqIAkuY29fbXNndHlwZXMJCT0gewotICogCQkJCQl7IFJUTV9ORVdBRERSLCBO
TF9BQ1RfTkVXLCAibmV3IiB9LAotICogCQkJCQl7IFJUTV9ERUxBRERSLCBOTF9BQ1RfREVMLCAi
ZGVsIiB9LAotICogCQkJCQl7IFJUTV9HRVRBRERSLCBOTF9BQ1RfR0VULCAiZ2V0IiB9LAotICog
CQkJCQlFTkRfT0ZfTVNHVFlQRVNfTElTVCwKLSAqIAkJCQl9LAotICogCS5jb19ncm91cHMJCT0g
YWRkcl9ncm91cHMsCi0gKiB9OwotICoKLSAqIC8vIEl0IGlzIG5vdyBwb3NzaWJsZSB0byBrZWVw
IHRoZSBjYWNoZSB1cC10by1kYXRlIHVzaW5nIHRoZSBjYWNoZSBtYW5hZ2VyLgotICogQGVuZGNv
ZGUKLSAqIEB7Ci0gKi8KLQotZW51bSB7Ci0JTkxfQUNUX1VOU1BFQywKLQlOTF9BQ1RfTkVXLAot
CU5MX0FDVF9ERUwsCi0JTkxfQUNUX0dFVCwKLQlOTF9BQ1RfU0VULAotCU5MX0FDVF9DSEFOR0Us
Ci0JX19OTF9BQ1RfTUFYLAotfTsKLQotI2RlZmluZSBOTF9BQ1RfTUFYIChfX05MX0FDVF9NQVgg
LSAxKQotCi0jZGVmaW5lIEVORF9PRl9NU0dUWVBFU19MSVNUCXsgLTEsIC0xLCBOVUxMIH0KLQot
LyoqCi0gKiBNZXNzYWdlIHR5cGUgdG8gY2FjaGUgYWN0aW9uIGFzc29jaWF0aW9uCi0gKi8KLXN0
cnVjdCBubF9tc2d0eXBlCi17Ci0JLyoqIE5ldGxpbmsgbWVzc2FnZSB0eXBlICovCi0JaW50CQkJ
bXRfaWQ7Ci0KLQkvKiogQ2FjaGUgYWN0aW9uIHRvIHRha2UgKi8KLQlpbnQJCQltdF9hY3Q7Ci0K
LQkvKiogTmFtZSBvZiBvcGVyYXRpb24gZm9yIGh1bWFuLXJlYWRhYmxlIHByaW50aW5nICovCi0J
Y2hhciAqCQkJbXRfbmFtZTsKLX07Ci0KLS8qKgotICogQWRkcmVzcyBmYW1pbHkgdG8gbmV0bGlu
ayBncm91cCBhc3NvY2lhdGlvbgotICovCi1zdHJ1Y3QgbmxfYWZfZ3JvdXAKLXsKLQkvKiogQWRk
cmVzcyBmYW1pbHkgKi8KLQlpbnQJCQlhZ19mYW1pbHk7Ci0KLQkvKiogTmV0bGluayBncm91cCBp
ZGVudGlmaWVyICovCi0JaW50CQkJYWdfZ3JvdXA7Ci19OwotCi0jZGVmaW5lIEVORF9PRl9HUk9V
UF9MSVNUIEFGX1VOU1BFQywgMAotCi1zdHJ1Y3QgbmxfcGFyc2VyX3BhcmFtCi17Ci0JaW50ICAg
ICAgICAgICAgICgqcHBfY2IpKHN0cnVjdCBubF9vYmplY3QgKiwgc3RydWN0IG5sX3BhcnNlcl9w
YXJhbSAqKTsKLQl2b2lkICogICAgICAgICAgICBwcF9hcmc7Ci19OwotCi0vKioKLSAqIENhY2hl
IE9wZXJhdGlvbnMKLSAqLwotc3RydWN0IG5sX2NhY2hlX29wcwotewotCWNoYXIgICoJCQljb19u
YW1lOwotCi0JaW50CQkJY29faGRyc2l6ZTsKLQlpbnQJCQljb19wcm90b2NvbDsKLQlzdHJ1Y3Qg
bmxfYWZfZ3JvdXAgKgljb19ncm91cHM7Ci0JCi0JLyoqCi0JICogQ2FsbGVkIHdoZW5ldmVyIGFu
IHVwZGF0ZSBvZiB0aGUgY2FjaGUgaXMgcmVxdWlyZWQuIE11c3Qgc2VuZAotCSAqIGEgcmVxdWVz
dCBtZXNzYWdlIHRvIHRoZSBrZXJuZWwgcmVxdWVzdGluZyBhIGNvbXBsZXRlIGR1bXAuCi0JICov
Ci0JaW50ICAgKCpjb19yZXF1ZXN0X3VwZGF0ZSkoc3RydWN0IG5sX2NhY2hlICosIHN0cnVjdCBu
bF9zb2NrICopOwotCi0JLyoqCi0JICogQ2FsbGVkIHdoZW5ldmVyIGEgbWVzc2FnZSB3YXMgcmVj
ZWl2ZWQgdGhhdCBuZWVkcyB0byBiZSBwYXJzZWQuCi0JICogTXVzdCBwYXJzZSB0aGUgbWVzc2Fn
ZSBhbmQgY2FsbCB0aGUgcGFzZXIgY2FsbGJhY2sgZnVuY3Rpb24KLQkgKiAobmxfcGFyc2VyX3Bh
cmFtKSBwcm92aWRlZCB2aWEgdGhlIGFyZ3VtZW50LgotCSAqLwotCWludCAgICgqY29fbXNnX3Bh
cnNlcikoc3RydWN0IG5sX2NhY2hlX29wcyAqLCBzdHJ1Y3Qgc29ja2FkZHJfbmwgKiwKLQkJCSAg
ICAgICBzdHJ1Y3Qgbmxtc2doZHIgKiwgc3RydWN0IG5sX3BhcnNlcl9wYXJhbSAqKTsKLQotCXN0
cnVjdCBubF9vYmplY3Rfb3BzICoJY29fb2JqX29wczsKLQotCXN0cnVjdCBubF9jYWNoZV9vcHMg
KmNvX25leHQ7Ci0Jc3RydWN0IG5sX2NhY2hlICpjb19tYWpvcl9jYWNoZTsKLQlzdHJ1Y3QgZ2Vu
bF9vcHMgKgljb19nZW5sOwotCXN0cnVjdCBubF9tc2d0eXBlCWNvX21zZ3R5cGVzW107Ci19Owot
Ci0vKiogQH0gKi8KLQotI2lmZGVmIF9fY3BsdXNwbHVzCi19Ci0jZW5kaWYKLQotI2VuZGlmCmRp
ZmYgLS1naXQgYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL2Nh
Y2hlLmggYi9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL2NhY2hl
LmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDA5NzE5ZjNhNzQwZS4uMDAwMDAwMDAw
MDAwCi0tLSBhL3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvY2Fj
aGUuaAorKysgL2Rldi9udWxsCkBAIC0xLDEyOCArMCwwIEBACi0vKgotICogbmV0bGluay9jYWNo
ZS5oCQlDYWNoaW5nIE1vZHVsZQotICoKLSAqCVRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJl
OyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKLSAqCW1vZGlmeSBpdCB1bmRlciB0aGUg
dGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKLSAqCUxpY2Vuc2UgYXMgcHVi
bGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24gdmVyc2lvbiAyLjEKLSAqCW9m
IHRoZSBMaWNlbnNlLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAwMy0yMDA4IFRob21hcyBHcmFm
IDx0Z3JhZkBzdXVnLmNoPgotICovCi0KLSNpZm5kZWYgTkVUTElOS19DQUNIRV9IXwotI2RlZmlu
ZSBORVRMSU5LX0NBQ0hFX0hfCi0KLSNpbmNsdWRlIDxuZXRsaW5rL25ldGxpbmsuaD4KLSNpbmNs
dWRlIDxuZXRsaW5rL21zZy5oPgotI2luY2x1ZGUgPG5ldGxpbmsvdXRpbHMuaD4KLSNpbmNsdWRl
IDxuZXRsaW5rL29iamVjdC5oPgotI2luY2x1ZGUgPG5ldGxpbmsvY2FjaGUtYXBpLmg+Ci0KLSNp
ZmRlZiBfX2NwbHVzcGx1cwotZXh0ZXJuICJDIiB7Ci0jZW5kaWYKLQotc3RydWN0IG5sX2NhY2hl
OwotCi10eXBlZGVmIHZvaWQgKCpjaGFuZ2VfZnVuY190KShzdHJ1Y3QgbmxfY2FjaGUgKiwgc3Ry
dWN0IG5sX29iamVjdCAqLCBpbnQpOwotCi0vKiBBY2Nlc3MgRnVuY3Rpb25zICovCi1leHRlcm4g
aW50CQkJbmxfY2FjaGVfbml0ZW1zKHN0cnVjdCBubF9jYWNoZSAqKTsKLWV4dGVybiBpbnQJCQlu
bF9jYWNoZV9uaXRlbXNfZmlsdGVyKHN0cnVjdCBubF9jYWNoZSAqLAotCQkJCQkJICAgICAgIHN0
cnVjdCBubF9vYmplY3QgKik7Ci1leHRlcm4gc3RydWN0IG5sX2NhY2hlX29wcyAqCW5sX2NhY2hl
X2dldF9vcHMoc3RydWN0IG5sX2NhY2hlICopOwotZXh0ZXJuIHN0cnVjdCBubF9vYmplY3QgKglu
bF9jYWNoZV9nZXRfZmlyc3Qoc3RydWN0IG5sX2NhY2hlICopOwotZXh0ZXJuIHN0cnVjdCBubF9v
YmplY3QgKglubF9jYWNoZV9nZXRfbGFzdChzdHJ1Y3QgbmxfY2FjaGUgKik7Ci1leHRlcm4gc3Ry
dWN0IG5sX29iamVjdCAqCW5sX2NhY2hlX2dldF9uZXh0KHN0cnVjdCBubF9vYmplY3QgKik7Ci1l
eHRlcm4gc3RydWN0IG5sX29iamVjdCAqCW5sX2NhY2hlX2dldF9wcmV2KHN0cnVjdCBubF9vYmpl
Y3QgKik7Ci0KLWV4dGVybiBzdHJ1Y3QgbmxfY2FjaGUgKglubF9jYWNoZV9hbGxvYyhzdHJ1Y3Qg
bmxfY2FjaGVfb3BzICopOwotZXh0ZXJuIGludAkJCW5sX2NhY2hlX2FsbG9jX2FuZF9maWxsKHN0
cnVjdCBubF9jYWNoZV9vcHMgKiwKLQkJCQkJCQlzdHJ1Y3Qgbmxfc29jayAqLAotCQkJCQkJCXN0
cnVjdCBubF9jYWNoZSAqKik7Ci1leHRlcm4gaW50CQkJbmxfY2FjaGVfYWxsb2NfbmFtZShjb25z
dCBjaGFyICosCi0JCQkJCQkgICAgc3RydWN0IG5sX2NhY2hlICoqKTsKLWV4dGVybiBzdHJ1Y3Qg
bmxfY2FjaGUgKglubF9jYWNoZV9zdWJzZXQoc3RydWN0IG5sX2NhY2hlICosCi0JCQkJCQlzdHJ1
Y3Qgbmxfb2JqZWN0ICopOwotZXh0ZXJuIHZvaWQJCQlubF9jYWNoZV9jbGVhcihzdHJ1Y3Qgbmxf
Y2FjaGUgKik7Ci1leHRlcm4gdm9pZAkJCW5sX2NhY2hlX2ZyZWUoc3RydWN0IG5sX2NhY2hlICop
OwotCi0vKiBDYWNoZSBtb2RpZmljYXRpb24gKi8KLWV4dGVybiBpbnQJCQlubF9jYWNoZV9hZGQo
c3RydWN0IG5sX2NhY2hlICosCi0JCQkJCSAgICAgc3RydWN0IG5sX29iamVjdCAqKTsKLWV4dGVy
biBpbnQJCQlubF9jYWNoZV9wYXJzZV9hbmRfYWRkKHN0cnVjdCBubF9jYWNoZSAqLAotCQkJCQkJ
ICAgICAgIHN0cnVjdCBubF9tc2cgKik7Ci1leHRlcm4gdm9pZAkJCW5sX2NhY2hlX3JlbW92ZShz
dHJ1Y3Qgbmxfb2JqZWN0ICopOwotZXh0ZXJuIGludAkJCW5sX2NhY2hlX3JlZmlsbChzdHJ1Y3Qg
bmxfc29jayAqLAotCQkJCQkJc3RydWN0IG5sX2NhY2hlICopOwotZXh0ZXJuIGludAkJCW5sX2Nh
Y2hlX3BpY2t1cChzdHJ1Y3Qgbmxfc29jayAqLAotCQkJCQkJc3RydWN0IG5sX2NhY2hlICopOwot
ZXh0ZXJuIGludAkJCW5sX2NhY2hlX3Jlc3luYyhzdHJ1Y3Qgbmxfc29jayAqLAotCQkJCQkJc3Ry
dWN0IG5sX2NhY2hlICosCi0JCQkJCQljaGFuZ2VfZnVuY190KTsKLWV4dGVybiBpbnQJCQlubF9j
YWNoZV9pbmNsdWRlKHN0cnVjdCBubF9jYWNoZSAqLAotCQkJCQkJIHN0cnVjdCBubF9vYmplY3Qg
KiwKLQkJCQkJCSBjaGFuZ2VfZnVuY190KTsKLQotLyogR2VuZXJhbCAqLwotZXh0ZXJuIGludAkJ
CW5sX2NhY2hlX2lzX2VtcHR5KHN0cnVjdCBubF9jYWNoZSAqKTsKLWV4dGVybiB2b2lkCQkJbmxf
Y2FjaGVfbWFya19hbGwoc3RydWN0IG5sX2NhY2hlICopOwotCi0vKiBEdW1waW5nICovCi1leHRl
cm4gdm9pZAkJCW5sX2NhY2hlX2R1bXAoc3RydWN0IG5sX2NhY2hlICosCi0JCQkJCSAgICAgIHN0
cnVjdCBubF9kdW1wX3BhcmFtcyAqKTsKLWV4dGVybiB2b2lkCQkJbmxfY2FjaGVfZHVtcF9maWx0
ZXIoc3RydWN0IG5sX2NhY2hlICosCi0JCQkJCQkgICAgIHN0cnVjdCBubF9kdW1wX3BhcmFtcyAq
LAotCQkJCQkJICAgICBzdHJ1Y3Qgbmxfb2JqZWN0ICopOwotCi0vKiBJdGVyYXRvcnMgKi8KLSNp
ZmRlZiBkaXNhYmxlZAotZXh0ZXJuIHZvaWQJCQlubF9jYWNoZV9mb3JlYWNoKHN0cnVjdCBubF9j
YWNoZSAqLAotCQkJCQkJIHZvaWQgKCpjYikoc3RydWN0IG5sX29iamVjdCAqLAotCQkJCQkJCSAg
ICB2b2lkICopLAotCQkJCQkJIHZvaWQgKmFyZyk7Ci1leHRlcm4gdm9pZAkJCW5sX2NhY2hlX2Zv
cmVhY2hfZmlsdGVyKHN0cnVjdCBubF9jYWNoZSAqLAotCQkJCQkJCXN0cnVjdCBubF9vYmplY3Qg
KiwKLQkJCQkJCQl2b2lkICgqY2IpKHN0cnVjdAotCQkJCQkJCQkgICBubF9vYmplY3QgKiwKLQkJ
CQkJCQkJICAgdm9pZCAqKSwKLQkJCQkJCQl2b2lkICphcmcpOwotI2VuZGlmCi0KLS8qIC0tLSBj
YWNoZSBtYW5hZ2VtZW50IC0tLSAqLwotCi0vKiBDYWNoZSB0eXBlIG1hbmFnZW1lbnQgKi8KLWV4
dGVybiBzdHJ1Y3QgbmxfY2FjaGVfb3BzICoJbmxfY2FjaGVfb3BzX2xvb2t1cChjb25zdCBjaGFy
ICopOwotZXh0ZXJuIHN0cnVjdCBubF9jYWNoZV9vcHMgKglubF9jYWNoZV9vcHNfYXNzb2NpYXRl
KGludCwgaW50KTsKLWV4dGVybiBzdHJ1Y3QgbmxfbXNndHlwZSAqCW5sX21zZ3R5cGVfbG9va3Vw
KHN0cnVjdCBubF9jYWNoZV9vcHMgKiwgaW50KTsKLWV4dGVybiB2b2lkCQkJbmxfY2FjaGVfb3Bz
X2ZvcmVhY2godm9pZCAoKmNiKShzdHJ1Y3QgbmxfY2FjaGVfb3BzICosIHZvaWQgKiksIHZvaWQg
Kik7Ci1leHRlcm4gaW50CQkJbmxfY2FjaGVfbW5ndF9yZWdpc3RlcihzdHJ1Y3QgbmxfY2FjaGVf
b3BzICopOwotZXh0ZXJuIGludAkJCW5sX2NhY2hlX21uZ3RfdW5yZWdpc3RlcihzdHJ1Y3Qgbmxf
Y2FjaGVfb3BzICopOwotCi0vKiBHbG9iYWwgY2FjaGUgcHJvdmlzaW9uaW5nL3JlcXVpcmluZyAq
LwotZXh0ZXJuIHZvaWQJCQlubF9jYWNoZV9tbmd0X3Byb3ZpZGUoc3RydWN0IG5sX2NhY2hlICop
OwotZXh0ZXJuIHZvaWQJCQlubF9jYWNoZV9tbmd0X3VucHJvdmlkZShzdHJ1Y3QgbmxfY2FjaGUg
Kik7Ci1leHRlcm4gc3RydWN0IG5sX2NhY2hlICoJbmxfY2FjaGVfbW5ndF9yZXF1aXJlKGNvbnN0
IGNoYXIgKik7Ci0KLXN0cnVjdCBubF9jYWNoZV9tbmdyOwotCi0jZGVmaW5lIE5MX0FVVE9fUFJP
VklERQkJMQotCi1leHRlcm4gaW50CQkJbmxfY2FjaGVfbW5ncl9hbGxvYyhzdHJ1Y3Qgbmxfc29j
ayAqLAotCQkJCQkJICAgIGludCwgaW50LAotCQkJCQkJICAgIHN0cnVjdCBubF9jYWNoZV9tbmdy
ICoqKTsKLWV4dGVybiBpbnQJCQlubF9jYWNoZV9tbmdyX2FkZChzdHJ1Y3QgbmxfY2FjaGVfbW5n
ciAqLAotCQkJCQkJICBjb25zdCBjaGFyICosCi0JCQkJCQkgIGNoYW5nZV9mdW5jX3QsCi0JCQkJ
CQkgIHN0cnVjdCBubF9jYWNoZSAqKik7Ci1leHRlcm4gaW50CQkJbmxfY2FjaGVfbW5ncl9nZXRf
ZmQoc3RydWN0IG5sX2NhY2hlX21uZ3IgKik7Ci1leHRlcm4gaW50CQkJbmxfY2FjaGVfbW5ncl9w
b2xsKHN0cnVjdCBubF9jYWNoZV9tbmdyICosCi0JCQkJCQkgICBpbnQpOwotZXh0ZXJuIGludAkJ
CW5sX2NhY2hlX21uZ3JfZGF0YV9yZWFkeShzdHJ1Y3QgbmxfY2FjaGVfbW5nciAqKTsKLWV4dGVy
biB2b2lkCQkJbmxfY2FjaGVfbW5ncl9mcmVlKHN0cnVjdCBubF9jYWNoZV9tbmdyICopOwotCi0j
aWZkZWYgX19jcGx1c3BsdXMKLX0KLSNlbmRpZgotCi0jZW5kaWYKZGlmZiAtLWdpdCBhL3BhY2th
Z2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvZGF0YS5oIGIvcGFja2FnZS9s
aWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay9kYXRhLmgKZGVsZXRlZCBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDA3MTE1OWVlNWIzMC4uMDAwMDAwMDAwMDAwCi0tLSBhL3BhY2thZ2Uv
bGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvZGF0YS5oCisrKyAvZGV2L251bGwK
QEAgLTEsNDEgKzAsMCBAQAotLyoKLSAqIG5ldGxpbmsvZGF0YS5oCUFic3RyYWN0IERhdGEKLSAq
Ci0gKglUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUg
aXQgYW5kL29yCi0gKgltb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2Vy
IEdlbmVyYWwgUHVibGljCi0gKglMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0
d2FyZSBGb3VuZGF0aW9uIHZlcnNpb24gMi4xCi0gKglvZiB0aGUgTGljZW5zZS4KLSAqCi0gKiBD
b3B5cmlnaHQgKGMpIDIwMDMtMjAwOCBUaG9tYXMgR3JhZiA8dGdyYWZAc3V1Zy5jaD4KLSAqLwot
Ci0jaWZuZGVmIE5FVExJTktfREFUQV9IXwotI2RlZmluZSBORVRMSU5LX0RBVEFfSF8KLQotI2lu
Y2x1ZGUgPG5ldGxpbmsvbmV0bGluay5oPgotCi0jaWZkZWYgX19jcGx1c3BsdXMKLWV4dGVybiAi
QyIgewotI2VuZGlmCi0KLXN0cnVjdCBubF9kYXRhOwotCi0vKiBHZW5lcmFsICovCi1leHRlcm4g
c3RydWN0IG5sX2RhdGEgKglubF9kYXRhX2FsbG9jKHZvaWQgKiwgc2l6ZV90KTsKLWV4dGVybiBz
dHJ1Y3QgbmxfZGF0YSAqIG5sX2RhdGFfYWxsb2NfYXR0cihzdHJ1Y3QgbmxhdHRyICopOwotZXh0
ZXJuIHN0cnVjdCBubF9kYXRhICoJbmxfZGF0YV9jbG9uZShzdHJ1Y3QgbmxfZGF0YSAqKTsKLWV4
dGVybiBpbnQJCW5sX2RhdGFfYXBwZW5kKHN0cnVjdCBubF9kYXRhICosIHZvaWQgKiwgc2l6ZV90
KTsKLWV4dGVybiB2b2lkCQlubF9kYXRhX2ZyZWUoc3RydWN0IG5sX2RhdGEgKik7Ci0KLS8qIEFj
Y2VzcyBGdW5jdGlvbnMgKi8KLWV4dGVybiB2b2lkICoJCW5sX2RhdGFfZ2V0KHN0cnVjdCBubF9k
YXRhICopOwotZXh0ZXJuIHNpemVfdAkJbmxfZGF0YV9nZXRfc2l6ZShzdHJ1Y3QgbmxfZGF0YSAq
KTsKLQotLyogTWlzYyAqLwotZXh0ZXJuIGludAkJbmxfZGF0YV9jbXAoc3RydWN0IG5sX2RhdGEg
Kiwgc3RydWN0IG5sX2RhdGEgKik7Ci0KLSNpZmRlZiBfX2NwbHVzcGx1cwotfQotI2VuZGlmCi0K
LSNlbmRpZgpkaWZmIC0tZ2l0IGEvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUv
bmV0bGluay9lcnJuby5oIGIvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0
bGluay9lcnJuby5oCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCBmOGI1MTMwYzIyZTEu
LjAwMDAwMDAwMDAwMAotLS0gYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9u
ZXRsaW5rL2Vycm5vLmgKKysrIC9kZXYvbnVsbApAQCAtMSw2NCArMCwwIEBACi0vKgotICogbmV0
bGluay9lcnJuby5oCQlFcnJvciBOdW1iZXJzCi0gKgotICoJVGhpcyBsaWJyYXJ5IGlzIGZyZWUg
c29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgotICoJbW9kaWZ5IGl0IHVu
ZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwotICoJTGljZW5z
ZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiB2ZXJzaW9uIDIu
MQotICoJb2YgdGhlIExpY2Vuc2UuCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDA4IFRob21hcyBH
cmFmIDx0Z3JhZkBzdXVnLmNoPgotICovCi0KLSNpZm5kZWYgTkVUTElOS19FUlJOT19IXwotI2Rl
ZmluZSBORVRMSU5LX0VSUk5PX0hfCi0KLSNpZmRlZiBfX2NwbHVzcGx1cwotZXh0ZXJuICJDIiB7
Ci0jZW5kaWYKLQotI2RlZmluZSBOTEVfU1VDQ0VTUwkJMAotI2RlZmluZSBOTEVfRkFJTFVSRQkJ
MQotI2RlZmluZSBOTEVfSU5UUgkJMgotI2RlZmluZSBOTEVfQkFEX1NPQ0sJCTMKLSNkZWZpbmUg
TkxFX0FHQUlOCQk0Ci0jZGVmaW5lIE5MRV9OT01FTQkJNQotI2RlZmluZSBOTEVfRVhJU1QJCTYK
LSNkZWZpbmUgTkxFX0lOVkFMCQk3Ci0jZGVmaW5lIE5MRV9SQU5HRQkJOAotI2RlZmluZSBOTEVf
TVNHU0laRQkJOQotI2RlZmluZSBOTEVfT1BOT1RTVVBQCQkxMAotI2RlZmluZSBOTEVfQUZfTk9T
VVBQT1JUCTExCi0jZGVmaW5lIE5MRV9PQkpfTk9URk9VTkQJMTIKLSNkZWZpbmUgTkxFX05PQVRU
UgkJMTMKLSNkZWZpbmUgTkxFX01JU1NJTkdfQVRUUgkxNAotI2RlZmluZSBOTEVfQUZfTUlTTUFU
Q0gJCTE1Ci0jZGVmaW5lIE5MRV9TRVFfTUlTTUFUQ0gJMTYKLSNkZWZpbmUgTkxFX01TR19PVkVS
RkxPVwkxNwotI2RlZmluZSBOTEVfTVNHX1RSVU5DCQkxOAotI2RlZmluZSBOTEVfTk9BRERSCQkx
OQotI2RlZmluZSBOTEVfU1JDUlRfTk9TVVBQT1JUCTIwCi0jZGVmaW5lIE5MRV9NU0dfVE9PU0hP
UlQJMjEKLSNkZWZpbmUgTkxFX01TR1RZUEVfTk9TVVBQT1JUCTIyCi0jZGVmaW5lIE5MRV9PQkpf
TUlTTUFUQ0gJMjMKLSNkZWZpbmUgTkxFX05PQ0FDSEUJCTI0Ci0jZGVmaW5lIE5MRV9CVVNZCQky
NQotI2RlZmluZSBOTEVfUFJPVE9fTUlTTUFUQ0gJMjYKLSNkZWZpbmUgTkxFX05PQUNDRVNTCQky
NwotI2RlZmluZSBOTEVfUEVSTQkJMjgKLSNkZWZpbmUgTkxFX1BLVExPQ19GSUxFCQkyOQotI2Rl
ZmluZSBOTEVfUEFSU0VfRVJSCQkzMAotI2RlZmluZSBOTEVfTk9ERVYJCTMxCi0jZGVmaW5lIE5M
RV9JTU1VVEFCTEUJCTMyCi0jZGVmaW5lIE5MRV9EVU1QX0lOVFIJCTMzCi0KLSNkZWZpbmUgTkxF
X01BWAkJCU5MRV9EVU1QX0lOVFIKLQotZXh0ZXJuIGNvbnN0IGNoYXIgKglubF9nZXRlcnJvcihp
bnQpOwotZXh0ZXJuIHZvaWQJCW5sX3BlcnJvcihpbnQsIGNvbnN0IGNoYXIgKik7Ci1leHRlcm4g
aW50CQlubF9zeXNlcnIybmxlcnIoaW50KTsKLQotI2lmZGVmIF9fY3BsdXNwbHVzCi19Ci0jZW5k
aWYKLQotI2VuZGlmCmRpZmYgLS1naXQgYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5j
bHVkZS9uZXRsaW5rL2dlbmwvY3RybC5oIGIvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2lu
Y2x1ZGUvbmV0bGluay9nZW5sL2N0cmwuaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MjZhMGE5OTY3YjQ3Li4wMDAwMDAwMDAwMDAKLS0tIGEvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkv
c3JjL2luY2x1ZGUvbmV0bGluay9nZW5sL2N0cmwuaAorKysgL2Rldi9udWxsCkBAIC0xLDQwICsw
LDAgQEAKLS8qCi0gKiBuZXRsaW5rL2dlbmwvY3RybC5oCQlHZW5lcmljIE5ldGxpbmsgQ29udHJv
bGxlcgotICoKLSAqCVRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlz
dHJpYnV0ZSBpdCBhbmQvb3IKLSAqCW1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdO
VSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKLSAqCUxpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBG
cmVlIFNvZnR3YXJlIEZvdW5kYXRpb24gdmVyc2lvbiAyLjEKLSAqCW9mIHRoZSBMaWNlbnNlLgot
ICoKLSAqIENvcHlyaWdodCAoYykgMjAwMy0yMDA4IFRob21hcyBHcmFmIDx0Z3JhZkBzdXVnLmNo
PgotICovCi0KLSNpZm5kZWYgTkVUTElOS19HRU5MX0NUUkxfSF8KLSNkZWZpbmUgTkVUTElOS19H
RU5MX0NUUkxfSF8KLQotI2luY2x1ZGUgPG5ldGxpbmsvbmV0bGluay5oPgotI2luY2x1ZGUgPG5l
dGxpbmsvY2FjaGUuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL2FkZHIuaD4KLQotI2lmZGVmIF9fY3Bs
dXNwbHVzCi1leHRlcm4gIkMiIHsKLSNlbmRpZgotCi1zdHJ1Y3QgZ2VubF9mYW1pbHk7Ci0KLWV4
dGVybiBpbnQJCQlnZW5sX2N0cmxfYWxsb2NfY2FjaGUoc3RydWN0IG5sX3NvY2sgKiwKLQkJCQkJ
CSAgICAgIHN0cnVjdCBubF9jYWNoZSAqKik7Ci1leHRlcm4gc3RydWN0IGdlbmxfZmFtaWx5ICoJ
Z2VubF9jdHJsX3NlYXJjaChzdHJ1Y3QgbmxfY2FjaGUgKiwgaW50KTsKLWV4dGVybiBzdHJ1Y3Qg
Z2VubF9mYW1pbHkgKglnZW5sX2N0cmxfc2VhcmNoX2J5X25hbWUoc3RydWN0IG5sX2NhY2hlICos
Ci0JCQkJCQkJIGNvbnN0IGNoYXIgKik7Ci1leHRlcm4gaW50CQkJZ2VubF9jdHJsX3Jlc29sdmUo
c3RydWN0IG5sX3NvY2sgKiwKLQkJCQkJCSAgY29uc3QgY2hhciAqKTsKLWV4dGVybiBpbnQgCQkJ
Z2VubF9jdHJsX3Jlc29sdmVfZ3JwKHN0cnVjdCBubF9zb2NrICpzaywKLQkJCQkJCSAgICAgIGNv
bnN0IGNoYXIgKmZhbWlseSwKLQkJCQkJCSAgICAgIGNvbnN0IGNoYXIgKmdycCk7Ci0KLSNpZmRl
ZiBfX2NwbHVzcGx1cwotfQotI2VuZGlmCi0KLSNlbmRpZgpkaWZmIC0tZ2l0IGEvcGFja2FnZS9s
aWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay9nZW5sL2ZhbWlseS5oIGIvcGFja2Fn
ZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay9nZW5sL2ZhbWlseS5oCmRlbGV0
ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCA4YTFhMzhiYTI1ZDUuLjAwMDAwMDAwMDAwMAotLS0g
YS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL2dlbmwvZmFtaWx5
LmgKKysrIC9kZXYvbnVsbApAQCAtMSwxMzQgKzAsMCBAQAotLyoKLSAqIG5ldGxpbmsvZ2VubC9m
YW1pbHkuaAlHZW5lcmljIE5ldGxpbmsgRmFtaWx5Ci0gKgotICoJVGhpcyBsaWJyYXJ5IGlzIGZy
ZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgotICoJbW9kaWZ5IGl0
IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwotICoJTGlj
ZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiB2ZXJzaW9u
IDIuMQotICoJb2YgdGhlIExpY2Vuc2UuCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDAzLTIwMDYg
VGhvbWFzIEdyYWYgPHRncmFmQHN1dWcuY2g+Ci0gKi8KLQotI2lmbmRlZiBORVRMSU5LX0dFTkxf
RkFNSUxZX0hfCi0jZGVmaW5lIE5FVExJTktfR0VOTF9GQU1JTFlfSF8KLQotI2luY2x1ZGUgPG5l
dGxpbmsvbmV0bGluay5oPgotI2luY2x1ZGUgPG5ldGxpbmsvY2FjaGUuaD4KLQotI2lmZGVmIF9f
Y3BsdXNwbHVzCi1leHRlcm4gIkMiIHsKLSNlbmRpZgotCi0vKiogQGNvbmQgU0tJUCAqLwotI2Rl
ZmluZSBGQU1JTFlfQVRUUl9JRAkJMHgwMQotI2RlZmluZSBGQU1JTFlfQVRUUl9OQU1FCTB4MDIK
LSNkZWZpbmUgRkFNSUxZX0FUVFJfVkVSU0lPTgkweDA0Ci0jZGVmaW5lIEZBTUlMWV9BVFRSX0hE
UlNJWkUJMHgwOAotI2RlZmluZSBGQU1JTFlfQVRUUl9NQVhBVFRSCTB4MTAKLSNkZWZpbmUgRkFN
SUxZX0FUVFJfT1BTCQkweDIwCi0KLQotc3RydWN0IGdlbmxfZmFtaWx5Ci17Ci0JTkxIRFJfQ09N
TU9OCi0KLQl1aW50MTZfdAkJZ2ZfaWQ7Ci0JY2hhciAJCQlnZl9uYW1lW0dFTkxfTkFNU0laXTsK
LQl1aW50MzJfdAkJZ2ZfdmVyc2lvbjsKLQl1aW50MzJfdAkJZ2ZfaGRyc2l6ZTsKLQl1aW50MzJf
dAkJZ2ZfbWF4YXR0cjsKLQotCXN0cnVjdCBubF9saXN0X2hlYWQJZ2Zfb3BzOwotCXN0cnVjdCBu
bF9saXN0X2hlYWQJZ2ZfbWNfZ3JwczsKLX07Ci0KLQotZXh0ZXJuIHN0cnVjdCBnZW5sX2ZhbWls
eSAqCWdlbmxfZmFtaWx5X2FsbG9jKHZvaWQpOwotZXh0ZXJuIHZvaWQJCQlnZW5sX2ZhbWlseV9w
dXQoc3RydWN0IGdlbmxfZmFtaWx5ICopOwotCi1leHRlcm4gaW50CQkJZ2VubF9mYW1pbHlfYWRk
X29wKHN0cnVjdCBnZW5sX2ZhbWlseSAqLAotCQkJCQkJICAgaW50LCBpbnQpOwotZXh0ZXJuIGlu
dCAJCQlnZW5sX2ZhbWlseV9hZGRfZ3JwKHN0cnVjdCBnZW5sX2ZhbWlseSAqLAotCQkJCQl1aW50
MzJfdCAsIGNvbnN0IGNoYXIgKik7Ci0KLQotLyoqCi0gKiBAbmFtZSBBdHRyaWJ1dGVzCi0gKiBA
ewotICovCi0KLXN0YXRpYyBpbmxpbmUgdW5zaWduZWQgaW50IGdlbmxfZmFtaWx5X2dldF9pZChz
dHJ1Y3QgZ2VubF9mYW1pbHkgKmZhbWlseSkKLXsKLQlpZiAoZmFtaWx5LT5jZV9tYXNrICYgRkFN
SUxZX0FUVFJfSUQpCi0JCXJldHVybiBmYW1pbHktPmdmX2lkOwotCWVsc2UKLQkJcmV0dXJuIDA7
Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZCBnZW5sX2ZhbWlseV9zZXRfaWQoc3RydWN0IGdlbmxf
ZmFtaWx5ICpmYW1pbHksIHVuc2lnbmVkIGludCBpZCkKLXsKLQlmYW1pbHktPmdmX2lkID0gaWQ7
Ci0JZmFtaWx5LT5jZV9tYXNrIHw9IEZBTUlMWV9BVFRSX0lEOwotfQotCi1zdGF0aWMgaW5saW5l
IGNoYXIgKmdlbmxfZmFtaWx5X2dldF9uYW1lKHN0cnVjdCBnZW5sX2ZhbWlseSAqZmFtaWx5KQot
ewotCWlmIChmYW1pbHktPmNlX21hc2sgJiBGQU1JTFlfQVRUUl9OQU1FKQotCQlyZXR1cm4gZmFt
aWx5LT5nZl9uYW1lOwotCWVsc2UKLQkJcmV0dXJuIE5VTEw7Ci19Ci0KLXN0YXRpYyBpbmxpbmUg
dm9pZCBnZW5sX2ZhbWlseV9zZXRfbmFtZShzdHJ1Y3QgZ2VubF9mYW1pbHkgKmZhbWlseSwgY29u
c3QgY2hhciAqbmFtZSkKLXsKLQlzdHJuY3B5KGZhbWlseS0+Z2ZfbmFtZSwgbmFtZSwgR0VOTF9O
QU1TSVotMSk7Ci0JZmFtaWx5LT5jZV9tYXNrIHw9IEZBTUlMWV9BVFRSX05BTUU7Ci19Ci0KLXN0
YXRpYyBpbmxpbmUgdWludDhfdCBnZW5sX2ZhbWlseV9nZXRfdmVyc2lvbihzdHJ1Y3QgZ2VubF9m
YW1pbHkgKmZhbWlseSkKLXsKLQlpZiAoZmFtaWx5LT5jZV9tYXNrICYgRkFNSUxZX0FUVFJfVkVS
U0lPTikKLQkJcmV0dXJuIGZhbWlseS0+Z2ZfdmVyc2lvbjsKLQllbHNlCi0JCXJldHVybiAwOwot
fQotCi1zdGF0aWMgaW5saW5lIHZvaWQgZ2VubF9mYW1pbHlfc2V0X3ZlcnNpb24oc3RydWN0IGdl
bmxfZmFtaWx5ICpmYW1pbHksIHVpbnQ4X3QgdmVyc2lvbikKLXsKLQlmYW1pbHktPmdmX3ZlcnNp
b24gPSB2ZXJzaW9uOwotCWZhbWlseS0+Y2VfbWFzayB8PSBGQU1JTFlfQVRUUl9WRVJTSU9OOwot
fQotCi1zdGF0aWMgaW5saW5lIHVpbnQzMl90IGdlbmxfZmFtaWx5X2dldF9oZHJzaXplKHN0cnVj
dCBnZW5sX2ZhbWlseSAqZmFtaWx5KQotewotCWlmIChmYW1pbHktPmNlX21hc2sgJiBGQU1JTFlf
QVRUUl9IRFJTSVpFKQotCQlyZXR1cm4gZmFtaWx5LT5nZl9oZHJzaXplOwotCWVsc2UKLQkJcmV0
dXJuIDA7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZCBnZW5sX2ZhbWlseV9zZXRfaGRyc2l6ZShz
dHJ1Y3QgZ2VubF9mYW1pbHkgKmZhbWlseSwgdWludDMyX3QgaGRyc2l6ZSkKLXsKLQlmYW1pbHkt
PmdmX2hkcnNpemUgPSBoZHJzaXplOwotCWZhbWlseS0+Y2VfbWFzayB8PSBGQU1JTFlfQVRUUl9I
RFJTSVpFOwotfQotCi1zdGF0aWMgaW5saW5lIHVpbnQzMl90IGdlbmxfZmFtaWx5X2dldF9tYXhh
dHRyKHN0cnVjdCBnZW5sX2ZhbWlseSAqZmFtaWx5KQotewotCWlmIChmYW1pbHktPmNlX21hc2sg
JiBGQU1JTFlfQVRUUl9NQVhBVFRSKQotCQlyZXR1cm4gZmFtaWx5LT5nZl9tYXhhdHRyOwotCWVs
c2UKLQkJcmV0dXJuIGZhbWlseS0+Z2ZfbWF4YXR0cjsKLX0KLQotc3RhdGljIGlubGluZSB2b2lk
IGdlbmxfZmFtaWx5X3NldF9tYXhhdHRyKHN0cnVjdCBnZW5sX2ZhbWlseSAqZmFtaWx5LCB1aW50
MzJfdCBtYXhhdHRyKQotewotCWZhbWlseS0+Z2ZfbWF4YXR0ciA9IG1heGF0dHI7Ci0JZmFtaWx5
LT5jZV9tYXNrIHw9IEZBTUlMWV9BVFRSX01BWEFUVFI7Ci19Ci0KLSNpZmRlZiBfX2NwbHVzcGx1
cwotfQotI2VuZGlmCi0KLSNlbmRpZgpkaWZmIC0tZ2l0IGEvcGFja2FnZS9saWJzL2xpYm5sLXRp
bnkvc3JjL2luY2x1ZGUvbmV0bGluay9nZW5sL2dlbmwuaCBiL3BhY2thZ2UvbGlicy9saWJubC10
aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvZ2VubC9nZW5sLmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAw
NjQ0CmluZGV4IDNmMzM0MGNmZGM3Yi4uMDAwMDAwMDAwMDAwCi0tLSBhL3BhY2thZ2UvbGlicy9s
aWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvZ2VubC9nZW5sLmgKKysrIC9kZXYvbnVsbApA
QCAtMSw0NyArMCwwIEBACi0vKgotICogbmV0bGluay9nZW5sL2dlbmwuaAkJR2VuZXJpYyBOZXRs
aW5rCi0gKgotICoJVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0
cmlidXRlIGl0IGFuZC9vcgotICoJbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05V
IExlc3NlciBHZW5lcmFsIFB1YmxpYwotICoJTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZy
ZWUgU29mdHdhcmUgRm91bmRhdGlvbiB2ZXJzaW9uIDIuMQotICoJb2YgdGhlIExpY2Vuc2UuCi0g
KgotICogQ29weXJpZ2h0IChjKSAyMDAzLTIwMDggVGhvbWFzIEdyYWYgPHRncmFmQHN1dWcuY2g+
Ci0gKi8KLQotI2lmbmRlZiBORVRMSU5LX0dFTkxfSF8KLSNkZWZpbmUgTkVUTElOS19HRU5MX0hf
Ci0KLSNpbmNsdWRlIDxuZXRsaW5rL25ldGxpbmsuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL21zZy5o
PgotI2luY2x1ZGUgPG5ldGxpbmsvYXR0ci5oPgotCi0jaWZkZWYgX19jcGx1c3BsdXMKLWV4dGVy
biAiQyIgewotI2VuZGlmCi0KLWV4dGVybiBpbnQJCWdlbmxfY29ubmVjdChzdHJ1Y3Qgbmxfc29j
ayAqKTsKLQotZXh0ZXJuIGludAkJZ2VubF9zZW5kX3NpbXBsZShzdHJ1Y3Qgbmxfc29jayAqLCBp
bnQsIGludCwKLQkJCQkJIGludCwgaW50KTsKLQotZXh0ZXJuIHZvaWQgKgkJZ2VubG1zZ19wdXQo
c3RydWN0IG5sX21zZyAqLCB1aW50MzJfdCwgdWludDMyX3QsCi0JCQkJICAgIGludCwgaW50LCBp
bnQsIHVpbnQ4X3QsIHVpbnQ4X3QpOwotCi1leHRlcm4gaW50CQlnZW5sbXNnX3ZhbGlkX2hkcihz
dHJ1Y3Qgbmxtc2doZHIgKiwgaW50KTsKLWV4dGVybiBpbnQJCWdlbmxtc2dfdmFsaWRhdGUoc3Ry
dWN0IG5sbXNnaGRyICosIGludCwgaW50LAotCQkJCQkgc3RydWN0IG5sYV9wb2xpY3kgKik7Ci1l
eHRlcm4gaW50CQlnZW5sbXNnX3BhcnNlKHN0cnVjdCBubG1zZ2hkciAqLCBpbnQsIHN0cnVjdCBu
bGF0dHIgKiosCi0JCQkJICAgICAgaW50LCBzdHJ1Y3QgbmxhX3BvbGljeSAqKTsKLWV4dGVybiB2
b2lkICoJCWdlbmxtc2dfZGF0YShjb25zdCBzdHJ1Y3QgZ2VubG1zZ2hkciAqKTsKLWV4dGVybiBp
bnQJCWdlbmxtc2dfbGVuKGNvbnN0IHN0cnVjdCBnZW5sbXNnaGRyICopOwotZXh0ZXJuIHN0cnVj
dCBubGF0dHIgKglnZW5sbXNnX2F0dHJkYXRhKGNvbnN0IHN0cnVjdCBnZW5sbXNnaGRyICosIGlu
dCk7Ci1leHRlcm4gaW50CQlnZW5sbXNnX2F0dHJsZW4oY29uc3Qgc3RydWN0IGdlbmxtc2doZHIg
KiwgaW50KTsKLQotZXh0ZXJuIGNoYXIgKgkJZ2VubF9vcDJuYW1lKGludCwgaW50LCBjaGFyICos
IHNpemVfdCk7Ci0KLSNpZmRlZiBfX2NwbHVzcGx1cwotfQotI2VuZGlmCi0KLSNlbmRpZgpkaWZm
IC0tZ2l0IGEvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay9nZW5s
L21uZ3QuaCBiL3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvZ2Vu
bC9tbmd0LmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDhiMDI0NGYyY2NhMS4uMDAw
MDAwMDAwMDAwCi0tLSBhL3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxp
bmsvZ2VubC9tbmd0LmgKKysrIC9kZXYvbnVsbApAQCAtMSw4NyArMCwwIEBACi0vKgotICogbmV0
bGluay9nZW5sL21uZ3QuaAkJR2VuZXJpYyBOZXRsaW5rIE1hbmFnZW1lbnQKLSAqCi0gKglUaGlz
IGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29y
Ci0gKgltb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwg
UHVibGljCi0gKglMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3Vu
ZGF0aW9uIHZlcnNpb24gMi4xCi0gKglvZiB0aGUgTGljZW5zZS4KLSAqCi0gKiBDb3B5cmlnaHQg
KGMpIDIwMDMtMjAwNiBUaG9tYXMgR3JhZiA8dGdyYWZAc3V1Zy5jaD4KLSAqLwotCi0jaWZuZGVm
IE5FVExJTktfR0VOTF9NTkdUX0hfCi0jZGVmaW5lIE5FVExJTktfR0VOTF9NTkdUX0hfCi0KLSNp
bmNsdWRlIDxuZXRsaW5rL25ldGxpbmsuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL2F0dHIuaD4KLSNp
bmNsdWRlIDxuZXRsaW5rL2xpc3QuaD4KLQotI2lmZGVmIF9fY3BsdXNwbHVzCi1leHRlcm4gIkMi
IHsKLSNlbmRpZgotCi1zdHJ1Y3QgbmxfY2FjaGVfb3BzOwotCi1zdHJ1Y3QgZ2VubF9pbmZvCi17
Ci0Jc3RydWN0IHNvY2thZGRyX25sICogICAgd2hvOwotCXN0cnVjdCBubG1zZ2hkciAqICAgICAg
IG5saDsKLQlzdHJ1Y3QgZ2VubG1zZ2hkciAqICAgICBnZW5saGRyOwotCXZvaWQgKiAgICAgICAg
ICAgICAgICAgIHVzZXJoZHI7Ci0Jc3RydWN0IG5sYXR0ciAqKiAgICAgICAgYXR0cnM7Ci19Owot
Ci0vKioKLSAqIEBpbmdyb3VwIGdlbmxfbW5ndAotICogR2VuZXJpYyBOZXRsaW5rIENvbW1hbmQK
LSAqLwotc3RydWN0IGdlbmxfY21kCi17Ci0JLyoqIFVuaXF1ZSBjb21tYW5kIGlkZW50aWZpZXIg
Ki8KLQlpbnQJCQljX2lkOwotCi0JLyoqIE5hbWUvZGVzY3JpcHRpb24gb2YgY29tbWFuZCAqLwot
CWNoYXIgKgkJCWNfbmFtZTsKLQotCS8qKgotCSAqIE1heGltdW0gYXR0cmlidXRlIGlkZW50aWZp
ZXIsIG11c3QgYmUgcHJvdmlkZWQgaWYKLQkgKiBhIG1lc3NhZ2UgcGFyc2VyIGlzIGF2YWlsYWJs
ZS4KLQkgKi8KLQlpbnQJCQljX21heGF0dHI7Ci0KLQlpbnQJCSAgICAgICgqY19tc2dfcGFyc2Vy
KShzdHJ1Y3QgbmxfY2FjaGVfb3BzICosCi0JCQkJCSAgICAgIHN0cnVjdCBnZW5sX2NtZCAqLAot
CQkJCQkgICAgICBzdHJ1Y3QgZ2VubF9pbmZvICosIHZvaWQgKik7Ci0KLQkvKioKLQkgKiBBdHRy
aWJ1dGUgdmFsaWRhdGlvbiBwb2xpY3kgKG9wdGlvbmFsKQotCSAqLwotCXN0cnVjdCBubGFfcG9s
aWN5ICoJY19hdHRyX3BvbGljeTsKLX07Ci0KLS8qKgotICogQGluZ3JvdXAgZ2VubF9tbmd0Ci0g
KiBHZW5lcmljIE5ldGxpbmsgT3BlcmF0aW9ucwotICovCi1zdHJ1Y3QgZ2VubF9vcHMKLXsKLQlp
bnQJCQlvX2ZhbWlseTsKLQlpbnQJCQlvX2lkOwotCWNoYXIgKgkJCW9fbmFtZTsKLQlzdHJ1Y3Qg
bmxfY2FjaGVfb3BzICoJb19jYWNoZV9vcHM7Ci0Jc3RydWN0IGdlbmxfY21kCSoJb19jbWRzOwot
CWludAkJCW9fbmNtZHM7Ci0KLQkvKiBsaW5rZWQgbGlzdCBvZiBhbGwgZ2VubCBjYWNoZSBvcGVy
YXRpb25zICovCi0Jc3RydWN0IG5sX2xpc3RfaGVhZAlvX2xpc3Q7Ci19OwotCi0KLWV4dGVybiBp
bnQJCWdlbmxfcmVnaXN0ZXIoc3RydWN0IG5sX2NhY2hlX29wcyAqKTsKLWV4dGVybiB2b2lkCQln
ZW5sX3VucmVnaXN0ZXIoc3RydWN0IG5sX2NhY2hlX29wcyAqKTsKLQotI2lmZGVmIF9fY3BsdXNw
bHVzCi19Ci0jZW5kaWYKLQotI2VuZGlmCmRpZmYgLS1naXQgYS9wYWNrYWdlL2xpYnMvbGlibmwt
dGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL2hhbmRsZXJzLmggYi9wYWNrYWdlL2xpYnMvbGlibmwt
dGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL2hhbmRsZXJzLmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAw
NjQ0CmluZGV4IGY1YzkzM2QwZDcxMy4uMDAwMDAwMDAwMDAwCi0tLSBhL3BhY2thZ2UvbGlicy9s
aWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvaGFuZGxlcnMuaAorKysgL2Rldi9udWxsCkBA
IC0xLDIzMSArMCwwIEBACi0vKgotICogbmV0bGluay9oYW5kbGVycy5jCWRlZmF1bHQgbmV0bGlu
ayBtZXNzYWdlIGhhbmRsZXJzCi0gKgotICoJVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7
IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgotICoJbW9kaWZ5IGl0IHVuZGVyIHRoZSB0
ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwotICoJTGljZW5zZSBhcyBwdWJs
aXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiB2ZXJzaW9uIDIuMQotICoJb2Yg
dGhlIExpY2Vuc2UuCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDAzLTIwMDYgVGhvbWFzIEdyYWYg
PHRncmFmQHN1dWcuY2g+Ci0gKi8KLQotI2lmbmRlZiBORVRMSU5LX0hBTkRMRVJTX0hfCi0jZGVm
aW5lIE5FVExJTktfSEFORExFUlNfSF8KLQotI2luY2x1ZGUgPHN0ZGlvLmg+Ci0jaW5jbHVkZSA8
c3RkaW50Lmg+Ci0jaW5jbHVkZSA8c3lzL3NvY2tldC5oPgotI2luY2x1ZGUgPHN5cy90eXBlcy5o
PgotI2luY2x1ZGUgPG5ldGxpbmsvbmV0bGluay1jb21wYXQuaD4KLSNpbmNsdWRlIDxuZXRsaW5r
L25ldGxpbmsta2VybmVsLmg+Ci0jaW5jbHVkZSA8bmV0bGluay90eXBlcy5oPgotCi0jaWZkZWYg
X19jcGx1c3BsdXMKLWV4dGVybiAiQyIgewotI2VuZGlmCi0KLXN0cnVjdCBubF9zb2NrOwotc3Ry
dWN0IG5sX21zZzsKLXN0cnVjdCBubF9jYjsKLS8qKgotICogQG5hbWUgQ2FsbGJhY2sgVHlwZWRl
ZnMKLSAqIEB7Ci0gKi8KLQotLyoqCi0gKiBubF9yZWN2bXNncygpIGNhbGxiYWNrIGZvciBtZXNz
YWdlIHByb2Nlc3NpbmcgY3VzdG9taXphdGlvbgotICogQGluZ3JvdXAgY2IKLSAqIEBhcmcgbXNn
CQluZXRsaW5rIG1lc3NhZ2UgYmVpbmcgcHJvY2Vzc2VkCi0gKiBAYXJnIGFyZwkJYXJndW1lbnQg
cGFzc3dkIG9uIHRocm91Z2ggY2FsbGVyCi0gKi8KLXR5cGVkZWYgaW50ICgqbmxfcmVjdm1zZ19t
c2dfY2JfdCkoc3RydWN0IG5sX21zZyAqbXNnLCB2b2lkICphcmcpOwotCi0vKioKLSAqIG5sX3Jl
Y3Ztc2dzKCkgY2FsbGJhY2sgZm9yIGVycm9yIG1lc3NhZ2UgcHJvY2Vzc2luZyBjdXN0b21pemF0
aW9uCi0gKiBAaW5ncm91cCBjYgotICogQGFyZyBubGEJCW5ldGxpbmsgYWRkcmVzcyBvZiB0aGUg
cGVlcgotICogQGFyZyBubGVycgkJbmV0bGluayBlcnJvciBtZXNzYWdlIGJlaW5nIHByb2Nlc3Nl
ZAotICogQGFyZyBhcmcJCWFyZ3VtZW50IHBhc3NlZCBvbiB0aHJvdWdoIGNhbGxlcgotICovCi10
eXBlZGVmIGludCAoKm5sX3JlY3Ztc2dfZXJyX2NiX3QpKHN0cnVjdCBzb2NrYWRkcl9ubCAqbmxh
LAotCQkJCSAgIHN0cnVjdCBubG1zZ2VyciAqbmxlcnIsIHZvaWQgKmFyZyk7Ci0KLS8qKiBAfSAq
LwotCi0vKioKLSAqIENhbGxiYWNrIGFjdGlvbnMKLSAqIEBpbmdyb3VwIGNiCi0gKi8KLWVudW0g
bmxfY2JfYWN0aW9uIHsKLQkvKiogUHJvY2VlZCB3aXRoIHdhdGhldmVyIHdvdWxkIGNvbWUgbmV4
dCAqLwotCU5MX09LLAotCS8qKiBTa2lwIHRoaXMgbWVzc2FnZSAqLwotCU5MX1NLSVAsCi0JLyoq
IFN0b3AgcGFyc2luZyBhbHRvZ2V0aGVyIGFuZCBkaXNjYXJkIHJlbWFpbmluZyBtZXNzYWdlcyAq
LwotCU5MX1NUT1AsCi19OwotCi0vKioKLSAqIENhbGxiYWNrIGtpbmRzCi0gKiBAaW5ncm91cCBj
YgotICovCi1lbnVtIG5sX2NiX2tpbmQgewotCS8qKiBEZWZhdWx0IGhhbmRsZXJzIChxdWlldCkg
Ki8KLQlOTF9DQl9ERUZBVUxULAotCS8qKiBWZXJib3NlIGRlZmF1bHQgaGFuZGxlcnMgKGVycm9y
IG1lc3NhZ2VzIHByaW50ZWQpICovCi0JTkxfQ0JfVkVSQk9TRSwKLQkvKiogRGVidWcgaGFuZGxl
cnMgZm9yIGRlYnVnZ2luZyAqLwotCU5MX0NCX0RFQlVHLAotCS8qKiBDdXN0b21pemVkIGhhbmRs
ZXIgc3BlY2lmaWVkIGJ5IHRoZSB1c2VyICovCi0JTkxfQ0JfQ1VTVE9NLAotCV9fTkxfQ0JfS0lO
RF9NQVgsCi19OwotCi0jZGVmaW5lIE5MX0NCX0tJTkRfTUFYIChfX05MX0NCX0tJTkRfTUFYIC0g
MSkKLQotLyoqCi0gKiBDYWxsYmFjayB0eXBlcwotICogQGluZ3JvdXAgY2IKLSAqLwotZW51bSBu
bF9jYl90eXBlIHsKLQkvKiogTWVzc2FnZSBpcyB2YWxpZCAqLwotCU5MX0NCX1ZBTElELAotCS8q
KiBMYXN0IG1lc3NhZ2UgaW4gYSBzZXJpZXMgb2YgbXVsdGkgcGFydCBtZXNzYWdlcyByZWNlaXZl
ZCAqLwotCU5MX0NCX0ZJTklTSCwKLQkvKiogUmVwb3J0IHJlY2VpdmVkIHRoYXQgZGF0YSB3YXMg
bG9zdCAqLwotCU5MX0NCX09WRVJSVU4sCi0JLyoqIE1lc3NhZ2Ugd2FudHMgdG8gYmUgc2tpcHBl
ZCAqLwotCU5MX0NCX1NLSVBQRUQsCi0JLyoqIE1lc3NhZ2UgaXMgYW4gYWNrbm93bGVkZ2UgKi8K
LQlOTF9DQl9BQ0ssCi0JLyoqIENhbGxlZCBmb3IgZXZlcnkgbWVzc2FnZSByZWNlaXZlZCAqLwot
CU5MX0NCX01TR19JTiwKLQkvKiogQ2FsbGVkIGZvciBldmVyeSBtZXNzYWdlIHNlbnQgb3V0IGV4
Y2VwdCBmb3Igbmxfc2VuZHRvKCkgKi8KLQlOTF9DQl9NU0dfT1VULAotCS8qKiBNZXNzYWdlIGlz
IG1hbGZvcm1lZCBhbmQgaW52YWxpZCAqLwotCU5MX0NCX0lOVkFMSUQsCi0JLyoqIENhbGxlZCBp
bnN0ZWFkIG9mIGludGVybmFsIHNlcXVlbmNlIG51bWJlciBjaGVja2luZyAqLwotCU5MX0NCX1NF
UV9DSEVDSywKLQkvKiogU2VuZGluZyBvZiBhbiBhY2tub3dsZWRnZSBtZXNzYWdlIGhhcyBiZWVu
IHJlcXVlc3RlZCAqLwotCU5MX0NCX1NFTkRfQUNLLAotCV9fTkxfQ0JfVFlQRV9NQVgsCi19Owot
Ci0jZGVmaW5lIE5MX0NCX1RZUEVfTUFYIChfX05MX0NCX1RZUEVfTUFYIC0gMSkKLQotc3RydWN0
IG5sX2NiCi17Ci0JbmxfcmVjdm1zZ19tc2dfY2JfdAljYl9zZXRbTkxfQ0JfVFlQRV9NQVgrMV07
Ci0Jdm9pZCAqCQkJY2JfYXJnc1tOTF9DQl9UWVBFX01BWCsxXTsKLQkKLQlubF9yZWN2bXNnX2Vy
cl9jYl90CWNiX2VycjsKLQl2b2lkICoJCQljYl9lcnJfYXJnOwotCi0JLyoqIE1heSBiZSB1c2Vk
IHRvIHJlcGxhY2UgbmxfcmVjdm1zZ3Mgd2l0aCB5b3VyIG93biBpbXBsZW1lbnRhdGlvbgotCSAq
IGluIGFsbCBpbnRlcm5hbCBjYWxscyB0byBubF9yZWN2bXNncy4gKi8KLQlpbnQJCQkoKmNiX3Jl
Y3Ztc2dzX293KShzdHJ1Y3Qgbmxfc29jayAqLAotCQkJCQkJICBzdHJ1Y3QgbmxfY2IgKik7Ci0K
LQkvKiogT3ZlcndyaXRlIGludGVybmFsIGNhbGxzIHRvIG5sX3JlY3YsIG11c3QgcmV0dXJuIHRo
ZSBudW1iZXIgb2YKLQkgKiBvY3RldHMgcmVhZCBhbmQgYWxsb2NhdGUgYSBidWZmZXIgZm9yIHRo
ZSByZWNlaXZlZCBkYXRhLiAqLwotCWludAkJCSgqY2JfcmVjdl9vdykoc3RydWN0IG5sX3NvY2sg
KiwKLQkJCQkJICAgICAgc3RydWN0IHNvY2thZGRyX25sICosCi0JCQkJCSAgICAgIHVuc2lnbmVk
IGNoYXIgKiosCi0JCQkJCSAgICAgIHN0cnVjdCB1Y3JlZCAqKik7Ci0KLQkvKiogT3ZlcndyaXRl
cyBpbnRlcm5hbCBjYWxscyB0byBubF9zZW5kLCBtdXN0IHNlbmQgdGhlIG5ldGxpbmsKLQkgKiBt
ZXNzYWdlLiAqLwotCWludAkJCSgqY2Jfc2VuZF9vdykoc3RydWN0IG5sX3NvY2sgKiwKLQkJCQkJ
ICAgICAgc3RydWN0IG5sX21zZyAqKTsKLQotCWludAkJCWNiX3JlZmNudDsKLX07Ci0KLQotZXh0
ZXJuIHN0cnVjdCBubF9jYiAqCW5sX2NiX2FsbG9jKGVudW0gbmxfY2Jfa2luZCk7Ci1leHRlcm4g
c3RydWN0IG5sX2NiICoJbmxfY2JfY2xvbmUoc3RydWN0IG5sX2NiICopOwotZXh0ZXJuIHZvaWQJ
CW5sX2NiX3B1dChzdHJ1Y3QgbmxfY2IgKik7Ci0KLWV4dGVybiBpbnQgIG5sX2NiX3NldChzdHJ1
Y3QgbmxfY2IgKiwgZW51bSBubF9jYl90eXBlLCBlbnVtIG5sX2NiX2tpbmQsCi0JCSAgICAgIG5s
X3JlY3Ztc2dfbXNnX2NiX3QsIHZvaWQgKik7Ci1leHRlcm4gaW50ICBubF9jYl9lcnIoc3RydWN0
IG5sX2NiICosIGVudW0gbmxfY2Jfa2luZCwgbmxfcmVjdm1zZ19lcnJfY2JfdCwKLQkJICAgICAg
dm9pZCAqKTsKLQotc3RhdGljIGlubGluZSBzdHJ1Y3QgbmxfY2IgKm5sX2NiX2dldChzdHJ1Y3Qg
bmxfY2IgKmNiKQotewotCWNiLT5jYl9yZWZjbnQrKzsKLQotCXJldHVybiBjYjsKLX0KLQotLyoq
Ci0gKiBTZXQgdXAgYSBhbGwgY2FsbGJhY2tzCi0gKiBAYXJnIGNiCQljYWxsYmFjayBzZXQKLSAq
IEBhcmcga2luZAkJa2luZCBvZiBjYWxsYmFjawotICogQGFyZyBmdW5jCQljYWxsYmFjayBmdW5j
dGlvbgotICogQGFyZyBhcmcJCWFyZ3VtZW50IHRvIGJlIHBhc3N3ZCB0byBjYWxsYmFjayBmdW5j
dGlvbgotICoKLSAqIEByZXR1cm4gMCBvbiBzdWNjZXNzIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29k
ZQotICovCi1zdGF0aWMgaW5saW5lIGludCBubF9jYl9zZXRfYWxsKHN0cnVjdCBubF9jYiAqY2Is
IGVudW0gbmxfY2Jfa2luZCBraW5kLAotCQkgIG5sX3JlY3Ztc2dfbXNnX2NiX3QgZnVuYywgdm9p
ZCAqYXJnKQotewotCWludCBpLCBlcnI7Ci0KLQlmb3IgKGkgPSAwOyBpIDw9IE5MX0NCX1RZUEVf
TUFYOyBpKyspIHsKLQkJZXJyID0gbmxfY2Jfc2V0KGNiLChlbnVtIG5sX2NiX3R5cGUpaSwga2lu
ZCwgZnVuYywgYXJnKTsKLQkJaWYgKGVyciA8IDApCi0JCQlyZXR1cm4gZXJyOwotCX0KLQotCXJl
dHVybiAwOwotfQotCi0KLS8qKgotICogQG5hbWUgT3ZlcndyaXRpbmcKLSAqIEB7Ci0gKi8KLQot
LyoqCi0gKiBPdmVyd3JpdGUgaW50ZXJuYWwgY2FsbHMgdG8gbmxfcmVjdm1zZ3MoKQotICogQGFy
ZyBjYgkJY2FsbGJhY2sgc2V0Ci0gKiBAYXJnIGZ1bmMJCXJlcGxhY2VtZW50IGNhbGxiYWNrIGZv
ciBubF9yZWN2bXNncygpCi0gKi8KLXN0YXRpYyBpbmxpbmUgdm9pZCBubF9jYl9vdmVyd3JpdGVf
cmVjdm1zZ3Moc3RydWN0IG5sX2NiICpjYiwKLQkJCSAgICAgIGludCAoKmZ1bmMpKHN0cnVjdCBu
bF9zb2NrICosIHN0cnVjdCBubF9jYiAqKSkKLXsKLQljYi0+Y2JfcmVjdm1zZ3Nfb3cgPSBmdW5j
OwotfQotCi0vKioKLSAqIE92ZXJ3cml0ZSBpbnRlcm5hbCBjYWxscyB0byBubF9yZWN2KCkKLSAq
IEBhcmcgY2IJCWNhbGxiYWNrIHNldAotICogQGFyZyBmdW5jCQlyZXBsYWNlbWVudCBjYWxsYmFj
ayBmb3IgbmxfcmVjdigpCi0gKi8KLXN0YXRpYyBpbmxpbmUgdm9pZCBubF9jYl9vdmVyd3JpdGVf
cmVjdihzdHJ1Y3QgbmxfY2IgKmNiLAotCQkJICBpbnQgKCpmdW5jKShzdHJ1Y3Qgbmxfc29jayAq
LCBzdHJ1Y3Qgc29ja2FkZHJfbmwgKiwKLQkJCQkgICAgICB1bnNpZ25lZCBjaGFyICoqLCBzdHJ1
Y3QgdWNyZWQgKiopKQotewotCWNiLT5jYl9yZWN2X293ID0gZnVuYzsKLX0KLQotLyoqCi0gKiBP
dmVyd3JpdGUgaW50ZXJuYWwgY2FsbHMgdG8gbmxfc2VuZCgpCi0gKiBAYXJnIGNiCQljYWxsYmFj
ayBzZXQKLSAqIEBhcmcgZnVuYwkJcmVwbGFjZW1lbnQgY2FsbGJhY2sgZm9yIG5sX3NlbmQoKQot
ICovCi1zdGF0aWMgaW5saW5lIHZvaWQgbmxfY2Jfb3ZlcndyaXRlX3NlbmQoc3RydWN0IG5sX2Ni
ICpjYiwKLQkJCSAgaW50ICgqZnVuYykoc3RydWN0IG5sX3NvY2sgKiwgc3RydWN0IG5sX21zZyAq
KSkKLXsKLQljYi0+Y2Jfc2VuZF9vdyA9IGZ1bmM7Ci19Ci0KLS8qKiBAfSAqLwotCi0KLSNpZmRl
ZiBfX2NwbHVzcGx1cwotfQotI2VuZGlmCi0KLSNlbmRpZgpkaWZmIC0tZ2l0IGEvcGFja2FnZS9s
aWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay9saXN0LmggYi9wYWNrYWdlL2xpYnMv
bGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL2xpc3QuaApkZWxldGVkIGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggYzY4NzZhNzdmNzZjLi4wMDAwMDAwMDAwMDAKLS0tIGEvcGFja2FnZS9saWJz
L2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay9saXN0LmgKKysrIC9kZXYvbnVsbApAQCAt
MSw4OCArMCwwIEBACi0vKgotICogbmV0bGluay9saXN0LmgJTmV0bGluayBMaXN0IFV0aWxpdGll
cwotICoKLSAqCVRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJp
YnV0ZSBpdCBhbmQvb3IKLSAqCW1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBM
ZXNzZXIgR2VuZXJhbCBQdWJsaWMKLSAqCUxpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVl
IFNvZnR3YXJlIEZvdW5kYXRpb24gdmVyc2lvbiAyLjEKLSAqCW9mIHRoZSBMaWNlbnNlLgotICoK
LSAqIENvcHlyaWdodCAoYykgMjAwMy0yMDA2IFRob21hcyBHcmFmIDx0Z3JhZkBzdXVnLmNoPgot
ICovCi0KLSNpZm5kZWYgTkVUTElOS19MSVNUX0hfCi0jZGVmaW5lIE5FVExJTktfTElTVF9IXwot
Ci1zdHJ1Y3QgbmxfbGlzdF9oZWFkCi17Ci0Jc3RydWN0IG5sX2xpc3RfaGVhZCAqCW5leHQ7Ci0J
c3RydWN0IG5sX2xpc3RfaGVhZCAqCXByZXY7Ci19OwotCi0KLXN0YXRpYyBpbmxpbmUgdm9pZCBf
X25sX2xpc3RfYWRkKHN0cnVjdCBubF9saXN0X2hlYWQgKm9iaiwKLQkJCQkgc3RydWN0IG5sX2xp
c3RfaGVhZCAqcHJldiwKLQkJCQkgc3RydWN0IG5sX2xpc3RfaGVhZCAqbmV4dCkKLXsKLQlwcmV2
LT5uZXh0ID0gb2JqOwotCW9iai0+cHJldiA9IHByZXY7Ci0JbmV4dC0+cHJldiA9IG9iajsKLQlv
YmotPm5leHQgPSBuZXh0OwotfQotCi1zdGF0aWMgaW5saW5lIHZvaWQgbmxfbGlzdF9hZGRfdGFp
bChzdHJ1Y3QgbmxfbGlzdF9oZWFkICpvYmosCi0JCQkJICAgIHN0cnVjdCBubF9saXN0X2hlYWQg
KmhlYWQpCi17Ci0JX19ubF9saXN0X2FkZChvYmosIGhlYWQtPnByZXYsIGhlYWQpOwotfQotCi1z
dGF0aWMgaW5saW5lIHZvaWQgbmxfbGlzdF9hZGRfaGVhZChzdHJ1Y3QgbmxfbGlzdF9oZWFkICpv
YmosCi0JCQkJICAgIHN0cnVjdCBubF9saXN0X2hlYWQgKmhlYWQpCi17Ci0JX19ubF9saXN0X2Fk
ZChvYmosIGhlYWQsIGhlYWQtPm5leHQpOwotfQotCi1zdGF0aWMgaW5saW5lIHZvaWQgbmxfbGlz
dF9kZWwoc3RydWN0IG5sX2xpc3RfaGVhZCAqb2JqKQotewotCW9iai0+bmV4dC0+cHJldiA9IG9i
ai0+cHJldjsKLQlvYmotPnByZXYtPm5leHQgPSBvYmotPm5leHQ7Ci19Ci0KLXN0YXRpYyBpbmxp
bmUgaW50IG5sX2xpc3RfZW1wdHkoc3RydWN0IG5sX2xpc3RfaGVhZCAqaGVhZCkKLXsKLQlyZXR1
cm4gaGVhZC0+bmV4dCA9PSBoZWFkOwotfQotCi0jZGVmaW5lIG5sX2NvbnRhaW5lcl9vZihwdHIs
IHR5cGUsIG1lbWJlcikgKHsJCQlcCi0gICAgICAgIGNvbnN0IHR5cGVvZiggKCh0eXBlICopMCkt
Pm1lbWJlciApICpfX21wdHIgPSAocHRyKTsJXAotICAgICAgICAodHlwZSAqKSggKGNoYXIgKilf
X21wdHIgLSAoKHNpemVfdCkgJigodHlwZSAqKTApLT5tZW1iZXIpKTt9KQotCi0jZGVmaW5lIG5s
X2xpc3RfZW50cnkocHRyLCB0eXBlLCBtZW1iZXIpIFwKLQlubF9jb250YWluZXJfb2YocHRyLCB0
eXBlLCBtZW1iZXIpCi0KLSNkZWZpbmUgbmxfbGlzdF9hdF90YWlsKHBvcywgaGVhZCwgbWVtYmVy
KSBcCi0JKChwb3MpLT5tZW1iZXIubmV4dCA9PSAoaGVhZCkpCi0KLSNkZWZpbmUgbmxfbGlzdF9h
dF9oZWFkKHBvcywgaGVhZCwgbWVtYmVyKSBcCi0JKChwb3MpLT5tZW1iZXIucHJldiA9PSAoaGVh
ZCkpCi0KLSNkZWZpbmUgTkxfTElTVF9IRUFEKG5hbWUpIFwKLQlzdHJ1Y3QgbmxfbGlzdF9oZWFk
IG5hbWUgPSB7ICYobmFtZSksICYobmFtZSkgfQotCi0jZGVmaW5lIG5sX2xpc3RfZmlyc3RfZW50
cnkoaGVhZCwgdHlwZSwgbWVtYmVyKQkJCVwKLQlubF9saXN0X2VudHJ5KChoZWFkKS0+bmV4dCwg
dHlwZSwgbWVtYmVyKQotCi0jZGVmaW5lIG5sX2xpc3RfZm9yX2VhY2hfZW50cnkocG9zLCBoZWFk
LCBtZW1iZXIpCQkJCVwKLQlmb3IgKHBvcyA9IG5sX2xpc3RfZW50cnkoKGhlYWQpLT5uZXh0LCB0
eXBlb2YoKnBvcyksIG1lbWJlcik7CVwKLQkgICAgICYocG9zKS0+bWVtYmVyICE9IChoZWFkKTsg
CVwKLQkgICAgIChwb3MpID0gbmxfbGlzdF9lbnRyeSgocG9zKS0+bWVtYmVyLm5leHQsIHR5cGVv
ZigqKHBvcykpLCBtZW1iZXIpKQotCi0jZGVmaW5lIG5sX2xpc3RfZm9yX2VhY2hfZW50cnlfc2Fm
ZShwb3MsIG4sIGhlYWQsIG1lbWJlcikJCQlcCi0JZm9yIChwb3MgPSBubF9saXN0X2VudHJ5KCho
ZWFkKS0+bmV4dCwgdHlwZW9mKCpwb3MpLCBtZW1iZXIpLAlcCi0JCW4gPSBubF9saXN0X2VudHJ5
KHBvcy0+bWVtYmVyLm5leHQsIHR5cGVvZigqcG9zKSwgbWVtYmVyKTsJXAotCSAgICAgJihwb3Mp
LT5tZW1iZXIgIT0gKGhlYWQpOyAJCQkJCVwKLQkgICAgIHBvcyA9IG4sIG4gPSBubF9saXN0X2Vu
dHJ5KG4tPm1lbWJlci5uZXh0LCB0eXBlb2YoKm4pLCBtZW1iZXIpKQotCi0jZGVmaW5lIG5sX2lu
aXRfbGlzdF9oZWFkKGhlYWQpIFwKLQlkbyB7IChoZWFkKS0+bmV4dCA9IChoZWFkKTsgKGhlYWQp
LT5wcmV2ID0gKGhlYWQpOyB9IHdoaWxlICgwKQotCi0jZW5kaWYKZGlmZiAtLWdpdCBhL3BhY2th
Z2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvbXNnLmggYi9wYWNrYWdlL2xp
YnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL21zZy5oCmRlbGV0ZWQgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCBiM2UyYjBiMmI5OTAuLjAwMDAwMDAwMDAwMAotLS0gYS9wYWNrYWdlL2xp
YnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL21zZy5oCisrKyAvZGV2L251bGwKQEAg
LTEsMzA4ICswLDAgQEAKLS8qCi0gKiBuZXRsaW5rL21zZy5jCQlOZXRsaW5rIE1lc3NhZ2VzIElu
dGVyZmFjZQotICoKLSAqCVRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJl
ZGlzdHJpYnV0ZSBpdCBhbmQvb3IKLSAqCW1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhl
IEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKLSAqCUxpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRo
ZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24gdmVyc2lvbiAyLjEKLSAqCW9mIHRoZSBMaWNlbnNl
LgotICoKLSAqIENvcHlyaWdodCAoYykgMjAwMy0yMDA2IFRob21hcyBHcmFmIDx0Z3JhZkBzdXVn
LmNoPgotICovCi0KLSNpZm5kZWYgTkVUTElOS19NU0dfSF8KLSNkZWZpbmUgTkVUTElOS19NU0df
SF8KLQotI2luY2x1ZGUgPG5ldGxpbmsvbmV0bGluay5oPgotI2luY2x1ZGUgPG5ldGxpbmsvb2Jq
ZWN0Lmg+Ci0KLSNpZmRlZiBfX2NwbHVzcGx1cwotZXh0ZXJuICJDIiB7Ci0jZW5kaWYKLQotc3Ry
dWN0IG5sYV9wb2xpY3k7Ci0KLSNkZWZpbmUgTkxfRE9OVFBBRAkwCi0KLS8qKgotICogQGluZ3Jv
dXAgbXNnCi0gKiBAYnJpZWYKLSAqIFdpbGwgY2F1c2UgdGhlIG5ldGxpbmsgcGlkIHRvIGJlIHNl
dCB0byB0aGUgcGlkIGFzc2lnbmVkIHRvCi0gKiB0aGUgbmV0bGluayBoYW5kbGUgKHNvY2tldCkg
anVzdCBiZWZvcmUgc2VuZGluZyB0aGUgbWVzc2FnZSBvZmYuCi0gKiBAbm90ZSBSZXF1aXJlcyB0
aGUgdXNlIG9mIG5sX3NlbmRfYXV0b19jb21wbGV0ZSgpIQotICovCi0jZGVmaW5lIE5MX0FVVE9f
UElECTAKLQotLyoqCi0gKiBAaW5ncm91cCBtc2cKLSAqIEBicmllZgotICogTWF5IGJlIHVzZWQg
dG8gcmVmZXIgdG8gYSBzZXF1ZW5jZSBudW1iZXIgd2hpY2ggc2hvdWxkIGJlCi0gKiBhdXRvbWF0
aWNhbGx5IHNldCBqdXN0IGJlZm9yZSBzZW5kaW5nIHRoZSBtZXNzYWdlIG9mZi4KLSAqIEBub3Rl
IFJlcXVpcmVzIHRoZSB1c2Ugb2Ygbmxfc2VuZF9hdXRvX2NvbXBsZXRlKCkhCi0gKi8KLSNkZWZp
bmUgTkxfQVVUT19TRVEJMAotCi0jZGVmaW5lIE5MX01TR19DUkVEX1BSRVNFTlQgMQotCi1zdHJ1
Y3QgbmxfbXNnCi17Ci0JaW50CQkJbm1fcHJvdG9jb2w7Ci0JaW50CQkJbm1fZmxhZ3M7Ci0Jc3Ry
dWN0IHNvY2thZGRyX25sCW5tX3NyYzsKLQlzdHJ1Y3Qgc29ja2FkZHJfbmwJbm1fZHN0OwotCXN0
cnVjdCB1Y3JlZAkJbm1fY3JlZHM7Ci0Jc3RydWN0IG5sbXNnaGRyICoJbm1fbmxoOwotCXNpemVf
dAkJCW5tX3NpemU7Ci0JaW50CQkJbm1fcmVmY250OwotfTsKLQotCi1zdHJ1Y3QgbmxfbXNnOwot
c3RydWN0IG5sX3RyZWU7Ci1zdHJ1Y3QgdWNyZWQ7Ci0KLS8qIG1lc3NhZ2UgcGFyc2luZyAqLwot
ZXh0ZXJuIGludAkJICBubG1zZ19vayhjb25zdCBzdHJ1Y3Qgbmxtc2doZHIgKiwgaW50KTsKLWV4
dGVybiBzdHJ1Y3Qgbmxtc2doZHIgKiAgbmxtc2dfbmV4dChzdHJ1Y3Qgbmxtc2doZHIgKiwgaW50
ICopOwotZXh0ZXJuIGludAkJICBubG1zZ19wYXJzZShzdHJ1Y3Qgbmxtc2doZHIgKiwgaW50LCBz
dHJ1Y3QgbmxhdHRyICoqLAotCQkJCSAgICAgIGludCwgc3RydWN0IG5sYV9wb2xpY3kgKik7Ci1l
eHRlcm4gaW50CQkgIG5sbXNnX3ZhbGlkYXRlKHN0cnVjdCBubG1zZ2hkciAqLCBpbnQsIGludCwK
LQkJCQkJIHN0cnVjdCBubGFfcG9saWN5ICopOwotCi1leHRlcm4gc3RydWN0IG5sX21zZyAqCSAg
bmxtc2dfYWxsb2Modm9pZCk7Ci1leHRlcm4gc3RydWN0IG5sX21zZyAqCSAgbmxtc2dfYWxsb2Nf
c2l6ZShzaXplX3QpOwotZXh0ZXJuIHN0cnVjdCBubF9tc2cgKgkgIG5sbXNnX2FsbG9jX3NpbXBs
ZShpbnQsIGludCk7Ci1leHRlcm4gdm9pZAkJICBubG1zZ19zZXRfZGVmYXVsdF9zaXplKHNpemVf
dCk7Ci1leHRlcm4gc3RydWN0IG5sX21zZyAqCSAgbmxtc2dfaW5oZXJpdChzdHJ1Y3Qgbmxtc2do
ZHIgKik7Ci1leHRlcm4gc3RydWN0IG5sX21zZyAqCSAgbmxtc2dfY29udmVydChzdHJ1Y3Qgbmxt
c2doZHIgKik7Ci1leHRlcm4gdm9pZCAqCQkgIG5sbXNnX3Jlc2VydmUoc3RydWN0IG5sX21zZyAq
LCBzaXplX3QsIGludCk7Ci1leHRlcm4gaW50CQkgIG5sbXNnX2FwcGVuZChzdHJ1Y3QgbmxfbXNn
ICosIHZvaWQgKiwgc2l6ZV90LCBpbnQpOwotCi1leHRlcm4gc3RydWN0IG5sbXNnaGRyICogIG5s
bXNnX3B1dChzdHJ1Y3QgbmxfbXNnICosIHVpbnQzMl90LCB1aW50MzJfdCwKLQkJCQkgICAgaW50
LCBpbnQsIGludCk7Ci1leHRlcm4gdm9pZAkJICBubG1zZ19mcmVlKHN0cnVjdCBubF9tc2cgKik7
Ci0KLWV4dGVybiBpbnQJCSAgbmxfbXNnX3BhcnNlKHN0cnVjdCBubF9tc2cgKiwKLQkJCQkgICAg
ICAgdm9pZCAoKmNiKShzdHJ1Y3Qgbmxfb2JqZWN0ICosIHZvaWQgKiksCi0JCQkJICAgICAgIHZv
aWQgKik7Ci0KLWV4dGVybiB2b2lkCQlubF9tc2dfZHVtcChzdHJ1Y3QgbmxfbXNnICosIEZJTEUg
Kik7Ci0KLS8qKgotICogbGVuZ3RoIG9mIG5ldGxpbmsgbWVzc2FnZSBub3QgaW5jbHVkaW5nIHBh
ZGRpbmcKLSAqIEBhcmcgcGF5bG9hZAkJbGVuZ3RoIG9mIG1lc3NhZ2UgcGF5bG9hZAotICovCi1z
dGF0aWMgaW5saW5lIGludCBubG1zZ19tc2dfc2l6ZShpbnQgcGF5bG9hZCkKLXsKLQlyZXR1cm4g
TkxNU0dfSERSTEVOICsgcGF5bG9hZDsKLX0KLQotLyoqCi0gKiBsZW5ndGggb2YgbmV0bGluayBt
ZXNzYWdlIGluY2x1ZGluZyBwYWRkaW5nCi0gKiBAYXJnIHBheWxvYWQJCWxlbmd0aCBvZiBtZXNz
YWdlIHBheWxvYWQKLSAqLwotc3RhdGljIGlubGluZSBpbnQgbmxtc2dfdG90YWxfc2l6ZShpbnQg
cGF5bG9hZCkKLXsKLQlyZXR1cm4gTkxNU0dfQUxJR04obmxtc2dfbXNnX3NpemUocGF5bG9hZCkp
OwotfQotCi0vKioKLSAqIGxlbmd0aCBvZiBwYWRkaW5nIGF0IHRoZSBtZXNzYWdlJ3MgdGFpbAot
ICogQGFyZyBwYXlsb2FkCQlsZW5ndGggb2YgbWVzc2FnZSBwYXlsb2FkCi0gKi8KLXN0YXRpYyBp
bmxpbmUgaW50IG5sbXNnX3BhZGxlbihpbnQgcGF5bG9hZCkKLXsKLQlyZXR1cm4gbmxtc2dfdG90
YWxfc2l6ZShwYXlsb2FkKSAtIG5sbXNnX21zZ19zaXplKHBheWxvYWQpOwotfQotCi0vKioKLSAq
IGhlYWQgb2YgbWVzc2FnZSBwYXlsb2FkCi0gKiBAYXJnIG5saAkJbmV0bGluayBtZXNzc2FnZSBo
ZWFkZXIKLSAqLwotc3RhdGljIGlubGluZSB2b2lkICpubG1zZ19kYXRhKGNvbnN0IHN0cnVjdCBu
bG1zZ2hkciAqbmxoKQotewotCXJldHVybiAodW5zaWduZWQgY2hhciAqKSBubGggKyBOTE1TR19I
RFJMRU47Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZCAqbmxtc2dfdGFpbChjb25zdCBzdHJ1Y3Qg
bmxtc2doZHIgKm5saCkKLXsKLQlyZXR1cm4gKHVuc2lnbmVkIGNoYXIgKikgbmxoICsgTkxNU0df
QUxJR04obmxoLT5ubG1zZ19sZW4pOwotfQotCi0vKioKLSAqIGxlbmd0aCBvZiBtZXNzYWdlIHBh
eWxvYWQKLSAqIEBhcmcgbmxoCQluZXRsaW5rIG1lc3NhZ2UgaGVhZGVyCi0gKi8KLXN0YXRpYyBp
bmxpbmUgaW50IG5sbXNnX2xlbihjb25zdCBzdHJ1Y3Qgbmxtc2doZHIgKm5saCkKLXsKLQlyZXR1
cm4gbmxoLT5ubG1zZ19sZW4gLSBOTE1TR19IRFJMRU47Ci19Ci0KLS8qKgotICogaGVhZCBvZiBh
dHRyaWJ1dGVzIGRhdGEKLSAqIEBhcmcgbmxoCQluZXRsaW5rIG1lc3NhZ2UgaGVhZGVyCi0gKiBA
YXJnIGhkcmxlbgkJbGVuZ3RoIG9mIGZhbWlseSBzcGVjaWZpYyBoZWFkZXIKLSAqLwotc3RhdGlj
IGlubGluZSBzdHJ1Y3QgbmxhdHRyICpubG1zZ19hdHRyZGF0YShjb25zdCBzdHJ1Y3Qgbmxtc2do
ZHIgKm5saCwgaW50IGhkcmxlbikKLXsKLQl1bnNpZ25lZCBjaGFyICpkYXRhID0gKHVuc2lnbmVk
IGNoYXIqKW5sbXNnX2RhdGEobmxoKTsKLQlyZXR1cm4gKHN0cnVjdCBubGF0dHIgKikgKGRhdGEg
KyBOTE1TR19BTElHTihoZHJsZW4pKTsKLX0KLQotLyoqCi0gKiBsZW5ndGggb2YgYXR0cmlidXRl
cyBkYXRhCi0gKiBAYXJnIG5saAkJbmV0bGluayBtZXNzYWdlIGhlYWRlcgotICogQGFyZyBoZHJs
ZW4JCWxlbmd0aCBvZiBmYW1pbHkgc3BlY2lmaWMgaGVhZGVyCi0gKi8KLXN0YXRpYyBpbmxpbmUg
aW50IG5sbXNnX2F0dHJsZW4oY29uc3Qgc3RydWN0IG5sbXNnaGRyICpubGgsIGludCBoZHJsZW4p
Ci17Ci0JcmV0dXJuIG5sbXNnX2xlbihubGgpIC0gTkxNU0dfQUxJR04oaGRybGVuKTsKLX0KLQot
c3RhdGljIGlubGluZSBpbnQgbmxtc2dfdmFsaWRfaGRyKGNvbnN0IHN0cnVjdCBubG1zZ2hkciAq
bmxoLCBpbnQgaGRybGVuKQotewotCWlmIChubGgtPm5sbXNnX2xlbiA8ICh1aW50KW5sbXNnX21z
Z19zaXplKGhkcmxlbikpCi0JCXJldHVybiAwOwotCi0JcmV0dXJuIDE7Ci19Ci0KLQotc3RhdGlj
IGlubGluZSB2b2lkIG5sbXNnX3NldF9wcm90byhzdHJ1Y3QgbmxfbXNnICptc2csIGludCBwcm90
b2NvbCkKLXsKLQltc2ctPm5tX3Byb3RvY29sID0gcHJvdG9jb2w7Ci19Ci0KLXN0YXRpYyBpbmxp
bmUgaW50IG5sbXNnX2dldF9wcm90byhzdHJ1Y3QgbmxfbXNnICptc2cpCi17Ci0JcmV0dXJuIG1z
Zy0+bm1fcHJvdG9jb2w7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgc2l6ZV90IG5sbXNnX2dldF9tYXhf
c2l6ZShzdHJ1Y3QgbmxfbXNnICptc2cpCi17Ci0JcmV0dXJuIG1zZy0+bm1fc2l6ZTsKLX0KLQot
c3RhdGljIGlubGluZSB2b2lkIG5sbXNnX3NldF9zcmMoc3RydWN0IG5sX21zZyAqbXNnLCBzdHJ1
Y3Qgc29ja2FkZHJfbmwgKmFkZHIpCi17Ci0JbWVtY3B5KCZtc2ctPm5tX3NyYywgYWRkciwgc2l6
ZW9mKCphZGRyKSk7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgc3RydWN0IHNvY2thZGRyX25sICpubG1z
Z19nZXRfc3JjKHN0cnVjdCBubF9tc2cgKm1zZykKLXsKLQlyZXR1cm4gJm1zZy0+bm1fc3JjOwot
fQotCi1zdGF0aWMgaW5saW5lIHZvaWQgbmxtc2dfc2V0X2RzdChzdHJ1Y3QgbmxfbXNnICptc2cs
IHN0cnVjdCBzb2NrYWRkcl9ubCAqYWRkcikKLXsKLQltZW1jcHkoJm1zZy0+bm1fZHN0LCBhZGRy
LCBzaXplb2YoKmFkZHIpKTsKLX0KLQotc3RhdGljIGlubGluZSBzdHJ1Y3Qgc29ja2FkZHJfbmwg
Km5sbXNnX2dldF9kc3Qoc3RydWN0IG5sX21zZyAqbXNnKQotewotCXJldHVybiAmbXNnLT5ubV9k
c3Q7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZCBubG1zZ19zZXRfY3JlZHMoc3RydWN0IG5sX21z
ZyAqbXNnLCBzdHJ1Y3QgdWNyZWQgKmNyZWRzKQotewotCW1lbWNweSgmbXNnLT5ubV9jcmVkcywg
Y3JlZHMsIHNpemVvZigqY3JlZHMpKTsKLQltc2ctPm5tX2ZsYWdzIHw9IE5MX01TR19DUkVEX1BS
RVNFTlQ7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgc3RydWN0IHVjcmVkICpubG1zZ19nZXRfY3JlZHMo
c3RydWN0IG5sX21zZyAqbXNnKQotewotCWlmIChtc2ctPm5tX2ZsYWdzICYgTkxfTVNHX0NSRURf
UFJFU0VOVCkKLQkJcmV0dXJuICZtc2ctPm5tX2NyZWRzOwotCXJldHVybiBOVUxMOwotfQotCi0v
KioKLSAqIFJldHVybiBhY3R1YWwgbmV0bGluayBtZXNzYWdlCi0gKiBAYXJnIG4JCW5ldGxpbmsg
bWVzc2FnZQotICogCi0gKiBSZXR1cm5zIHRoZSBhY3R1YWwgbmV0bGluayBtZXNzYWdlIGNhc3Rl
ZCB0byB0aGUgdHlwZSBvZiB0aGUgbmV0bGluawotICogbWVzc2FnZSBoZWFkZXIuCi0gKiAKLSAq
IEByZXR1cm4gQSBwb2ludGVyIHRvIHRoZSBuZXRsaW5rIG1lc3NhZ2UuCi0gKi8KLXN0YXRpYyBp
bmxpbmUgc3RydWN0IG5sbXNnaGRyICpubG1zZ19oZHIoc3RydWN0IG5sX21zZyAqbikKLXsKLQly
ZXR1cm4gbi0+bm1fbmxoOwotfQotCi0vKioKLSAqIEFjcXVpcmUgYSByZWZlcmVuY2Ugb24gYSBu
ZXRsaW5rIG1lc3NhZ2UKLSAqIEBhcmcgbXNnCQltZXNzYWdlIHRvIGFjcXVpcmUgcmVmZXJlbmNl
IGZyb20KLSAqLwotc3RhdGljIGlubGluZSB2b2lkIG5sbXNnX2dldChzdHJ1Y3QgbmxfbXNnICpt
c2cpCi17Ci0JbXNnLT5ubV9yZWZjbnQrKzsKLX0KLQotLyoqCi0gKiBFeHBhbmQgbWF4aW11bSBw
YXlsb2FkIHNpemUgb2YgYSBuZXRsaW5rIG1lc3NhZ2UKLSAqIEBhcmcgbgkJTmV0bGluayBtZXNz
YWdlLgotICogQGFyZyBuZXdsZW4JCU5ldyBtYXhpbXVtIHBheWxvYWQgc2l6ZS4KLSAqCi0gKiBS
ZWFsbG9jYXRlcyB0aGUgcGF5bG9hZCBzZWN0aW9uIG9mIGEgbmV0bGluayBtZXNzYWdlIGFuZCBp
bmNyZWFzZXMKLSAqIHRoZSBtYXhpbXVtIHBheWxvYWQgc2l6ZSBvZiB0aGUgbWVzc2FnZS4KLSAq
Ci0gKiBAbm90ZSBBbnkgcG9pbnRlcnMgcG9pbnRpbmcgdG8gb2xkIHBheWxvYWQgYmxvY2sgd2ls
bCBiZSBzdGFsZSBhbmQKLSAqICAgICAgIG5lZWQgdG8gYmUgcmVmZXRjaGVkLiBUaGVyZm9yZSwg
ZG8gbm90IGV4cGFuZCB3aGlsZSBjb25zdHJ1Y3RpbmcKLSAqICAgICAgIG5lc3RlZCBhdHRyaWJ1
dGVzIG9yIHdoaWxlIHJlc2VydmVkIGRhdGEgYmxvY2tzIGFyZSBoZWxkLgotICoKLSAqIEByZXR1
cm4gMCBvbiBzdWNjZXNzIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29kZS4KLSAqLwotc3RhdGljIGlu
bGluZSBpbnQgbmxtc2dfZXhwYW5kKHN0cnVjdCBubF9tc2cgKm4sIHNpemVfdCBuZXdsZW4pCi17
Ci0Jdm9pZCAqdG1wOwotCi0JaWYgKG5ld2xlbiA8PSBuLT5ubV9zaXplKQotCQlyZXR1cm4gLU5M
RV9JTlZBTDsKLQotCXRtcCA9IHJlYWxsb2Mobi0+bm1fbmxoLCBuZXdsZW4pOwotCWlmICh0bXAg
PT0gTlVMTCkKLQkJcmV0dXJuIC1OTEVfTk9NRU07Ci0KLQluLT5ubV9ubGggPSAoc3RydWN0IG5s
bXNnaGRyKil0bXA7Ci0Jbi0+bm1fc2l6ZSA9IG5ld2xlbjsKLQotCXJldHVybiAwOwotfQotCi0K
LS8qKgotICogQG5hbWUgSXRlcmF0b3JzCi0gKiBAewotICovCi0KLS8qKgotICogQGluZ3JvdXAg
bXNnCi0gKiBJdGVyYXRlIG92ZXIgYSBzdHJlYW0gb2YgYXR0cmlidXRlcyBpbiBhIG1lc3NhZ2UK
LSAqIEBhcmcgcG9zCWxvb3AgY291bnRlciwgc2V0IHRvIGN1cnJlbnQgYXR0cmlidXRlCi0gKiBA
YXJnIG5saAluZXRsaW5rIG1lc3NhZ2UgaGVhZGVyCi0gKiBAYXJnIGhkcmxlbglsZW5ndGggb2Yg
ZmFtaWx5IGhlYWRlcgotICogQGFyZyByZW0JaW5pdGlhbGl6ZWQgdG8gbGVuLCBob2xkcyBieXRl
cyBjdXJyZW50bHkgcmVtYWluaW5nIGluIHN0cmVhbQotICovCi0jZGVmaW5lIG5sbXNnX2Zvcl9l
YWNoX2F0dHIocG9zLCBubGgsIGhkcmxlbiwgcmVtKSBcCi0JbmxhX2Zvcl9lYWNoX2F0dHIocG9z
LCBubG1zZ19hdHRyZGF0YShubGgsIGhkcmxlbiksIFwKLQkJCSAgbmxtc2dfYXR0cmxlbihubGgs
IGhkcmxlbiksIHJlbSkKLQotLyoqCi0gKiBJdGVyYXRlIG92ZXIgYSBzdHJlYW0gb2YgbWVzc2Fn
ZXMKLSAqIEBhcmcgcG9zCWxvb3AgY291bnRlciwgc2V0IHRvIGN1cnJlbnQgbWVzc2FnZQotICog
QGFyZyBoZWFkCWhlYWQgb2YgbWVzc2FnZSBzdHJlYW0KLSAqIEBhcmcgbGVuCWxlbmd0aCBvZiBt
ZXNzYWdlIHN0cmVhbQotICogQGFyZyByZW0JaW5pdGlhbGl6ZWQgdG8gbGVuLCBob2xkcyBieXRl
cyBjdXJyZW50bHkgcmVtYWluaW5nIGluIHN0cmVhbQotICovCi0jZGVmaW5lIG5sbXNnX2Zvcl9l
YWNoX21zZyhwb3MsIGhlYWQsIGxlbiwgcmVtKSBcCi0JZm9yIChwb3MgPSBoZWFkLCByZW0gPSBs
ZW47IFwKLQkgICAgIG5sbXNnX29rKHBvcywgcmVtKTsgXAotCSAgICAgcG9zID0gbmxtc2dfbmV4
dChwb3MsICYocmVtKSkpCi0KLS8qKiBAfSAqLwotCi0jaWZkZWYgX19jcGx1c3BsdXMKLX0KLSNl
bmRpZgotCi0jZW5kaWYKZGlmZiAtLWdpdCBhL3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9p
bmNsdWRlL25ldGxpbmsvbmV0bGluay1jb21wYXQuaCBiL3BhY2thZ2UvbGlicy9saWJubC10aW55
L3NyYy9pbmNsdWRlL25ldGxpbmsvbmV0bGluay1jb21wYXQuaApkZWxldGVkIGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMTdlYzlmYzhkMWRmLi4wMDAwMDAwMDAwMDAKLS0tIGEvcGFja2FnZS9saWJz
L2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay9uZXRsaW5rLWNvbXBhdC5oCisrKyAvZGV2
L251bGwKQEAgLTEsNTAgKzAsMCBAQAotLyoKLSAqIG5ldGxpbmsvbmV0bGluay1jb21wYXQuaAlO
ZXRsaW5rIENvbXBhdGFiaWxpdHkKLSAqCi0gKglUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2Fy
ZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCi0gKgltb2RpZnkgaXQgdW5kZXIgdGhl
IHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCi0gKglMaWNlbnNlIGFzIHB1
Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIHZlcnNpb24gMi4xCi0gKglv
ZiB0aGUgTGljZW5zZS4KLSAqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMDMtMjAwNiBUaG9tYXMgR3Jh
ZiA8dGdyYWZAc3V1Zy5jaD4KLSAqLwotCi0jaWZuZGVmIE5FVExJTktfQ09NUEFUX0hfCi0jZGVm
aW5lIE5FVExJTktfQ09NUEFUX0hfCi0KLSNpZiAhZGVmaW5lZCBfTElOVVhfU09DS0VUX0ggJiYg
IWRlZmluZWQgX0JJVFNfU09DS0FERFJfSAotdHlwZWRlZiB1bnNpZ25lZCBzaG9ydCAgc2FfZmFt
aWx5X3Q7Ci0jZW5kaWYKLQotI2lmbmRlZiBJRk5BTVNJWiAKLS8qKiBNYXhpbXVtIGxlbmd0aCBv
ZiBhIGludGVyZmFjZSBuYW1lICovCi0jZGVmaW5lIElGTkFNU0laIDE2Ci0jZW5kaWYKLQotLyog
cGF0Y2ggMi40LnggaWZfYXJwICovCi0jaWZuZGVmIEFSUEhSRF9JTkZJTklCQU5ECi0jZGVmaW5l
IEFSUEhSRF9JTkZJTklCQU5EIDMyCi0jZW5kaWYKLQotLyogcGF0Y2ggMi40LnggZXRoIGhlYWRl
ciBmaWxlICovCi0jaWZuZGVmIEVUSF9QX01QTFNfVUMKLSNkZWZpbmUgRVRIX1BfTVBMU19VQyAg
MHg4ODQ3IAotI2VuZGlmCi0KLSNpZm5kZWYgRVRIX1BfTVBMU19NQwotI2RlZmluZSBFVEhfUF9N
UExTX01DICAgMHg4ODQ4Ci0jZW5kaWYKLQotI2lmbmRlZiAgRVRIX1BfRURQMgotI2RlZmluZSBF
VEhfUF9FRFAyICAgICAgMHg4OEEyCi0jZW5kaWYKLQotI2lmbmRlZiBFVEhfUF9IRExDCi0jZGVm
aW5lIEVUSF9QX0hETEMgICAgICAweDAwMTkgCi0jZW5kaWYKLQotI2lmbmRlZiBBRl9MTEMKLSNk
ZWZpbmUgQUZfTExDCQkyNgotI2VuZGlmCi0KLSNlbmRpZgpkaWZmIC0tZ2l0IGEvcGFja2FnZS9s
aWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay9uZXRsaW5rLWtlcm5lbC5oIGIvcGFj
a2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay9uZXRsaW5rLWtlcm5lbC5o
CmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCBhMGY1NTM1NjY0ZmMuLjAwMDAwMDAwMDAw
MAotLS0gYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL25ldGxp
bmsta2VybmVsLmgKKysrIC9kZXYvbnVsbApAQCAtMSwxOTYgKzAsMCBAQAotI2lmbmRlZiBfX0xJ
TlVYX05FVExJTktfSAotI2RlZmluZSBfX0xJTlVYX05FVExJTktfSAotCi0vKioKLSAqIE5ldGxp
bmsgc29ja2V0IGFkZHJlc3MKLSAqIEBpbmdyb3VwIG5sCi0gKi8KLXN0cnVjdCBzb2NrYWRkcl9u
bAotewotCS8qKiBzb2NrZXQgZmFtaWx5IChBRl9ORVRMSU5LKSAqLwotCXNhX2ZhbWlseV90ICAg
ICBubF9mYW1pbHk7Ci0KLQkvKiogUGFkZGluZyAodW51c2VkKSAqLwotCXVuc2lnbmVkIHNob3J0
ICBubF9wYWQ7Ci0KLQkvKiogVW5pcXVlIHByb2Nlc3MgSUQgICovCi0JdWludDMyX3QgICAgICAg
IG5sX3BpZDsKLQotCS8qKiBNdWx0aWNhc3QgZ3JvdXAgc3Vic2NyaXB0aW9ucyAqLwotCXVpbnQz
Ml90ICAgICAgICBubF9ncm91cHM7Ci19OwotCi0vKioKLSAqIE5ldGxpbmsgbWVzc2FnZSBoZWFk
ZXIKLSAqIEBpbmdyb3VwIG1zZwotICovCi1zdHJ1Y3Qgbmxtc2doZHIKLXsKLQkvKioKLQkgKiBM
ZW5ndGggb2YgbWVzc2FnZSBpbmNsdWRpbmcgaGVhZGVyLgotCSAqLwotCXVpbnQzMl90CW5sbXNn
X2xlbjsKLQotCS8qKgotCSAqIE1lc3NhZ2UgdHlwZSAoY29udGVudCB0eXBlKQotCSAqLwotCXVp
bnQxNl90CW5sbXNnX3R5cGU7Ci0KLQkvKioKLQkgKiBNZXNzYWdlIGZsYWdzCi0JICovCi0JdWlu
dDE2X3QJbmxtc2dfZmxhZ3M7Ci0KLQkvKioKLQkgKiBTZXF1ZW5jZSBudW1iZXIKLQkgKi8KLQl1
aW50MzJfdAlubG1zZ19zZXE7Ci0KLQkvKioKLQkgKiBOZXRsaW5rIFBJRCBvZiB0aGUgcHJvY2Nl
c3Mgc2VuZGluZyB0aGUgbWVzc2FnZS4KLQkgKi8KLQl1aW50MzJfdAlubG1zZ19waWQ7Ci19Owot
Ci0vKioKLSAqIEBuYW1lIFN0YW5kYXJkIG1lc3NhZ2UgZmxhZ3MKLSAqIEB7Ci0gKi8KLQotLyoq
Ci0gKiBNdXN0IGJlIHNldCBvbiBhbGwgcmVxdWVzdCBtZXNzYWdlcyAodHlwaWNhbGx5IGZyb20g
dXNlciBzcGFjZSB0bwotICoga2VybmVsIHNwYWNlKS4KLSAqIEBpbmdyb3VwIG1zZwotICovCi0j
ZGVmaW5lIE5MTV9GX1JFUVVFU1QJCTEKLQotLyoqCi0gKiBJbmRpY2F0ZXMgdGhlIG1lc3NhZ2Ug
aXMgcGFydCBvZiBhIG11bHRpcGFydCBtZXNzYWdlIHRlcm1pbmF0ZWQKLSAqIGJ5IE5MTVNHX0RP
TkUuCi0gKi8KLSNkZWZpbmUgTkxNX0ZfTVVMVEkJCTIKLQotLyoqCi0gKiBSZXF1ZXN0IGZvciBh
biBhY2tub3dsZWRnbWVudCBvbiBzdWNjZXNzLgotICovCi0jZGVmaW5lIE5MTV9GX0FDSwkJNAot
Ci0vKioKLSAqIEVjaG8gdGhpcyByZXF1ZXN0Ci0gKi8KLSNkZWZpbmUgTkxNX0ZfRUNITwkJOAot
Ci0vKiogQH0gKi8KLQotLyoqCi0gKiBAbmFtZSBBZGRpdGlvbmFsIG1lc3NhZ2UgZmxhZ3MgZm9y
IEdFVCByZXF1ZXN0cwotICogQHsKLSAqLwotCi0vKioKLSAqIFJldHVybiB0aGUgY29tcGxldGUg
dGFibGUgaW5zdGVhZCBvZiBhIHNpbmdsZSBlbnRyeS4KLSAqIEBpbmdyb3VwIG1zZwotICovCi0j
ZGVmaW5lIE5MTV9GX1JPT1QJMHgxMDAKLQotLyoqCi0gKiBSZXR1cm4gYWxsIGVudHJpZXMgbWF0
Y2hpbmcgY3JpdGVyaWEgcGFzc2VkIGluIG1lc3NhZ2UgY29udGVudC4KLSAqLwotI2RlZmluZSBO
TE1fRl9NQVRDSAkweDIwMAotCi0vKioKLSAqIFJldHVybiBhbiBhdG9taWMgc25hcHNob3Qgb2Yg
dGhlIHRhYmxlIGJlaW5nIHJlZmVyZW5jZWQuIFRoaXMKLSAqIG1heSByZXF1aXJlIHNwZWNpYWwg
cHJpdmlsZWdlcyBiZWNhdXNlIGl0IGhhcyB0aGUgcG90ZW50aWFsIHRvCi0gKiBpbnRlcnJ1cHQg
c2VydmljZSBpbiB0aGUgRkUgZm9yIGEgbG9uZ2VyIHRpbWUuCi0gKi8KLSNkZWZpbmUgTkxNX0Zf
QVRPTUlDCTB4NDAwCi0KLS8qKgotICogRHVtcCBhbGwgZW50cmllcwotICovCi0jZGVmaW5lIE5M
TV9GX0RVTVAJKE5MTV9GX1JPT1R8TkxNX0ZfTUFUQ0gpCi0KLS8qKiBAfSAqLwotCi0vKioKLSAq
IEBuYW1lIEFkZGl0aW9uYWwgbWVzc3NhZ2UgZmxhZ3MgZm9yIE5FVyByZXF1ZXN0cwotICogQHsK
LSAqLwotCi0vKioKLSAqIFJlcGxhY2UgZXhpc3RpbmcgbWF0Y2hpbmcgY29uZmlnIG9iamVjdCB3
aXRoIHRoaXMgcmVxdWVzdC4KLSAqIEBpbmdyb3VwIG1zZwotICovCi0jZGVmaW5lIE5MTV9GX1JF
UExBQ0UJMHgxMDAKLQotLyoqCi0gKiBEb24ndCByZXBsYWNlIHRoZSBjb25maWcgb2JqZWN0IGlm
IGl0IGFscmVhZHkgZXhpc3RzLgotICovCi0jZGVmaW5lIE5MTV9GX0VYQ0wJMHgyMDAKLQotLyoq
Ci0gKiBDcmVhdGUgY29uZmlnIG9iamVjdCBpZiBpdCBkb2Vzbid0IGFscmVhZHkgZXhpc3QuCi0g
Ki8KLSNkZWZpbmUgTkxNX0ZfQ1JFQVRFCTB4NDAwCi0KLS8qKgotICogQWRkIHRvIHRoZSBlbmQg
b2YgdGhlIG9iamVjdCBsaXN0LgotICovCi0jZGVmaW5lIE5MTV9GX0FQUEVORAkweDgwMAotCi0v
KiogQH0gKi8KLQotLyoqCi0gKiBAbmFtZSBTdGFuZGFyZCBNZXNzYWdlIHR5cGVzCi0gKiBAewot
ICovCi0KLS8qKgotICogTm8gb3BlcmF0aW9uLCBtZXNzYWdlIG11c3QgYmUgaWdub3JlZAotICog
QGluZ3JvdXAgbXNnCi0gKi8KLSNkZWZpbmUgTkxNU0dfTk9PUAkJMHgxCi0KLS8qKgotICogVGhl
IG1lc3NhZ2Ugc2lnbmFscyBhbiBlcnJvciBhbmQgdGhlIHBheWxvYWQgY29udGFpbnMgYSBubG1z
Z2VycgotICogc3RydWN0dXJlLiBUaGlzIGNhbiBiZSBsb29rZWQgYXQgYXMgYSBOQUNLIGFuZCB0
eXBpY2FsbHkgaXQgaXMKLSAqIGZyb20gRkVDIHRvIENQQy4KLSAqLwotI2RlZmluZSBOTE1TR19F
UlJPUgkJMHgyCi0KLS8qKgotICogTWVzc2FnZSB0ZXJtaW5hdGVzIGEgbXVsdGlwYXJ0IG1lc3Nh
Z2UuCi0gKi8KLSNkZWZpbmUgTkxNU0dfRE9ORQkJMHgzCi0KLS8qKgotICogVGhlIG1lc3NhZ2Ug
c2lnbmFscyB0aGF0IGRhdGEgZ290IGxvc3QKLSAqLwotI2RlZmluZSBOTE1TR19PVkVSUlVOCQkw
eDQKLQotLyoqCi0gKiBMb3dlciBsaW1pdCBvZiByZXNlcnZlZCBtZXNzYWdlIHR5cGVzCi0gKi8K
LSNkZWZpbmUgTkxNU0dfTUlOX1RZUEUJCTB4MTAKLQotLyoqIEB9ICovCi0KLS8qKgotICogTmV0
bGluayBlcnJvciBtZXNzYWdlCi0gKiBAaW5ncm91cCBtc2cKLSAqLwotc3RydWN0IG5sbXNnZXJy
Ci17Ci0JLyoqIEVycm9yIGNvZGUgKGVycm5vIG51bWJlcikgKi8KLQlpbnQJCWVycm9yOwotCi0J
LyoqIE9yaWdpbmFsIG5ldGxpbmsgbWVzc2FnZSBjYXVzaW5nIHRoZSBlcnJvciAqLwotCXN0cnVj
dCBubG1zZ2hkcgltc2c7Ci19OwotCi1zdHJ1Y3QgbmxfcGt0aW5mbwotewotCV9fdTMyCWdyb3Vw
OwotfTsKLQotI2VuZGlmCS8qIF9fTElOVVhfTkVUTElOS19IICovCmRpZmYgLS1naXQgYS9wYWNr
YWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL25ldGxpbmsuaCBiL3BhY2th
Z2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvbmV0bGluay5oCmRlbGV0ZWQg
ZmlsZSBtb2RlIDEwMDY0NAppbmRleCBjMzMzYzUwM2RkODEuLjAwMDAwMDAwMDAwMAotLS0gYS9w
YWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL25ldGxpbmsuaAorKysg
L2Rldi9udWxsCkBAIC0xLDgyICswLDAgQEAKLS8qCi0gKiBuZXRsaW5rL25ldGxpbmsuaAkJTmV0
bGluayBJbnRlcmZhY2UKLSAqCi0gKglUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91
IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCi0gKgltb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1z
IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCi0gKglMaWNlbnNlIGFzIHB1Ymxpc2hl
ZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIHZlcnNpb24gMi4xCi0gKglvZiB0aGUg
TGljZW5zZS4KLSAqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMDMtMjAwNiBUaG9tYXMgR3JhZiA8dGdy
YWZAc3V1Zy5jaD4KLSAqLwotCi0jaWZuZGVmIE5FVExJTktfTkVUTElOS19IXwotI2RlZmluZSBO
RVRMSU5LX05FVExJTktfSF8KLQotI2luY2x1ZGUgPHN0ZGlvLmg+Ci0jaW5jbHVkZSA8c3RkaW50
Lmg+Ci0jaW5jbHVkZSA8c3RyaW5nLmg+Ci0jaW5jbHVkZSA8c3RkbGliLmg+Ci0jaW5jbHVkZSA8
cG9sbC5oPgotI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4KLSNpbmNsdWRlIDxzeXMvdHlwZXMuaD4K
LSNpbmNsdWRlIDxzeXMvdGltZS5oPgotI2luY2x1ZGUgPG5ldGRiLmg+Ci0jaW5jbHVkZSA8bmV0
bGluay9uZXRsaW5rLWNvbXBhdC5oPgotI2luY2x1ZGUgPGxpbnV4L25ldGxpbmsuaD4KLSNpbmNs
dWRlIDxsaW51eC9nZW5ldGxpbmsuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL3ZlcnNpb24uaD4KLSNp
bmNsdWRlIDxuZXRsaW5rL2Vycm5vLmg+Ci0jaW5jbHVkZSA8bmV0bGluay90eXBlcy5oPgotI2lu
Y2x1ZGUgPG5ldGxpbmsvaGFuZGxlcnMuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL3NvY2tldC5oPgot
Ci0jaWZkZWYgX19jcGx1c3BsdXMKLWV4dGVybiAiQyIgewotI2VuZGlmCi0KLWV4dGVybiBpbnQg
bmxfZGVidWc7Ci1leHRlcm4gc3RydWN0IG5sX2R1bXBfcGFyYW1zIG5sX2RlYnVnX2RwOwotCi0v
KiBDb25uZWN0aW9uIE1hbmFnZW1lbnQgKi8KLWV4dGVybiBpbnQJCQlubF9jb25uZWN0KHN0cnVj
dCBubF9zb2NrICosIGludCk7Ci1leHRlcm4gdm9pZAkJCW5sX2Nsb3NlKHN0cnVjdCBubF9zb2Nr
ICopOwotCi0vKiBTZW5kICovCi1leHRlcm4gaW50CQkJbmxfc2VuZHRvKHN0cnVjdCBubF9zb2Nr
ICosIHZvaWQgKiwgc2l6ZV90KTsKLWV4dGVybiBpbnQJCQlubF9zZW5kbXNnKHN0cnVjdCBubF9z
b2NrICosIHN0cnVjdCBubF9tc2cgKiwKLQkJCQkJICAgc3RydWN0IG1zZ2hkciAqKTsKLWV4dGVy
biBpbnQJCQlubF9zZW5kKHN0cnVjdCBubF9zb2NrICosIHN0cnVjdCBubF9tc2cgKik7Ci1leHRl
cm4gaW50CQkJbmxfc2VuZF9hdXRvX2NvbXBsZXRlKHN0cnVjdCBubF9zb2NrICosCi0JCQkJCQkg
ICAgICBzdHJ1Y3QgbmxfbXNnICopOwotZXh0ZXJuIGludAkJCW5sX3NlbmRfc2ltcGxlKHN0cnVj
dCBubF9zb2NrICosIGludCwgaW50LAotCQkJCQkgICAgICAgdm9pZCAqLCBzaXplX3QpOwotCi0v
KiBSZWNlaXZlICovCi1leHRlcm4gaW50CQkJbmxfcmVjdihzdHJ1Y3Qgbmxfc29jayAqLAotCQkJ
CQlzdHJ1Y3Qgc29ja2FkZHJfbmwgKiwgdW5zaWduZWQgY2hhciAqKiwKLQkJCQkJc3RydWN0IHVj
cmVkICoqKTsKLWV4dGVybiBpbnQJCQlubF9yZWN2bXNncyhzdHJ1Y3Qgbmxfc29jayAqc2ssIHN0
cnVjdCBubF9jYiAqY2IpOwotCi1leHRlcm4gaW50CQkJbmxfd2FpdF9mb3JfYWNrKHN0cnVjdCBu
bF9zb2NrICopOwotCi0vKiBOZXRsaW5rIEZhbWlseSBUcmFuc2xhdGlvbnMgKi8KLWV4dGVybiBj
aGFyICoJCQlubF9ubGZhbWlseTJzdHIoaW50LCBjaGFyICosIHNpemVfdCk7Ci1leHRlcm4gaW50
CQkJbmxfc3RyMm5sZmFtaWx5KGNvbnN0IGNoYXIgKik7Ci0KLS8qKgotICogUmVjZWl2ZSBhIHNl
dCBvZiBtZXNzYWdlIGZyb20gYSBuZXRsaW5rIHNvY2tldCB1c2luZyBoYW5kbGVycyBpbiBubF9z
b2NrLgotICogQGFyZyBzawkJTmV0bGluayBzb2NrZXQuCi0gKgotICogQ2FsbHMgbmxfcmVjdm1z
Z3MoKSB3aXRoIHRoZSBoYW5kbGVycyBjb25maWd1cmVkIGluIHRoZSBuZXRsaW5rIHNvY2tldC4K
LSAqLwotc3RhdGljIGlubGluZSBpbnQgbmxfcmVjdm1zZ3NfZGVmYXVsdChzdHJ1Y3Qgbmxfc29j
ayAqc2spCi17Ci0JcmV0dXJuIG5sX3JlY3Ztc2dzKHNrLCBzay0+c19jYik7Ci19Ci0KLQotI2lm
ZGVmIF9fY3BsdXNwbHVzCi19Ci0jZW5kaWYKLQotI2VuZGlmCmRpZmYgLS1naXQgYS9wYWNrYWdl
L2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL29iamVjdC1hcGkuaCBiL3BhY2th
Z2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvb2JqZWN0LWFwaS5oCmRlbGV0
ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCA4YTQ0ZmU5MDEyOWYuLjAwMDAwMDAwMDAwMAotLS0g
YS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL29iamVjdC1hcGku
aAorKysgL2Rldi9udWxsCkBAIC0xLDMzMSArMCwwIEBACi0vKgotICogbmV0bGluay9vYmplY3Qt
YXBpLmMJCU9iamVjdCBBUEkKLSAqCi0gKglUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsg
eW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCi0gKgltb2RpZnkgaXQgdW5kZXIgdGhlIHRl
cm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCi0gKglMaWNlbnNlIGFzIHB1Ymxp
c2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIHZlcnNpb24gMi4xCi0gKglvZiB0
aGUgTGljZW5zZS4KLSAqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMDMtMjAwNyBUaG9tYXMgR3JhZiA8
dGdyYWZAc3V1Zy5jaD4KLSAqLwotCi0jaWZuZGVmIE5FVExJTktfT0JKRUNUX0FQSV9IXwotI2Rl
ZmluZSBORVRMSU5LX09CSkVDVF9BUElfSF8KLQotI2luY2x1ZGUgPG5ldGxpbmsvbmV0bGluay5o
PgotI2luY2x1ZGUgPG5ldGxpbmsvdXRpbHMuaD4KLQotI2lmZGVmIF9fY3BsdXNwbHVzCi1leHRl
cm4gIkMiIHsKLSNlbmRpZgotCi0vKioKLSAqIEBpbmdyb3VwIG9iamVjdAotICogQGRlZmdyb3Vw
IG9iamVjdF9hcGkgT2JqZWN0IEFQSQotICogQGJyaWVmCi0gKgotICogQHBhciAxKSBPYmplY3Qg
RGVmaW5pdGlvbgotICogQGNvZGUKLSAqIC8vIERlZmluZSB5b3VyIG9iamVjdCBzdGFydGluZyB3
aXRoIHRoZSBjb21tb24gb2JqZWN0IGhlYWRlcgotICogc3RydWN0IG15X29iaiB7Ci0gKiAJTkxI
RFJfQ09NTU9OCi0gKiAJaW50CQlteV9kYXRhOwotICogfTsKLSAqCi0gKiAvLyBGaWxsIG91dCB0
aGUgb2JqZWN0IG9wZXJhdGlvbnMgc3RydWN0dXJlCi0gKiBzdHJ1Y3Qgbmxfb2JqZWN0X29wcyBt
eV9vcHMgPSB7Ci0gKiAJLm9vX25hbWUJPSAibXlfb2JqIiwKLSAqIAkub29fc2l6ZQk9IHNpemVv
ZihzdHJ1Y3QgbXlfb2JqKSwKLSAqIH07Ci0gKgotICogLy8gQXQgdGhpcyBwb2ludCB0aGUgb2Jq
ZWN0IGNhbiBiZSBhbGxvY2F0ZWQsIHlvdSBtYXkgd2FudCB0byBwcm92aWRlIGEKLSAqIC8vIHNl
cGFyYXRlIF9hbGxvYygpIGZ1bmN0aW9uIHRvIGVhc2UgYWxsb2N0aW5nIG9iamVjdHMgb2YgdGhp
cyBraW5kLgotICogc3RydWN0IG5sX29iamVjdCAqb2JqID0gbmxfb2JqZWN0X2FsbG9jKCZteV9v
cHMpOwotICoKLSAqIC8vIEFuZCByZWxlYXNlIGl0IGFnYWluLi4uCi0gKiBubF9vYmplY3RfcHV0
KG9iaik7Ci0gKiBAZW5kY29kZQotICoKLSAqIEBwYXIgMikgQWxsb2NhdGluZyBhZGRpdGlvbmFs
IGRhdGEKLSAqIEBjb2RlCi0gKiAvLyBZb3UgbWF5IHJlcXVpcmUgdG8gYWxsb2NhdGUgYWRkaXRp
b25hbCBkYXRhIGFuZCBzdG9yZSBpdCBpbnNpZGUKLSAqIC8vIG9iamVjdCwgZi5lLiBhc3N1bWlu
ZyB0aGVyZSBpcyBhIGZpZWxkIGBwdHInLgotICogc3RydWN0IG15X29iaiB7Ci0gKiAJTkxIRFJf
Q09NTU9OCi0gKiAJdm9pZCAqCQlwdHI7Ci0gKiB9OwotICoKLSAqIC8vIEFuZCBhdCBzb21lIHBv
aW50IHlvdSBtYXkgYXNzaWduIGFsbG9jYXRlZCBkYXRhIHRvIHRoaXMgZmllbGQ6Ci0gKiBteV9v
YmotPnB0ciA9IGNhbGxvYygxLCAuLi4pOwotICoKLSAqIC8vIEluIG9yZGVyIHRvIG5vdCBpbnRy
b2R1Y2UgYW55IG1lbW9yeSBsZWFrcyB5b3UgaGF2ZSB0byByZWxlYXNlCi0gKiAvLyB0aGlzIGRh
dGEgYWdhaW4gd2hlbiB0aGUgbGFzdCByZWZlcmVuY2UgaXMgZ2l2ZW4gYmFjay4KLSAqIHN0YXRp
YyB2b2lkIG15X29ial9mcmVlX2RhdGEoc3RydWN0IG5sX29iamVjdCAqb2JqKQotICogewotICog
CXN0cnVjdCBteV9vYmogKm15X29iaiA9IG5sX29iamVjdF9wcml2KG9iaik7Ci0gKgotICogCWZy
ZWUobXlfb2JqLT5wdHIpOwotICogfQotICoKLSAqIC8vIEFsc28gd2hlbiB0aGUgb2JqZWN0IGlz
IGNsb25lZCwgeW91IG11c3QgZW5zdXJlIGZvciB5b3VyIHBvaW50ZXIKLSAqIC8vIHN0YXkgdmFs
aWQgZXZlbiBpZiBvbmUgb2YgdGhlIGNsb25lcyBpcyBmcmVlZCBieSBlaXRoZXIgbWFraW5nCi0g
KiAvLyBhIGNsb25lIGFzIHdlbGwgb3IgaW5jcmVhc2UgdGhlIHJlZmVyZW5jZSBjb3VudC4KLSAq
IHN0YXRpYyBpbnQgbXlfb2JqX2Nsb25lKHN0cnVjdCBubF9vYmplY3QgKnNyYywgc3RydWN0IG5s
X29iamVjdCAqZHN0KQotICogewotICogCXN0cnVjdCBteV9vYmogKm15X3NyYyA9IG5sX29iamVj
dF9wcml2KHNyYyk7Ci0gKiAJc3RydWN0IG15X29iaiAqbXlfZHN0ID0gbmxfb2JqZWN0X3ByaXYo
ZHN0KTsKLSAqCi0gKiAJaWYgKHNyYy0+cHRyKSB7Ci0gKiAJCWRzdC0+cHRyID0gY2FsbG9jKDEs
IC4uLik7Ci0gKiAJCW1lbWNweShkc3QtPnB0ciwgc3JjLT5wdHIsIC4uLik7Ci0gKiAJfQotICog
fQotICoKLSAqIHN0cnVjdCBubF9vYmplY3Rfb3BzIG15X29wcyA9IHsKLSAqIAkuLi4KLSAqIAku
b29fZnJlZV9kYXRhCT0gbXlfb2JqX2ZyZWVfZGF0YSwKLSAqIAkub29fY2xvbmUJPSBteV9vYmpf
Y2xvbmUsCi0gKiB9OwotICogQGVuZGNvZGUKLSAqCi0gKiBAcGFyIDMpIE9iamVjdCBEdW1waW5n
Ci0gKiBAY29kZQotICogc3RhdGljIGludCBteV9vYmpfZHVtcF9kZXRhaWxlZChzdHJ1Y3Qgbmxf
b2JqZWN0ICpvYmosCi0gKiAJCQkJICAgc3RydWN0IG5sX2R1bXBfcGFyYW1zICpwYXJhbXMpCi0g
KiB7Ci0gKiAJc3RydWN0IG15X29iaiAqbXlfb2JqID0gbmxfb2JqZWN0X3ByaXYob2JqKTsKLSAq
Ci0gKiAJLy8gSXQgaXMgYWJzb2x1dGVseSBlc3NlbnRpYWwgdG8gdXNlIG5sX2R1bXAoKSB3aGVu
IHByaW50aW5nCi0gKgkvLyBhbnkgdGV4dCB0byBtYWtlIHN1cmUgdGhlIGR1bXBpbmcgcGFyYW1l
dGVycyBhcmUgcmVzcGVjdGVkLgotICogCW5sX2R1bXAocGFyYW1zLCAiT2JqIEludGVnZXI6ICVk
XG4iLCBteV9vYmotPm15X2ludCk7Ci0gKgotICogCS8vIEJlZm9yZSB3ZSBjYW4gZHVtcCB0aGUg
bmV4dCBsaW5lLCBtYWtlIHN1cmUgdG8gcHJlZml4Ci0gKgkvLyB0aGlzIGxpbmUgY29ycmVjdGx5
LgotICogCW5sX25ld19saW5lKHBhcmFtcyk7Ci0gKgotICogCS8vIFlvdSBtYXkgYWxzbyBzcGxp
dCBhIGxpbmUgaW50byBtdWx0aXBsZSBubF9kdW1wKCkgY2FsbHMuCi0gKiAJbmxfZHVtcChwYXJh
bXMsICJTdHJpbmc6ICVzICIsIG15X29iai0+bXlfc3RyaW5nKTsKLSAqIAlubF9kdW1wKHBhcmFt
cywgIlN0cmluZy0yOiAlc1xuIiwgbXlfb2JqLT5hbm90aGVyX3N0cmluZyk7Ci0gKiB9Ci0gKgot
ICogc3RydWN0IG5sX29iamVjdF9vcHMgbXlfb3BzID0gewotICogCS4uLgotICogCS5vb19kdW1w
W05MX0RVTVBfRlVMTF0JPSBteV9vYmpfZHVtcF9kZXRhaWxlZCwKLSAqIH07Ci0gKiBAZW5kY29k
ZQotICoKLSAqIEBwYXIgNCkgT2JqZWN0IEF0dHJpYnV0ZXMKLSAqIEBjb2RlCi0gKiAvLyBUaGUg
Y29uY2VwdCBvZiBvYmplY3QgYXR0cmlidXRlcyBpcyBvcHRpb25hbCBidXQgY2FuIGVhc2UgdGhl
IHR5cGljYWwKLSAqIC8vIGNhc2Ugb2Ygb2JqZWN0cyB0aGF0IGhhdmUgb3B0aW9uYWwgYXR0cmli
dXRlcywgZS5nLiBhIHJvdXRlIG1heSBoYXZlIGEKLSAqIC8vIG5leHRob3AgYXNzaWduZWQgYnV0
IGl0IGlzIG5vdCByZXF1aXJlZCB0by4KLSAqCi0gKiAvLyBUaGUgZmlyc3Qgc3RlcCB0byBkZWZp
bmUgeW91ciBvYmplY3Qgc3BlY2lmaWMgYml0bWFzayBsaXN0aW5nIGFsbAotICogLy8gYXR0cmli
dXRlcwotICogI2RlZmluZSBNWV9BVFRSX0ZPTwkJKDE8PDApCi0gKiAjZGVmaW5lIE1ZX0FUVFJf
QkFSCQkoMTw8MSkKLSAqCi0gKiAvLyBXaGVuIGFzc2lnbmluZyBhbiBvcHRpb25hbCBhdHRyaWJ1
dGUgdG8gdGhlIG9iamVjdCwgbWFrZSBzdXJlCi0gKiAvLyB0byBtYXJrIGl0cyBhdmFpbGFiaWxp
dHkuCi0gKiBteV9vYmotPmZvbyA9IDEyMzEyMzsKLSAqIG15X29iai0+Y2VfbWFzayB8PSBNWV9B
VFRSX0ZPTzsKLSAqCi0gKiAvLyBBdCBhbnkgdGltZSB5b3UgbWF5IHVzZSB0aGlzIG1hc2sgdG8g
Y2hlY2sgZm9yIHRoZSBhdmFpbGFiaWxpdHkKLSAqIC8vIG9mIHRoZSBhdHRyaWJ1dGUsIGUuZy4g
d2hpbGUgZHVtcGluZwotICogaWYgKG15X29iai0+Y2VfbWFzayAmIE1ZX0FUVFJfRk9PKQotICog
CW5sX2R1bXAocGFyYW1zLCAiZm9vICVkICIsIG15X29iai0+Zm9vKTsKLSAqCi0gKiAvLyBPbmUg
b2YgdGhlIGJpZyBhZHZhbnRhZ2VzIG9mIHRoaXMgY29uY2VwdCBpcyB0aGF0IGl0IGFsbG93cyBm
b3IKLSAqIC8vIHN0YW5kYXJkaXplZCBjb21wYXJpc29ucyB3aGljaCBtYWtlIGl0IHRyaXZpYWwg
Zm9yIGNhY2hlcyB0bwotICogLy8gaWRlbnRpZnkgdW5pcXVlIG9iamVjdHMgYnkgdXNlIG9mIHVu
aWZpZWQgY29tcGFyaXNvbiBmdW5jdGlvbnMuCi0gKiAvLyBJbiBvcmRlciBmb3IgaXQgdG8gd29y
aywgeW91ciBvYmplY3QgaW1wbGVtZW50YXRpb24gbXVzdCBwcm92aWRlCi0gKiAvLyBhIGNvbXBh
cmlzb24gZnVuY3Rpb24gYW5kIGRlZmluZSBhIGxpc3Qgb2YgYXR0cmlidXRlcyB3aGljaAotICog
Ly8gY29tYmluZWQgdG9nZXRoZXIgbWFrZSBhbiBvYmplY3QgdW5pcXVlLgotICoKLSAqIHN0YXRp
YyBpbnQgbXlfb2JqX2NvbXBhcmUoc3RydWN0IG5sX29iamVjdCAqX2EsIHN0cnVjdCBubF9vYmpl
Y3QgKl9iLAotICogCQkJICAgICB1aW50MzJfdCBhdHRycywgaW50IGZsYWdzKQotICogewotICog
CXN0cnVjdCBteV9vYmogKmEgPSBubF9vYmplY3RfcHJpdihfYSk6Ci0gKiAJc3RydWN0IG15X29i
aiAqYiA9IG5sX29iamVjdF9wcml2KF9iKToKLSAqIAlpbnQgZGlmZiA9IDA7Ci0gKgotICogCS8v
IFdlIGhlbHAgb3Vyc2VsdmVzIGluIGRlZmluaW5nIG91ciBvd24gRElGRiBtYWNybyB3aGljaCB3
aWxsCi0gKgkvLyBjYWxsIEFUVFJfRElGRigpIG9uIGJvdGggb2JqZWN0cyB3aGljaCB3aWxsIG1h
a2Ugc3VyZSB0byBvbmx5Ci0gKgkvLyBjb21wYXJlIHRoZSBhdHRyaWJ1dGVzIGlmIHJlcXVpcmVk
LgotICogCSNkZWZpbmUgTVlfRElGRihBVFRSLCBFWFBSKSBBVFRSX0RJRkYoYXR0cnMsIE1ZX0FU
VFJfIyNBVFRSLCBhLCBiLCBFWFBSKQotICoKLSAqIAkvLyBDYWxsIG91ciBvd24gZGlmZiBtYWNy
byBmb3IgZWFjaCBhdHRyaWJ1dGUgdG8gYnVpbGQgYSBiaXRtYXNrCi0gKgkvLyByZXByZXNlbnRp
bmcgdGhlIGF0dHJpYnV0ZXMgd2hpY2ggbWlzbWF0Y2guCi0gKiAJZGlmZiB8PSBNWV9ESUZGKEZP
TywgYS0+Zm9vICE9IGItPmZvbykKLSAqIAlkaWZmIHw9IE1ZX0RJRkYoQkFSLCBzdHJjbXAoYS0+
YmFyLCBiLT5iYXIpKQotICoKLSAqIAlyZXR1cm4gZGlmZjsKLSAqIH0KLSAqCi0gKiAvLyBJbiBv
cmRlciB0byBpZGVudGlmeSBpZGVudGljYWwgb2JqZWN0cyB3aXRoIGRpZmZlcmluZyBhdHRyaWJ1
dGVzCi0gKiAvLyB5b3UgbXVzdCBzcGVjaWZ5IHRoZSBhdHRyaWJ1dGVzIHJlcXVpcmVkIHRvIHVu
aXF1ZWx5IGlkZW50aWZ5Ci0gKiAvLyB5b3VyIG9iamVjdC4gTWFrZSBzdXJlIHRvIG5vdCBpbmNs
dWRlIHRvbyBtYW55IGF0dHJpYnV0ZXMsIHRoaXMKLSAqIC8vIGxpc3QgaXMgdXNlZCB3aGVuIGNh
Y2hlcyBsb29rIGZvciBhbiBvbGQgdmVyc2lvbiBvZiBhbiBvYmplY3QuCi0gKiBzdHJ1Y3Qgbmxf
b2JqZWN0X29wcyBteV9vcHMgPSB7Ci0gKiAJLi4uCi0gKiAJLm9vX2lkX2F0dHJzCQk9IE1ZX0FU
VFJfRk9PLAotICogCS5vb19jb21wYXJlCQk9IG15X29ial9jb21wYXJlLAotICogfTsKLSAqIEBl
bmRjb2RlCi0gKiBAewotICovCi0KLS8qKgotICogQ29tbW9uIE9iamVjdCBIZWFkZXIKLSAqCi0g
KiBUaGlzIG1hY3JvIG11c3QgYmUgaW5jbHVkZWQgYXMgZmlyc3QgbWVtYmVyIGluIGV2ZXJ5IG9i
amVjdAotICogZGVmaW5pdGlvbiB0byBhbGxvdyBvYmplY3RzIHRvIGJlIGNhY2hlZC4KLSAqLwot
I2RlZmluZSBOTEhEUl9DT01NT04JCQkJXAotCWludAkJCWNlX3JlZmNudDsJXAotCXN0cnVjdCBu
bF9vYmplY3Rfb3BzICoJY2Vfb3BzOwkJXAotCXN0cnVjdCBubF9jYWNoZSAqCWNlX2NhY2hlOwlc
Ci0Jc3RydWN0IG5sX2xpc3RfaGVhZAljZV9saXN0OwlcCi0JaW50CQkJY2VfbXNndHlwZTsJXAot
CWludAkJCWNlX2ZsYWdzOwlcCi0JdWludDMyX3QJCWNlX21hc2s7Ci0KLS8qKgotICogUmV0dXJu
IHRydWUgaWYgYXR0cmlidXRlIGlzIGF2YWlsYWJsZSBpbiBib3RoIG9iamVjdHMKLSAqIEBhcmcg
QQkJYW4gb2JqZWN0Ci0gKiBAYXJnIEIJCWFub3RoZXIgb2JqZWN0Ci0gKiBAYXJnIEFUVFIJCWF0
dHJpYnV0ZSBiaXQKLSAqCi0gKiBAcmV0dXJuIFRydWUgaWYgdGhlIGF0dHJpYnV0ZSBpcyBhdmFp
bGFibGUsIG90aGVyd2lzZSBmYWxzZSBpcyByZXR1cm5lZC4KLSAqLwotI2RlZmluZSBBVkFJTEFC
TEUoQSwgQiwgQVRUUikJKCgoQSktPmNlX21hc2sgJiAoQiktPmNlX21hc2spICYgKEFUVFIpKQot
Ci0vKioKLSAqIFJldHVybiB0cnVlIGlmIGF0dHJpYnV0ZXMgbWlzbWF0Y2gKLSAqIEBhcmcgQQkJ
YW4gb2JqZWN0Ci0gKiBAYXJnIEIJCWFub3RoZXIgb2JqZWN0Ci0gKiBAYXJnIEFUVFIJCWF0dHJp
YnV0ZSBiaXQKLSAqIEBhcmcgRVhQUgkJQ29tcGFyaXNvbiBleHByZXNzaW9uCi0gKgotICogVGhp
cyBmdW5jdGlvbiB3aWxsIGNoZWNrIGlmIHRoZSBhdHRyaWJ1dGUgaW4gcXVlc3Rpb24gaXMgYXZh
aWxhYmxlCi0gKiBpbiBib3RoIG9iamVjdHMsIGlmIG5vdCB0aGlzIHdpbGwgY291bnQgYXMgYSBt
aXNtYXRjaC4KLSAqCi0gKiBJZiBhdmFpbGFibGUgdGhlIGZ1bmN0aW9uIHdpbGwgZXhlY3V0ZSB0
aGUgZXhwcmVzc2lvbiB3aGljaCBtdXN0Ci0gKiByZXR1cm4gdHJ1ZSBpZiB0aGUgYXR0cmlidXRl
cyBtaXNtYXRjaC4KLSAqCi0gKiBAcmV0dXJuIFRydWUgaWYgdGhlIGF0dHJpYnV0ZSBtaXNtYXRj
aCwgb3IgZmFsc2UgaWYgdGhleSBtYXRjaC4KLSAqLwotI2RlZmluZSBBVFRSX01JU01BVENIKEEs
IEIsIEFUVFIsIEVYUFIpCSghQVZBSUxBQkxFKEEsIEIsIEFUVFIpIHx8IChFWFBSKSkKLQotLyoq
Ci0gKiBSZXR1cm4gYXR0cmlidXRlIGJpdCBpZiBhdHRyaWJ1dGUgZG9lcyBub3QgbWF0Y2gKLSAq
IEBhcmcgTElTVAkJbGlzdCBvZiBhdHRyaWJ1dGVzIHRvIGJlIGNvbXBhcmVkCi0gKiBAYXJnIEFU
VFIJCWF0dHJpYnV0ZSBiaXQKLSAqIEBhcmcgQQkJYW4gb2JqZWN0Ci0gKiBAYXJnIEIJCWFub3Ro
ZXIgb2JqZWN0Ci0gKiBAYXJnIEVYUFIJCUNvbXBhcmlzb24gZXhwcmVzc2lvbgotICoKLSAqIFRo
aXMgZnVuY3Rpb24gd2lsbCBjaGVjayBpZiB0aGUgYXR0cmlidXRlIGluIHF1ZXN0aW9uIGlzIGF2
YWlsYWJsZQotICogaW4gYm90aCBvYmplY3RzLCBpZiBub3QgdGhpcyB3aWxsIGNvdW50IGFzIGEg
bWlzbWF0Y2guCi0gKgotICogSWYgYXZhaWxhYmxlIHRoZSBmdW5jdGlvbiB3aWxsIGV4ZWN1dGUg
dGhlIGV4cHJlc3Npb24gd2hpY2ggbXVzdAotICogcmV0dXJuIHRydWUgaWYgdGhlIGF0dHJpYnV0
ZXMgbWlzbWF0Y2guCi0gKgotICogSW4gY2FzZSB0aGUgYXR0cmlidXRlcyBtaXNtYXRjaCwgdGhl
IGF0dHJpYnV0ZSBpcyByZXR1cm5lZCwgb3RoZXJ3aXNlCi0gKiAwIGlzIHJldHVybmVkLgotICoK
LSAqIEBjb2RlCi0gKiBkaWZmIHw9IEFUVFJfRElGRihhdHRycywgTVlfQVRUUl9GT08sIGEsIGIs
IGEtPmZvbyAhPSBiLT5mb28pOwotICogQGVuZGNvZGUKLSAqLwotI2RlZmluZSBBVFRSX0RJRkYo
TElTVCwgQVRUUiwgQSwgQiwgRVhQUikgXAotKHsJaW50IGRpZmYgPSAwOyBcCi0JaWYgKCgoTElT
VCkgJiAoQVRUUikpICYmIEFUVFJfTUlTTUFUQ0goQSwgQiwgQVRUUiwgRVhQUikpIFwKLQkJZGlm
ZiA9IEFUVFI7IFwKLQlkaWZmOyB9KQotCi0vKioKLSAqIE9iamVjdCBPcGVyYXRpb25zCi0gKi8K
LXN0cnVjdCBubF9vYmplY3Q7Ci1zdHJ1Y3Qgbmxfb2JqZWN0X29wcwotewotCS8qKgotCSAqIFVu
aXF1ZSBuYW1lIG9mIG9iamVjdCB0eXBlCi0JICoKLQkgKiBNdXN0IGJlIGluIHRoZSBmb3JtIGZh
bWlseS9uYW1lLCBlLmcuICJyb3V0ZS9hZGRyIgotCSAqLwotCWNoYXIgKgkJb29fbmFtZTsKLQot
CS8qKiBTaXplIG9mIG9iamVjdCBpbmNsdWRpbmcgaXRzIGhlYWRlciAqLwotCXNpemVfdAkJb29f
c2l6ZTsKLQotCS8qIExpc3Qgb2YgYXR0cmlidXRlcyBuZWVkZWQgdG8gdW5pcXVlbHkgaWRlbnRp
ZnkgdGhlIG9iamVjdCAqLwotCXVpbnQzMl90CW9vX2lkX2F0dHJzOwotCi0JLyoqCi0JICogQ29u
c3RydWN0b3IgZnVuY3Rpb24KLQkgKgotCSAqIFdpbGwgYmUgY2FsbGVkIHdoZW4gYSBuZXcgb2Jq
ZWN0IG9mIHRoaXMgdHlwZSBpcyBhbGxvY2F0ZWQuCi0JICogQ2FuIGJlIHVzZWQgdG8gaW5pdGlh
bGl6ZSBtZW1iZXJzIHN1Y2ggYXMgbGlzdHMgZXRjLgotCSAqLwotCXZvaWQgICgqb29fY29uc3Ry
dWN0b3IpKHN0cnVjdCBubF9vYmplY3QgKik7Ci0KLQkvKioKLQkgKiBEZXN0cnVjdG9yIGZ1bmN0
aW9uCi0JICoKLQkgKiBXaWxsIGJlIGNhbGxlZCB3aGVuIGFuIG9iamVjdCBpcyBmcmVlZC4gTXVz
dCBmcmVlIGFsbAotCSAqIHJlc291cmNlcyB3aGljaCBtYXkgaGF2ZSBiZWVuIGFsbG9jYXRlZCBh
cyBwYXJ0IG9mIHRoaXMKLQkgKiBvYmplY3QuCi0JICovCi0Jdm9pZCAgKCpvb19mcmVlX2RhdGEp
KHN0cnVjdCBubF9vYmplY3QgKik7Ci0KLQkvKioKLQkgKiBDbG9uaW5nIGZ1bmN0aW9uCi0JICoK
LQkgKiBXaWxsIGJlIGNhbGxlZCB3aGVuIGFuIG9iamVjdCBuZWVkcyB0byBiZSBjbG9uZWQuIFBs
ZWFzZQotCSAqIG5vdGUgdGhhdCB0aGUgZ2VuZXJpYyBvYmplY3QgY29kZSB3aWxsIG1ha2UgYW4g
ZXhhY3QKLQkgKiBjb3B5IG9mIHRoZSBvYmplY3QgZmlyc3QsIHRoZXJlZm9yZSB5b3Ugb25seSBu
ZWVkIHRvIHRha2UKLQkgKiBjYXJlIG9mIG1lbWJlcnMgd2hpY2ggcmVxdWlyZSByZWZlcmVuY2Ug
Y291bnRpbmcgZXRjLgotCSAqCi0JICogTWF5IHJldHVybiBhIG5lZ2F0aXZlIGVycm9yIGNvZGUg
dG8gYWJvcnQgY2xvbmluZy4KLQkgKi8KLQlpbnQgICgqb29fY2xvbmUpKHN0cnVjdCBubF9vYmpl
Y3QgKiwgc3RydWN0IG5sX29iamVjdCAqKTsKLQotCS8qKgotCSAqIER1bXBpbmcgZnVuY3Rpb25z
Ci0JICoKLQkgKiBXaWxsIGJlIGNhbGxlZCB3aGVuIGFuIG9iamVjdCBpcyBkdW1wZWQuIFRoZSBp
bXBsZW1lbnRhdGlvbnMKLQkgKiBoYXZlIHRvIHVzZSBubF9kdW1wKCksIG5sX2R1bXBfbGluZSgp
LCBhbmQgbmxfbmV3X2xpbmUoKSB0bwotCSAqIGR1bXAgb2JqZWN0cy4KLQkgKgotCSAqIFRoZSBm
dW5jdGlvbnMgbXVzdCByZXR1cm4gdGhlIG51bWJlciBvZiBsaW5lcyBwcmludGVkLgotCSAqLwot
CXZvaWQgKCpvb19kdW1wW05MX0RVTVBfTUFYKzFdKShzdHJ1Y3Qgbmxfb2JqZWN0ICosCi0JCQkJ
ICAgICAgIHN0cnVjdCBubF9kdW1wX3BhcmFtcyAqKTsKLQotCS8qKgotCSAqIENvbXBhcmlzb24g
ZnVuY3Rpb24KLQkgKgotCSAqIFdpbGwgYmUgY2FsbGVkIHdoZW4gdHdvIG9iamVjdHMgb2YgdGhl
IHNhbWUgdHlwZSBhcmUKLQkgKiBjb21wYXJlZC4gSXQgdGFrZXMgdGhlIHR3byBvYmplY3RzIGlu
IHF1ZXN0aW9uLCBhbiBvYmplY3QKLQkgKiBzcGVjaWZpYyBiaXRtYXNrIGRlZmluaW5nIHdoaWNo
IGF0dHJpYnV0ZXMgc2hvdWxkIGJlCi0JICogY29tcGFyZWQgYW5kIGZsYWdzIHRvIGNvbnRyb2wg
dGhlIGJlaGF2aW91ci4KLQkgKgotCSAqIFRoZSBmdW5jdGlvbiBtdXN0IHJldHVybiBhIGJpdG1h
c2sgd2l0aCB0aGUgcmVsZXZhbnQgYml0Ci0JICogc2V0IGZvciBlYWNoIGF0dHJpYnV0ZSB0aGF0
IG1pc21hdGNoZXMuCi0JICovCi0JaW50ICAgKCpvb19jb21wYXJlKShzdHJ1Y3Qgbmxfb2JqZWN0
ICosIHN0cnVjdCBubF9vYmplY3QgKiwKLQkJCSAgICB1aW50MzJfdCwgaW50KTsKLQotCi0JY2hh
ciAqKCpvb19hdHRyczJzdHIpKGludCwgY2hhciAqLCBzaXplX3QpOwotfTsKLQotLyoqIEB9ICov
Ci0KLSNpZmRlZiBfX2NwbHVzcGx1cwotfQotI2VuZGlmCi0KLSNlbmRpZgpkaWZmIC0tZ2l0IGEv
cGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay9vYmplY3QuaCBiL3Bh
Y2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvb2JqZWN0LmgKZGVsZXRl
ZCBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDhhYWJlN2JiMTJmZC4uMDAwMDAwMDAwMDAwCi0tLSBh
L3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvb2JqZWN0LmgKKysr
IC9kZXYvbnVsbApAQCAtMSwxNjQgKzAsMCBAQAotLyoKLSAqIG5ldGxpbmsvb2JqZWN0LmMJR2Vu
ZXJpYyBDYWNoZWFibGUgT2JqZWN0Ci0gKgotICoJVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdh
cmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgotICoJbW9kaWZ5IGl0IHVuZGVyIHRo
ZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwotICoJTGljZW5zZSBhcyBw
dWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiB2ZXJzaW9uIDIuMQotICoJ
b2YgdGhlIExpY2Vuc2UuCi0gKgotICogQ29weXJpZ2h0IChjKSAyMDAzLTIwMDggVGhvbWFzIEdy
YWYgPHRncmFmQHN1dWcuY2g+Ci0gKi8KLQotI2lmbmRlZiBORVRMSU5LX09CSkVDVF9IXwotI2Rl
ZmluZSBORVRMSU5LX09CSkVDVF9IXwotCi0jaW5jbHVkZSA8bmV0bGluay9uZXRsaW5rLmg+Ci0j
aW5jbHVkZSA8bmV0bGluay91dGlscy5oPgotI2luY2x1ZGUgPG5ldGxpbmsvb2JqZWN0LWFwaS5o
PgotCi0jaWZkZWYgX19jcGx1c3BsdXMKLWV4dGVybiAiQyIgewotI2VuZGlmCi0KLSNkZWZpbmUg
TkxfT0JKX01BUksJCTEKLQotc3RydWN0IG5sX2NhY2hlOwotc3RydWN0IG5sX29iamVjdDsKLXN0
cnVjdCBubF9vYmplY3Rfb3BzOwotCi1zdHJ1Y3Qgbmxfb2JqZWN0Ci17Ci0JTkxIRFJfQ09NTU9O
Ci19OwotCi0jZGVmaW5lIE9CSl9DQVNUKHB0cikJCSgoc3RydWN0IG5sX29iamVjdCAqKSAocHRy
KSkKLQotLyogR2VuZXJhbCAqLwotZXh0ZXJuIHN0cnVjdCBubF9vYmplY3QgKglubF9vYmplY3Rf
YWxsb2Moc3RydWN0IG5sX29iamVjdF9vcHMgKik7Ci1leHRlcm4gdm9pZAkJCW5sX29iamVjdF9m
cmVlKHN0cnVjdCBubF9vYmplY3QgKik7Ci1leHRlcm4gc3RydWN0IG5sX29iamVjdCAqCW5sX29i
amVjdF9jbG9uZShzdHJ1Y3Qgbmxfb2JqZWN0ICpvYmopOwotCi0jaWZkZWYgZGlzYWJsZWQKLQot
ZXh0ZXJuIGludAkJCW5sX29iamVjdF9hbGxvY19uYW1lKGNvbnN0IGNoYXIgKiwKLQkJCQkJCSAg
ICAgc3RydWN0IG5sX29iamVjdCAqKik7Ci1leHRlcm4gdm9pZAkJCW5sX29iamVjdF9kdW1wKHN0
cnVjdCBubF9vYmplY3QgKiwKLQkJCQkJICAgICAgIHN0cnVjdCBubF9kdW1wX3BhcmFtcyAqKTsK
LQotZXh0ZXJuIHVpbnQzMl90CQkJbmxfb2JqZWN0X2RpZmYoc3RydWN0IG5sX29iamVjdCAqLAot
CQkJCQkgICAgICAgc3RydWN0IG5sX29iamVjdCAqKTsKLWV4dGVybiBpbnQJCQlubF9vYmplY3Rf
bWF0Y2hfZmlsdGVyKHN0cnVjdCBubF9vYmplY3QgKiwKLQkJCQkJCSAgICAgICBzdHJ1Y3Qgbmxf
b2JqZWN0ICopOwotZXh0ZXJuIGludAkJCW5sX29iamVjdF9pZGVudGljYWwoc3RydWN0IG5sX29i
amVjdCAqLAotCQkJCQkJICAgIHN0cnVjdCBubF9vYmplY3QgKik7Ci1leHRlcm4gY2hhciAqCQkJ
bmxfb2JqZWN0X2F0dHJzMnN0cihzdHJ1Y3Qgbmxfb2JqZWN0ICosCi0JCQkJCQkgICAgdWludDMy
X3QgYXR0cnMsIGNoYXIgKmJ1ZiwKLQkJCQkJCSAgICBzaXplX3QpOwotI2VuZGlmCi0vKioKLSAq
IENoZWNrIHdoZXRoZXIgdGhpcyBvYmplY3QgaXMgdXNlZCBieSBtdWx0aXBsZSB1c2VycwotICog
QGFyZyBvYmoJCW9iamVjdCB0byBjaGVjawotICogQHJldHVybiB0cnVlIG9yIGZhbHNlCi0gKi8K
LXN0YXRpYyBpbmxpbmUgaW50IG5sX29iamVjdF9zaGFyZWQoc3RydWN0IG5sX29iamVjdCAqb2Jq
KQotewotCXJldHVybiBvYmotPmNlX3JlZmNudCA+IDE7Ci19Ci0KLQotc3RhdGljIGlubGluZSB2
b2lkIG5sX29iamVjdF9nZXQoc3RydWN0IG5sX29iamVjdCAqb2JqKQotewotCW9iai0+Y2VfcmVm
Y250Kys7Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZCBubF9vYmplY3RfcHV0KHN0cnVjdCBubF9v
YmplY3QgKm9iaikKLXsKLQlpZiAoIW9iaikKLQkJcmV0dXJuOwotCi0Jb2JqLT5jZV9yZWZjbnQt
LTsKLQotCWlmIChvYmotPmNlX3JlZmNudCA8PSAwKQotCQlubF9vYmplY3RfZnJlZShvYmopOwot
fQotCi0KLS8qKgotICogQG5hbWUgTWFya3MKLSAqIEB7Ci0gKi8KLQotLyoqCi0gKiBBZGQgbWFy
ayB0byBvYmplY3QKLSAqIEBhcmcgb2JqCQlPYmplY3QgdG8gbWFyawotICovCi1zdGF0aWMgaW5s
aW5lIHZvaWQgbmxfb2JqZWN0X21hcmsoc3RydWN0IG5sX29iamVjdCAqb2JqKQotewotCW9iai0+
Y2VfZmxhZ3MgfD0gTkxfT0JKX01BUks7Ci19Ci0KLS8qKgotICogUmVtb3ZlIG1hcmsgZnJvbSBv
YmplY3QKLSAqIEBhcmcgb2JqCQlPYmplY3QgdG8gdW5tYXJrCi0gKi8KLXN0YXRpYyBpbmxpbmUg
dm9pZCBubF9vYmplY3RfdW5tYXJrKHN0cnVjdCBubF9vYmplY3QgKm9iaikKLXsKLQlvYmotPmNl
X2ZsYWdzICY9IH5OTF9PQkpfTUFSSzsKLX0KLQotLyoqCi0gKiBSZXR1cm4gdHJ1ZSBpZiBvYmpl
Y3QgaXMgbWFya2VkCi0gKiBAYXJnIG9iagkJT2JqZWN0IHRvIGNoZWNrCi0gKiBAcmV0dXJuIHRy
dWUgaWYgb2JqZWN0IGlzIG1hcmtlZCwgb3RoZXJ3aXNlIGZhbHNlCi0gKi8KLXN0YXRpYyBpbmxp
bmUgaW50IG5sX29iamVjdF9pc19tYXJrZWQoc3RydWN0IG5sX29iamVjdCAqb2JqKQotewotCXJl
dHVybiAob2JqLT5jZV9mbGFncyAmIE5MX09CSl9NQVJLKTsKLX0KLQotLyoqIEB9ICovCi0KLSNp
ZmRlZiBkaXNhYmxlZAotLyoqCi0gKiBSZXR1cm4gbGlzdCBvZiBhdHRyaWJ1dGVzIHByZXNlbnQg
aW4gYW4gb2JqZWN0Ci0gKiBAYXJnIG9iagkJYW4gb2JqZWN0Ci0gKiBAYXJnIGJ1ZgkJZGVzdGlu
YXRpb24gYnVmZmVyCi0gKiBAYXJnIGxlbgkJbGVuZ3RoIG9mIGRlc3RpbmF0aW9uIGJ1ZmZlcgot
ICoKLSAqIEByZXR1cm4gZGVzdGluYXRpb24gYnVmZmVyLgotICovCi1zdGF0aWMgaW5saW5lIGNo
YXIgKm5sX29iamVjdF9hdHRyX2xpc3Qoc3RydWN0IG5sX29iamVjdCAqb2JqLCBjaGFyICpidWYs
IHNpemVfdCBsZW4pCi17Ci0JcmV0dXJuIG5sX29iamVjdF9hdHRyczJzdHIob2JqLCBvYmotPmNl
X21hc2ssIGJ1ZiwgbGVuKTsKLX0KLSNlbmRpZgotCi0vKioKLSAqIEBuYW1lIEF0dHJpYnV0ZXMK
LSAqIEB7Ci0gKi8KLQotc3RhdGljIGlubGluZSBpbnQgbmxfb2JqZWN0X2dldF9yZWZjbnQoc3Ry
dWN0IG5sX29iamVjdCAqb2JqKQotewotCXJldHVybiBvYmotPmNlX3JlZmNudDsKLX0KLQotc3Rh
dGljIGlubGluZSBzdHJ1Y3QgbmxfY2FjaGUgKm5sX29iamVjdF9nZXRfY2FjaGUoc3RydWN0IG5s
X29iamVjdCAqb2JqKQotewotCXJldHVybiBvYmotPmNlX2NhY2hlOwotfQotCi1zdGF0aWMgaW5s
aW5lIHZvaWQgKgkJbmxfb2JqZWN0X3ByaXYoc3RydWN0IG5sX29iamVjdCAqb2JqKQotewotCXJl
dHVybiBvYmo7Ci19Ci0KLQotLyoqIEB9ICovCi0KLQotI2lmZGVmIF9fY3BsdXNwbHVzCi19Ci0j
ZW5kaWYKLQotI2VuZGlmCmRpZmYgLS1naXQgYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMv
aW5jbHVkZS9uZXRsaW5rL3NvY2tldC5oIGIvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2lu
Y2x1ZGUvbmV0bGluay9zb2NrZXQuaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggYmNi
OTM0YzUwYjQ1Li4wMDAwMDAwMDAwMDAKLS0tIGEvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3Jj
L2luY2x1ZGUvbmV0bGluay9zb2NrZXQuaAorKysgL2Rldi9udWxsCkBAIC0xLDIzMSArMCwwIEBA
Ci0vKgotICogbmV0bGluay9zb2NrZXQuaAkJTmV0bGluayBTb2NrZXQKLSAqCi0gKglUaGlzIGxp
YnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCi0g
Kgltb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVi
bGljCi0gKglMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0
aW9uIHZlcnNpb24gMi4xCi0gKglvZiB0aGUgTGljZW5zZS4KLSAqCi0gKiBDb3B5cmlnaHQgKGMp
IDIwMDMtMjAwOCBUaG9tYXMgR3JhZiA8dGdyYWZAc3V1Zy5jaD4KLSAqLwotCi0jaWZuZGVmIE5F
VExJTktfU09DS0VUX0hfCi0jZGVmaW5lIE5FVExJTktfU09DS0VUX0hfCi0KLSNpbmNsdWRlIDxu
ZXRsaW5rL3R5cGVzLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9oYW5kbGVycy5oPgotCi0jaWZkZWYg
X19jcGx1c3BsdXMKLWV4dGVybiAiQyIgewotI2VuZGlmCi0KLSNkZWZpbmUgTkxfU09DS19CVUZT
SVpFX1NFVAkoMTw8MCkKLSNkZWZpbmUgTkxfU09DS19QQVNTQ1JFRAkoMTw8MSkKLSNkZWZpbmUg
TkxfT1dOX1BPUlQJCSgxPDwyKQotI2RlZmluZSBOTF9NU0dfUEVFSwkJKDE8PDMpCi0jZGVmaW5l
IE5MX05PX0FVVE9fQUNLCQkoMTw8NCkKLQotc3RydWN0IG5sX2NiOwotc3RydWN0IG5sX3NvY2sK
LXsKLQlzdHJ1Y3Qgc29ja2FkZHJfbmwJc19sb2NhbDsKLQlzdHJ1Y3Qgc29ja2FkZHJfbmwJc19w
ZWVyOwotCWludAkJCXNfZmQ7Ci0JaW50CQkJc19wcm90bzsKLQl1bnNpZ25lZCBpbnQJCXNfc2Vx
X25leHQ7Ci0JdW5zaWduZWQgaW50CQlzX3NlcV9leHBlY3Q7Ci0JaW50CQkJc19mbGFnczsKLQlz
dHJ1Y3QgbmxfY2IgKgkJc19jYjsKLX07Ci0KLQotZXh0ZXJuIHN0cnVjdCBubF9zb2NrICoJbmxf
c29ja2V0X2FsbG9jKHZvaWQpOwotZXh0ZXJuIHN0cnVjdCBubF9zb2NrICoJbmxfc29ja2V0X2Fs
bG9jX2NiKHN0cnVjdCBubF9jYiAqKTsKLWV4dGVybiB2b2lkCQlubF9zb2NrZXRfZnJlZShzdHJ1
Y3Qgbmxfc29jayAqKTsKLQotZXh0ZXJuIHZvaWQJCW5sX3NvY2tldF9zZXRfbG9jYWxfcG9ydChz
dHJ1Y3Qgbmxfc29jayAqLCB1aW50MzJfdCk7Ci0KLWV4dGVybiBpbnQJCW5sX3NvY2tldF9hZGRf
bWVtYmVyc2hpcHMoc3RydWN0IG5sX3NvY2sgKiwgaW50LCAuLi4pOwotZXh0ZXJuIGludAkJbmxf
c29ja2V0X2Ryb3BfbWVtYmVyc2hpcHMoc3RydWN0IG5sX3NvY2sgKiwgaW50LCAuLi4pOwotCi1l
eHRlcm4gaW50CQlubF9zb2NrZXRfc2V0X2J1ZmZlcl9zaXplKHN0cnVjdCBubF9zb2NrICosIGlu
dCwgaW50KTsKLWV4dGVybiBpbnQJCW5sX3NvY2tldF9zZXRfcGFzc2NyZWQoc3RydWN0IG5sX3Nv
Y2sgKiwgaW50KTsKLWV4dGVybiBpbnQJCW5sX3NvY2tldF9yZWN2X3BrdGluZm8oc3RydWN0IG5s
X3NvY2sgKiwgaW50KTsKLQotZXh0ZXJuIHZvaWQJCW5sX3NvY2tldF9kaXNhYmxlX3NlcV9jaGVj
ayhzdHJ1Y3Qgbmxfc29jayAqKTsKLQotZXh0ZXJuIGludAkJbmxfc29ja2V0X3NldF9ub25ibG9j
a2luZyhzdHJ1Y3Qgbmxfc29jayAqKTsKLQotLyoqCi0gKiBVc2UgbmV4dCBzZXF1ZW5jZSBudW1i
ZXIKLSAqIEBhcmcgc2sJCU5ldGxpbmsgc29ja2V0LgotICoKLSAqIFVzZXMgdGhlIG5leHQgYXZh
aWxhYmxlIHNlcXVlbmNlIG51bWJlciBhbmQgaW5jcmVhc2VzIHRoZSBjb3VudGVyCi0gKiBieSBv
bmUgZm9yIHN1YnNlcXVlbnQgY2FsbHMuCi0gKgotICogQHJldHVybiBVbmlxdWUgc2VyaWFsIHNl
cXVlbmNlIG51bWJlcgotICovCi1zdGF0aWMgaW5saW5lIHVuc2lnbmVkIGludCBubF9zb2NrZXRf
dXNlX3NlcShzdHJ1Y3Qgbmxfc29jayAqc2spCi17Ci0JcmV0dXJuIHNrLT5zX3NlcV9uZXh0Kys7
Ci19Ci0KLS8qKgotICogRGlzYWJsZSBhdXRvbWF0aWMgcmVxdWVzdCBmb3IgQUNLCi0gKiBAYXJn
IHNrCQlOZXRsaW5rIHNvY2tldC4KLSAqCi0gKiBUaGUgZGVmYXVsdCBiZWhhdmlvdXIgb2YgYSBz
b2NrZXQgaXMgdG8gcmVxdWVzdCBhbiBBQ0sgZm9yCi0gKiBlYWNoIG1lc3NhZ2Ugc2VudCB0byBh
bGxvdyBmb3IgdGhlIGNhbGxlciB0byBzeW5jaHJvbml6ZSB0bwotICogdGhlIGNvbXBsZXRpb24g
b2YgdGhlIG5ldGxpbmsgb3BlcmF0aW9uLiBUaGlzIGZ1bmN0aW9uCi0gKiBkaXNhYmxlcyB0aGlz
IGJlaGF2aW91ciBhbmQgd2lsbCByZXN1bHQgaW4gcmVxdWVzdHMgYmVpbmcKLSAqIHNlbnQgd2hp
Y2ggd2lsbCBub3QgaGF2ZSB0aGUgTkxNX0ZfQUNLIGZsYWcgc2V0IGF1dG9tYXRpY2FsbHkuCi0g
KiBIb3dldmVyLCBpdCBpcyBzdGlsbCBwb3NzaWJsZSBmb3IgdGhlIGNhbGxlciB0byBzZXQgdGhl
Ci0gKiBOTE1fRl9BQ0sgZmxhZyBleHBsaWNpdGVseS4KLSAqLwotc3RhdGljIGlubGluZSB2b2lk
IG5sX3NvY2tldF9kaXNhYmxlX2F1dG9fYWNrKHN0cnVjdCBubF9zb2NrICpzaykKLXsKLQlzay0+
c19mbGFncyB8PSBOTF9OT19BVVRPX0FDSzsKLX0KLQotLyoqCi0gKiBFbmFibGUgYXV0b21hdGlj
IHJlcXVlc3QgZm9yIEFDSyAoZGVmYXVsdCkKLSAqIEBhcmcgc2sJCU5ldGxpbmsgc29ja2V0Lgot
ICogQHNlZSBubF9zb2NrZXRfZGlzYWJsZV9hdXRvX2FjawotICovCi1zdGF0aWMgaW5saW5lIHZv
aWQgbmxfc29ja2V0X2VuYWJsZV9hdXRvX2FjayhzdHJ1Y3Qgbmxfc29jayAqc2spCi17Ci0Jc2st
PnNfZmxhZ3MgJj0gfk5MX05PX0FVVE9fQUNLOwotfQotCi0vKioKLSAqIEBuYW1lIFNvdXJjZSBJ
ZGVuZmljaWF0aW9uCi0gKiBAewotICovCi0KLXN0YXRpYyBpbmxpbmUgdWludDMyX3Qgbmxfc29j
a2V0X2dldF9sb2NhbF9wb3J0KHN0cnVjdCBubF9zb2NrICpzaykKLXsKLQlyZXR1cm4gc2stPnNf
bG9jYWwubmxfcGlkOwotfQotCi0vKioKLSAqIEpvaW4gbXVsdGljYXN0IGdyb3VwcyAoZGVwcmVj
YXRlZCkKLSAqIEBhcmcgc2sJCU5ldGxpbmsgc29ja2V0LgotICogQGFyZyBncm91cHMJCUJpdG1h
c2sgb2YgZ3JvdXBzIHRvIGpvaW4uCi0gKgotICogVGhpcyBmdW5jdGlvbiBkZWZpbmVzIHRoZSBv
bGQgd2F5IG9mIGpvaW5pbmcgbXVsdGljYXN0IGdyb3VwIHdoaWNoCi0gKiBoYXMgdG8gYmUgZG9u
ZSBwcmlvciB0byBjYWxsaW5nIG5sX2Nvbm5lY3QoKS4gSXQgd29ya3Mgb24gYW55IGtlcm5lbAot
ICogdmVyc2lvbiBidXQgaXMgdmVyeSBsaW1pdGVkIGFzIG9ubHkgMzIgZ3JvdXBzIGNhbiBiZSBq
b2luZWQuCi0gKi8KLXN0YXRpYyBpbmxpbmUgdm9pZCBubF9qb2luX2dyb3VwcyhzdHJ1Y3Qgbmxf
c29jayAqc2ssIGludCBncm91cHMpCi17Ci0Jc2stPnNfbG9jYWwubmxfZ3JvdXBzIHw9IGdyb3Vw
czsKLX0KLQotLyoqCi0gKiBAbmFtZSBQZWVyIElkZW50ZmljYXRpb24KLSAqIEB7Ci0gKi8KLQot
c3RhdGljIGlubGluZSB1aW50MzJfdCBubF9zb2NrZXRfZ2V0X3BlZXJfcG9ydChzdHJ1Y3Qgbmxf
c29jayAqc2spCi17Ci0JcmV0dXJuIHNrLT5zX3BlZXIubmxfcGlkOwotfQotCi1zdGF0aWMgaW5s
aW5lIHZvaWQgbmxfc29ja2V0X3NldF9wZWVyX3BvcnQoc3RydWN0IG5sX3NvY2sgKnNrLCB1aW50
MzJfdCBwb3J0KQotewotCXNrLT5zX3BlZXIubmxfcGlkID0gcG9ydDsKLX0KLQotLyoqIEB9ICov
Ci0KLS8qKgotICogQG5hbWUgRmlsZSBEZXNjcmlwdG9yCi0gKiBAewotICovCi0KLXN0YXRpYyBp
bmxpbmUgaW50IG5sX3NvY2tldF9nZXRfZmQoc3RydWN0IG5sX3NvY2sgKnNrKQotewotCXJldHVy
biBzay0+c19mZDsKLX0KLQotLyoqCi0gKiBFbmFibGUgdXNlIG9mIE1TR19QRUVLIHdoZW4gcmVh
ZGluZyBmcm9tIHNvY2tldAotICogQGFyZyBzawkJTmV0bGluayBzb2NrZXQuCi0gKi8KLXN0YXRp
YyBpbmxpbmUgdm9pZCBubF9zb2NrZXRfZW5hYmxlX21zZ19wZWVrKHN0cnVjdCBubF9zb2NrICpz
aykKLXsKLQlzay0+c19mbGFncyB8PSBOTF9NU0dfUEVFSzsKLX0KLQotLyoqCi0gKiBEaXNhYmxl
IHVzZSBvZiBNU0dfUEVFSyB3aGVuIHJlYWRpbmcgZnJvbSBzb2NrZXQKLSAqIEBhcmcgc2sJCU5l
dGxpbmsgc29ja2V0LgotICovCi1zdGF0aWMgaW5saW5lIHZvaWQgbmxfc29ja2V0X2Rpc2FibGVf
bXNnX3BlZWsoc3RydWN0IG5sX3NvY2sgKnNrKQotewotCXNrLT5zX2ZsYWdzICY9IH5OTF9NU0df
UEVFSzsKLX0KLQotc3RhdGljIGlubGluZSB1aW50MzJfdCBubF9zb2NrZXRfZ2V0X3BlZXJfZ3Jv
dXBzKHN0cnVjdCBubF9zb2NrICpzaykKLXsKLQlyZXR1cm4gc2stPnNfcGVlci5ubF9ncm91cHM7
Ci19Ci0KLXN0YXRpYyBpbmxpbmUgdm9pZCBubF9zb2NrZXRfc2V0X3BlZXJfZ3JvdXBzKHN0cnVj
dCBubF9zb2NrICpzaywgdWludDMyX3QgZ3JvdXBzKQotewotCXNrLT5zX3BlZXIubmxfZ3JvdXBz
ID0gZ3JvdXBzOwotfQotCi0vKioKLSAqIEBuYW1lIENhbGxiYWNrIEhhbmRsZXIKLSAqIEB7Ci0g
Ki8KLQotc3RhdGljIGlubGluZSBzdHJ1Y3QgbmxfY2IgKm5sX3NvY2tldF9nZXRfY2Ioc3RydWN0
IG5sX3NvY2sgKnNrKQotewotCXJldHVybiBubF9jYl9nZXQoc2stPnNfY2IpOwotfQotCi1zdGF0
aWMgaW5saW5lIHZvaWQgbmxfc29ja2V0X3NldF9jYihzdHJ1Y3Qgbmxfc29jayAqc2ssIHN0cnVj
dCBubF9jYiAqY2IpCi17Ci0JbmxfY2JfcHV0KHNrLT5zX2NiKTsKLQlzay0+c19jYiA9IG5sX2Ni
X2dldChjYik7Ci19Ci0KLS8qKgotICogTW9kaWZ5IHRoZSBjYWxsYmFjayBoYW5kbGVyIGFzc29j
aWF0ZWQgdG8gdGhlIHNvY2tldAotICogQGFyZyBzawkJTmV0bGluayBzb2NrZXQuCi0gKiBAYXJn
IHR5cGUJCXdoaWNoIHR5cGUgY2FsbGJhY2sgdG8gc2V0Ci0gKiBAYXJnIGtpbmQJCWtpbmQgb2Yg
Y2FsbGJhY2sKLSAqIEBhcmcgZnVuYwkJY2FsbGJhY2sgZnVuY3Rpb24KLSAqIEBhcmcgYXJnCQlh
cmd1bWVudCB0byBiZSBwYXNzd2QgdG8gY2FsbGJhY2sgZnVuY3Rpb24KLSAqCi0gKiBAc2VlIG5s
X2NiX3NldAotICovCi1zdGF0aWMgaW5saW5lIGludCBubF9zb2NrZXRfbW9kaWZ5X2NiKHN0cnVj
dCBubF9zb2NrICpzaywgZW51bSBubF9jYl90eXBlIHR5cGUsCi0JCQllbnVtIG5sX2NiX2tpbmQg
a2luZCwgbmxfcmVjdm1zZ19tc2dfY2JfdCBmdW5jLAotCQkJdm9pZCAqYXJnKQotewotCXJldHVy
biBubF9jYl9zZXQoc2stPnNfY2IsIHR5cGUsIGtpbmQsIGZ1bmMsIGFyZyk7Ci19Ci0KLS8qKiBA
fSAqLwotCi1zdGF0aWMgaW5saW5lIGludCBubF9zb2NrZXRfYWRkX21lbWJlcnNoaXAoc3RydWN0
IG5sX3NvY2sgKnNrLCBpbnQgZ3JvdXApCi17Ci0JcmV0dXJuIG5sX3NvY2tldF9hZGRfbWVtYmVy
c2hpcHMoc2ssIGdyb3VwLCAwKTsKLX0KLQotCi1zdGF0aWMgaW5saW5lIGludCBubF9zb2NrZXRf
ZHJvcF9tZW1iZXJzaGlwKHN0cnVjdCBubF9zb2NrICpzaywgaW50IGdyb3VwKQotewotCXJldHVy
biBubF9zb2NrZXRfZHJvcF9tZW1iZXJzaGlwcyhzaywgZ3JvdXAsIDApOwotfQotCi0KLQotI2lm
ZGVmIF9fY3BsdXNwbHVzCi19Ci0jZW5kaWYKLQotI2VuZGlmCmRpZmYgLS1naXQgYS9wYWNrYWdl
L2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL3R5cGVzLmggYi9wYWNrYWdlL2xp
YnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL3R5cGVzLmgKZGVsZXRlZCBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IGRlODFhY2UxMWUwMy4uMDAwMDAwMDAwMDAwCi0tLSBhL3BhY2thZ2Uv
bGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL25ldGxpbmsvdHlwZXMuaAorKysgL2Rldi9udWxs
CkBAIC0xLDEyMSArMCwwIEBACi0vKgotICogbmV0bGluay9uZXRsaW5rLXR5cGVzLmgJTmV0bGlu
ayBUeXBlcwotICoKLSAqCVRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJl
ZGlzdHJpYnV0ZSBpdCBhbmQvb3IKLSAqCW1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhl
IEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKLSAqCUxpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRo
ZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24gdmVyc2lvbiAyLjEKLSAqCW9mIHRoZSBMaWNlbnNl
LgotICoKLSAqIENvcHlyaWdodCAoYykgMjAwMy0yMDA2IFRob21hcyBHcmFmIDx0Z3JhZkBzdXVn
LmNoPgotICovCi0KLSNpZm5kZWYgX19ORVRMSU5LX1RZUEVTX0hfCi0jZGVmaW5lIF9fTkVUTElO
S19UWVBFU19IXwotCi0jaW5jbHVkZSA8c3RkaW8uaD4KLQotLyoqCi0gKiBEdW1waW5nIHR5cGVz
IChkcF90eXBlKQotICogQGluZ3JvdXAgdXRpbHMKLSAqLwotZW51bSBubF9kdW1wX3R5cGUgewot
CU5MX0RVTVBfTElORSwJCS8qKjwgRHVtcCBvYmplY3QgYnJpZWZseSBvbiBvbmUgbGluZSAqLwot
CU5MX0RVTVBfREVUQUlMUywJLyoqPCBEdW1wIGFsbCBhdHRyaWJ1dGVzIGJ1dCBubyBzdGF0aXN0
aWNzICovCi0JTkxfRFVNUF9TVEFUUywJCS8qKjwgRHVtcCBhbGwgYXR0cmlidXRlcyBpbmNsdWRp
bmcgc3RhdGlzdGljcyAqLwotCU5MX0RVTVBfRU5WLAkJLyoqPCBEdW1wIGFsbCBhdHRyaWJ0dWVz
IGFzIGVudiB2YXJpYWJsZXMgKi8KLQlfX05MX0RVTVBfTUFYLAotfTsKLSNkZWZpbmUgTkxfRFVN
UF9NQVggKF9fTkxfRFVNUF9NQVggLSAxKQotCi0vKioKLSAqIER1bXBpbmcgcGFyYW1ldGVycwot
ICogQGluZ3JvdXAgdXRpbHMKLSAqLwotc3RydWN0IG5sX2R1bXBfcGFyYW1zCi17Ci0JLyoqCi0J
ICogU3BlY2lmaWVzIHRoZSB0eXBlIG9mIGR1bXAgdGhhdCBpcyByZXF1ZXN0ZWQuCi0JICovCi0J
ZW51bSBubF9kdW1wX3R5cGUJZHBfdHlwZTsKLQotCS8qKgotCSAqIFNwZWNpZmllcyB0aGUgbnVt
YmVyIG9mIHdoaXRlc3BhY2VzIHRvIGJlIHB1dCBpbiBmcm9udAotCSAqIG9mIGV2ZXJ5IG5ldyBs
aW5lIChpbmRlbnRhdGlvbikuCi0JICovCi0JaW50CQkJZHBfcHJlZml4OwotCi0JLyoqCi0JICog
Q2F1c2VzIHRoZSBjYWNoZSBpbmRleCB0byBiZSBwcmludGVkIGZvciBlYWNoIGVsZW1lbnQuCi0J
ICovCi0JaW50CQkJZHBfcHJpbnRfaW5kZXg7Ci0KLQkvKioKLQkgKiBDYXVzZXMgZWFjaCBlbGVt
ZW50IHRvIGJlIHByZWZpeGVkIHdpdGggdGhlIG1lc3NhZ2UgdHlwZS4KLQkgKi8KLQlpbnQJCQlk
cF9kdW1wX21zZ3R5cGU7Ci0KLQkvKioKLQkgKiBBIGNhbGxiYWNrIGludm9rZWQgZm9yIG91dHB1
dAotCSAqCi0JICogUGFzc2VkIGFyZ3VtZW50cyBhcmU6Ci0JICogIC0gZHVtcGluZyBwYXJhbWV0
ZXJzCi0JICogIC0gc3RyaW5nIHRvIGFwcGVuZCB0byB0aGUgb3V0cHV0Ci0JICovCi0Jdm9pZAkJ
CSgqZHBfY2IpKHN0cnVjdCBubF9kdW1wX3BhcmFtcyAqLCBjaGFyICopOwotCi0JLyoqCi0JICog
QSBjYWxsYmFjayBpbnZva2VkIGZvciBldmVyeSBuZXcgbGluZSwgY2FuIGJlIHVzZWQgdG8KLQkg
KiBjdXN0b21pemUgdGhlIGluZGVudGF0aW9uLgotCSAqCi0JICogUGFzc2VkIGFyZ3VtZW50cyBh
cmU6Ci0JICogIC0gZHVtcGluZyBwYXJhbWV0ZXJzCi0JICogIC0gbGluZSBudW1iZXIgc3RhcnRp
bmcgZnJvbSAwCi0JICovCi0Jdm9pZAkJCSgqZHBfbmxfY2IpKHN0cnVjdCBubF9kdW1wX3BhcmFt
cyAqLCBpbnQpOwotCi0JLyoqCi0JICogVXNlciBkYXRhIHBvaW50ZXIsIGNhbiBiZSB1c2VkIHRv
IHBhc3MgZGF0YSB0byBjYWxsYmFja3MuCi0JICovCi0Jdm9pZAkJCSpkcF9kYXRhOwotCi0JLyoq
Ci0JICogRmlsZSBkZXNjcmlwdG9yIHRoZSBkdW1waW5nIG91dHB1dCBzaG91bGQgZ28gdG8KLQkg
Ki8KLQlGSUxFICoJCQlkcF9mZDsKLQotCS8qKgotCSAqIEFsdGVybmF0aXZlbHkgdGhlIG91dHB1
dCBtYXkgYmUgcmVkaXJlY3RlZCBpbnRvIGEgYnVmZmVyCi0JICovCi0JY2hhciAqCQkJZHBfYnVm
OwotCi0JLyoqCi0JICogTGVuZ3RoIG9mIHRoZSBidWZmZXIgZHBfYnVmCi0JICovCi0Jc2l6ZV90
CQkJZHBfYnVmbGVuOwotCi0JLyoqCi0JICogUFJJVkFURQotCSAqIFNldCBpZiBhIGR1bXAgd2Fz
IHBlcmZvcm1lZCBwcmlvciB0byB0aGUgYWN0dWFsIGR1bXAgaGFuZGxlci4KLQkgKi8KLQlpbnQJ
CQlkcF9wcmVfZHVtcDsKLQotCS8qKgotCSAqIFBSSVZBVEUKLQkgKiBPd25lZCBieSB0aGUgY3Vy
cmVudCBjYWxsZXIKLQkgKi8KLQlpbnQJCQlkcF9pdmFyOwotCi0JdW5zaWduZWQgaW50CQlkcF9s
aW5lOwotfTsKLQotI2lmbmRlZiBfX0dOVUNfXwotI2RlZmluZSBfX2V4dGVuc2lvbl9fCi0jZW5k
aWYKLQotI2RlZmluZSBtaW5fdCh0eXBlLHgseSkgXAotCV9fZXh0ZW5zaW9uX18oeyB0eXBlIF9f
eCA9ICh4KTsgdHlwZSBfX3kgPSAoeSk7IF9feCA8IF9feSA/IF9feDogX195OyB9KQotI2RlZmlu
ZSBtYXhfdCh0eXBlLHgseSkgXAotCV9fZXh0ZW5zaW9uX18oeyB0eXBlIF9feCA9ICh4KTsgdHlw
ZSBfX3kgPSAoeSk7IF9feCA+IF9feSA/IF9feDogX195OyB9KQotCi0KLSNlbmRpZgpkaWZmIC0t
Z2l0IGEvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay91dGlscy5o
IGIvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay91dGlscy5oCmRl
bGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCA0ODBiYWI2MTg2OWMuLjAwMDAwMDAwMDAwMAot
LS0gYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL3V0aWxzLmgK
KysrIC9kZXYvbnVsbApAQCAtMSw3OCArMCwwIEBACi0vKgotICogbmV0bGluay91dGlscy5oCQlV
dGlsaXR5IEZ1bmN0aW9ucwotICoKLSAqCVRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5
b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKLSAqCW1vZGlmeSBpdCB1bmRlciB0aGUgdGVy
bXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKLSAqCUxpY2Vuc2UgYXMgcHVibGlz
aGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24gdmVyc2lvbiAyLjEKLSAqCW9mIHRo
ZSBMaWNlbnNlLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAwMy0yMDA4IFRob21hcyBHcmFmIDx0
Z3JhZkBzdXVnLmNoPgotICovCi0KLSNpZm5kZWYgTkVUTElOS19VVElMU19IXwotI2RlZmluZSBO
RVRMSU5LX1VUSUxTX0hfCi0KLSNpbmNsdWRlIDxuZXRsaW5rL25ldGxpbmsuaD4KLSNpbmNsdWRl
IDxuZXRsaW5rL2xpc3QuaD4KLQotI2lmZGVmIF9fY3BsdXNwbHVzCi1leHRlcm4gIkMiIHsKLSNl
bmRpZgotCi0vKioKLSAqIEBuYW1lIFByb2JhYmlsaXR5IENvbnN0YW50cwotICogQHsKLSAqLwot
Ci0vKioKLSAqIExvd2VyIHByb2JhYmlsaXR5IGxpbWl0Ci0gKiBAaW5ncm91cCB1dGlscwotICov
Ci0jZGVmaW5lIE5MX1BST0JfTUlOIDB4MAotCi0vKioKLSAqIFVwcGVyIHByb2JhYmlsaXR5IGxp
bWl0Ci0gKiBAaW5ncm91cCB1dGlscwotICovCi0jZGVmaW5lIE5MX1BST0JfTUFYIDB4ZmZmZmZm
ZmYKLQotLyoqIEB9ICovCi0KLS8qIHVuaXQgcHJldHR5LXByaW50aW5nICovCi1leHRlcm4gZG91
YmxlCW5sX2NhbmNlbF9kb3duX2J5dGVzKHVuc2lnbmVkIGxvbmcgbG9uZywgY2hhciAqKik7Ci1l
eHRlcm4gZG91YmxlCW5sX2NhbmNlbF9kb3duX2JpdHModW5zaWduZWQgbG9uZyBsb25nLCBjaGFy
ICoqKTsKLWV4dGVybiBkb3VibGUJbmxfY2FuY2VsX2Rvd25fdXModWludDMyX3QsIGNoYXIgKiop
OwotCi0vKiBnZW5lcmljIHVuaXQgdHJhbnNsYXRpb25zICovCi1leHRlcm4gbG9uZwlubF9zaXpl
MmludChjb25zdCBjaGFyICopOwotZXh0ZXJuIGxvbmcJbmxfcHJvYjJpbnQoY29uc3QgY2hhciAq
KTsKLQotLyogdGltZSB0cmFuc2xhdGlvbnMgKi8KLWV4dGVybiBpbnQJbmxfZ2V0X2h6KHZvaWQp
OwotZXh0ZXJuIHVpbnQzMl90CW5sX3VzMnRpY2tzKHVpbnQzMl90KTsKLWV4dGVybiB1aW50MzJf
dAlubF90aWNrczJ1cyh1aW50MzJfdCk7Ci1leHRlcm4gaW50CW5sX3N0cjJtc2VjKGNvbnN0IGNo
YXIgKiwgdWludDY0X3QgKik7Ci1leHRlcm4gY2hhciAqCW5sX21zZWMyc3RyKHVpbnQ2NF90LCBj
aGFyICosIHNpemVfdCk7Ci0KLS8qIGxpbmsgbGF5ZXIgcHJvdG9jb2wgdHJhbnNsYXRpb25zICov
Ci1leHRlcm4gY2hhciAqCW5sX2xscHJvdG8yc3RyKGludCwgY2hhciAqLCBzaXplX3QpOwotZXh0
ZXJuIGludAlubF9zdHIybGxwcm90byhjb25zdCBjaGFyICopOwotCi0vKiBldGhlcm5ldCBwcm90
b2NvbCB0cmFuc2xhdGlvbnMgKi8KLWV4dGVybiBjaGFyICoJbmxfZXRoZXJfcHJvdG8yc3RyKGlu
dCwgY2hhciAqLCBzaXplX3QpOwotZXh0ZXJuIGludAlubF9zdHIyZXRoZXJfcHJvdG8oY29uc3Qg
Y2hhciAqKTsKLQotLyogSVAgcHJvdG9jb2wgdHJhbnNsYXRpb25zICovCi1leHRlcm4gY2hhciAq
CW5sX2lwX3Byb3RvMnN0cihpbnQsIGNoYXIgKiwgc2l6ZV90KTsKLWV4dGVybiBpbnQJbmxfc3Ry
MmlwX3Byb3RvKGNvbnN0IGNoYXIgKik7Ci0KLS8qIER1bXBpbmcgaGVscGVycyAqLwotZXh0ZXJu
IHZvaWQJbmxfbmV3X2xpbmUoc3RydWN0IG5sX2R1bXBfcGFyYW1zICopOwotZXh0ZXJuIHZvaWQJ
bmxfZHVtcChzdHJ1Y3QgbmxfZHVtcF9wYXJhbXMgKiwgY29uc3QgY2hhciAqLCAuLi4pOwotZXh0
ZXJuIHZvaWQJbmxfZHVtcF9saW5lKHN0cnVjdCBubF9kdW1wX3BhcmFtcyAqLCBjb25zdCBjaGFy
ICosIC4uLik7Ci0KLSNpZmRlZiBfX2NwbHVzcGx1cwotfQotI2VuZGlmCi0KLSNlbmRpZgpkaWZm
IC0tZ2l0IGEvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay92ZXJz
aW9uLmggYi9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvaW5jbHVkZS9uZXRsaW5rL3ZlcnNp
b24uaApkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggNmEzMTZkNDkzMzZhLi4wMDAwMDAw
MDAwMDAKLS0tIGEvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvbmV0bGluay92
ZXJzaW9uLmgKKysrIC9kZXYvbnVsbApAQCAtMSwxOCArMCwwIEBACi0vKgotICogbmV0bGluay92
ZXJzaW9uLmgJQ29tcGlsZSBUaW1lIFZlcnNpb25pbmcgSW5mb3JtYXRpb24KLSAqCi0gKglUaGlz
IGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29y
Ci0gKgltb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwg
UHVibGljCi0gKglMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3Vu
ZGF0aW9uIHZlcnNpb24gMi4xCi0gKglvZiB0aGUgTGljZW5zZS4KLSAqCi0gKiBDb3B5cmlnaHQg
KGMpIDIwMDggVGhvbWFzIEdyYWYgPHRncmFmQHN1dWcuY2g+Ci0gKi8KLQotI2lmbmRlZiBORVRM
SU5LX1ZFUlNJT05fSF8KLSNkZWZpbmUgTkVUTElOS19WRVJTSU9OX0hfCi0KLSNkZWZpbmUgTElC
TkxfU1RSSU5HICJsaWJubCIKLSNkZWZpbmUgTElCTkxfVkVSU0lPTiAiMi4wIgotCi0jZW5kaWYK
ZGlmZiAtLWdpdCBhL3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL3VubC5oIGIv
cGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL2luY2x1ZGUvdW5sLmgKZGVsZXRlZCBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDRmZTdkYzc0NWQxYi4uMDAwMDAwMDAwMDAwCi0tLSBhL3BhY2thZ2Uv
bGlicy9saWJubC10aW55L3NyYy9pbmNsdWRlL3VubC5oCisrKyAvZGV2L251bGwKQEAgLTEsNDcg
KzAsMCBAQAotI2lmbmRlZiBfX1VOTF9ICi0jZGVmaW5lIF9fVU5MX0gKLQotI2luY2x1ZGUgPG5l
dGxpbmsvbmV0bGluay5oPgotI2luY2x1ZGUgPG5ldGxpbmsvZ2VubC9nZW5sLmg+Ci0jaW5jbHVk
ZSA8bmV0bGluay9nZW5sL2ZhbWlseS5oPgotI2luY2x1ZGUgPHN0ZGJvb2wuaD4KLQotc3RydWN0
IHVubCB7Ci0Jc3RydWN0IG5sX3NvY2sgKnNvY2s7Ci0Jc3RydWN0IG5sX2NhY2hlICpjYWNoZTsK
LQlzdHJ1Y3QgZ2VubF9mYW1pbHkgKmZhbWlseTsKLQljaGFyICpmYW1pbHlfbmFtZTsKLQlpbnQg
aGRybGVuOwotCWJvb2wgbG9vcF9kb25lOwotfTsKLQotaW50IHVubF9nZW5sX2luaXQoc3RydWN0
IHVubCAqdW5sLCBjb25zdCBjaGFyICpmYW1pbHkpOwotdm9pZCB1bmxfZnJlZShzdHJ1Y3QgdW5s
ICp1bmwpOwotCi10eXBlZGVmIGludCAoKnVubF9jYikoc3RydWN0IG5sX21zZyAqLCB2b2lkICop
OwotCi1zdHJ1Y3QgbmxfbXNnICp1bmxfZ2VubF9tc2coc3RydWN0IHVubCAqdW5sLCBpbnQgY21k
LCBib29sIGR1bXApOwotaW50IHVubF9nZW5sX3JlcXVlc3Qoc3RydWN0IHVubCAqdW5sLCBzdHJ1
Y3QgbmxfbXNnICptc2csIHVubF9jYiBoYW5kbGVyLCB2b2lkICphcmcpOwotaW50IHVubF9nZW5s
X3JlcXVlc3Rfc2luZ2xlKHN0cnVjdCB1bmwgKnVubCwgc3RydWN0IG5sX21zZyAqbXNnLCBzdHJ1
Y3QgbmxfbXNnICoqZGVzdCk7Ci12b2lkIHVubF9nZW5sX2xvb3Aoc3RydWN0IHVubCAqdW5sLCB1
bmxfY2IgaGFuZGxlciwgdm9pZCAqYXJnKTsKLQotaW50IHVubF9nZW5sX211bHRpY2FzdF9pZChz
dHJ1Y3QgdW5sICp1bmwsIGNvbnN0IGNoYXIgKm5hbWUpOwotaW50IHVubF9nZW5sX3N1YnNjcmli
ZShzdHJ1Y3QgdW5sICp1bmwsIGNvbnN0IGNoYXIgKm5hbWUpOwotaW50IHVubF9nZW5sX3Vuc3Vi
c2NyaWJlKHN0cnVjdCB1bmwgKnVubCwgY29uc3QgY2hhciAqbmFtZSk7Ci0KLWludCB1bmxfbmw4
MDIxMV9waHlfbG9va3VwKGNvbnN0IGNoYXIgKm5hbWUpOwotaW50IHVubF9ubDgwMjExX3dkZXZf
dG9fcGh5KHN0cnVjdCB1bmwgKnVubCwgaW50IHdkZXYpOwotc3RydWN0IG5sX21zZyAqdW5sX25s
ODAyMTFfcGh5X21zZyhzdHJ1Y3QgdW5sICp1bmwsIGludCBwaHksIGludCBjbWQsIGJvb2wgZHVt
cCk7Ci1zdHJ1Y3QgbmxfbXNnICp1bmxfbmw4MDIxMV92aWZfbXNnKHN0cnVjdCB1bmwgKnVubCwg
aW50IGRldiwgaW50IGNtZCwgYm9vbCBkdW1wKTsKLQotc3RhdGljIGlubGluZSB2b2lkIHVubF9s
b29wX2RvbmUoc3RydWN0IHVubCAqdW5sKQotewotCXVubC0+bG9vcF9kb25lID0gdHJ1ZTsKLX0K
LQotc3RhdGljIGlubGluZSBzdHJ1Y3QgbmxhdHRyICp1bmxfZmluZF9hdHRyKHN0cnVjdCB1bmwg
KnVubCwgc3RydWN0IG5sX21zZyAqbXNnLCBpbnQgYXR0cikKLXsKLQlyZXR1cm4gbmxtc2dfZmlu
ZF9hdHRyKG5sbXNnX2hkcihtc2cpLCB1bmwtPmhkcmxlbiwgYXR0cik7Ci19Ci0KLSNlbmRpZgpk
aWZmIC0tZ2l0IGEvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL21zZy5jIGIvcGFja2FnZS9s
aWJzL2xpYm5sLXRpbnkvc3JjL21zZy5jCmRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCBi
NTAyMDQ3YzRjNzQuLjAwMDAwMDAwMDAwMAotLS0gYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9z
cmMvbXNnLmMKKysrIC9kZXYvbnVsbApAQCAtMSw1NjEgKzAsMCBAQAotLyoKLSAqIGxpYi9tc2cu
YwkJTmV0bGluayBNZXNzYWdlcyBJbnRlcmZhY2UKLSAqCi0gKglUaGlzIGxpYnJhcnkgaXMgZnJl
ZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yCi0gKgltb2RpZnkgaXQg
dW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCi0gKglMaWNl
bnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uIHZlcnNpb24g
Mi4xCi0gKglvZiB0aGUgTGljZW5zZS4KLSAqCi0gKiBDb3B5cmlnaHQgKGMpIDIwMDMtMjAwOCBU
aG9tYXMgR3JhZiA8dGdyYWZAc3V1Zy5jaD4KLSAqLwotCi0vKioKLSAqIEBpbmdyb3VwIGNvcmUK
LSAqIEBkZWZncm91cCBtc2cgTWVzc2FnZXMKLSAqIE5ldGxpbmsgTWVzc2FnZSBDb25zdHJ1Y3Rp
b24vUGFyc2luZyBJbnRlcmZhY2UKLSAqIAotICogVGhlIGZvbGxvd2luZyBpbmZvcm1hdGlvbiBp
cyBwYXJ0bHkgZXh0cmFjdGVkIGZyb20gUkZDMzU0OQotICogKGZ0cDovL2Z0cC5yZmMtZWRpdG9y
Lm9yZy9pbi1ub3Rlcy9yZmMzNTQ5LnR4dCkKLSAqCi0gKiBAcGFyIE1lc3NhZ2UgRm9ybWF0Ci0g
KiBOZXRsaW5rIG1lc3NhZ2VzIGNvbnNpc3Qgb2YgYSBieXRlIHN0cmVhbSB3aXRoIG9uZSBvciBt
dWx0aXBsZQotICogTmV0bGluayBoZWFkZXJzIGFuZCBhbiBhc3NvY2lhdGVkIHBheWxvYWQuICBJ
ZiB0aGUgcGF5bG9hZCBpcyB0b28gYmlnCi0gKiB0byBmaXQgaW50byBhIHNpbmdsZSBtZXNzYWdl
IGl0LCBjYW4gYmUgc3BsaXQgb3ZlciBtdWx0aXBsZSBOZXRsaW5rCi0gKiBtZXNzYWdlcywgY29s
bGVjdGl2ZWx5IGNhbGxlZCBhIG11bHRpcGFydCBtZXNzYWdlLiAgRm9yIG11bHRpcGFydAotICog
bWVzc2FnZXMsIHRoZSBmaXJzdCBhbmQgYWxsIGZvbGxvd2luZyBoZWFkZXJzIGhhdmUgdGhlIFxj
IE5MTV9GX01VTFRJCi0gKiBOZXRsaW5rIGhlYWRlciBmbGFnIHNldCwgZXhjZXB0IGZvciB0aGUg
bGFzdCBoZWFkZXIgd2hpY2ggaGFzIHRoZQotICogTmV0bGluayBoZWFkZXIgdHlwZSBcYyBOTE1T
R19ET05FLgotICoKLSAqIEBwYXIKLSAqIFRoZSBOZXRsaW5rIG1lc3NhZ2UgaGVhZGVyIChcbGlu
ayBubG1zZ2hkciBzdHJ1Y3Qgbmxtc2doZHJcZW5kbGluaykgaXMgc2hvd24gYmVsb3cuCi0gKiBA
Y29kZSAgIAotICogMCAgICAgICAgICAgICAgICAgICAxICAgICAgICAgICAgICAgICAgIDIgICAg
ICAgICAgICAgICAgICAgMwotICogMCAxIDIgMyA0IDUgNiA3IDggOSAwIDEgMiAzIDQgNSA2IDcg
OCA5IDAgMSAyIDMgNCA1IDYgNyA4IDkgMCAxCi0gKiArLSstKy0rLSstKy0rLSstKy0rLSstKy0r
LSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSsKLSAqIHwgICAgICAgICAgICAg
ICAgICAgICAgICAgIExlbmd0aCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfAotICogKy0r
LSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSst
Ky0rCi0gKiB8ICAgICAgICAgICAgVHlwZSAgICAgICAgICAgICAgfCAgICAgICAgICAgRmxhZ3Mg
ICAgICAgICAgICAgIHwKLSAqICstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSst
Ky0rLSstKy0rLSstKy0rLSstKy0rLSstKwotICogfCAgICAgICAgICAgICAgICAgICAgICBTZXF1
ZW5jZSBOdW1iZXIgICAgICAgICAgICAgICAgICAgICAgICB8Ci0gKiArLSstKy0rLSstKy0rLSst
Ky0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSsKLSAqIHwgICAg
ICAgICAgICAgICAgICAgICAgUHJvY2VzcyBJRCAoUElEKSAgICAgICAgICAgICAgICAgICAgICAg
fAotICogKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0r
LSstKy0rLSstKy0rCi0gKiBAZW5kY29kZQotICoKLSAqIEBwYXIKLSAqIFRoZSBuZXRsaW5rIG1l
c3NhZ2UgaGVhZGVyIGFuZCBwYXlsb2FkIG11c3QgYmUgYWxpZ25lZCBwcm9wZXJseToKLSAqIEBj
b2RlCi0gKiAgPC0tLS0tLS0gTkxNU0dfQUxJR04oaGxlbikgLS0tLS0tPiA8LS0tLSBOTE1TR19B
TElHTihsZW4pIC0tLT4KLSAqICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0gLSAtKy0g
LSAtIC0gLSAtIC0gLSAtIC0gLSstIC0gLSsKLSAqIHwgICAgICAgICAgIEhlYWRlciAgICAgICAg
ICAgfCBQYWQgfCAgICAgICBQYXlsb2FkICAgICAgIHwgUGFkIHwKLSAqIHwgICAgICBzdHJ1Y3Qg
bmxtc2doZHIgICAgICAgfCAgICAgfCAgICAgICAgICAgICAgICAgICAgIHwgICAgIHwKLSAqICst
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0gLSAtKy0gLSAtIC0gLSAtIC0gLSAtIC0gLSst
IC0gLSsKLSAqIEBlbmRjb2RlCi0gKiBAcGFyCi0gKiBNZXNzYWdlIEZvcm1hdDoKLSAqIEBjb2Rl
Ci0gKiAgICA8LS0tIG5sbXNnX3RvdGFsX3NpemUocGF5bG9hZCkgIC0tLT4KLSAqICAgIDwtLSBu
bG1zZ19tc2dfc2l6ZShwYXlsb2FkKSAtPgotICogICArLS0tLS0tLS0tLSstIC0gLSstLS0tLS0t
LS0tLS0tKy0gLSAtKy0tLS0tLS0tIC0gLQotICogICB8IG5sbXNnaGRyIHwgUGFkIHwgICBQYXls
b2FkICAgfCBQYWQgfCBubG1zZ2hkcgotICogICArLS0tLS0tLS0tLSstIC0gLSstLS0tLS0tLS0t
LS0tKy0gLSAtKy0tLS0tLS0tIC0gLQotICogICBubG1zZ19kYXRhKG5saCktLS1eICAgICAgICAg
ICAgICAgICAgIF4KLSAqICAgbmxtc2dfbmV4dChubGgpLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0r
Ci0gKiBAZW5kY29kZQotICogQHBhcgotICogVGhlIHBheWxvYWQgbWF5IGNvbnNpc3Qgb2YgYXJi
aXRhcnkgZGF0YSBidXQgbWF5IGhhdmUgc3RyaWN0Ci0gKiBhbGlnbm1lbnQgYW5kIGZvcm1hdHRp
bmcgcnVsZXMgZGVwZW5pbmcgb24gdGhlIHNwZWNpZmljIG5ldGxpbmsKLSAqIGZhbWlsaWVzLgot
ICogQHBhcgotICogQGNvZGUKLSAqICAgIDwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tIG5sbXNnX2xl
bihubGgpIC0tLS0tLS0tLS0tLS0tLS0tLS0tLT4KLSAqICAgIDwtLS0tLS0gaGRybGVuIC0tLS0t
LT4gICAgICAgPC0gbmxtc2dfYXR0cmxlbihubGgsIGhkcmxlbikgLT4KLSAqICAgKy0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0rLSAtIC0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCi0g
KiAgIHwgICAgIEZhbWlseSBIZWFkZXIgICAgfCBQYWQgfCAgICAgICAgICAgQXR0cmlidXRlcyAg
ICAgICAgICAgfAotICogICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstIC0gLSstLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKLSAqICAgbmxtc2dfYXR0cmRhdGEobmxoLCBoZHJsZW4p
LS0tXgotICogQGVuZGNvZGUKLSAqIEBwYXIgVGhlIEFDSyBOZXRsaW5rIE1lc3NhZ2UKLSAqIFRo
aXMgbWVzc2FnZSBpcyBhY3R1YWxseSB1c2VkIHRvIGRlbm90ZSBib3RoIGFuIEFDSyBhbmQgYSBO
QUNLLgotICogVHlwaWNhbGx5LCB0aGUgZGlyZWN0aW9uIGlzIGZyb20gRkVDIHRvIENQQyAoaW4g
cmVzcG9uc2UgdG8gYW4gQUNLCi0gKiByZXF1ZXN0IG1lc3NhZ2UpLiAgSG93ZXZlciwgdGhlIENQ
QyBzaG91bGQgYmUgYWJsZSB0byBzZW5kIEFDS3MgYmFjawotICogdG8gRkVDIHdoZW4gcmVxdWVz
dGVkLgotICogQGNvZGUKLSAqICAwICAgICAgICAgICAgICAgICAgIDEgICAgICAgICAgICAgICAg
ICAgMiAgICAgICAgICAgICAgICAgICAzCi0gKiAgMCAxIDIgMyA0IDUgNiA3IDggOSAwIDEgMiAz
IDQgNSA2IDcgOCA5IDAgMSAyIDMgNCA1IDYgNyA4IDkgMCAxCi0gKiArLSstKy0rLSstKy0rLSst
Ky0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKwotICogfCAg
ICAgICAgICAgICAgICAgICAgICAgTmV0bGluayBtZXNzYWdlIGhlYWRlciAgICAgICAgICAgICAg
ICAgIHwKLSAqIHwgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSBOTE1TR19FUlJPUiAgICAg
ICAgICAgICAgICAgICAgICB8Ci0gKiArLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSst
Ky0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKwotICogfCAgICAgICAgICAgICAgICAgICAg
ICAgICAgRXJyb3IgY29kZSAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKLSAqICstKy0rLSst
Ky0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0r
Ci0gKiB8ICAgICAgICAgICAgICAgICAgICAgICBPTEQgTmV0bGluayBtZXNzYWdlIGhlYWRlciAg
ICAgICAgICAgICAgfAotICogKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0rLSstKy0r
LSstKy0rLSstKy0rLSstKy0rLSstKy0rLSsKLSAqIEBlbmRjb2RlCi0gKgotICogQHBhciBFeGFt
cGxlCi0gKiBAY29kZQotICogLy8gVmFyaW91cyBtZXRob2RzIGV4aXN0IHRvIGNyZWF0ZS9hbGxv
Y2F0ZSBhIG5ldyBuZXRsaW5rCi0gKiAvLyBtZXNzYWdlLiAKLSAqIC8vCi0gKiAvLyBubG1zZ19h
bGxvYygpIHdpbGwgYWxsb2NhdGUgYW4gZW1wdHkgbmV0bGluayBtZXNzYWdlIHdpdGgKLSAqIC8v
IGEgbWF4aW11bSBwYXlsb2FkIHNpemUgd2hpY2ggZGVmYXVsdHMgdG8gdGhlIHBhZ2Ugc2l6ZSBv
ZgotICogLy8gdGhlIHN5c3RlbS4gVGhpcyBkZWZhdWx0IHNpemUgY2FuIGJlIG1vZGlmaWVkIHVz
aW5nIHRoZQotICogLy8gZnVuY3Rpb24gbmxtc2dfc2V0X2RlZmF1bHRfc2l6ZSgpLgotICogc3Ry
dWN0IG5sX21zZyAqbXNnID0gbmxtc2dfYWxsb2MoKTsKLSAqCi0gKiAvLyBWZXJ5IG9mdGVuLCB0
aGUgbWVzc2FnZSB0eXBlIGFuZCBtZXNzYWdlIGZsYWdzIGFyZSBrbm93bgotICogLy8gYXQgYWxs
b2NhdGlvbiB0aW1lIHdoaWxlIHRoZSBvdGhlciBmaWVsZHMgYXJlIGF1dG8gZ2VuZXJhdGVkOgot
ICogc3RydWN0IG5sX21zZyAqbXNnID0gbmxtc2dfYWxsb2Nfc2ltcGxlKE1ZX1RZUEUsIE1ZX0ZM
QUdTKTsKLSAqCi0gKiAvLyBBbHRlcm5hdGl2ZWx5IGFuIGV4aXN0aW5nIG5ldGxpbmsgbWVzc2Fn
ZSBoZWFkZXIgY2FuIGJlIHVzZWQKLSAqIC8vIHRvIGluaGVyaXQgdGhlIGhlYWRlciB2YWx1ZXM6
Ci0gKiBzdHJ1Y3Qgbmxtc2doZHIgaGRyID0gewotICogCS5ubG1zZ190eXBlID0gTVlfVFlQRSwK
LSAqIAkubmxtc2dfZmxhZ3MgPSBNWV9GTEFHUywKLSAqIH07Ci0gKiBzdHJ1Y3QgbmxfbXNnICpt
c2cgPSBubG1zZ19pbmhlcml0KCZoZHIpOwotICoKLSAqIC8vIExhc3QgYnV0IG5vdCBsZWFzdCwg
bmV0bGluayBtZXNzYWdlcyByZWNlaXZlZCBmcm9tIG5ldGxpbmsgc29ja2V0cwotICogLy8gY2Fu
IGJlIGNvbnZlcnRlZCBpbnRvIG5sX21zZyBvYmplY3RzIHVzaW5nIG5sbXNnX2NvbnZlcnQoKS4g
VGhpcwotICogLy8gd2lsbCBjcmVhdGUgYSBtZXNzYWdlIHdpdGggYSBtYXhpbXVtIHBheWxvYWQg
c2l6ZSB3aGljaCBlcXVhbHMgdGhlCi0gKiAvLyBsZW5ndGggb2YgdGhlIGV4aXN0aW5nIG5ldGxp
bmsgbWVzc2FnZSwgdGhlcmVmb3JlIG5vIG1vcmUgZGF0YSBjYW4KLSAqIC8vIGJlIGFwcGVuZWQg
d2l0aG91dCBjYWxsaW5nIG5sbXNnX2V4cGFuZCgpIGZpcnN0LgotICogc3RydWN0IG5sX21zZyAq
bXNnID0gbmxtc2dfY29udmVydChubGhfZnJvbV9ubF9zb2NrKTsKLSAqCi0gKiAvLyBQYXlsb2Fk
IG1heSBiZSBhZGRlZCB0byB0aGUgbWVzc2FnZSB2aWEgbmxtc2dfYXBwZW5kKCkuIFRoZSBmb3Vy
dGgKLSAqIC8vIHBhcmFtZXRlciBzcGVjaWZpZXMgdGhlIG51bWJlciBvZiBhbGlnbm1lbnQgYnl0
ZXMgdGhlIGRhdGEgc2hvdWxkCi0gKiAvLyBiZSBwYWRkaW5nIHdpdGggYXQgdGhlIGVuZC4gQ29t
bW9uIHZhbHVlcyBhcmUgMCB0byBkaXNhYmxlIGl0IG9yCi0gKiAvLyBOTE1TR19BTElHTlRPIHRv
IGVuc3VyZSBwcm9wZXIgbmV0bGluayBtZXNzYWdlIHBhZGRpbmcuCi0gKiBubG1zZ19hcHBlbmQo
bXNnLCAmbXlkYXRhLCBzaXplb2YobXlkYXRhKSwgMCk7Ci0gKgotICogLy8gU29tZXRpbWVzIGl0
IG1heSBiZSBuZWNlc3NhcnkgdG8gcmVzZXJ2ZSByb29tIGZvciBkYXRhIGJ1dCBkZWZlcgotICog
Ly8gdGhlIGFjdHVhbCBjb3B5aW5nIHRvIGEgbGF0ZXIgcG9pbnQsIG5sbXNnX3Jlc2VydmUoKSBj
YW4gYmUgdXNlZAotICogLy8gZm9yIHRoaXMgcHVycG9zZToKLSAqIHZvaWQgKmRhdGEgPSBubG1z
Z19yZXNlcnZlKG1zZywgc2l6ZW9mKG15ZGF0YSksIE5MTVNHX0FMSUdOVE8pOwotICoKLSAqIC8v
IEF0dHJpYnV0ZXMgbWF5IGJlIGFkZGVkIHVzaW5nIHRoZSBhdHRyaWJ1dGVzIGludGVyZmFjZS4K
LSAqCi0gKiAvLyBBZnRlciBzdWNjZXNzZnVsIHVzZSBvZiB0aGUgbWVzc2FnZSwgdGhlIG1lbW9y
eSBtdXN0IGJlIGZyZWVkCi0gKiAvLyB1c2luZyBubG1zZ19mcmVlKCkKLSAqIG5sbXNnX2ZyZWUo
bXNnKTsKLSAqIEBlbmRjb2RlCi0gKiAKLSAqIEBwYXIgNCkgUGFyc2luZyBtZXNzYWdlcwotICog
QGNvZGUKLSAqIGludCBuOwotICogdW5zaWduZWQgY2hhciAqYnVmOwotICogc3RydWN0IG5sbXNn
aGRyICpoZHI7Ci0gKgotICogbiA9IG5sX3JlY3YoaGFuZGxlLCBOVUxMLCAmYnVmKTsKLSAqIAot
ICogaGRyID0gKHN0cnVjdCBubG1zZ2hkciAqKSBidWY7Ci0gKiB3aGlsZSAobmxtc2dfb2soaGRy
LCBuKSkgewotICogCS8vIFByb2Nlc3MgbWVzc2FnZSBoZXJlLi4uCi0gKiAJaGRyID0gbmxtc2df
bmV4dChoZHIsICZuKTsKLSAqIH0KLSAqIEBlbmRjb2RlCi0gKiBAewotICovCi0KLSNpbmNsdWRl
IDxuZXRsaW5rLWxvY2FsLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9uZXRsaW5rLmg+Ci0jaW5jbHVk
ZSA8bmV0bGluay91dGlscy5oPgotI2luY2x1ZGUgPG5ldGxpbmsvY2FjaGUuaD4KLSNpbmNsdWRl
IDxuZXRsaW5rL2F0dHIuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL21zZy5oPgotI2luY2x1ZGUgPGxp
bnV4L3NvY2tldC5oPgotCi1zdGF0aWMgc2l6ZV90IGRlZmF1bHRfbXNnX3NpemUgPSA0MDk2Owot
Ci0vKioKLSAqIEBuYW1lIEF0dHJpYnV0ZSBBY2Nlc3MKLSAqIEB7Ci0gKi8KLQotLy8qKiBAfSAq
LwotCi0vKioKLSAqIEBuYW1lIE1lc3NhZ2UgUGFyc2luZwotICogQHsKLSAqLwotCi0vKioKLSAq
IGNoZWNrIGlmIHRoZSBuZXRsaW5rIG1lc3NhZ2UgZml0cyBpbnRvIHRoZSByZW1haW5pbmcgYnl0
ZXMKLSAqIEBhcmcgbmxoCQluZXRsaW5rIG1lc3NhZ2UgaGVhZGVyCi0gKiBAYXJnIHJlbWFpbmlu
ZwludW1iZXIgb2YgYnl0ZXMgcmVtYWluaW5nIGluIG1lc3NhZ2Ugc3RyZWFtCi0gKi8KLWludCBu
bG1zZ19vayhjb25zdCBzdHJ1Y3Qgbmxtc2doZHIgKm5saCwgaW50IHJlbWFpbmluZykKLXsKLQly
ZXR1cm4gKHJlbWFpbmluZyA+PSBzaXplb2Yoc3RydWN0IG5sbXNnaGRyKSAmJgotCQlubGgtPm5s
bXNnX2xlbiA+PSBzaXplb2Yoc3RydWN0IG5sbXNnaGRyKSAmJgotCQlubGgtPm5sbXNnX2xlbiA8
PSByZW1haW5pbmcpOwotfQotCi0vKioKLSAqIG5leHQgbmV0bGluayBtZXNzYWdlIGluIG1lc3Nh
Z2Ugc3RyZWFtCi0gKiBAYXJnIG5saAkJbmV0bGluayBtZXNzYWdlIGhlYWRlcgotICogQGFyZyBy
ZW1haW5pbmcJbnVtYmVyIG9mIGJ5dGVzIHJlbWFpbmluZyBpbiBtZXNzYWdlIHN0cmVhbQotICoK
LSAqIEByZXR1cm5zIHRoZSBuZXh0IG5ldGxpbmsgbWVzc2FnZSBpbiB0aGUgbWVzc2FnZSBzdHJl
YW0gYW5kCi0gKiBkZWNyZW1lbnRzIHJlbWFpbmluZyBieSB0aGUgc2l6ZSBvZiB0aGUgY3VycmVu
dCBtZXNzYWdlLgotICovCi1zdHJ1Y3Qgbmxtc2doZHIgKm5sbXNnX25leHQoc3RydWN0IG5sbXNn
aGRyICpubGgsIGludCAqcmVtYWluaW5nKQotewotCWludCB0b3RsZW4gPSBOTE1TR19BTElHTihu
bGgtPm5sbXNnX2xlbik7Ci0KLQkqcmVtYWluaW5nIC09IHRvdGxlbjsKLQotCXJldHVybiAoc3Ry
dWN0IG5sbXNnaGRyICopICgodW5zaWduZWQgY2hhciAqKSBubGggKyB0b3RsZW4pOwotfQotCi0v
KioKLSAqIHBhcnNlIGF0dHJpYnV0ZXMgb2YgYSBuZXRsaW5rIG1lc3NhZ2UKLSAqIEBhcmcgbmxo
CQluZXRsaW5rIG1lc3NhZ2UgaGVhZGVyCi0gKiBAYXJnIGhkcmxlbgkJbGVuZ3RoIG9mIGZhbWls
eSBzcGVjaWZpYyBoZWFkZXIKLSAqIEBhcmcgdGIJCWRlc3RpbmF0aW9uIGFycmF5IHdpdGggbWF4
dHlwZSsxIGVsZW1lbnRzCi0gKiBAYXJnIG1heHR5cGUJCW1heGltdW0gYXR0cmlidXRlIHR5cGUg
dG8gYmUgZXhwZWN0ZWQKLSAqIEBhcmcgcG9saWN5CQl2YWxpZGF0aW9uIHBvbGljeQotICoKLSAq
IFNlZSBubGFfcGFyc2UoKQotICovCi1pbnQgbmxtc2dfcGFyc2Uoc3RydWN0IG5sbXNnaGRyICpu
bGgsIGludCBoZHJsZW4sIHN0cnVjdCBubGF0dHIgKnRiW10sCi0JCWludCBtYXh0eXBlLCBzdHJ1
Y3QgbmxhX3BvbGljeSAqcG9saWN5KQotewotCWlmICghbmxtc2dfdmFsaWRfaGRyKG5saCwgaGRy
bGVuKSkKLQkJcmV0dXJuIC1OTEVfTVNHX1RPT1NIT1JUOwotCi0JcmV0dXJuIG5sYV9wYXJzZSh0
YiwgbWF4dHlwZSwgbmxtc2dfYXR0cmRhdGEobmxoLCBoZHJsZW4pLAotCQkJIG5sbXNnX2F0dHJs
ZW4obmxoLCBoZHJsZW4pLCBwb2xpY3kpOwotfQotCi0vKioKLSAqIG5sbXNnX3ZhbGlkYXRlIC0g
dmFsaWRhdGUgYSBuZXRsaW5rIG1lc3NhZ2UgaW5jbHVkaW5nIGF0dHJpYnV0ZXMKLSAqIEBhcmcg
bmxoCQluZXRsaW5rZXQgbWVzc2FnZSBoZWFkZXIKLSAqIEBhcmcgaGRybGVuCQlsZW5ndGggb2Yg
ZmFtaWxpeSBzcGVjaWZpYyBoZWFkZXIKLSAqIEBhcmcgbWF4dHlwZQkJbWF4aW11bSBhdHRyaWJ1
dGUgdHlwZSB0byBiZSBleHBlY3RlZAotICogQGFyZyBwb2xpY3kJCXZhbGlkYXRpb24gcG9saWN5
Ci0gKi8KLWludCBubG1zZ192YWxpZGF0ZShzdHJ1Y3Qgbmxtc2doZHIgKm5saCwgaW50IGhkcmxl
biwgaW50IG1heHR5cGUsCi0JCSAgIHN0cnVjdCBubGFfcG9saWN5ICpwb2xpY3kpCi17Ci0JaWYg
KCFubG1zZ192YWxpZF9oZHIobmxoLCBoZHJsZW4pKQotCQlyZXR1cm4gLU5MRV9NU0dfVE9PU0hP
UlQ7Ci0KLQlyZXR1cm4gbmxhX3ZhbGlkYXRlKG5sbXNnX2F0dHJkYXRhKG5saCwgaGRybGVuKSwK
LQkJCSAgICBubG1zZ19hdHRybGVuKG5saCwgaGRybGVuKSwgbWF4dHlwZSwgcG9saWN5KTsKLX0K
LQotLyoqIEB9ICovCi0KLS8qKgotICogQG5hbWUgTWVzc2FnZSBCdWlsZGluZy9BY2Nlc3MKLSAq
IEB7Ci0gKi8KLQotc3RhdGljIHN0cnVjdCBubF9tc2cgKl9fbmxtc2dfYWxsb2Moc2l6ZV90IGxl
bikKLXsKLQlzdHJ1Y3QgbmxfbXNnICpubTsKLQotCW5tID0gY2FsbG9jKDEsIHNpemVvZigqbm0p
KTsKLQlpZiAoIW5tKQotCQlnb3RvIGVycm91dDsKLQotCW5tLT5ubV9yZWZjbnQgPSAxOwotCi0J
bm0tPm5tX25saCA9IG1hbGxvYyhsZW4pOwotCWlmICghbm0tPm5tX25saCkKLQkJZ290byBlcnJv
dXQ7Ci0KLQltZW1zZXQobm0tPm5tX25saCwgMCwgc2l6ZW9mKHN0cnVjdCBubG1zZ2hkcikpOwot
Ci0Jbm0tPm5tX3Byb3RvY29sID0gLTE7Ci0Jbm0tPm5tX3NpemUgPSBsZW47Ci0Jbm0tPm5tX25s
aC0+bmxtc2dfbGVuID0gbmxtc2dfdG90YWxfc2l6ZSgwKTsKLQotCU5MX0RCRygyLCAibXNnICVw
OiBBbGxvY2F0ZWQgbmV3IG1lc3NhZ2UsIG1heGxlbj0lenVcbiIsIG5tLCBsZW4pOwotCi0JcmV0
dXJuIG5tOwotZXJyb3V0OgotCWZyZWUobm0pOwotCXJldHVybiBOVUxMOwotfQotCi0vKioKLSAq
IEFsbG9jYXRlIGEgbmV3IG5ldGxpbmsgbWVzc2FnZSB3aXRoIHRoZSBkZWZhdWx0IG1heGltdW0g
cGF5bG9hZCBzaXplLgotICoKLSAqIEFsbG9jYXRlcyBhIG5ldyBuZXRsaW5rIG1lc3NhZ2Ugd2l0
aG91dCBhbnkgZnVydGhlciBwYXlsb2FkLiBUaGUKLSAqIG1heGltdW0gcGF5bG9hZCBzaXplIGRl
ZmF1bHRzIHRvIFBBR0VTSVpFIG9yIGFzIG90aGVyd2lzZSBzcGVjaWZpZWQKLSAqIHdpdGggbmxt
c2dfc2V0X2RlZmF1bHRfc2l6ZSgpLgotICoKLSAqIEByZXR1cm4gTmV3bHkgYWxsb2NhdGVkIG5l
dGxpbmsgbWVzc2FnZSBvciBOVUxMLgotICovCi1zdHJ1Y3QgbmxfbXNnICpubG1zZ19hbGxvYyh2
b2lkKQotewotCXJldHVybiBfX25sbXNnX2FsbG9jKGRlZmF1bHRfbXNnX3NpemUpOwotfQotCi0v
KioKLSAqIEFsbG9jYXRlIGEgbmV3IG5ldGxpbmsgbWVzc2FnZSB3aXRoIG1heGltdW0gcGF5bG9h
ZCBzaXplIHNwZWNpZmllZC4KLSAqLwotc3RydWN0IG5sX21zZyAqbmxtc2dfYWxsb2Nfc2l6ZShz
aXplX3QgbWF4KQotewotCXJldHVybiBfX25sbXNnX2FsbG9jKG1heCk7Ci19Ci0KLS8qKgotICog
QWxsb2NhdGUgYSBuZXcgbmV0bGluayBtZXNzYWdlIGFuZCBpbmhlcml0IG5ldGxpbmsgbWVzc2Fn
ZSBoZWFkZXIKLSAqIEBhcmcgaGRyCQlOZXRsaW5rIG1lc3NhZ2UgaGVhZGVyIHRlbXBsYXRlCi0g
KgotICogQWxsb2NhdGVzIGEgbmV3IG5ldGxpbmsgbWVzc2FnZSBhbmQgaW5oZXJpdHMgdGhlIG9y
aWdpbmFsIG1lc3NhZ2UKLSAqIGhlYWRlci4gSWYgXGEgaGRyIGlzIG5vdCBOVUxMIGl0IHdpbGwg
YmUgdXNlZCBhcyBhIHRlbXBsYXRlIGZvcgotICogdGhlIG5ldGxpbmsgbWVzc2FnZSBoZWFkZXIs
IG90aGVyd2lzZSB0aGUgaGVhZGVyIGlzIGxlZnQgYmxhbmsuCi0gKiAKLSAqIEByZXR1cm4gTmV3
bHkgYWxsb2NhdGVkIG5ldGxpbmsgbWVzc2FnZSBvciBOVUxMCi0gKi8KLXN0cnVjdCBubF9tc2cg
Km5sbXNnX2luaGVyaXQoc3RydWN0IG5sbXNnaGRyICpoZHIpCi17Ci0Jc3RydWN0IG5sX21zZyAq
bm07Ci0KLQlubSA9IG5sbXNnX2FsbG9jKCk7Ci0JaWYgKG5tICYmIGhkcikgewotCQlzdHJ1Y3Qg
bmxtc2doZHIgKm5ldyA9IG5tLT5ubV9ubGg7Ci0KLQkJbmV3LT5ubG1zZ190eXBlID0gaGRyLT5u
bG1zZ190eXBlOwotCQluZXctPm5sbXNnX2ZsYWdzID0gaGRyLT5ubG1zZ19mbGFnczsKLQkJbmV3
LT5ubG1zZ19zZXEgPSBoZHItPm5sbXNnX3NlcTsKLQkJbmV3LT5ubG1zZ19waWQgPSBoZHItPm5s
bXNnX3BpZDsKLQl9Ci0KLQlyZXR1cm4gbm07Ci19Ci0KLS8qKgotICogQWxsb2NhdGUgYSBuZXcg
bmV0bGluayBtZXNzYWdlCi0gKiBAYXJnIG5sbXNndHlwZQlOZXRsaW5rIG1lc3NhZ2UgdHlwZQot
ICogQGFyZyBmbGFncwkJTWVzc2FnZSBmbGFncy4KLSAqCi0gKiBAcmV0dXJuIE5ld2x5IGFsbG9j
YXRlZCBuZXRsaW5rIG1lc3NhZ2Ugb3IgTlVMTC4KLSAqLwotc3RydWN0IG5sX21zZyAqbmxtc2df
YWxsb2Nfc2ltcGxlKGludCBubG1zZ3R5cGUsIGludCBmbGFncykKLXsKLQlzdHJ1Y3QgbmxfbXNn
ICptc2c7Ci0Jc3RydWN0IG5sbXNnaGRyIG5saCA9IHsKLQkJLm5sbXNnX3R5cGUgPSBubG1zZ3R5
cGUsCi0JCS5ubG1zZ19mbGFncyA9IGZsYWdzLAotCX07Ci0KLQltc2cgPSBubG1zZ19pbmhlcml0
KCZubGgpOwotCWlmIChtc2cpCi0JCU5MX0RCRygyLCAibXNnICVwOiBBbGxvY2F0ZWQgbmV3IHNp
bXBsZSBtZXNzYWdlXG4iLCBtc2cpOwotCi0JcmV0dXJuIG1zZzsKLX0KLQotLyoqCi0gKiBTZXQg
dGhlIGRlZmF1bHQgbWF4aW11bSBtZXNzYWdlIHBheWxvYWQgc2l6ZSBmb3IgYWxsb2NhdGVkIG1l
c3NhZ2VzCi0gKiBAYXJnIG1heAkJU2l6ZSBvZiBwYXlsb2FkIGluIGJ5dGVzLgotICovCi12b2lk
IG5sbXNnX3NldF9kZWZhdWx0X3NpemUoc2l6ZV90IG1heCkKLXsKLQlpZiAobWF4IDwgbmxtc2df
dG90YWxfc2l6ZSgwKSkKLQkJbWF4ID0gbmxtc2dfdG90YWxfc2l6ZSgwKTsKLQotCWRlZmF1bHRf
bXNnX3NpemUgPSBtYXg7Ci19Ci0KLS8qKgotICogQ29udmVydCBhIG5ldGxpbmsgbWVzc2FnZSBy
ZWNlaXZlZCBmcm9tIGEgbmV0bGluayBzb2NrZXQgdG8gYSBubF9tc2cKLSAqIEBhcmcgaGRyCQlO
ZXRsaW5rIG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBuZXRsaW5rIHNvY2tldC4KLSAqCi0gKiBBbGxv
Y2F0ZXMgYSBuZXcgbmV0bGluayBtZXNzYWdlIGFuZCBjb3BpZXMgYWxsIG9mIHRoZSBkYXRhIHBv
aW50ZWQgdG8KLSAqIGJ5IFxhIGhkciBpbnRvIHRoZSBuZXcgbWVzc2FnZSBvYmplY3QuCi0gKgot
ICogQHJldHVybiBOZXdseSBhbGxvY2F0ZWQgbmV0bGluayBtZXNzYWdlIG9yIE5VTEwuCi0gKi8K
LXN0cnVjdCBubF9tc2cgKm5sbXNnX2NvbnZlcnQoc3RydWN0IG5sbXNnaGRyICpoZHIpCi17Ci0J
c3RydWN0IG5sX21zZyAqbm07Ci0KLQlubSA9IF9fbmxtc2dfYWxsb2MoTkxNU0dfQUxJR04oaGRy
LT5ubG1zZ19sZW4pKTsKLQlpZiAoIW5tKQotCQlnb3RvIGVycm91dDsKLQotCW1lbWNweShubS0+
bm1fbmxoLCBoZHIsIGhkci0+bmxtc2dfbGVuKTsKLQotCXJldHVybiBubTsKLWVycm91dDoKLQlu
bG1zZ19mcmVlKG5tKTsKLQlyZXR1cm4gTlVMTDsKLX0KLQotLyoqCi0gKiBSZXNlcnZlIHJvb20g
Zm9yIGFkZGl0aW9uYWwgZGF0YSBpbiBhIG5ldGxpbmsgbWVzc2FnZQotICogQGFyZyBuCQluZXRs
aW5rIG1lc3NhZ2UKLSAqIEBhcmcgbGVuCQlsZW5ndGggb2YgYWRkaXRpb25hbCBkYXRhIHRvIHJl
c2VydmUgcm9vbSBmb3IKLSAqIEBhcmcgcGFkCQludW1iZXIgb2YgYnl0ZXMgdG8gYWxpZ24gZGF0
YSB0bwotICoKLSAqIFJlc2VydmVzIHJvb20gZm9yIGFkZGl0aW9uYWwgZGF0YSBhdCB0aGUgdGFp
bCBvZiB0aGUgYW4KLSAqIGV4aXN0aW5nIG5ldGxpbmsgbWVzc2FnZS4gRXZlbnR1YWwgcGFkZGlu
ZyByZXF1aXJlZCB3aWxsCi0gKiBiZSB6ZXJvZWQgb3V0LgotICoKLSAqIEByZXR1cm4gUG9pbnRl
ciB0byBzdGFydCBvZiBhZGRpdGlvbmFsIGRhdGEgdGFpbHJvb20gb3IgTlVMTC4KLSAqLwotdm9p
ZCAqbmxtc2dfcmVzZXJ2ZShzdHJ1Y3QgbmxfbXNnICpuLCBzaXplX3QgbGVuLCBpbnQgcGFkKQot
ewotCXZvaWQgKmJ1ZiA9IG4tPm5tX25saDsKLQlzaXplX3Qgbmxtc2dfbGVuID0gbi0+bm1fbmxo
LT5ubG1zZ19sZW47Ci0Jc2l6ZV90IHRsZW47Ci0KLQl0bGVuID0gcGFkID8gKChsZW4gKyAocGFk
IC0gMSkpICYgfihwYWQgLSAxKSkgOiBsZW47Ci0KLQlpZiAoKHRsZW4gKyBubG1zZ19sZW4pID4g
bi0+bm1fc2l6ZSkKLQkJcmV0dXJuIE5VTEw7Ci0KLQlidWYgKz0gbmxtc2dfbGVuOwotCW4tPm5t
X25saC0+bmxtc2dfbGVuICs9IHRsZW47Ci0KLQlpZiAodGxlbiA+IGxlbikKLQkJbWVtc2V0KGJ1
ZiArIGxlbiwgMCwgdGxlbiAtIGxlbik7Ci0KLQlOTF9EQkcoMiwgIm1zZyAlcDogUmVzZXJ2ZWQg
JXp1IGJ5dGVzLCBwYWQ9JWQsIG5sbXNnX2xlbj0lZFxuIiwKLQkJICBuLCBsZW4sIHBhZCwgbi0+
bm1fbmxoLT5ubG1zZ19sZW4pOwotCi0JcmV0dXJuIGJ1ZjsKLX0KLQotLyoqCi0gKiBBcHBlbmQg
ZGF0YSB0byB0YWlsIG9mIGEgbmV0bGluayBtZXNzYWdlCi0gKiBAYXJnIG4JCW5ldGxpbmsgbWVz
c2FnZQotICogQGFyZyBkYXRhCQlkYXRhIHRvIGFkZAotICogQGFyZyBsZW4JCWxlbmd0aCBvZiBk
YXRhCi0gKiBAYXJnIHBhZAkJTnVtYmVyIG9mIGJ5dGVzIHRvIGFsaWduIGRhdGEgdG8uCi0gKgot
ICogRXh0ZW5kcyB0aGUgbmV0bGluayBtZXNzYWdlIGFzIG5lZWRlZCBhbmQgYXBwZW5kcyB0aGUg
ZGF0YSBvZiBnaXZlbgotICogbGVuZ3RoIHRvIHRoZSBtZXNzYWdlLiAKLSAqCi0gKiBAcmV0dXJu
IDAgb24gc3VjY2VzcyBvciBhIG5lZ2F0aXZlIGVycm9yIGNvZGUKLSAqLwotaW50IG5sbXNnX2Fw
cGVuZChzdHJ1Y3QgbmxfbXNnICpuLCB2b2lkICpkYXRhLCBzaXplX3QgbGVuLCBpbnQgcGFkKQot
ewotCXZvaWQgKnRtcDsKLQotCXRtcCA9IG5sbXNnX3Jlc2VydmUobiwgbGVuLCBwYWQpOwotCWlm
ICh0bXAgPT0gTlVMTCkKLQkJcmV0dXJuIC1OTEVfTk9NRU07Ci0KLQltZW1jcHkodG1wLCBkYXRh
LCBsZW4pOwotCU5MX0RCRygyLCAibXNnICVwOiBBcHBlbmRlZCAlenUgYnl0ZXMgd2l0aCBwYWRk
aW5nICVkXG4iLCBuLCBsZW4sIHBhZCk7Ci0KLQlyZXR1cm4gMDsKLX0KLQotLyoqCi0gKiBBZGQg
YSBuZXRsaW5rIG1lc3NhZ2UgaGVhZGVyIHRvIGEgbmV0bGluayBtZXNzYWdlCi0gKiBAYXJnIG4J
CW5ldGxpbmsgbWVzc2FnZQotICogQGFyZyBwaWQJCW5ldGxpbmsgcHJvY2VzcyBpZCBvciBOTF9B
VVRPX1BJRAotICogQGFyZyBzZXEJCXNlcXVlbmNlIG51bWJlciBvZiBtZXNzYWdlIG9yIE5MX0FV
VE9fU0VRCi0gKiBAYXJnIHR5cGUJCW1lc3NhZ2UgdHlwZQotICogQGFyZyBwYXlsb2FkCQlsZW5n
dGggb2YgbWVzc2FnZSBwYXlsb2FkCi0gKiBAYXJnIGZsYWdzCQltZXNzYWdlIGZsYWdzCi0gKgot
ICogQWRkcyBvciBvdmVyd3JpdGVzIHRoZSBuZXRsaW5rIG1lc3NhZ2UgaGVhZGVyIGluIGFuIGV4
aXN0aW5nIG1lc3NhZ2UKLSAqIG9iamVjdC4gSWYgXGEgcGF5bG9hZCBpcyBncmVhdGVyLXRoYW4g
emVybyBhZGRpdGlvbmFsIHJvb20gd2lsbCBiZQotICogcmVzZXJ2ZWQsIGYuZS4gZm9yIGZhbWls
eSBzcGVjaWZpYyBoZWFkZXJzLiBJdCBjYW4gYmUgYWNjZXNlZCB2aWEKLSAqIG5sbXNnX2RhdGEo
KS4KLSAqCi0gKiBAcmV0dXJuIEEgcG9pbnRlciB0byB0aGUgbmV0bGluayBtZXNzYWdlIGhlYWRl
ciBvciBOVUxMLgotICovCi1zdHJ1Y3Qgbmxtc2doZHIgKm5sbXNnX3B1dChzdHJ1Y3QgbmxfbXNn
ICpuLCB1aW50MzJfdCBwaWQsIHVpbnQzMl90IHNlcSwKLQkJCSAgIGludCB0eXBlLCBpbnQgcGF5
bG9hZCwgaW50IGZsYWdzKQotewotCXN0cnVjdCBubG1zZ2hkciAqbmxoOwotCi0JaWYgKG4tPm5t
X25saC0+bmxtc2dfbGVuIDwgTkxNU0dfSERSTEVOKQotCQlCVUcoKTsKLQotCW5saCA9IChzdHJ1
Y3Qgbmxtc2doZHIgKikgbi0+bm1fbmxoOwotCW5saC0+bmxtc2dfdHlwZSA9IHR5cGU7Ci0Jbmxo
LT5ubG1zZ19mbGFncyA9IGZsYWdzOwotCW5saC0+bmxtc2dfcGlkID0gcGlkOwotCW5saC0+bmxt
c2dfc2VxID0gc2VxOwotCi0JTkxfREJHKDIsICJtc2cgJXA6IEFkZGVkIG5ldGxpbmsgaGVhZGVy
IHR5cGU9JWQsIGZsYWdzPSVkLCBwaWQ9JWQsICIKLQkJICAic2VxPSVkXG4iLCBuLCB0eXBlLCBm
bGFncywgcGlkLCBzZXEpOwotCi0JaWYgKHBheWxvYWQgPiAwICYmCi0JICAgIG5sbXNnX3Jlc2Vy
dmUobiwgcGF5bG9hZCwgTkxNU0dfQUxJR05UTykgPT0gTlVMTCkKLQkJcmV0dXJuIE5VTEw7Ci0K
LQlyZXR1cm4gbmxoOwotfQotCi0vKioKLSAqIFJlbGVhc2UgYSByZWZlcmVuY2UgZnJvbSBhbiBu
ZXRsaW5rIG1lc3NhZ2UKLSAqIEBhcmcgbXNnCQltZXNzYWdlIHRvIHJlbGVhc2UgcmVmZXJlbmNl
IGZyb20KLSAqCi0gKiBGcmVlcyBtZW1vcnkgYWZ0ZXIgdGhlIGxhc3QgcmVmZXJlbmNlIGhhcyBi
ZWVuIHJlbGVhc2VkLgotICovCi12b2lkIG5sbXNnX2ZyZWUoc3RydWN0IG5sX21zZyAqbXNnKQot
ewotCWlmICghbXNnKQotCQlyZXR1cm47Ci0KLQltc2ctPm5tX3JlZmNudC0tOwotCU5MX0RCRyg0
LCAiUmV0dXJuZWQgbWVzc2FnZSByZWZlcmVuY2UgJXAsICVkIHJlbWFpbmluZ1xuIiwKLQkgICAg
ICAgbXNnLCBtc2ctPm5tX3JlZmNudCk7Ci0KLQlpZiAobXNnLT5ubV9yZWZjbnQgPCAwKQotCQlC
VUcoKTsKLQotCWlmIChtc2ctPm5tX3JlZmNudCA8PSAwKSB7Ci0JCWZyZWUobXNnLT5ubV9ubGgp
OwotCQlmcmVlKG1zZyk7Ci0JCU5MX0RCRygyLCAibXNnICVwOiBGcmVlZFxuIiwgbXNnKTsKLQl9
Ci19Ci0KLS8qKiBAfSAqLwotCi0vKioKLSAqIEBuYW1lIERpcmVjdCBQYXJzaW5nCi0gKiBAewot
ICovCi0KLS8qKiBAY29uZCBTS0lQICovCi1zdHJ1Y3QgZHBfeGRhdGEgewotCXZvaWQgKCpjYiko
c3RydWN0IG5sX29iamVjdCAqLCB2b2lkICopOwotCXZvaWQgKmFyZzsKLX07Ci0vKiogQGVuZGNv
bmQgKi8KLQotc3RhdGljIGludCBwYXJzZV9jYihzdHJ1Y3Qgbmxfb2JqZWN0ICpvYmosIHN0cnVj
dCBubF9wYXJzZXJfcGFyYW0gKnApCi17Ci0Jc3RydWN0IGRwX3hkYXRhICp4ID0gcC0+cHBfYXJn
OwotCi0JeC0+Y2Iob2JqLCB4LT5hcmcpOwotCXJldHVybiAwOwotfQotCi1pbnQgbmxfbXNnX3Bh
cnNlKHN0cnVjdCBubF9tc2cgKm1zZywgdm9pZCAoKmNiKShzdHJ1Y3Qgbmxfb2JqZWN0ICosIHZv
aWQgKiksCi0JCSB2b2lkICphcmcpCi17Ci0Jc3RydWN0IG5sX2NhY2hlX29wcyAqb3BzOwotCXN0
cnVjdCBubF9wYXJzZXJfcGFyYW0gcCA9IHsKLQkJLnBwX2NiID0gcGFyc2VfY2IKLQl9OwotCXN0
cnVjdCBkcF94ZGF0YSB4ID0gewotCQkuY2IgPSBjYiwKLQkJLmFyZyA9IGFyZywKLQl9OwotCi0J
b3BzID0gbmxfY2FjaGVfb3BzX2Fzc29jaWF0ZShubG1zZ19nZXRfcHJvdG8obXNnKSwKLQkJCQkg
ICAgIG5sbXNnX2hkcihtc2cpLT5ubG1zZ190eXBlKTsKLQlpZiAob3BzID09IE5VTEwpCi0JCXJl
dHVybiAtTkxFX01TR1RZUEVfTk9TVVBQT1JUOwotCXAucHBfYXJnID0gJng7Ci0KLQlyZXR1cm4g
bmxfY2FjaGVfcGFyc2Uob3BzLCBOVUxMLCBubG1zZ19oZHIobXNnKSwgJnApOwotfQotCi0vKiog
QH0gKi8KZGlmZiAtLWdpdCBhL3BhY2thZ2UvbGlicy9saWJubC10aW55L3NyYy9ubC5jIGIvcGFj
a2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL25sLmMKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDJmYjg2NmVjYTkwMy4uMDAwMDAwMDAwMDAwCi0tLSBhL3BhY2thZ2UvbGlicy9saWJubC10
aW55L3NyYy9ubC5jCisrKyAvZGV2L251bGwKQEAgLTEsNzIwICswLDAgQEAKLS8qCi0gKiBsaWIv
bmwuYwkJQ29yZSBOZXRsaW5rIEludGVyZmFjZQotICoKLSAqCVRoaXMgbGlicmFyeSBpcyBmcmVl
IHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKLSAqCW1vZGlmeSBpdCB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKLSAqCUxpY2Vu
c2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24gdmVyc2lvbiAy
LjEKLSAqCW9mIHRoZSBMaWNlbnNlLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAwMy0yMDA4IFRo
b21hcyBHcmFmIDx0Z3JhZkBzdXVnLmNoPgotICovCi0KLS8qKgotICogQGRlZmdyb3VwIGNvcmUg
Q29yZQotICoKLSAqIEBkZXRhaWxzCi0gKiBAcGFyIDEpIENvbm5lY3RpbmcgdGhlIHNvY2tldAot
ICogQGNvZGUKLSAqIC8vIEJpbmQgYW5kIGNvbm5lY3QgdGhlIHNvY2tldCB0byBhIHByb3RvY29s
LCBORVRMSU5LX1JPVVRFIGluIHRoaXMgZXhhbXBsZS4KLSAqIG5sX2Nvbm5lY3Qoc2ssIE5FVExJ
TktfUk9VVEUpOwotICogQGVuZGNvZGUKLSAqCi0gKiBAcGFyIDIpIFNlbmRpbmcgZGF0YQotICog
QGNvZGUKLSAqIC8vIFRoZSBtb3N0IHJ1ZGltZW50YXJ5IG1ldGhvZCBpcyB0byB1c2Ugbmxfc2Vu
ZHRvKCkgc2ltcGx5IHB1c2hpbmcKLSAqIC8vIGEgcGllY2Ugb2YgZGF0YSB0byB0aGUgb3RoZXIg
bmV0bGluayBwZWVyLiBUaGlzIG1ldGhvZCBpcyBub3QKLSAqIC8vIHJlY29tbWVuZGVkLgotICog
Y29uc3QgY2hhciBidWZbXSA9IHsgMHgwMSwgMHgwMiwgMHgwMywgMHgwNCB9OwotICogbmxfc2Vu
ZHRvKHNrLCBidWYsIHNpemVvZihidWYpKTsKLSAqCi0gKiAvLyBBIG1vcmUgY29tZm9ydGFibGUg
aW50ZXJmYWNlIGlzIG5sX3NlbmQoKSB0YWtpbmcgYSBwb2ludGVyIHRvCi0gKiAvLyBhIG5ldGxp
bmsgbWVzc2FnZS4KLSAqIHN0cnVjdCBubF9tc2cgKm1zZyA9IG15X21zZ19idWlsZGVyKCk7Ci0g
KiBubF9zZW5kKHNrLCBubG1zZ19oZHIobXNnKSk7Ci0gKgotICogLy8gbmxfc2VuZG1zZygpIHBy
b3ZpZGVzIGFkZGl0aW9uYWwgY29udHJvbCBvdmVyIHRoZSBzZW5kbXNnKCkgbWVzc2FnZQotICog
Ly8gaGVhZGVyIGluIG9yZGVyIHRvIGFsbG93IG1vcmUgc3BlY2lmaWMgYWRkcmVzc2luZyBvZiBt
dWx0aXBsZSBwZWVycyBldGMuCi0gKiBzdHJ1Y3QgbXNnaGRyIGhkciA9IHsgLi4uIH07Ci0gKiBu
bF9zZW5kbXNnKHNrLCBubG1zZ19oZHIobXNnKSwgJmhkcik7Ci0gKgotICogLy8gWW91J3JlIHBy
b2JhYmx5IHRvbyBsYXp5IHRvIGZpbGwgb3V0IHRoZSBuZXRsaW5rIHBpZCwgc2VxdWVuY2UgbnVt
YmVyCi0gKiAvLyBhbmQgbWVzc2FnZSBmbGFncyBhbGwgdGhlIHRpbWUuIG5sX3NlbmRfYXV0b19j
b21wbGV0ZSgpIGF1dG9tYXRpY2FsbHkKLSAqIC8vIGV4dGVuZHMgeW91ciBtZXNzYWdlIGhlYWRl
ciBhcyBuZWVkZWQgd2l0aCBhbiBhcHByb3ByaWF0ZSBzZXF1ZW5jZQotICogLy8gbnVtYmVyLCB0
aGUgbmV0bGluayBwaWQgc3RvcmVkIGluIHRoZSBuZXRsaW5rIHNvY2tldCBhbmQgdGhlIG1lc3Nh
Z2UKLSAqIC8vIGZsYWdzIE5MTV9GX1JFUVVFU1QgYW5kIE5MTV9GX0FDSyAoaWYgbm90IGRpc2Fi
bGVkIGluIHRoZSBzb2NrZXQpCi0gKiBubF9zZW5kX2F1dG9fY29tcGxldGUoc2ssIG5sbXNnX2hk
cihtc2cpKTsKLSAqCi0gKiAvLyBTaW1wbGUgcHJvdG9jb2xzIGRvbid0IHJlcXVpcmUgdGhlIGNv
bXBsZXggbWVzc2FnZSBjb25zdHJ1Y3Rpb24gaW50ZXJmYWNlCi0gKiAvLyBhbmQgbWF5IGZhdm91
ciBubF9zZW5kX3NpbXBsZSgpIHRvIGVhc2x5IHNlbmQgYSBidW5jaCBvZiBwYXlsb2FkCi0gKiAv
LyBlbmNhcHN1bGF0ZWQgaW4gYSBuZXRsaW5rIG1lc3NhZ2UgaGVhZGVyLgotICogbmxfc2VuZF9z
aW1wbGUoc2ssIE1ZX01TR19UWVBFLCAwLCBidWYsIHNpemVvZihidWYpKTsKLSAqIEBlbmRjb2Rl
Ci0gKgotICogQHBhciAzKSBSZWNlaXZpbmcgZGF0YQotICogQGNvZGUKLSAqIC8vIG5sX3JlY3Yo
KSByZWNlaXZlcyBhIHNpbmdsZSBtZXNzYWdlIGFsbG9jYXRpbmcgYSBidWZmZXIgZm9yIHRoZSBt
ZXNzYWdlCi0gKiAvLyBjb250ZW50IGFuZCBnaXZlcyBiYWNrIHRoZSBwb2ludGVyIHRvIHlvdS4K
LSAqIHN0cnVjdCBzb2NrYWRkcl9ubCBwZWVyOwotICogdW5zaWduZWQgY2hhciAqbXNnOwotICog
bmxfcmVjdihzaywgJnBlZXIsICZtc2cpOwotICoKLSAqIC8vIG5sX3JlY3Ztc2dzKCkgcmVjZWl2
ZXMgYSBidW5jaCBvZiBtZXNzYWdlcyB1bnRpbCB0aGUgY2FsbGJhY2sgc3lzdGVtCi0gKiAvLyBv
cmRlcnMgaXQgdG8gc3RhdGUsIHVzdWFsbHkgYWZ0ZXIgcmVjZXZpbmcgYSBjb21wb2xldGUgbXVs
dGkgcGFydAotICogLy8gbWVzc2FnZSBzZXJpZXMuCi0gKiBubF9yZWN2bXNncyhzaywgbXlfY2Fs
bGJhY2tfY29uZmlndXJhdGlvbik7Ci0gKgotICogLy8gbmxfcmVjdm1zZ3NfZGVmYXVsdCgpIGFj
dHMganVzdCBsaWtlIG5sX3JlY3Ztc2coKSBidXQgdXNlcyB0aGUgY2FsbGJhY2sKLSAqIC8vIGNv
bmZpZ3VyYXRpb24gc3RvcmVkIGluIHRoZSBzb2NrZXQuCi0gKiBubF9yZWN2bXNnc19kZWZhdWx0
KHNrKTsKLSAqCi0gKiAvLyBJbiBjYXNlIHlvdSB3YW50IHRvIHdhaXQgZm9yIHRoZSBBQ0sgdG8g
YmUgcmVjaWV2ZWQgdGhhdCB5b3UgcmVxdWVzdGVkCi0gKiAvLyB3aXRoIHlvdXIgbGF0ZXN0IG1l
c3NhZ2UsIHlvdSBjYW4gY2FsbCBubF93YWl0X2Zvcl9hY2soKQotICogbmxfd2FpdF9mb3JfYWNr
KHNrKTsKLSAqIEBlbmRjb2RlCi0gKgotICogQHBhciA0KSBDbG9zaW5nCi0gKiBAY29kZQotICog
Ly8gQ2xvc2UgdGhlIHNvY2tldCBmaXJzdCB0byByZWxlYXNlIGtlcm5lbCBtZW1vcnkKLSAqIG5s
X2Nsb3NlKHNrKTsKLSAqIEBlbmRjb2RlCi0gKiAKLSAqIEB7Ci0gKi8KLQotI2luY2x1ZGUgPG5l
dGxpbmstbG9jYWwuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL25ldGxpbmsuaD4KLSNpbmNsdWRlIDxu
ZXRsaW5rL3V0aWxzLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9oYW5kbGVycy5oPgotI2luY2x1ZGUg
PG5ldGxpbmsvbXNnLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9hdHRyLmg+Ci0KLS8qKgotICogQG5h
bWUgQ29ubmVjdGlvbiBNYW5hZ2VtZW50Ci0gKiBAewotICovCi0KLS8qKgotICogQ3JlYXRlIGFu
ZCBjb25uZWN0IG5ldGxpbmsgc29ja2V0LgotICogQGFyZyBzawkJTmV0bGluayBzb2NrZXQuCi0g
KiBAYXJnIHByb3RvY29sCU5ldGxpbmsgcHJvdG9jb2wgdG8gdXNlLgotICoKLSAqIENyZWF0ZXMg
YSBuZXRsaW5rIHNvY2tldCB1c2luZyB0aGUgc3BlY2lmaWVkIHByb3RvY29sLCBiaW5kcyB0aGUg
c29ja2V0Ci0gKiBhbmQgaXNzdWVzIGEgY29ubmVjdGlvbiBhdHRlbXB0LgotICoKLSAqIEByZXR1
cm4gMCBvbiBzdWNjZXNzIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29kZS4KLSAqLwotaW50IG5sX2Nv
bm5lY3Qoc3RydWN0IG5sX3NvY2sgKnNrLCBpbnQgcHJvdG9jb2wpCi17Ci0JaW50IGVycjsKLQlz
b2NrbGVuX3QgYWRkcmxlbjsKLQotCXNrLT5zX2ZkID0gc29ja2V0KEFGX05FVExJTkssIFNPQ0tf
UkFXLCBwcm90b2NvbCk7Ci0JaWYgKHNrLT5zX2ZkIDwgMCkgewotCQllcnIgPSAtbmxfc3lzZXJy
Mm5sZXJyKGVycm5vKTsKLQkJZ290byBlcnJvdXQ7Ci0JfQotCi0JaWYgKCEoc2stPnNfZmxhZ3Mg
JiBOTF9TT0NLX0JVRlNJWkVfU0VUKSkgewotCQllcnIgPSBubF9zb2NrZXRfc2V0X2J1ZmZlcl9z
aXplKHNrLCAwLCAwKTsKLQkJaWYgKGVyciA8IDApCi0JCQlnb3RvIGVycm91dDsKLQl9Ci0KLQll
cnIgPSBiaW5kKHNrLT5zX2ZkLCAoc3RydWN0IHNvY2thZGRyKikgJnNrLT5zX2xvY2FsLAotCQkg
ICBzaXplb2Yoc2stPnNfbG9jYWwpKTsKLQlpZiAoZXJyIDwgMCkgewotCQllcnIgPSAtbmxfc3lz
ZXJyMm5sZXJyKGVycm5vKTsKLQkJZ290byBlcnJvdXQ7Ci0JfQotCi0JYWRkcmxlbiA9IHNpemVv
Zihzay0+c19sb2NhbCk7Ci0JZXJyID0gZ2V0c29ja25hbWUoc2stPnNfZmQsIChzdHJ1Y3Qgc29j
a2FkZHIgKikgJnNrLT5zX2xvY2FsLAotCQkJICAmYWRkcmxlbik7Ci0JaWYgKGVyciA8IDApIHsK
LQkJZXJyID0gLW5sX3N5c2VycjJubGVycihlcnJubyk7Ci0JCWdvdG8gZXJyb3V0OwotCX0KLQot
CWlmIChhZGRybGVuICE9IHNpemVvZihzay0+c19sb2NhbCkpIHsKLQkJZXJyID0gLU5MRV9OT0FE
RFI7Ci0JCWdvdG8gZXJyb3V0OwotCX0KLQotCWlmIChzay0+c19sb2NhbC5ubF9mYW1pbHkgIT0g
QUZfTkVUTElOSykgewotCQllcnIgPSAtTkxFX0FGX05PU1VQUE9SVDsKLQkJZ290byBlcnJvdXQ7
Ci0JfQotCi0Jc2stPnNfcHJvdG8gPSBwcm90b2NvbDsKLQotCXJldHVybiAwOwotZXJyb3V0Ogot
CWNsb3NlKHNrLT5zX2ZkKTsKLQlzay0+c19mZCA9IC0xOwotCi0JcmV0dXJuIGVycjsKLX0KLQot
LyoqCi0gKiBDbG9zZS9EaXNjb25uZWN0IG5ldGxpbmsgc29ja2V0LgotICogQGFyZyBzawkJTmV0
bGluayBzb2NrZXQuCi0gKi8KLXZvaWQgbmxfY2xvc2Uoc3RydWN0IG5sX3NvY2sgKnNrKQotewot
CWlmIChzay0+c19mZCA+PSAwKSB7Ci0JCWNsb3NlKHNrLT5zX2ZkKTsKLQkJc2stPnNfZmQgPSAt
MTsKLQl9Ci0KLQlzay0+c19wcm90byA9IDA7Ci19Ci0KLS8qKiBAfSAqLwotCi0vKioKLSAqIEBu
YW1lIFNlbmQKLSAqIEB7Ci0gKi8KLQotLyoqCi0gKiBTZW5kIHJhdyBkYXRhIG92ZXIgbmV0bGlu
ayBzb2NrZXQuCi0gKiBAYXJnIHNrCQlOZXRsaW5rIHNvY2tldC4KLSAqIEBhcmcgYnVmCQlEYXRh
IGJ1ZmZlci4KLSAqIEBhcmcgc2l6ZQkJU2l6ZSBvZiBkYXRhIGJ1ZmZlci4KLSAqIEByZXR1cm4g
TnVtYmVyIG9mIGNoYXJhY3RlcnMgd3JpdHRlbiBvbiBzdWNjZXNzIG9yIGEgbmVnYXRpdmUgZXJy
b3IgY29kZS4KLSAqLwotaW50IG5sX3NlbmR0byhzdHJ1Y3Qgbmxfc29jayAqc2ssIHZvaWQgKmJ1
Ziwgc2l6ZV90IHNpemUpCi17Ci0JaW50IHJldDsKLQotCXJldCA9IHNlbmR0byhzay0+c19mZCwg
YnVmLCBzaXplLCAwLCAoc3RydWN0IHNvY2thZGRyICopCi0JCSAgICAgJnNrLT5zX3BlZXIsIHNp
emVvZihzay0+c19wZWVyKSk7Ci0JaWYgKHJldCA8IDApCi0JCXJldHVybiAtbmxfc3lzZXJyMm5s
ZXJyKGVycm5vKTsKLQotCXJldHVybiByZXQ7Ci19Ci0KLS8qKgotICogU2VuZCBuZXRsaW5rIG1l
c3NhZ2Ugd2l0aCBjb250cm9sIG92ZXIgc2VuZG1zZygpIG1lc3NhZ2UgaGVhZGVyLgotICogQGFy
ZyBzawkJTmV0bGluayBzb2NrZXQuCi0gKiBAYXJnIG1zZwkJTmV0bGluayBtZXNzYWdlIHRvIGJl
IHNlbnQuCi0gKiBAYXJnIGhkcgkJU2VuZG1zZygpIG1lc3NhZ2UgaGVhZGVyLgotICogQHJldHVy
biBOdW1iZXIgb2YgY2hhcmFjdGVycyBzZW50IG9uIHN1Y2VzcyBvciBhIG5lZ2F0aXZlIGVycm9y
IGNvZGUuCi0gKi8KLWludCBubF9zZW5kbXNnKHN0cnVjdCBubF9zb2NrICpzaywgc3RydWN0IG5s
X21zZyAqbXNnLCBzdHJ1Y3QgbXNnaGRyICpoZHIpCi17Ci0Jc3RydWN0IG5sX2NiICpjYjsKLQlp
bnQgcmV0OwotCi0Jc3RydWN0IGlvdmVjIGlvdiA9IHsKLQkJLmlvdl9iYXNlID0gKHZvaWQgKikg
bmxtc2dfaGRyKG1zZyksCi0JCS5pb3ZfbGVuID0gbmxtc2dfaGRyKG1zZyktPm5sbXNnX2xlbiwK
LQl9OwotCi0JaGRyLT5tc2dfaW92ID0gJmlvdjsKLQloZHItPm1zZ19pb3ZsZW4gPSAxOwotCi0J
bmxtc2dfc2V0X3NyYyhtc2csICZzay0+c19sb2NhbCk7Ci0KLQljYiA9IHNrLT5zX2NiOwotCWlm
IChjYi0+Y2Jfc2V0W05MX0NCX01TR19PVVRdKQotCQlpZiAobmxfY2JfY2FsbChjYiwgTkxfQ0Jf
TVNHX09VVCwgbXNnKSAhPSBOTF9PSykKLQkJCXJldHVybiAwOwotCi0JcmV0ID0gc2VuZG1zZyhz
ay0+c19mZCwgaGRyLCAwKTsKLQlpZiAocmV0IDwgMCkKLQkJcmV0dXJuIC1ubF9zeXNlcnIybmxl
cnIoZXJybm8pOwotCi0JcmV0dXJuIHJldDsKLX0KLQotCi0vKioKLSAqIFNlbmQgbmV0bGluayBt
ZXNzYWdlLgotICogQGFyZyBzawkJTmV0bGluayBzb2NrZXQuCi0gKiBAYXJnIG1zZwkJTmV0bGlu
ayBtZXNzYWdlIHRvIGJlIHNlbnQuCi0gKiBAc2VlIG5sX3NlbmRtc2coKQotICogQHJldHVybiBO
dW1iZXIgb2YgY2hhcmFjdGVycyBzZW50IG9uIHN1Y2Nlc3Mgb3IgYSBuZWdhdGl2ZSBlcnJvciBj
b2RlLgotICovCi1pbnQgbmxfc2VuZChzdHJ1Y3Qgbmxfc29jayAqc2ssIHN0cnVjdCBubF9tc2cg
Km1zZykKLXsKLQlzdHJ1Y3Qgc29ja2FkZHJfbmwgKmRzdDsKLQlzdHJ1Y3QgdWNyZWQgKmNyZWRz
OwotCQotCXN0cnVjdCBtc2doZHIgaGRyID0gewotCQkubXNnX25hbWUgPSAodm9pZCAqKSAmc2st
PnNfcGVlciwKLQkJLm1zZ19uYW1lbGVuID0gc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9ubCksCi0J
fTsKLQotCS8qIE92ZXJ3cml0ZSBkZXN0aW5hdGlvbiBpZiBzcGVjaWZpZWQgaW4gdGhlIG1lc3Nh
Z2UgaXRzZWxmLCBkZWZhdWx0cwotCSAqIHRvIHRoZSBwZWVyIGFkZHJlc3Mgb2YgdGhlIHNvY2tl
dC4KLQkgKi8KLQlkc3QgPSBubG1zZ19nZXRfZHN0KG1zZyk7Ci0JaWYgKGRzdC0+bmxfZmFtaWx5
ID09IEFGX05FVExJTkspCi0JCWhkci5tc2dfbmFtZSA9IGRzdDsKLQotCS8qIEFkZCBjcmVkZW50
aWFscyBpZiBwcmVzZW50LiAqLwotCWNyZWRzID0gbmxtc2dfZ2V0X2NyZWRzKG1zZyk7Ci0JaWYg
KGNyZWRzICE9IE5VTEwpIHsKLQkJY2hhciBidWZbQ01TR19TUEFDRShzaXplb2Yoc3RydWN0IHVj
cmVkKSldOwotCQlzdHJ1Y3QgY21zZ2hkciAqY21zZzsKLQotCQloZHIubXNnX2NvbnRyb2wgPSBi
dWY7Ci0JCWhkci5tc2dfY29udHJvbGxlbiA9IHNpemVvZihidWYpOwotCi0JCWNtc2cgPSBDTVNH
X0ZJUlNUSERSKCZoZHIpOwotCQljbXNnLT5jbXNnX2xldmVsID0gU09MX1NPQ0tFVDsKLQkJY21z
Zy0+Y21zZ190eXBlID0gU0NNX0NSRURFTlRJQUxTOwotCQljbXNnLT5jbXNnX2xlbiA9IENNU0df
TEVOKHNpemVvZihzdHJ1Y3QgdWNyZWQpKTsKLQkJbWVtY3B5KENNU0dfREFUQShjbXNnKSwgY3Jl
ZHMsIHNpemVvZihzdHJ1Y3QgdWNyZWQpKTsKLQl9Ci0KLQlyZXR1cm4gbmxfc2VuZG1zZyhzaywg
bXNnLCAmaGRyKTsKLX0KLQotLyoqCi0gKiBTZW5kIG5ldGxpbmsgbWVzc2FnZSBhbmQgY2hlY2sg
JiBleHRlbmQgaGVhZGVyIHZhbHVlcyBhcyBuZWVkZWQuCi0gKiBAYXJnIHNrCQlOZXRsaW5rIHNv
Y2tldC4KLSAqIEBhcmcgbXNnCQlOZXRsaW5rIG1lc3NhZ2UgdG8gYmUgc2VudC4KLSAqCi0gKiBD
aGVja3MgdGhlIG5ldGxpbmsgbWVzc2FnZSBcYyBubGggZm9yIGNvbXBsZXRuZXNzIGFuZCBleHRl
bmRzIGl0Ci0gKiBhcyByZXF1aXJlZCBiZWZvcmUgc2VuZGluZyBpdCBvdXQuIENoZWNrZWQgZmll
bGRzIGluY2x1ZGUgcGlkLAotICogc2VxdWVuY2UgbnIsIGFuZCBmbGFncy4KLSAqCi0gKiBAc2Vl
IG5sX3NlbmQoKQotICogQHJldHVybiBOdW1iZXIgb2YgY2hhcmFjdGVycyBzZW50IG9yIGEgbmVn
YXRpdmUgZXJyb3IgY29kZS4KLSAqLwotaW50IG5sX3NlbmRfYXV0b19jb21wbGV0ZShzdHJ1Y3Qg
bmxfc29jayAqc2ssIHN0cnVjdCBubF9tc2cgKm1zZykKLXsKLQlzdHJ1Y3Qgbmxtc2doZHIgKm5s
aDsKLQlzdHJ1Y3QgbmxfY2IgKmNiID0gc2stPnNfY2I7Ci0KLQlubGggPSBubG1zZ19oZHIobXNn
KTsKLQlpZiAobmxoLT5ubG1zZ19waWQgPT0gMCkKLQkJbmxoLT5ubG1zZ19waWQgPSBzay0+c19s
b2NhbC5ubF9waWQ7Ci0KLQlpZiAobmxoLT5ubG1zZ19zZXEgPT0gMCkKLQkJbmxoLT5ubG1zZ19z
ZXEgPSBzay0+c19zZXFfbmV4dCsrOwotCi0JaWYgKG1zZy0+bm1fcHJvdG9jb2wgPT0gLTEpCi0J
CW1zZy0+bm1fcHJvdG9jb2wgPSBzay0+c19wcm90bzsKLQkKLQlubGgtPm5sbXNnX2ZsYWdzIHw9
IE5MTV9GX1JFUVVFU1Q7Ci0KLQlpZiAoIShzay0+c19mbGFncyAmIE5MX05PX0FVVE9fQUNLKSkK
LQkJbmxoLT5ubG1zZ19mbGFncyB8PSBOTE1fRl9BQ0s7Ci0KLQlpZiAoY2ItPmNiX3NlbmRfb3cp
Ci0JCXJldHVybiBjYi0+Y2Jfc2VuZF9vdyhzaywgbXNnKTsKLQllbHNlCi0JCXJldHVybiBubF9z
ZW5kKHNrLCBtc2cpOwotfQotCi0vKioKLSAqIFNlbmQgc2ltcGxlIG5ldGxpbmsgbWVzc2FnZSB1
c2luZyBubF9zZW5kX2F1dG9fY29tcGxldGUoKQotICogQGFyZyBzawkJTmV0bGluayBzb2NrZXQu
Ci0gKiBAYXJnIHR5cGUJCU5ldGxpbmsgbWVzc2FnZSB0eXBlLgotICogQGFyZyBmbGFncwkJTmV0
bGluayBtZXNzYWdlIGZsYWdzLgotICogQGFyZyBidWYJCURhdGEgYnVmZmVyLgotICogQGFyZyBz
aXplCQlTaXplIG9mIGRhdGEgYnVmZmVyLgotICoKLSAqIEJ1aWxkcyBhIG5ldGxpbmsgbWVzc2Fn
ZSB3aXRoIHRoZSBzcGVjaWZpZWQgdHlwZSBhbmQgZmxhZ3MgYW5kCi0gKiBhcHBlbmRzIHRoZSBz
cGVjaWZpZWQgZGF0YSBhcyBwYXlsb2FkIHRvIHRoZSBtZXNzYWdlLgotICoKLSAqIEBzZWUgbmxf
c2VuZF9hdXRvX2NvbXBsZXRlKCkKLSAqIEByZXR1cm4gTnVtYmVyIG9mIGNoYXJhY3RlcnMgc2Vu
dCBvbiBzdWNjZXNzIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29kZS4KLSAqLwotaW50IG5sX3NlbmRf
c2ltcGxlKHN0cnVjdCBubF9zb2NrICpzaywgaW50IHR5cGUsIGludCBmbGFncywgdm9pZCAqYnVm
LAotCQkgICBzaXplX3Qgc2l6ZSkKLXsKLQlpbnQgZXJyOwotCXN0cnVjdCBubF9tc2cgKm1zZzsK
LQotCW1zZyA9IG5sbXNnX2FsbG9jX3NpbXBsZSh0eXBlLCBmbGFncyk7Ci0JaWYgKCFtc2cpCi0J
CXJldHVybiAtTkxFX05PTUVNOwotCi0JaWYgKGJ1ZiAmJiBzaXplKSB7Ci0JCWVyciA9IG5sbXNn
X2FwcGVuZChtc2csIGJ1Ziwgc2l6ZSwgTkxNU0dfQUxJR05UTyk7Ci0JCWlmIChlcnIgPCAwKQot
CQkJZ290byBlcnJvdXQ7Ci0JfQotCQotCi0JZXJyID0gbmxfc2VuZF9hdXRvX2NvbXBsZXRlKHNr
LCBtc2cpOwotZXJyb3V0OgotCW5sbXNnX2ZyZWUobXNnKTsKLQotCXJldHVybiBlcnI7Ci19Ci0K
LS8qKiBAfSAqLwotCi0vKioKLSAqIEBuYW1lIFJlY2VpdmUKLSAqIEB7Ci0gKi8KLQotLyoqCi0g
KiBSZWNlaXZlIGRhdGEgZnJvbSBuZXRsaW5rIHNvY2tldAotICogQGFyZyBzawkJTmV0bGluayBz
b2NrZXQuCi0gKiBAYXJnIG5sYQkJRGVzdGluYXRpb24gcG9pbnRlciBmb3IgcGVlcidzIG5ldGxp
bmsgYWRkcmVzcy4KLSAqIEBhcmcgYnVmCQlEZXN0aW5hdGlvbiBwb2ludGVyIGZvciBtZXNzYWdl
IGNvbnRlbnQuCi0gKiBAYXJnIGNyZWRzCQlEZXN0aW5hdGlvbiBwb2ludGVyIGZvciBjcmVkZW50
aWFscy4KLSAqCi0gKiBSZWNlaXZlcyBhIG5ldGxpbmsgbWVzc2FnZSwgYWxsb2NhdGVzIGEgYnVm
ZmVyIGluIFxjICpidWYgYW5kCi0gKiBzdG9yZXMgdGhlIG1lc3NhZ2UgY29udGVudC4gVGhlIHBl
ZXIncyBuZXRsaW5rIGFkZHJlc3MgaXMgc3RvcmVkCi0gKiBpbiBcYyAqbmxhLiBUaGUgY2FsbGVy
IGlzIHJlc3BvbnNpYmxlIGZvciBmcmVlaW5nIHRoZSBidWZmZXIgYWxsb2NhdGVkCi0gKiBpbiBc
YyAqYnVmIGlmIGEgcG9zaXRpdmUgdmFsdWUgaXMgcmV0dXJuZWQuICBJbnRlcnJ1cHRlZCBzeXN0
ZW0gY2FsbHMKLSAqIGFyZSBoYW5kbGVkIGJ5IHJlcGVhdGluZyB0aGUgcmVhZC4gVGhlIGlucHV0
IGJ1ZmZlciBzaXplIGlzIGRldGVybWluZWQKLSAqIGJ5IHBlZWtpbmcgYmVmb3JlIHRoZSBhY3R1
YWwgcmVhZCBpcyBkb25lLgotICoKLSAqIEEgbm9uLWJsb2NraW5nIHNvY2tldHMgY2F1c2VzIHRo
ZSBmdW5jdGlvbiB0byByZXR1cm4gaW1tZWRpYXRlbHkgd2l0aAotICogYSByZXR1cm4gdmFsdWUg
b2YgMCBpZiBubyBkYXRhIGlzIGF2YWlsYWJsZS4KLSAqCi0gKiBAcmV0dXJuIE51bWJlciBvZiBv
Y3RldHMgcmVhZCwgMCBvbiBFT0Ygb3IgYSBuZWdhdGl2ZSBlcnJvciBjb2RlLgotICovCi1pbnQg
bmxfcmVjdihzdHJ1Y3Qgbmxfc29jayAqc2ssIHN0cnVjdCBzb2NrYWRkcl9ubCAqbmxhLAotCSAg
ICB1bnNpZ25lZCBjaGFyICoqYnVmLCBzdHJ1Y3QgdWNyZWQgKipjcmVkcykKLXsKLQlpbnQgbjsK
LQlpbnQgZmxhZ3MgPSAwOwotCXN0YXRpYyBpbnQgcGFnZV9zaXplID0gMDsKLQlzdHJ1Y3QgaW92
ZWMgaW92OwotCXN0cnVjdCBtc2doZHIgbXNnID0gewotCQkubXNnX25hbWUgPSAodm9pZCAqKSBu
bGEsCi0JCS5tc2dfbmFtZWxlbiA9IHNpemVvZihzdHJ1Y3Qgc29ja2FkZHJfbmwpLAotCQkubXNn
X2lvdiA9ICZpb3YsCi0JCS5tc2dfaW92bGVuID0gMSwKLQkJLm1zZ19jb250cm9sID0gTlVMTCwK
LQkJLm1zZ19jb250cm9sbGVuID0gMCwKLQkJLm1zZ19mbGFncyA9IDAsCi0JfTsKLQlzdHJ1Y3Qg
Y21zZ2hkciAqY21zZzsKLQotCWlmIChzay0+c19mbGFncyAmIE5MX01TR19QRUVLKQotCQlmbGFn
cyB8PSBNU0dfUEVFSzsKLQotCWlmIChwYWdlX3NpemUgPT0gMCkKLQkJcGFnZV9zaXplID0gZ2V0
cGFnZXNpemUoKSAqIDQ7Ci0KLQlpb3YuaW92X2xlbiA9IHBhZ2Vfc2l6ZTsKLQlpb3YuaW92X2Jh
c2UgPSAqYnVmID0gbWFsbG9jKGlvdi5pb3ZfbGVuKTsKLQotCWlmIChzay0+c19mbGFncyAmIE5M
X1NPQ0tfUEFTU0NSRUQpIHsKLQkJbXNnLm1zZ19jb250cm9sbGVuID0gQ01TR19TUEFDRShzaXpl
b2Yoc3RydWN0IHVjcmVkKSk7Ci0JCW1zZy5tc2dfY29udHJvbCA9IGNhbGxvYygxLCBtc2cubXNn
X2NvbnRyb2xsZW4pOwotCX0KLXJldHJ5OgotCi0JbiA9IHJlY3Ztc2coc2stPnNfZmQsICZtc2cs
IGZsYWdzKTsKLQlpZiAoIW4pCi0JCWdvdG8gYWJvcnQ7Ci0JZWxzZSBpZiAobiA8IDApIHsKLQkJ
aWYgKGVycm5vID09IEVJTlRSKSB7Ci0JCQlOTF9EQkcoMywgInJlY3Ztc2coKSByZXR1cm5lZCBF
SU5UUiwgcmV0cnlpbmdcbiIpOwotCQkJZ290byByZXRyeTsKLQkJfSBlbHNlIGlmIChlcnJubyA9
PSBFQUdBSU4pIHsKLQkJCU5MX0RCRygzLCAicmVjdm1zZygpIHJldHVybmVkIEVBR0FJTiwgYWJv
cnRpbmdcbiIpOwotCQkJZ290byBhYm9ydDsKLQkJfSBlbHNlIHsKLQkJCWZyZWUobXNnLm1zZ19j
b250cm9sKTsKLQkJCWZyZWUoKmJ1Zik7Ci0JCQlyZXR1cm4gLW5sX3N5c2VycjJubGVycihlcnJu
byk7Ci0JCX0KLQl9Ci0KLQlpZiAoaW92Lmlvdl9sZW4gPCBuIHx8Ci0JICAgIG1zZy5tc2dfZmxh
Z3MgJiBNU0dfVFJVTkMpIHsKLQkJLyogUHJvdmlkZWQgYnVmZmVyIGlzIG5vdCBsb25nIGVub3Vn
aCwgZW5sYXJnZSBpdAotCQkgKiBhbmQgdHJ5IGFnYWluLiAqLwotCQlpb3YuaW92X2xlbiAqPSAy
OwotCQlpb3YuaW92X2Jhc2UgPSAqYnVmID0gcmVhbGxvYygqYnVmLCBpb3YuaW92X2xlbik7Ci0J
CWdvdG8gcmV0cnk7Ci0JfSBlbHNlIGlmIChtc2cubXNnX2ZsYWdzICYgTVNHX0NUUlVOQykgewot
CQltc2cubXNnX2NvbnRyb2xsZW4gKj0gMjsKLQkJbXNnLm1zZ19jb250cm9sID0gcmVhbGxvYyht
c2cubXNnX2NvbnRyb2wsIG1zZy5tc2dfY29udHJvbGxlbik7Ci0JCWdvdG8gcmV0cnk7Ci0JfSBl
bHNlIGlmIChmbGFncyAhPSAwKSB7Ci0JCS8qIEJ1ZmZlciBpcyBiaWcgZW5vdWdoLCBkbyB0aGUg
YWN0dWFsIHJlYWRpbmcgKi8KLQkJZmxhZ3MgPSAwOwotCQlnb3RvIHJldHJ5OwotCX0KLQotCWlm
IChtc2cubXNnX25hbWVsZW4gIT0gc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9ubCkpIHsKLQkJZnJl
ZShtc2cubXNnX2NvbnRyb2wpOwotCQlmcmVlKCpidWYpOwotCQlyZXR1cm4gLU5MRV9OT0FERFI7
Ci0JfQotCi0JZm9yIChjbXNnID0gQ01TR19GSVJTVEhEUigmbXNnKTsgY21zZzsgY21zZyA9IENN
U0dfTlhUSERSKCZtc2csIGNtc2cpKSB7Ci0JCWlmIChjbXNnLT5jbXNnX2xldmVsID09IFNPTF9T
T0NLRVQgJiYKLQkJICAgIGNtc2ctPmNtc2dfdHlwZSA9PSBTQ01fQ1JFREVOVElBTFMpIHsKLQkJ
CSpjcmVkcyA9IGNhbGxvYygxLCBzaXplb2Yoc3RydWN0IHVjcmVkKSk7Ci0JCQltZW1jcHkoKmNy
ZWRzLCBDTVNHX0RBVEEoY21zZyksIHNpemVvZihzdHJ1Y3QgdWNyZWQpKTsKLQkJCWJyZWFrOwot
CQl9Ci0JfQotCi0JZnJlZShtc2cubXNnX2NvbnRyb2wpOwotCXJldHVybiBuOwotCi1hYm9ydDoK
LQlmcmVlKG1zZy5tc2dfY29udHJvbCk7Ci0JZnJlZSgqYnVmKTsKLQlyZXR1cm4gMDsKLX0KLQot
I2RlZmluZSBOTF9DQl9DQUxMKGNiLCB0eXBlLCBtc2cpIFwKLWRvIHsgXAotCWVyciA9IG5sX2Ni
X2NhbGwoY2IsIHR5cGUsIG1zZyk7IFwKLQlzd2l0Y2ggKGVycikgeyBcCi0JY2FzZSBOTF9PSzog
XAotCQllcnIgPSAwOyBcCi0JCWJyZWFrOyBcCi0JY2FzZSBOTF9TS0lQOiBcCi0JCWdvdG8gc2tp
cDsgXAotCWNhc2UgTkxfU1RPUDogXAotCQlnb3RvIHN0b3A7IFwKLQlkZWZhdWx0OiBcCi0JCWdv
dG8gb3V0OyBcCi0JfSBcCi19IHdoaWxlICgwKQotCi1zdGF0aWMgaW50IHJlY3Ztc2dzKHN0cnVj
dCBubF9zb2NrICpzaywgc3RydWN0IG5sX2NiICpjYikKLXsKLQlpbnQgbiwgZXJyID0gMCwgbXVs
dGlwYXJ0ID0gMDsKLQl1bnNpZ25lZCBjaGFyICpidWYgPSBOVUxMOwotCXN0cnVjdCBubG1zZ2hk
ciAqaGRyOwotCXN0cnVjdCBzb2NrYWRkcl9ubCBubGEgPSB7MH07Ci0Jc3RydWN0IG5sX21zZyAq
bXNnID0gTlVMTDsKLQlzdHJ1Y3QgdWNyZWQgKmNyZWRzID0gTlVMTDsKLQotY29udGludWVfcmVh
ZGluZzoKLQlOTF9EQkcoMywgIkF0dGVtcHRpbmcgdG8gcmVhZCBmcm9tICVwXG4iLCBzayk7Ci0J
aWYgKGNiLT5jYl9yZWN2X293KQotCQluID0gY2ItPmNiX3JlY3Zfb3coc2ssICZubGEsICZidWYs
ICZjcmVkcyk7Ci0JZWxzZQotCQluID0gbmxfcmVjdihzaywgJm5sYSwgJmJ1ZiwgJmNyZWRzKTsK
LQotCWlmIChuIDw9IDApCi0JCXJldHVybiBuOwotCi0JTkxfREJHKDMsICJyZWN2bXNncyglcCk6
IFJlYWQgJWQgYnl0ZXNcbiIsIHNrLCBuKTsKLQotCWhkciA9IChzdHJ1Y3Qgbmxtc2doZHIgKikg
YnVmOwotCXdoaWxlIChubG1zZ19vayhoZHIsIG4pKSB7Ci0JCU5MX0RCRygzLCAicmVjZ21zZ3Mo
JXApOiBQcm9jZXNzaW5nIHZhbGlkIG1lc3NhZ2UuLi5cbiIsIHNrKTsKLQotCQlubG1zZ19mcmVl
KG1zZyk7Ci0JCW1zZyA9IG5sbXNnX2NvbnZlcnQoaGRyKTsKLQkJaWYgKCFtc2cpIHsKLQkJCWVy
ciA9IC1OTEVfTk9NRU07Ci0JCQlnb3RvIG91dDsKLQkJfQotCi0JCW5sbXNnX3NldF9wcm90byht
c2csIHNrLT5zX3Byb3RvKTsKLQkJbmxtc2dfc2V0X3NyYyhtc2csICZubGEpOwotCQlpZiAoY3Jl
ZHMpCi0JCQlubG1zZ19zZXRfY3JlZHMobXNnLCBjcmVkcyk7Ci0KLQkJLyogUmF3IGNhbGxiYWNr
IGlzIHRoZSBmaXJzdCwgaXQgZ2l2ZXMgdGhlIG1vc3QgY29udHJvbAotCQkgKiB0byB0aGUgdXNl
ciBhbmQgaGUgY2FuIGRvIGhpcyB2ZXJ5IG93biBwYXJzaW5nLiAqLwotCQlpZiAoY2ItPmNiX3Nl
dFtOTF9DQl9NU0dfSU5dKQotCQkJTkxfQ0JfQ0FMTChjYiwgTkxfQ0JfTVNHX0lOLCBtc2cpOwot
Ci0JCS8qIFNlcXVlbmNlIG51bWJlciBjaGVja2luZy4gVGhlIGNoZWNrIG1heSBiZSBkb25lIGJ5
Ci0JCSAqIHRoZSB1c2VyLCBvdGhlcndpc2UgYSB2ZXJ5IHNpbXBsZSBjaGVjayBpcyBhcHBsaWVk
Ci0JCSAqIGVuZm9yY2luZyBzdHJpY3Qgb3JkZXJpbmcgKi8KLQkJaWYgKGNiLT5jYl9zZXRbTkxf
Q0JfU0VRX0NIRUNLXSkKLQkJCU5MX0NCX0NBTEwoY2IsIE5MX0NCX1NFUV9DSEVDSywgbXNnKTsK
LQkJZWxzZSBpZiAoaGRyLT5ubG1zZ19zZXEgIT0gc2stPnNfc2VxX2V4cGVjdCkgewotCQkJaWYg
KGNiLT5jYl9zZXRbTkxfQ0JfSU5WQUxJRF0pCi0JCQkJTkxfQ0JfQ0FMTChjYiwgTkxfQ0JfSU5W
QUxJRCwgbXNnKTsKLQkJCWVsc2UgewotCQkJCWVyciA9IC1OTEVfU0VRX01JU01BVENIOwotCQkJ
CWdvdG8gb3V0OwotCQkJfQotCQl9Ci0KLQkJaWYgKGhkci0+bmxtc2dfdHlwZSA9PSBOTE1TR19E
T05FIHx8Ci0JCSAgICBoZHItPm5sbXNnX3R5cGUgPT0gTkxNU0dfRVJST1IgfHwKLQkJICAgIGhk
ci0+bmxtc2dfdHlwZSA9PSBOTE1TR19OT09QIHx8Ci0JCSAgICBoZHItPm5sbXNnX3R5cGUgPT0g
TkxNU0dfT1ZFUlJVTikgewotCQkJLyogV2UgY2FuJ3QgY2hlY2sgZm9yICFOTE1fRl9NVUxUSSBz
aW5jZSBzb21lIG5ldGxpbmsKLQkJCSAqIHVzZXJzIGluIHRoZSBrZXJuZWwgYXJlIGJyb2tlbi4g
Ki8KLQkJCXNrLT5zX3NlcV9leHBlY3QrKzsKLQkJCU5MX0RCRygzLCAicmVjdm1zZ3MoJXApOiBJ
bmNyZWFzZWQgZXhwZWN0ZWQgIiBcCi0JCQkgICAgICAgInNlcXVlbmNlIG51bWJlciB0byAlZFxu
IiwKLQkJCSAgICAgICBzaywgc2stPnNfc2VxX2V4cGVjdCk7Ci0JCX0KLQotCQlpZiAoaGRyLT5u
bG1zZ19mbGFncyAmIE5MTV9GX01VTFRJKQotCQkJbXVsdGlwYXJ0ID0gMTsKLQkKLQkJLyogT3Ro
ZXIgc2lkZSB3aXNoZXMgdG8gc2VlIGFuIGFjayBmb3IgdGhpcyBtZXNzYWdlICovCi0JCWlmICho
ZHItPm5sbXNnX2ZsYWdzICYgTkxNX0ZfQUNLKSB7Ci0JCQlpZiAoY2ItPmNiX3NldFtOTF9DQl9T
RU5EX0FDS10pCi0JCQkJTkxfQ0JfQ0FMTChjYiwgTkxfQ0JfU0VORF9BQ0ssIG1zZyk7Ci0JCQll
bHNlIHsKLQkJCQkvKiBGSVhNRTogaW1wbGVtZW50ICovCi0JCQl9Ci0JCX0KLQotCQkvKiBtZXNz
YWdlcyB0ZXJtaW5hdGVzIGEgbXVsdHBhcnQgbWVzc2FnZSwgdGhpcyBpcwotCQkgKiB1c3VhbGx5
IHRoZSBlbmQgb2YgYSBtZXNzYWdlIGFuZCB0aGVyZWZvcmUgd2Ugc2xpcAotCQkgKiBvdXQgb2Yg
dGhlIGxvb3AgYnkgZGVmYXVsdC4gdGhlIHVzZXIgbWF5IG92ZXJydWxlCi0JCSAqIHRoaXMgYWN0
aW9uIGJ5IHNraXBwaW5nIHRoaXMgcGFja2V0LiAqLwotCQlpZiAoaGRyLT5ubG1zZ190eXBlID09
IE5MTVNHX0RPTkUpIHsKLQkJCW11bHRpcGFydCA9IDA7Ci0JCQlpZiAoY2ItPmNiX3NldFtOTF9D
Ql9GSU5JU0hdKQotCQkJCU5MX0NCX0NBTEwoY2IsIE5MX0NCX0ZJTklTSCwgbXNnKTsKLQkJfQot
Ci0JCS8qIE1lc3NhZ2UgdG8gYmUgaWdub3JlZCwgdGhlIGRlZmF1bHQgYWN0aW9uIGlzIHRvCi0J
CSAqIHNraXAgdGhpcyBtZXNzYWdlIGlmIG5vIGNhbGxiYWNrIGlzIHNwZWNpZmllZC4gVGhlCi0J
CSAqIHVzZXIgbWF5IG92ZXJydWxlIHRoaXMgYWN0aW9uIGJ5IHJldHVybmluZwotCQkgKiBOTF9Q
Uk9DRUVELiAqLwotCQllbHNlIGlmIChoZHItPm5sbXNnX3R5cGUgPT0gTkxNU0dfTk9PUCkgewot
CQkJaWYgKGNiLT5jYl9zZXRbTkxfQ0JfU0tJUFBFRF0pCi0JCQkJTkxfQ0JfQ0FMTChjYiwgTkxf
Q0JfU0tJUFBFRCwgbXNnKTsKLQkJCWVsc2UKLQkJCQlnb3RvIHNraXA7Ci0JCX0KLQotCQkvKiBE
YXRhIGdvdCBsb3N0LCByZXBvcnQgYmFjayB0byB1c2VyLiBUaGUgZGVmYXVsdCBhY3Rpb24gaXMg
dG8KLQkJICogcXVpdCBwYXJzaW5nLiBUaGUgdXNlciBtYXkgb3ZlcnJ1bGUgdGhpcyBhY3Rpb24g
YnkgcmV0dW5pbmcKLQkJICogTkxfU0tJUCBvciBOTF9QUk9DRUVEIChkYW5nZXJvdXMpICovCi0J
CWVsc2UgaWYgKGhkci0+bmxtc2dfdHlwZSA9PSBOTE1TR19PVkVSUlVOKSB7Ci0JCQlpZiAoY2It
PmNiX3NldFtOTF9DQl9PVkVSUlVOXSkKLQkJCQlOTF9DQl9DQUxMKGNiLCBOTF9DQl9PVkVSUlVO
LCBtc2cpOwotCQkJZWxzZSB7Ci0JCQkJZXJyID0gLU5MRV9NU0dfT1ZFUkZMT1c7Ci0JCQkJZ290
byBvdXQ7Ci0JCQl9Ci0JCX0KLQotCQkvKiBNZXNzYWdlIGNhcnJpZXMgYSBubG1zZ2VyciAqLwot
CQllbHNlIGlmIChoZHItPm5sbXNnX3R5cGUgPT0gTkxNU0dfRVJST1IpIHsKLQkJCXN0cnVjdCBu
bG1zZ2VyciAqZSA9IG5sbXNnX2RhdGEoaGRyKTsKLQotCQkJaWYgKGhkci0+bmxtc2dfbGVuIDwg
bmxtc2dfbXNnX3NpemUoc2l6ZW9mKCplKSkpIHsKLQkJCQkvKiBUcnVuY2F0ZWQgZXJyb3IgbWVz
c2FnZSwgdGhlIGRlZmF1bHQgYWN0aW9uCi0JCQkJICogaXMgdG8gc3RvcCBwYXJzaW5nLiBUaGUg
dXNlciBtYXkgb3ZlcnJ1bGUKLQkJCQkgKiB0aGlzIGFjdGlvbiBieSByZXR1cm5pbmcgTkxfU0tJ
UCBvcgotCQkJCSAqIE5MX1BST0NFRUQgKGRhbmdlcm91cykgKi8KLQkJCQlpZiAoY2ItPmNiX3Nl
dFtOTF9DQl9JTlZBTElEXSkKLQkJCQkJTkxfQ0JfQ0FMTChjYiwgTkxfQ0JfSU5WQUxJRCwgbXNn
KTsKLQkJCQllbHNlIHsKLQkJCQkJZXJyID0gLU5MRV9NU0dfVFJVTkM7Ci0JCQkJCWdvdG8gb3V0
OwotCQkJCX0KLQkJCX0gZWxzZSBpZiAoZS0+ZXJyb3IpIHsKLQkJCQkvKiBFcnJvciBtZXNzYWdl
IHJlcG9ydGVkIGJhY2sgZnJvbSBrZXJuZWwuICovCi0JCQkJaWYgKGNiLT5jYl9lcnIpIHsKLQkJ
CQkJZXJyID0gY2ItPmNiX2VycigmbmxhLCBlLAotCQkJCQkJCSAgIGNiLT5jYl9lcnJfYXJnKTsK
LQkJCQkJaWYgKGVyciA8IDApCi0JCQkJCQlnb3RvIG91dDsKLQkJCQkJZWxzZSBpZiAoZXJyID09
IE5MX1NLSVApCi0JCQkJCQlnb3RvIHNraXA7Ci0JCQkJCWVsc2UgaWYgKGVyciA9PSBOTF9TVE9Q
KSB7Ci0JCQkJCQllcnIgPSAtbmxfc3lzZXJyMm5sZXJyKGUtPmVycm9yKTsKLQkJCQkJCWdvdG8g
b3V0OwotCQkJCQl9Ci0JCQkJfSBlbHNlIHsKLQkJCQkJZXJyID0gLW5sX3N5c2VycjJubGVycihl
LT5lcnJvcik7Ci0JCQkJCWdvdG8gb3V0OwotCQkJCX0KLQkJCX0gZWxzZSBpZiAoY2ItPmNiX3Nl
dFtOTF9DQl9BQ0tdKQotCQkJCU5MX0NCX0NBTEwoY2IsIE5MX0NCX0FDSywgbXNnKTsKLQkJfSBl
bHNlIHsKLQkJCS8qIFZhbGlkIG1lc3NhZ2UgKG5vdCBjaGVja2luZyBmb3IgTVVMVElQQVJUIGJp
dCB0bwotCQkJICogZ2V0IGFsb25nIHdpdGggYnJva2VuIGtlcm5lbHMuIE5MX1NLSVAgaGFzIG5v
Ci0JCQkgKiBlZmZlY3Qgb24gdGhpcy4gICovCi0JCQlpZiAoY2ItPmNiX3NldFtOTF9DQl9WQUxJ
RF0pCi0JCQkJTkxfQ0JfQ0FMTChjYiwgTkxfQ0JfVkFMSUQsIG1zZyk7Ci0JCX0KLXNraXA6Ci0J
CWVyciA9IDA7Ci0JCWhkciA9IG5sbXNnX25leHQoaGRyLCAmbik7Ci0JfQotCQotCW5sbXNnX2Zy
ZWUobXNnKTsKLQlmcmVlKGJ1Zik7Ci0JZnJlZShjcmVkcyk7Ci0JYnVmID0gTlVMTDsKLQltc2cg
PSBOVUxMOwotCWNyZWRzID0gTlVMTDsKLQotCWlmIChtdWx0aXBhcnQpIHsKLQkJLyogTXVsdGlw
YXJ0IG1lc3NhZ2Ugbm90IHlldCBjb21wbGV0ZSwgY29udGludWUgcmVhZGluZyAqLwotCQlnb3Rv
IGNvbnRpbnVlX3JlYWRpbmc7Ci0JfQotc3RvcDoKLQllcnIgPSAwOwotb3V0OgotCW5sbXNnX2Zy
ZWUobXNnKTsKLQlmcmVlKGJ1Zik7Ci0JZnJlZShjcmVkcyk7Ci0KLQlyZXR1cm4gZXJyOwotfQot
Ci0vKioKLSAqIFJlY2VpdmUgYSBzZXQgb2YgbWVzc2FnZXMgZnJvbSBhIG5ldGxpbmsgc29ja2V0
LgotICogQGFyZyBzawkJTmV0bGluayBzb2NrZXQuCi0gKiBAYXJnIGNiCQlzZXQgb2YgY2FsbGJh
Y2tzIHRvIGNvbnRyb2wgYmVoYXZpb3VyLgotICoKLSAqIFJlcGVhdGVkbHkgY2FsbHMgbmxfcmVj
digpIG9yIHRoZSByZXNwZWN0aXZlIHJlcGxhY2VtZW50IGlmIHByb3ZpZGVkCi0gKiBieSB0aGUg
YXBwbGljYXRpb24gKHNlZSBubF9jYl9vdmVyd3JpdGVfcmVjdigpKSBhbmQgcGFyc2VzIHRoZQot
ICogcmVjZWl2ZWQgZGF0YSBhcyBuZXRsaW5rIG1lc3NhZ2VzLiBTdG9wcyByZWFkaW5nIGlmIG9u
ZSBvZiB0aGUKLSAqIGNhbGxiYWNrcyByZXR1cm5zIE5MX1NUT1Agb3IgbmxfcmVjdiByZXR1cm5z
IGVpdGhlciAwIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29kZS4KLSAqCi0gKiBBIG5vbi1ibG9ja2lu
ZyBzb2NrZXRzIGNhdXNlcyB0aGUgZnVuY3Rpb24gdG8gcmV0dXJuIGltbWVkaWF0ZWx5IGlmCi0g
KiBubyBkYXRhIGlzIGF2YWlsYWJsZS4KLSAqCi0gKiBAcmV0dXJuIDAgb24gc3VjY2VzcyBvciBh
IG5lZ2F0aXZlIGVycm9yIGNvZGUgZnJvbSBubF9yZWN2KCkuCi0gKi8KLWludCBubF9yZWN2bXNn
cyhzdHJ1Y3Qgbmxfc29jayAqc2ssIHN0cnVjdCBubF9jYiAqY2IpCi17Ci0JaWYgKGNiLT5jYl9y
ZWN2bXNnc19vdykKLQkJcmV0dXJuIGNiLT5jYl9yZWN2bXNnc19vdyhzaywgY2IpOwotCWVsc2UK
LQkJcmV0dXJuIHJlY3Ztc2dzKHNrLCBjYik7Ci19Ci0KLQotc3RhdGljIGludCBhY2tfd2FpdF9o
YW5kbGVyKHN0cnVjdCBubF9tc2cgKm1zZywgdm9pZCAqYXJnKQotewotCXJldHVybiBOTF9TVE9Q
OwotfQotCi0vKioKLSAqIFdhaXQgZm9yIEFDSy4KLSAqIEBhcmcgc2sJCU5ldGxpbmsgc29ja2V0
LgotICogQHByZSBUaGUgbmV0bGluayBzb2NrZXQgbXVzdCBiZSBpbiBibG9ja2luZyBzdGF0ZS4K
LSAqCi0gKiBXYWl0cyB1bnRpbCBhbiBBQ0sgaXMgcmVjZWl2ZWQgZm9yIHRoZSBsYXRlc3Qgbm90
IHlldCBhY2tub3dsZWRnZWQKLSAqIG5ldGxpbmsgbWVzc2FnZS4KLSAqLwotaW50IG5sX3dhaXRf
Zm9yX2FjayhzdHJ1Y3Qgbmxfc29jayAqc2spCi17Ci0JaW50IGVycjsKLQlzdHJ1Y3QgbmxfY2Ig
KmNiOwotCi0JY2IgPSBubF9jYl9jbG9uZShzay0+c19jYik7Ci0JaWYgKGNiID09IE5VTEwpCi0J
CXJldHVybiAtTkxFX05PTUVNOwotCi0JbmxfY2Jfc2V0KGNiLCBOTF9DQl9BQ0ssIE5MX0NCX0NV
U1RPTSwgYWNrX3dhaXRfaGFuZGxlciwgTlVMTCk7Ci0JZXJyID0gbmxfcmVjdm1zZ3Moc2ssIGNi
KTsKLQlubF9jYl9wdXQoY2IpOwotCi0JcmV0dXJuIGVycjsKLX0KLQotLyoqIEB9ICovCi0KLS8q
KiBAfSAqLwpkaWZmIC0tZ2l0IGEvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL29iamVjdC5j
IGIvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL29iamVjdC5jCmRlbGV0ZWQgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAzODRiYWNkYzZjYmMuLjAwMDAwMDAwMDAwMAotLS0gYS9wYWNrYWdlL2xp
YnMvbGlibmwtdGlueS9zcmMvb2JqZWN0LmMKKysrIC9kZXYvbnVsbApAQCAtMSwxNDcgKzAsMCBA
QAotLyoKLSAqIGxpYi9vYmplY3QuYwkJR2VuZXJpYyBDYWNoZWFibGUgT2JqZWN0Ci0gKgotICoJ
VGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFu
ZC9vcgotICoJbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5l
cmFsIFB1YmxpYwotICoJTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUg
Rm91bmRhdGlvbiB2ZXJzaW9uIDIuMQotICoJb2YgdGhlIExpY2Vuc2UuCi0gKgotICogQ29weXJp
Z2h0IChjKSAyMDAzLTIwMDggVGhvbWFzIEdyYWYgPHRncmFmQHN1dWcuY2g+Ci0gKi8KLQotLyoq
Ci0gKiBAaW5ncm91cCBjYWNoZQotICogQGRlZmdyb3VwIG9iamVjdCBPYmplY3QKLSAqIEB7Ci0g
Ki8KLQotI2luY2x1ZGUgPG5ldGxpbmstbG9jYWwuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL25ldGxp
bmsuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL2NhY2hlLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9vYmpl
Y3QuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL3V0aWxzLmg+Ci0KLXN0YXRpYyBpbmxpbmUgc3RydWN0
IG5sX29iamVjdF9vcHMgKm9ial9vcHMoc3RydWN0IG5sX29iamVjdCAqb2JqKQotewotCWlmICgh
b2JqLT5jZV9vcHMpCi0JCUJVRygpOwotCi0JcmV0dXJuIG9iai0+Y2Vfb3BzOwotfQotCi0vKioK
LSAqIEBuYW1lIE9iamVjdCBDcmVhdGlvbi9EZWxldGlvbgotICogQHsKLSAqLwotCi0vKioKLSAq
IEFsbG9jYXRlIGEgbmV3IG9iamVjdCBvZiBraW5kIHNwZWNpZmllZCBieSB0aGUgb3BlcmF0aW9u
cyBoYW5kbGUKLSAqIEBhcmcgb3BzCQljYWNoZSBvcGVyYXRpb25zIGhhbmRsZQotICogQHJldHVy
biBUaGUgbmV3IG9iamVjdCBvciBOVUxMCi0gKi8KLXN0cnVjdCBubF9vYmplY3QgKm5sX29iamVj
dF9hbGxvYyhzdHJ1Y3Qgbmxfb2JqZWN0X29wcyAqb3BzKQotewotCXN0cnVjdCBubF9vYmplY3Qg
Km5ldzsKLQotCWlmIChvcHMtPm9vX3NpemUgPCBzaXplb2YoKm5ldykpCi0JCUJVRygpOwotCi0J
bmV3ID0gY2FsbG9jKDEsIG9wcy0+b29fc2l6ZSk7Ci0JaWYgKCFuZXcpCi0JCXJldHVybiBOVUxM
OwotCi0JbmV3LT5jZV9yZWZjbnQgPSAxOwotCW5sX2luaXRfbGlzdF9oZWFkKCZuZXctPmNlX2xp
c3QpOwotCi0JbmV3LT5jZV9vcHMgPSBvcHM7Ci0JaWYgKG9wcy0+b29fY29uc3RydWN0b3IpCi0J
CW9wcy0+b29fY29uc3RydWN0b3IobmV3KTsKLQotCU5MX0RCRyg0LCAiQWxsb2NhdGVkIG5ldyBv
YmplY3QgJXBcbiIsIG5ldyk7Ci0KLQlyZXR1cm4gbmV3OwotfQotCi1zdHJ1Y3QgbmxfZGVyaXZl
ZF9vYmplY3QgewotCU5MSERSX0NPTU1PTgotCWNoYXIgZGF0YTsKLX07Ci0KLS8qKgotICogQWxs
b2NhdGUgYSBuZXcgb2JqZWN0IGFuZCBjb3B5IGFsbCBkYXRhIGZyb20gYW4gZXhpc3Rpbmcgb2Jq
ZWN0Ci0gKiBAYXJnIG9iagkJb2JqZWN0IHRvIGluaGVyaXRlIGRhdGEgZnJvbQotICogQHJldHVy
biBUaGUgbmV3IG9iamVjdCBvciBOVUxMLgotICovCi1zdHJ1Y3Qgbmxfb2JqZWN0ICpubF9vYmpl
Y3RfY2xvbmUoc3RydWN0IG5sX29iamVjdCAqb2JqKQotewotCXN0cnVjdCBubF9vYmplY3QgKm5l
dzsKLQlzdHJ1Y3Qgbmxfb2JqZWN0X29wcyAqb3BzID0gb2JqX29wcyhvYmopOwotCWludCBkb2Zm
ID0gb2Zmc2V0b2Yoc3RydWN0IG5sX2Rlcml2ZWRfb2JqZWN0LCBkYXRhKTsKLQlpbnQgc2l6ZTsK
LQotCW5ldyA9IG5sX29iamVjdF9hbGxvYyhvcHMpOwotCWlmICghbmV3KQotCQlyZXR1cm4gTlVM
TDsKLQotCXNpemUgPSBvcHMtPm9vX3NpemUgLSBkb2ZmOwotCWlmIChzaXplIDwgMCkKLQkJQlVH
KCk7Ci0KLQluZXctPmNlX29wcyA9IG9iai0+Y2Vfb3BzOwotCW5ldy0+Y2VfbXNndHlwZSA9IG9i
ai0+Y2VfbXNndHlwZTsKLQotCWlmIChzaXplKQotCQltZW1jcHkoKHZvaWQgKiluZXcgKyBkb2Zm
LCAodm9pZCAqKW9iaiArIGRvZmYsIHNpemUpOwotCi0JaWYgKG9wcy0+b29fY2xvbmUpIHsKLQkJ
aWYgKG9wcy0+b29fY2xvbmUobmV3LCBvYmopIDwgMCkgewotCQkJbmxfb2JqZWN0X2ZyZWUobmV3
KTsKLQkJCXJldHVybiBOVUxMOwotCQl9Ci0JfSBlbHNlIGlmIChzaXplICYmIG9wcy0+b29fZnJl
ZV9kYXRhKQotCQlCVUcoKTsKLQotCXJldHVybiBuZXc7Ci19Ci0KLS8qKgotICogRnJlZSBhIGNh
Y2hlYWJsZSBvYmplY3QKLSAqIEBhcmcgb2JqCQlvYmplY3QgdG8gZnJlZQotICoKLSAqIEByZXR1
cm4gMCBvciBhIG5lZ2F0aXZlIGVycm9yIGNvZGUuCi0gKi8KLXZvaWQgbmxfb2JqZWN0X2ZyZWUo
c3RydWN0IG5sX29iamVjdCAqb2JqKQotewotCXN0cnVjdCBubF9vYmplY3Rfb3BzICpvcHMgPSBv
Ympfb3BzKG9iaik7Ci0KLQlpZiAob2JqLT5jZV9yZWZjbnQgPiAwKQotCQlOTF9EQkcoMSwgIldh
cm5pbmc6IEZyZWVpbmcgb2JqZWN0IGluIHVzZS4uLlxuIik7Ci0KLQlpZiAob2JqLT5jZV9jYWNo
ZSkKLQkJbmxfY2FjaGVfcmVtb3ZlKG9iaik7Ci0KLQlpZiAob3BzLT5vb19mcmVlX2RhdGEpCi0J
CW9wcy0+b29fZnJlZV9kYXRhKG9iaik7Ci0KLQlmcmVlKG9iaik7Ci0KLQlOTF9EQkcoNCwgIkZy
ZWVkIG9iamVjdCAlcFxuIiwgb2JqKTsKLX0KLQotLyoqIEB9ICovCi0KLS8qKgotICogQG5hbWUg
UmVmZXJlbmNlIE1hbmFnZW1lbnQKLSAqIEB7Ci0gKi8KLQotLyoqIEB9ICovCi0KLS8qKgotICog
QG5hbWUgVXRpbGxpdGllcwotICogQHsKLSAqLwotCi0vKiogQH0gKi8KLQotLyoqIEB9ICovCmRp
ZmYgLS1naXQgYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvc29ja2V0LmMgYi9wYWNrYWdl
L2xpYnMvbGlibmwtdGlueS9zcmMvc29ja2V0LmMKZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDE0Mjk4MjVlNjM2ZS4uMDAwMDAwMDAwMDAwCi0tLSBhL3BhY2thZ2UvbGlicy9saWJubC10
aW55L3NyYy9zb2NrZXQuYworKysgL2Rldi9udWxsCkBAIC0xLDQwNiArMCwwIEBACi0vKgotICog
bGliL3NvY2tldC5jCQlOZXRsaW5rIFNvY2tldAotICoKLSAqCVRoaXMgbGlicmFyeSBpcyBmcmVl
IHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKLSAqCW1vZGlmeSBpdCB1
bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKLSAqCUxpY2Vu
c2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24gdmVyc2lvbiAy
LjEKLSAqCW9mIHRoZSBMaWNlbnNlLgotICoKLSAqIENvcHlyaWdodCAoYykgMjAwMy0yMDA4IFRo
b21hcyBHcmFmIDx0Z3JhZkBzdXVnLmNoPgotICovCi0KLS8qKgotICogQGluZ3JvdXAgY29yZQot
ICogQGRlZmdyb3VwIHNvY2tldCBTb2NrZXQKLSAqIEB7Ci0gKi8KLQotI2luY2x1ZGUgPG5ldGxp
bmstbG9jYWwuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL25ldGxpbmsuaD4KLSNpbmNsdWRlIDxuZXRs
aW5rL3V0aWxzLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9oYW5kbGVycy5oPgotI2luY2x1ZGUgPG5l
dGxpbmsvbXNnLmg+Ci0jaW5jbHVkZSA8bmV0bGluay9hdHRyLmg+Ci0KLXN0YXRpYyB1aW50MzJf
dCB1c2VkX3BvcnRzX21hcFszMl07Ci0KLXN0YXRpYyB1aW50MzJfdCBnZW5lcmF0ZV9sb2NhbF9w
b3J0KHZvaWQpCi17Ci0JaW50IGksIG47Ci0JdWludDMyX3QgcGlkID0gZ2V0cGlkKCkgJiAweDNG
RkZGRjsKLQotCWZvciAoaSA9IDA7IGkgPCAzMjsgaSsrKSB7Ci0JCWlmICh1c2VkX3BvcnRzX21h
cFtpXSA9PSAweEZGRkZGRkZGKQotCQkJY29udGludWU7Ci0KLQkJZm9yIChuID0gMDsgbiA8IDMy
OyBuKyspIHsKLQkJCWlmICgxVUwgJiAodXNlZF9wb3J0c19tYXBbaV0gPj4gbikpCi0JCQkJY29u
dGludWU7Ci0KLQkJCXVzZWRfcG9ydHNfbWFwW2ldIHw9ICgxVUwgPDwgbik7Ci0JCQluICs9IChp
ICogMzIpOwotCi0JCQkvKiBQSURfTUFYX0xJTUlUIGlzIGN1cnJlbnRseSBhdCAyXjIyLCBsZWF2
aW5nIDEwIGJpdAotCQkJICogdG8sIGkuZS4gMTAyNCB1bmlxdWUgcG9ydHMgcGVyIGFwcGxpY2F0
aW9uLiAqLwotCQkJcmV0dXJuIHBpZCArIChuIDw8IDIyKTsKLQotCQl9Ci0JfQotCi0JLyogT3V0
IG9mIHNvY2tldHMgaW4gb3VyIG93biBQSUQgbmFtZXNwYWNlLCB3aGF0IHRvIGRvPyBGSVhNRSAq
LwotCXJldHVybiBVSU5UX01BWDsKLX0KLQotc3RhdGljIHZvaWQgcmVsZWFzZV9sb2NhbF9wb3J0
KHVpbnQzMl90IHBvcnQpCi17Ci0JaW50IG5yOwotCi0JaWYgKHBvcnQgPT0gVUlOVF9NQVgpCi0J
CXJldHVybjsKLQkKLQluciA9IHBvcnQgPj4gMjI7Ci0JdXNlZF9wb3J0c19tYXBbbnIgLyAzMl0g
Jj0gfigxIDw8IG5yICUgMzIpOwotfQotCi0vKioKLSAqIEBuYW1lIEFsbG9jYXRpb24KLSAqIEB7
Ci0gKi8KLQotc3RhdGljIHN0cnVjdCBubF9zb2NrICpfX2FsbG9jX3NvY2tldChzdHJ1Y3Qgbmxf
Y2IgKmNiKQotewotCXN0cnVjdCBubF9zb2NrICpzazsKLQotCXNrID0gY2FsbG9jKDEsIHNpemVv
Zigqc2spKTsKLQlpZiAoIXNrKQotCQlyZXR1cm4gTlVMTDsKLQotCXNrLT5zX2ZkID0gLTE7Ci0J
c2stPnNfY2IgPSBjYjsKLQlzay0+c19sb2NhbC5ubF9mYW1pbHkgPSBBRl9ORVRMSU5LOwotCXNr
LT5zX3BlZXIubmxfZmFtaWx5ID0gQUZfTkVUTElOSzsKLQlzay0+c19zZXFfZXhwZWN0ID0gc2st
PnNfc2VxX25leHQgPSB0aW1lKDApOwotCXNrLT5zX2xvY2FsLm5sX3BpZCA9IGdlbmVyYXRlX2xv
Y2FsX3BvcnQoKTsKLQlpZiAoc2stPnNfbG9jYWwubmxfcGlkID09IFVJTlRfTUFYKSB7Ci0JCW5s
X3NvY2tldF9mcmVlKHNrKTsKLQkJcmV0dXJuIE5VTEw7Ci0JfQotCi0JcmV0dXJuIHNrOwotfQot
Ci0vKioKLSAqIEFsbG9jYXRlIG5ldyBuZXRsaW5rIHNvY2tldAotICoKLSAqIEByZXR1cm4gTmV3
bHkgYWxsb2NhdGVkIG5ldGxpbmsgc29ja2V0IG9yIE5VTEwuCi0gKi8KLXN0cnVjdCBubF9zb2Nr
ICpubF9zb2NrZXRfYWxsb2Modm9pZCkKLXsKLQlzdHJ1Y3QgbmxfY2IgKmNiOwotCQotCWNiID0g
bmxfY2JfYWxsb2MoTkxfQ0JfREVGQVVMVCk7Ci0JaWYgKCFjYikKLQkJcmV0dXJuIE5VTEw7Ci0K
LQlyZXR1cm4gX19hbGxvY19zb2NrZXQoY2IpOwotfQotCi0vKioKLSAqIEFsbG9jYXRlIG5ldyBz
b2NrZXQgd2l0aCBjdXN0b20gY2FsbGJhY2tzCi0gKiBAYXJnIGNiCQlDYWxsYmFjayBoYW5kbGVy
Ci0gKgotICogVGhlIHJlZmVyZW5jZSB0byB0aGUgY2FsbGJhY2sgaGFuZGxlciBpcyB0YWtlbiBp
bnRvIGFjY291bnQKLSAqIGF1dG9tYXRpY2FsbHksIGl0IGlzIHJlbGVhc2VkIGFnYWluIHVwb24g
Y2FsbGluZyBubF9zb2NrZXRfZnJlZSgpLgotICoKLSAqQHJldHVybiBOZXdseSBhbGxvY3RlZCBz
b2NrZXQgaGFuZGxlIG9yIE5VTEwuCi0gKi8KLXN0cnVjdCBubF9zb2NrICpubF9zb2NrZXRfYWxs
b2NfY2Ioc3RydWN0IG5sX2NiICpjYikKLXsKLQlpZiAoY2IgPT0gTlVMTCkKLQkJQlVHKCk7Ci0K
LQlyZXR1cm4gX19hbGxvY19zb2NrZXQobmxfY2JfZ2V0KGNiKSk7Ci19Ci0KLS8qKgotICogRnJl
ZSBhIG5ldGxpbmsgc29ja2V0LgotICogQGFyZyBzawkJTmV0bGluayBzb2NrZXQuCi0gKi8KLXZv
aWQgbmxfc29ja2V0X2ZyZWUoc3RydWN0IG5sX3NvY2sgKnNrKQotewotCWlmICghc2spCi0JCXJl
dHVybjsKLQotCWlmIChzay0+c19mZCA+PSAwKQotCQljbG9zZShzay0+c19mZCk7Ci0KLQlpZiAo
IShzay0+c19mbGFncyAmIE5MX09XTl9QT1JUKSkKLQkJcmVsZWFzZV9sb2NhbF9wb3J0KHNrLT5z
X2xvY2FsLm5sX3BpZCk7Ci0KLQlubF9jYl9wdXQoc2stPnNfY2IpOwotCWZyZWUoc2spOwotfQot
Ci0vKiogQH0gKi8KLQotLyoqCi0gKiBAbmFtZSBTZXF1ZW5jZSBOdW1iZXJzCi0gKiBAewotICov
Ci0KLXN0YXRpYyBpbnQgbm9vcF9zZXFfY2hlY2soc3RydWN0IG5sX21zZyAqbXNnLCB2b2lkICph
cmcpCi17Ci0JcmV0dXJuIE5MX09LOwotfQotCi0KLS8qKgotICogRGlzYWJsZSBzZXF1ZW5jZSBu
dW1iZXIgY2hlY2tpbmcuCi0gKiBAYXJnIHNrCQlOZXRsaW5rIHNvY2tldC4KLSAqCi0gKiBEaXNh
YmxlcyBjaGVja2luZyBvZiBzZXF1ZW5jZSBudW1iZXJzIG9uIHRoZSBuZXRsaW5rIHNvY2tldCBU
aGlzIGlzCi0gKiByZXF1aXJlZCB0byBhbGxvdyBtZXNzYWdlcyB0byBiZSBwcm9jZXNzZWQgd2hp
Y2ggd2VyZSBub3QgcmVxdWVzdGVkIGJ5Ci0gKiBhIHByZWNlZGluZyByZXF1ZXN0IG1lc3NhZ2Us
IGUuZy4gbmV0bGluayBldmVudHMuCi0gKgotICogQG5vdGUgVGhpcyBmdW5jdGlvbiBtb2RpZmll
cyB0aGUgTkxfQ0JfU0VRX0NIRUNLIGNvbmZpZ3VyYXRpb24gaW4KLSAqIHRoZSBjYWxsYmFjayBo
YW5kbGUgYXNzb2NpYXRlZCB3aXRoIHRoZSBzb2NrZXQuCi0gKi8KLXZvaWQgbmxfc29ja2V0X2Rp
c2FibGVfc2VxX2NoZWNrKHN0cnVjdCBubF9zb2NrICpzaykKLXsKLQlubF9jYl9zZXQoc2stPnNf
Y2IsIE5MX0NCX1NFUV9DSEVDSywKLQkJICBOTF9DQl9DVVNUT00sIG5vb3Bfc2VxX2NoZWNrLCBO
VUxMKTsKLX0KLQotLyoqIEB9ICovCi0KLS8qKgotICogU2V0IGxvY2FsIHBvcnQgb2Ygc29ja2V0
Ci0gKiBAYXJnIHNrCQlOZXRsaW5rIHNvY2tldC4KLSAqIEBhcmcgcG9ydAkJTG9jYWwgcG9ydCBp
ZGVudGlmaWVyCi0gKgotICogQXNzaWducyBhIGxvY2FsIHBvcnQgaWRlbnRpZmllciB0byB0aGUg
c29ja2V0LiBJZiBwb3J0IGlzIDAKLSAqIGEgdW5pcXVlIHBvcnQgaWRlbnRpZmllciB3aWxsIGJl
IGdlbmVyYXRlZCBhdXRvbWF0aWNhbGx5LgotICovCi12b2lkIG5sX3NvY2tldF9zZXRfbG9jYWxf
cG9ydChzdHJ1Y3Qgbmxfc29jayAqc2ssIHVpbnQzMl90IHBvcnQpCi17Ci0JaWYgKHBvcnQgPT0g
MCkgewotCQlwb3J0ID0gZ2VuZXJhdGVfbG9jYWxfcG9ydCgpOyAKLQkJc2stPnNfZmxhZ3MgJj0g
fk5MX09XTl9QT1JUOwotCX0gZWxzZSAgewotCQlpZiAoIShzay0+c19mbGFncyAmIE5MX09XTl9Q
T1JUKSkKLQkJCXJlbGVhc2VfbG9jYWxfcG9ydChzay0+c19sb2NhbC5ubF9waWQpOwotCQlzay0+
c19mbGFncyB8PSBOTF9PV05fUE9SVDsKLQl9Ci0KLQlzay0+c19sb2NhbC5ubF9waWQgPSBwb3J0
OwotfQotCi0vKiogQH0gKi8KLQotLyoqCi0gKiBAbmFtZSBHcm91cCBTdWJzY3JpcHRpb25zCi0g
KiBAewotICovCi0KLS8qKgotICogSm9pbiBncm91cHMKLSAqIEBhcmcgc2sJCU5ldGxpbmsgc29j
a2V0Ci0gKiBAYXJnIGdyb3VwCQlHcm91cCBpZGVudGlmaWVyCi0gKgotICogSm9pbnMgdGhlIHNw
ZWNpZmllZCBncm91cHMgdXNpbmcgdGhlIG1vZGVybiBzb2NrZXQgb3B0aW9uIHdoaWNoCi0gKiBp
cyBhdmFpbGFibGUgc2luY2Uga2VybmVsIHZlcnNpb24gMi42LjE0LiBJdCBhbGxvd3Mgam9pbmlu
ZyBhbgotICogYWxtb3N0IGFyYml0YXJ5IG51bWJlciBvZiBncm91cHMgd2l0aG91dCBsaW1pdGF0
aW9uLiAgVGhlIGxpc3QKLSAqIG9mIGdyb3VwcyBoYXMgdG8gYmUgdGVybWluYXRlZCBieSAwICgl
TkZOTEdSUF9OT05FKS4KLSAqCi0gKiBNYWtlIHN1cmUgdG8gdXNlIHRoZSBjb3JyZWN0IGdyb3Vw
IGRlZmluaXRpb25zIGFzIHRoZSBvbGRlcgotICogYml0bWFzayBkZWZpbml0aW9ucyBmb3Igbmxf
am9pbl9ncm91cHMoKSBhcmUgbGlrZWx5IHRvIHN0aWxsCi0gKiBiZSBwcmVzZW50IGZvciBiYWNr
d2FyZCBjb21wYXRpYmlsaXR5IHJlYXNvbnMuCi0gKgotICogQHJldHVybiAwIG9uIHN1Y2VzcyBv
ciBhIG5lZ2F0aXZlIGVycm9yIGNvZGUuCi0gKi8KLWludCBubF9zb2NrZXRfYWRkX21lbWJlcnNo
aXBzKHN0cnVjdCBubF9zb2NrICpzaywgaW50IGdyb3VwLCAuLi4pCi17Ci0JaW50IGVycjsKLQl2
YV9saXN0IGFwOwotCi0JaWYgKHNrLT5zX2ZkID09IC0xKQotCQlyZXR1cm4gLU5MRV9CQURfU09D
SzsKLQotCXZhX3N0YXJ0KGFwLCBncm91cCk7Ci0KLQl3aGlsZSAoZ3JvdXAgIT0gMCkgewotCQlp
ZiAoZ3JvdXAgPCAwKQotCQkJcmV0dXJuIC1OTEVfSU5WQUw7Ci0KLQkJZXJyID0gc2V0c29ja29w
dChzay0+c19mZCwgU09MX05FVExJTkssIE5FVExJTktfQUREX01FTUJFUlNISVAsCi0JCQkJCQkg
Jmdyb3VwLCBzaXplb2YoZ3JvdXApKTsKLQkJaWYgKGVyciA8IDApCi0JCQlyZXR1cm4gLW5sX3N5
c2VycjJubGVycihlcnJubyk7Ci0KLQkJZ3JvdXAgPSB2YV9hcmcoYXAsIGludCk7Ci0JfQotCi0J
dmFfZW5kKGFwKTsKLQotCXJldHVybiAwOwotfQotCi0vKioKLSAqIExlYXZlIGdyb3VwcwotICog
QGFyZyBzawkJTmV0bGluayBzb2NrZXQKLSAqIEBhcmcgZ3JvdXAJCUdyb3VwIGlkZW50aWZpZXIK
LSAqCi0gKiBMZWF2ZXMgdGhlIHNwZWNpZmllZCBncm91cHMgdXNpbmcgdGhlIG1vZGVybiBzb2Nr
ZXQgb3B0aW9uCi0gKiB3aGljaCBpcyBhdmFpbGFibGUgc2luY2Uga2VybmVsIHZlcnNpb24gMi42
LjE0LiBUaGUgbGlzdCBvZiBncm91cHMKLSAqIGhhcyB0byB0ZXJtaW5hdGVkIGJ5IDAgKCVORk5M
R1JQX05PTkUpLgotICoKLSAqIEBzZWUgbmxfc29ja2V0X2FkZF9tZW1iZXJzaGlwCi0gKiBAcmV0
dXJuIDAgb24gc3VjY2VzcyBvciBhIG5lZ2F0aXZlIGVycm9yIGNvZGUuCi0gKi8KLWludCBubF9z
b2NrZXRfZHJvcF9tZW1iZXJzaGlwcyhzdHJ1Y3Qgbmxfc29jayAqc2ssIGludCBncm91cCwgLi4u
KQotewotCWludCBlcnI7Ci0JdmFfbGlzdCBhcDsKLQotCWlmIChzay0+c19mZCA9PSAtMSkKLQkJ
cmV0dXJuIC1OTEVfQkFEX1NPQ0s7Ci0KLQl2YV9zdGFydChhcCwgZ3JvdXApOwotCi0Jd2hpbGUg
KGdyb3VwICE9IDApIHsKLQkJaWYgKGdyb3VwIDwgMCkKLQkJCXJldHVybiAtTkxFX0lOVkFMOwot
Ci0JCWVyciA9IHNldHNvY2tvcHQoc2stPnNfZmQsIFNPTF9ORVRMSU5LLCBORVRMSU5LX0RST1Bf
TUVNQkVSU0hJUCwKLQkJCQkJCSAmZ3JvdXAsIHNpemVvZihncm91cCkpOwotCQlpZiAoZXJyIDwg
MCkKLQkJCXJldHVybiAtbmxfc3lzZXJyMm5sZXJyKGVycm5vKTsKLQotCQlncm91cCA9IHZhX2Fy
ZyhhcCwgaW50KTsKLQl9Ci0KLQl2YV9lbmQoYXApOwotCi0JcmV0dXJuIDA7Ci19Ci0KLQotLyoq
IEB9ICovCi0KLS8qKgotICogU2V0IGZpbGUgZGVzY3JpcHRvciBvZiBzb2NrZXQgdG8gbm9uLWJs
b2NraW5nIHN0YXRlCi0gKiBAYXJnIHNrCQlOZXRsaW5rIHNvY2tldC4KLSAqCi0gKiBAcmV0dXJu
IDAgb24gc3VjY2VzcyBvciBhIG5lZ2F0aXZlIGVycm9yIGNvZGUuCi0gKi8KLWludCBubF9zb2Nr
ZXRfc2V0X25vbmJsb2NraW5nKHN0cnVjdCBubF9zb2NrICpzaykKLXsKLQlpZiAoc2stPnNfZmQg
PT0gLTEpCi0JCXJldHVybiAtTkxFX0JBRF9TT0NLOwotCi0JaWYgKGZjbnRsKHNrLT5zX2ZkLCBG
X1NFVEZMLCBPX05PTkJMT0NLKSA8IDApCi0JCXJldHVybiAtbmxfc3lzZXJyMm5sZXJyKGVycm5v
KTsKLQotCXJldHVybiAwOwotfQotCi0vKiogQH0gKi8KLQotLyoqCi0gKiBAbmFtZSBVdGlsaXRp
ZXMKLSAqIEB7Ci0gKi8KLQotLyoqCi0gKiBTZXQgc29ja2V0IGJ1ZmZlciBzaXplIG9mIG5ldGxp
bmsgc29ja2V0LgotICogQGFyZyBzawkJTmV0bGluayBzb2NrZXQuCi0gKiBAYXJnIHJ4YnVmCQlO
ZXcgcmVjZWl2ZSBzb2NrZXQgYnVmZmVyIHNpemUgaW4gYnl0ZXMuCi0gKiBAYXJnIHR4YnVmCQlO
ZXcgdHJhbnNtaXQgc29ja2V0IGJ1ZmZlciBzaXplIGluIGJ5dGVzLgotICoKLSAqIFNldHMgdGhl
IHNvY2tldCBidWZmZXIgc2l6ZSBvZiBhIG5ldGxpbmsgc29ja2V0IHRvIHRoZSBzcGVjaWZpZWQK
LSAqIHZhbHVlcyBcYyByeGJ1ZiBhbmQgXGMgdHhidWYuIFByb3ZpZGluZyBhIHZhbHVlIG9mIFxj
IDAgYXNzdW1lcyBhCi0gKiBnb29kIGRlZmF1bHQgdmFsdWUuCi0gKgotICogQG5vdGUgSXQgaXMg
bm90IHJlcXVpcmVkIHRvIGNhbGwgdGhpcyBmdW5jdGlvbiBwcmlvciB0byBubF9jb25uZWN0KCku
Ci0gKiBAcmV0dXJuIDAgb24gc3VjZXNzIG9yIGEgbmVnYXRpdmUgZXJyb3IgY29kZS4KLSAqLwot
aW50IG5sX3NvY2tldF9zZXRfYnVmZmVyX3NpemUoc3RydWN0IG5sX3NvY2sgKnNrLCBpbnQgcnhi
dWYsIGludCB0eGJ1ZikKLXsKLQlpbnQgZXJyOwotCi0JaWYgKHJ4YnVmIDw9IDApCi0JCXJ4YnVm
ID0gMzI3Njg7Ci0KLQlpZiAodHhidWYgPD0gMCkKLQkJdHhidWYgPSAzMjc2ODsKLQotCWlmIChz
ay0+c19mZCA9PSAtMSkKLQkJcmV0dXJuIC1OTEVfQkFEX1NPQ0s7Ci0JCi0JZXJyID0gc2V0c29j
a29wdChzay0+c19mZCwgU09MX1NPQ0tFVCwgU09fU05EQlVGLAotCQkJICZ0eGJ1Ziwgc2l6ZW9m
KHR4YnVmKSk7Ci0JaWYgKGVyciA8IDApCi0JCXJldHVybiAtbmxfc3lzZXJyMm5sZXJyKGVycm5v
KTsKLQotCWVyciA9IHNldHNvY2tvcHQoc2stPnNfZmQsIFNPTF9TT0NLRVQsIFNPX1JDVkJVRiwK
LQkJCSAmcnhidWYsIHNpemVvZihyeGJ1ZikpOwotCWlmIChlcnIgPCAwKQotCQlyZXR1cm4gLW5s
X3N5c2VycjJubGVycihlcnJubyk7Ci0KLQlzay0+c19mbGFncyB8PSBOTF9TT0NLX0JVRlNJWkVf
U0VUOwotCi0JcmV0dXJuIDA7Ci19Ci0KLS8qKgotICogRW5hYmxlL2Rpc2FibGUgY3JlZGVudGlh
bCBwYXNzaW5nIG9uIG5ldGxpbmsgc29ja2V0LgotICogQGFyZyBzawkJTmV0bGluayBzb2NrZXQu
Ci0gKiBAYXJnIHN0YXRlCQlOZXcgc3RhdGUgKDAgLSBkaXNhYmxlZCwgMSAtIGVuYWJsZWQpCi0g
KgotICogQHJldHVybiAwIG9uIHN1Y2Nlc3Mgb3IgYSBuZWdhdGl2ZSBlcnJvciBjb2RlCi0gKi8K
LWludCBubF9zb2NrZXRfc2V0X3Bhc3NjcmVkKHN0cnVjdCBubF9zb2NrICpzaywgaW50IHN0YXRl
KQotewotCWludCBlcnI7Ci0KLQlpZiAoc2stPnNfZmQgPT0gLTEpCi0JCXJldHVybiAtTkxFX0JB
RF9TT0NLOwotCi0JZXJyID0gc2V0c29ja29wdChzay0+c19mZCwgU09MX1NPQ0tFVCwgU09fUEFT
U0NSRUQsCi0JCQkgJnN0YXRlLCBzaXplb2Yoc3RhdGUpKTsKLQlpZiAoZXJyIDwgMCkKLQkJcmV0
dXJuIC1ubF9zeXNlcnIybmxlcnIoZXJybm8pOwotCi0JaWYgKHN0YXRlKQotCQlzay0+c19mbGFn
cyB8PSBOTF9TT0NLX1BBU1NDUkVEOwotCWVsc2UKLQkJc2stPnNfZmxhZ3MgJj0gfk5MX1NPQ0tf
UEFTU0NSRUQ7Ci0KLQlyZXR1cm4gMDsKLX0KLQotLyoqCi0gKiBFbmFibGUvZGlzYWJsZSByZWNl
aXZhbCBvZiBhZGRpdGlvbmFsIHBhY2tldCBpbmZvcm1hdGlvbgotICogQGFyZyBzawkJTmV0bGlu
ayBzb2NrZXQuCi0gKiBAYXJnIHN0YXRlCQlOZXcgc3RhdGUgKDAgLSBkaXNhYmxlZCwgMSAtIGVu
YWJsZWQpCi0gKgotICogQHJldHVybiAwIG9uIHN1Y2Nlc3Mgb3IgYSBuZWdhdGl2ZSBlcnJvciBj
b2RlCi0gKi8KLWludCBubF9zb2NrZXRfcmVjdl9wa3RpbmZvKHN0cnVjdCBubF9zb2NrICpzaywg
aW50IHN0YXRlKQotewotCWludCBlcnI7Ci0KLQlpZiAoc2stPnNfZmQgPT0gLTEpCi0JCXJldHVy
biAtTkxFX0JBRF9TT0NLOwotCi0JZXJyID0gc2V0c29ja29wdChzay0+c19mZCwgU09MX05FVExJ
TkssIE5FVExJTktfUEtUSU5GTywKLQkJCSAmc3RhdGUsIHNpemVvZihzdGF0ZSkpOwotCWlmIChl
cnIgPCAwKQotCQlyZXR1cm4gLW5sX3N5c2VycjJubGVycihlcnJubyk7Ci0KLQlyZXR1cm4gMDsK
LX0KLQotLyoqIEB9ICovCi0KLS8qKiBAfSAqLwpkaWZmIC0tZ2l0IGEvcGFja2FnZS9saWJzL2xp
Ym5sLXRpbnkvc3JjL3VubC5jIGIvcGFja2FnZS9saWJzL2xpYm5sLXRpbnkvc3JjL3VubC5jCmRl
bGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAzM2MwMjBlYTEzZjguLjAwMDAwMDAwMDAwMAot
LS0gYS9wYWNrYWdlL2xpYnMvbGlibmwtdGlueS9zcmMvdW5sLmMKKysrIC9kZXYvbnVsbApAQCAt
MSwyODcgKzAsMCBAQAotI2RlZmluZSBfR05VX1NPVVJDRQotI2luY2x1ZGUgPG5ldGxpbmsvbmV0
bGluay5oPgotI2luY2x1ZGUgPG5ldGxpbmsvZ2VubC9nZW5sLmg+Ci0jaW5jbHVkZSA8bmV0bGlu
ay9nZW5sL2N0cmwuaD4KLSNpbmNsdWRlIDxuZXRsaW5rL2dlbmwvZmFtaWx5Lmg+Ci0jaW5jbHVk
ZSA8c3lzL3R5cGVzLmg+Ci0jaW5jbHVkZSA8bmV0L2lmLmg+Ci0jaW5jbHVkZSA8dW5pc3RkLmg+
Ci0jaW5jbHVkZSA8ZmNudGwuaD4KLSNpbmNsdWRlIDxsaW51eC9ubDgwMjExLmg+Ci0KLSNpbmNs
dWRlICJ1bmwuaCIKLQotc3RhdGljIGludCB1bmxfaW5pdChzdHJ1Y3QgdW5sICp1bmwpCi17Ci0J
dW5sLT5zb2NrID0gbmxfc29ja2V0X2FsbG9jKCk7Ci0JaWYgKCF1bmwtPnNvY2spCi0JCXJldHVy
biAtMTsKLQotCXJldHVybiAwOwotfQotCi1pbnQgdW5sX2dlbmxfaW5pdChzdHJ1Y3QgdW5sICp1
bmwsIGNvbnN0IGNoYXIgKmZhbWlseSkKLXsKLQltZW1zZXQodW5sLCAwLCBzaXplb2YoKnVubCkp
OwotCi0JaWYgKHVubF9pbml0KHVubCkpCi0JCWdvdG8gZXJyb3Jfb3V0OwotCi0JdW5sLT5oZHJs
ZW4gPSBOTE1TR19BTElHTihzaXplb2Yoc3RydWN0IGdlbmxtc2doZHIpKTsKLQl1bmwtPmZhbWls
eV9uYW1lID0gc3RyZHVwKGZhbWlseSk7Ci0JaWYgKCF1bmwtPmZhbWlseV9uYW1lKQotCQlnb3Rv
IGVycm9yOwotCi0JaWYgKGdlbmxfY29ubmVjdCh1bmwtPnNvY2spKQotCQlnb3RvIGVycm9yOwot
Ci0JaWYgKGdlbmxfY3RybF9hbGxvY19jYWNoZSh1bmwtPnNvY2ssICZ1bmwtPmNhY2hlKSkKLQkJ
Z290byBlcnJvcjsKLQotCXVubC0+ZmFtaWx5ID0gZ2VubF9jdHJsX3NlYXJjaF9ieV9uYW1lKHVu
bC0+Y2FjaGUsIGZhbWlseSk7Ci0JaWYgKCF1bmwtPmZhbWlseSkKLQkJZ290byBlcnJvcjsKLQot
CXJldHVybiAwOwotCi1lcnJvcjoKLQl1bmxfZnJlZSh1bmwpOwotZXJyb3Jfb3V0OgotCXJldHVy
biAtMTsKLX0KLQotdm9pZCB1bmxfZnJlZShzdHJ1Y3QgdW5sICp1bmwpCi17Ci0JaWYgKHVubC0+
ZmFtaWx5X25hbWUpCi0JCWZyZWUodW5sLT5mYW1pbHlfbmFtZSk7Ci0KLQlpZiAodW5sLT5zb2Nr
KQotCQlubF9zb2NrZXRfZnJlZSh1bmwtPnNvY2spOwotCi0JaWYgKHVubC0+Y2FjaGUpCi0JCW5s
X2NhY2hlX2ZyZWUodW5sLT5jYWNoZSk7Ci0KLQltZW1zZXQodW5sLCAwLCBzaXplb2YoKnVubCkp
OwotfQotCi1zdGF0aWMgaW50Ci1hY2tfaGFuZGxlcihzdHJ1Y3QgbmxfbXNnICptc2csIHZvaWQg
KmFyZykKLXsKLQlpbnQgKmVyciA9IGFyZzsKLQkqZXJyID0gMDsKLQlyZXR1cm4gTkxfU1RPUDsK
LX0KLQotc3RhdGljIGludAotZmluaXNoX2hhbmRsZXIoc3RydWN0IG5sX21zZyAqbXNnLCB2b2lk
ICphcmcpCi17Ci0JaW50ICplcnIgPSBhcmc7Ci0JKmVyciA9IDA7Ci0JcmV0dXJuIE5MX1NLSVA7
Ci19Ci0KLXN0YXRpYyBpbnQKLWVycm9yX2hhbmRsZXIoc3RydWN0IHNvY2thZGRyX25sICpubGEs
IHN0cnVjdCBubG1zZ2VyciAqZXJyLCB2b2lkICphcmcpCi17Ci0JaW50ICpyZXQgPSBhcmc7Ci0J
KnJldCA9IGVyci0+ZXJyb3I7Ci0JcmV0dXJuIE5MX1NLSVA7Ci19Ci0KLXN0cnVjdCBubF9tc2cg
KnVubF9nZW5sX21zZyhzdHJ1Y3QgdW5sICp1bmwsIGludCBjbWQsIGJvb2wgZHVtcCkKLXsKLQlz
dHJ1Y3QgbmxfbXNnICptc2c7Ci0JaW50IGZsYWdzID0gMDsKLQotCW1zZyA9IG5sbXNnX2FsbG9j
KCk7Ci0JaWYgKCFtc2cpCi0JCWdvdG8gb3V0OwotCi0JaWYgKGR1bXApCi0JCWZsYWdzIHw9IE5M
TV9GX0RVTVA7Ci0KLQlnZW5sbXNnX3B1dChtc2csIE5MX0FVVE9fUElELCBOTF9BVVRPX1NFUSwK
LQkJICAgIGdlbmxfZmFtaWx5X2dldF9pZCh1bmwtPmZhbWlseSksIDAsIGZsYWdzLCBjbWQsIDAp
OwotCi1vdXQ6Ci0JcmV0dXJuIG1zZzsKLX0KLQotaW50IHVubF9nZW5sX3JlcXVlc3Qoc3RydWN0
IHVubCAqdW5sLCBzdHJ1Y3QgbmxfbXNnICptc2csIHVubF9jYiBoYW5kbGVyLCB2b2lkICphcmcp
Ci17Ci0Jc3RydWN0IG5sX2NiICpjYjsKLQlpbnQgZXJyOwotCi0JY2IgPSBubF9jYl9hbGxvYyhO
TF9DQl9DVVNUT00pOwotCWVyciA9IG5sX3NlbmRfYXV0b19jb21wbGV0ZSh1bmwtPnNvY2ssIG1z
Zyk7Ci0JaWYgKGVyciA8IDApCi0JCWdvdG8gb3V0OwotCi0JZXJyID0gMTsKLQlubF9jYl9lcnIo
Y2IsIE5MX0NCX0NVU1RPTSwgZXJyb3JfaGFuZGxlciwgJmVycik7Ci0JbmxfY2Jfc2V0KGNiLCBO
TF9DQl9GSU5JU0gsIE5MX0NCX0NVU1RPTSwgZmluaXNoX2hhbmRsZXIsICZlcnIpOwotCW5sX2Ni
X3NldChjYiwgTkxfQ0JfQUNLLCBOTF9DQl9DVVNUT00sIGFja19oYW5kbGVyLCAmZXJyKTsKLQlp
ZiAoaGFuZGxlcikKLQkJbmxfY2Jfc2V0KGNiLCBOTF9DQl9WQUxJRCwgTkxfQ0JfQ1VTVE9NLCBo
YW5kbGVyLCBhcmcpOwotCi0Jd2hpbGUgKGVyciA+IDApCi0JCW5sX3JlY3Ztc2dzKHVubC0+c29j
aywgY2IpOwotCi1vdXQ6Ci0Jbmxtc2dfZnJlZShtc2cpOwotCW5sX2NiX3B1dChjYik7Ci0JcmV0
dXJuIGVycjsKLX0KLQotc3RhdGljIGludCByZXF1ZXN0X3NpbmdsZV9jYihzdHJ1Y3QgbmxfbXNn
ICptc2csIHZvaWQgKmFyZykKLXsKLQlzdHJ1Y3QgbmxfbXNnICoqZGVzdCA9IGFyZzsKLQotCWlm
ICghKmRlc3QpIHsKLQkJbmxtc2dfZ2V0KG1zZyk7Ci0JCSpkZXN0ID0gbXNnOwotCX0KLQlyZXR1
cm4gTkxfU0tJUDsKLX0KLQotaW50IHVubF9nZW5sX3JlcXVlc3Rfc2luZ2xlKHN0cnVjdCB1bmwg
KnVubCwgc3RydWN0IG5sX21zZyAqbXNnLCBzdHJ1Y3QgbmxfbXNnICoqZGVzdCkKLXsKLQkqZGVz
dCA9IE5VTEw7Ci0JcmV0dXJuIHVubF9nZW5sX3JlcXVlc3QodW5sLCBtc2csIHJlcXVlc3Rfc2lu
Z2xlX2NiLCBkZXN0KTsKLX0KLQotc3RhdGljIGludCBub19zZXFfY2hlY2soc3RydWN0IG5sX21z
ZyAqbXNnLCB2b2lkICphcmcpCi17Ci0JcmV0dXJuIE5MX09LOwotfQotCi12b2lkIHVubF9nZW5s
X2xvb3Aoc3RydWN0IHVubCAqdW5sLCB1bmxfY2IgaGFuZGxlciwgdm9pZCAqYXJnKQotewotCXN0
cnVjdCBubF9jYiAqY2I7Ci0KLQljYiA9IG5sX2NiX2FsbG9jKE5MX0NCX0NVU1RPTSk7Ci0JdW5s
LT5sb29wX2RvbmUgPSBmYWxzZTsKLQlubF9jYl9zZXQoY2IsIE5MX0NCX1NFUV9DSEVDSywgTkxf
Q0JfQ1VTVE9NLCBub19zZXFfY2hlY2ssIE5VTEwpOwotCW5sX2NiX3NldChjYiwgTkxfQ0JfVkFM
SUQsIE5MX0NCX0NVU1RPTSwgaGFuZGxlciwgYXJnKTsKLQotCXdoaWxlICghdW5sLT5sb29wX2Rv
bmUpCi0JCW5sX3JlY3Ztc2dzKHVubC0+c29jaywgY2IpOwotCi0JbmxfY2JfcHV0KGNiKTsKLX0K
LQotaW50IHVubF9nZW5sX211bHRpY2FzdF9pZChzdHJ1Y3QgdW5sICp1bmwsIGNvbnN0IGNoYXIg
Km5hbWUpCi17Ci0Jc3RydWN0IG5sYXR0ciAqdGJbQ1RSTF9BVFRSX01DQVNUX0dSUF9NQVggKyAx
XTsKLQlzdHJ1Y3QgbmxhdHRyICpncm91cHMsICpncm91cDsKLQlzdHJ1Y3QgbmxfbXNnICptc2c7
Ci0JaW50IGN0cmxpZDsKLQlpbnQgcmV0ID0gLTE7Ci0JaW50IHJlbTsKLQotCW1zZyA9IG5sbXNn
X2FsbG9jKCk7Ci0JaWYgKCFtc2cpCi0JCXJldHVybiAtMTsKLQotCWN0cmxpZCA9IGdlbmxfY3Ry
bF9yZXNvbHZlKHVubC0+c29jaywgIm5sY3RybCIpOwotCWdlbmxtc2dfcHV0KG1zZywgMCwgMCwg
Y3RybGlkLCAwLCAwLCBDVFJMX0NNRF9HRVRGQU1JTFksIDApOwotCU5MQV9QVVRfU1RSSU5HKG1z
ZywgQ1RSTF9BVFRSX0ZBTUlMWV9OQU1FLCB1bmwtPmZhbWlseV9uYW1lKTsKLQl1bmxfZ2VubF9y
ZXF1ZXN0X3NpbmdsZSh1bmwsIG1zZywgJm1zZyk7Ci0JaWYgKCFtc2cpCi0JCXJldHVybiAtMTsK
LQotCWdyb3VwcyA9IHVubF9maW5kX2F0dHIodW5sLCBtc2csIENUUkxfQVRUUl9NQ0FTVF9HUk9V
UFMpOwotCWlmICghZ3JvdXBzKQotCQlnb3RvIG5sYV9wdXRfZmFpbHVyZTsKLQotCW5sYV9mb3Jf
ZWFjaF9uZXN0ZWQoZ3JvdXAsIGdyb3VwcywgcmVtKSB7Ci0JCWNvbnN0IGNoYXIgKmduOwotCi0J
CW5sYV9wYXJzZSh0YiwgQ1RSTF9BVFRSX01DQVNUX0dSUF9NQVgsIG5sYV9kYXRhKGdyb3VwKSwK
LQkJCSAgbmxhX2xlbihncm91cCksIE5VTEwpOwotCi0JCWlmICghdGJbQ1RSTF9BVFRSX01DQVNU
X0dSUF9OQU1FXSB8fAotCQkgICAgIXRiW0NUUkxfQVRUUl9NQ0FTVF9HUlBfSURdKQotCQkJY29u
dGludWU7Ci0KLQkJZ24gPSBubGFfZGF0YSh0YltDVFJMX0FUVFJfTUNBU1RfR1JQX05BTUVdKTsK
LQkJaWYgKHN0cmNtcChnbiwgbmFtZSkgIT0gMCkKLQkJCWNvbnRpbnVlOwotCi0JCXJldCA9IG5s
YV9nZXRfdTMyKHRiW0NUUkxfQVRUUl9NQ0FTVF9HUlBfSURdKTsKLQkJYnJlYWs7Ci0JfQotCi1u
bGFfcHV0X2ZhaWx1cmU6Ci0Jbmxtc2dfZnJlZShtc2cpOwotCXJldHVybiByZXQ7Ci19Ci0KLWlu
dCB1bmxfZ2VubF9zdWJzY3JpYmUoc3RydWN0IHVubCAqdW5sLCBjb25zdCBjaGFyICpuYW1lKQot
ewotCWludCBtY2lkOwotCi0JbWNpZCA9IHVubF9nZW5sX211bHRpY2FzdF9pZCh1bmwsIG5hbWUp
OwotCWlmIChtY2lkIDwgMCkKLQkJcmV0dXJuIG1jaWQ7Ci0KLQlyZXR1cm4gbmxfc29ja2V0X2Fk
ZF9tZW1iZXJzaGlwKHVubC0+c29jaywgbWNpZCk7Ci19Ci0KLWludCB1bmxfZ2VubF91bnN1YnNj
cmliZShzdHJ1Y3QgdW5sICp1bmwsIGNvbnN0IGNoYXIgKm5hbWUpCi17Ci0JaW50IG1jaWQ7Ci0K
LQltY2lkID0gdW5sX2dlbmxfbXVsdGljYXN0X2lkKHVubCwgbmFtZSk7Ci0JaWYgKG1jaWQgPCAw
KQotCQlyZXR1cm4gbWNpZDsKLQotCXJldHVybiBubF9zb2NrZXRfZHJvcF9tZW1iZXJzaGlwKHVu
bC0+c29jaywgbWNpZCk7Ci19Ci0KLWludCB1bmxfbmw4MDIxMV9waHlfbG9va3VwKGNvbnN0IGNo
YXIgKm5hbWUpCi17Ci0JY2hhciBidWZbMzJdOwotCWludCBmZCwgcG9zOwotCi0Jc25wcmludGYo
YnVmLCBzaXplb2YoYnVmKSwgIi9zeXMvY2xhc3MvaWVlZTgwMjExLyVzL2luZGV4IiwgbmFtZSk7
Ci0KLQlmZCA9IG9wZW4oYnVmLCBPX1JET05MWSk7Ci0JaWYgKGZkIDwgMCkKLQkJcmV0dXJuIC0x
OwotCXBvcyA9IHJlYWQoZmQsIGJ1Ziwgc2l6ZW9mKGJ1ZikgLSAxKTsKLQlpZiAocG9zIDwgMCkg
ewotCQljbG9zZShmZCk7Ci0JCXJldHVybiAtMTsKLQl9Ci0JYnVmW3Bvc10gPSAnXDAnOwotCWNs
b3NlKGZkKTsKLQlyZXR1cm4gYXRvaShidWYpOwotfQotCi1pbnQgdW5sX25sODAyMTFfd2Rldl90
b19waHkoc3RydWN0IHVubCAqdW5sLCBpbnQgd2RldikKLXsKLQlzdHJ1Y3QgbmxfbXNnICptc2c7
Ci0Jc3RydWN0IG5sYXR0ciAqYXR0cjsKLQlpbnQgcmV0ID0gLTE7Ci0KLQltc2cgPSB1bmxfZ2Vu
bF9tc2codW5sLCBOTDgwMjExX0NNRF9HRVRfSU5URVJGQUNFLCBmYWxzZSk7Ci0JaWYgKCFtc2cp
Ci0JCXJldHVybiAtMTsKLQotCU5MQV9QVVRfVTMyKG1zZywgTkw4MDIxMV9BVFRSX0lGSU5ERVgs
IHdkZXYpOwotCWlmICh1bmxfZ2VubF9yZXF1ZXN0X3NpbmdsZSh1bmwsIG1zZywgJm1zZykgPCAw
KQotCQlyZXR1cm4gLTE7Ci0KLQlhdHRyID0gdW5sX2ZpbmRfYXR0cih1bmwsIG1zZywgTkw4MDIx
MV9BVFRSX1dJUEhZKTsKLQlpZiAoIWF0dHIpCi0JCWdvdG8gb3V0OwotCi0JcmV0ID0gbmxhX2dl
dF91MzIoYXR0cik7Ci1vdXQ6Ci1ubGFfcHV0X2ZhaWx1cmU6Ci0Jbmxtc2dfZnJlZShtc2cpOwot
CXJldHVybiByZXQ7Ci19Ci0KLQoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18Kb3BlbndydC1kZXZlbCBtYWlsaW5nIGxpc3QKb3BlbndydC1kZXZlbEBsaXN0
cy5vcGVud3J0Lm9yZwpodHRwczovL2xpc3RzLm9wZW53cnQub3JnL21haWxtYW4vbGlzdGluZm8v
b3BlbndydC1kZXZlbAo=
