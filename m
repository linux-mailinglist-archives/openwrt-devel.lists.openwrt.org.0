Return-Path: <openwrt-devel-bounces+lists+openwrt-devel=lfdr.de@lists.openwrt.org>
X-Original-To: lists+openwrt-devel@lfdr.de
Delivered-To: lists+openwrt-devel@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 21B731B90BC
	for <lists+openwrt-devel@lfdr.de>; Sun, 26 Apr 2020 15:48:22 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:
	Content-Transfer-Encoding:Content-Type:Cc:List-Subscribe:List-Help:List-Post:
	List-Archive:List-Unsubscribe:List-Id:Subject:To:Message-ID:Date:From:
	In-Reply-To:References:MIME-Version:Reply-To:Content-ID:Content-Description:
	Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:
	List-Owner; bh=5EUIQYMswSucE5t4bLU3ryRUGQLBPSxorwzSpoe9cYU=; b=hjdMRwuczVmJba
	peRJM6Md11eSbq6xSRQA1V1DPbZsck/4GBt0Nep0DEELM1bx9m/nwJ1ICutXl51neheAFm8ZWvR1G
	3cTBmMhUFJRAc0AiUI9ISufv+Ijh6hzcmmfoFMSbEQNtTjCPCJJ+WR4WJlDTwLygY7hO7ubE3Cdr5
	jTNR5EYnwkaXRAUd4b3doRAT3a/125KKDO/MZkzZygAWNh7z6es+vuzKKfLJTECFlncTzP6U68g/u
	Ju7d7cLAS0ad9gJfWrr1QxfcjlMdB8W/AugPTDDM9SWQsyM1Fwj9sgIpoGd6Ucx3T51E03wMf80N5
	QN5c/JD/edJToFk2unZA==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92.3 #3 (Red Hat Linux))
	id 1jShdX-0002SO-O5; Sun, 26 Apr 2020 13:47:59 +0000
Received: from mail-io1-xd41.google.com ([2607:f8b0:4864:20::d41])
 by bombadil.infradead.org with esmtps (Exim 4.92.3 #3 (Red Hat Linux))
 id 1jShdP-0002RN-Lr
 for openwrt-devel@lists.openwrt.org; Sun, 26 Apr 2020 13:47:54 +0000
Received: by mail-io1-xd41.google.com with SMTP id k6so15969799iob.3
 for <openwrt-devel@lists.openwrt.org>; Sun, 26 Apr 2020 06:47:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=VhhOqWbWJ4sYbG/BbYbsAg+GgRy0myVftx/BCp3B9ZU=;
 b=i2h5IDLgFtmCZBzXjVrwDrQ6FZOh/kxm0H4P9vaadcM6nwnThiAsed7X2koHy5J3Aj
 ywc8KhhxRb6qfO+1TjT07FTsHKbQE+KWafNP8DAk3Yq06xKIZUUGS/RNNyhfeWNymSUV
 V51I+p3TfzP85ArEKdnPPjZ+ck39z5g67X1O8xbmSQNtdZo+Jnw3XiQmpH7kQbIM0Usb
 OsSXUp2Sb+/yIekfqzZXEocV8MmIZEZwXix1UhkPjR1mQQCOXoM0dFCZoQIn/uDPGPVB
 P4tMcGcC52MCO5SJZjX5kBI6mWlm90XucBuG72YaAVjRDIoA5nX1tPcObj4NAIezPt0l
 nIlg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=VhhOqWbWJ4sYbG/BbYbsAg+GgRy0myVftx/BCp3B9ZU=;
 b=R0DSELLe+ElKdAMQxB2+xGanYHLBq84e9PY44MBM/VtGyisZCDMnj0YyKwpZXmS9px
 KL+ZceDSW4YyBWcRJGG6QOyeH3youEnqAEmFcV6OzboEbMTfyLJLLdkB8e/nTf3fMlLk
 k6boiiDuJYqpyrUldqHuQtDA20dR/P0zsJxYy8SEJJ1J/KIr8kRGE8c5weKAjm4Xjy5b
 rpnIDK5eEG7AVuvDnzlq6yqtpo8idq0NfmiEg2+cTaSgx61T/4pj0MY2U//j+HT88ekr
 hc/HKzE+J0BOTVHvZkJ51wN9LL+8JBDIo/NRvX1my+u/7TyQHLR6AF7YSL/0FT1IJ2gM
 5XrA==
X-Gm-Message-State: AGi0PuY82I4gBpo67VqY5MtCNk/hD5NAYqnPjvUpblaVvntdUlGQUeTr
 nt98JRqGzAzh54teXR324hSZSmjqaWV8sRXRSIkVuqERXJo=
X-Google-Smtp-Source: APiQypL85Goh05MNS2ew7FGCregeziXamS7UBlQbjBbs99MrUEKngchreI8iNfZNKs4Nu9mJzaEwV9biJuN73u2n2sA=
X-Received: by 2002:a02:a68e:: with SMTP id j14mr16585448jam.86.1587908870042; 
 Sun, 26 Apr 2020 06:47:50 -0700 (PDT)
MIME-Version: 1.0
References: <20200425234650.GA1336466@makrotopia.org>
 <CAOdf3gq2QhHqoC3GzSVq3FTZcY4RjBbUavsUq_LjmO7NeXzd1Q@mail.gmail.com>
 <20200426105311.GA1795@makrotopia.org>
In-Reply-To: <20200426105311.GA1795@makrotopia.org>
From: Etienne Champetier <champetier.etienne@gmail.com>
Date: Sun, 26 Apr 2020 09:47:38 -0400
Message-ID: <CAOdf3goKN++hLVjqgb6tOQkFdZDTg3HyYwBKZ=Rk1NBLGu9BEA@mail.gmail.com>
To: Daniel Golle <daniel@makrotopia.org>
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20200426_064751_747738_181EB6C5 
X-CRM114-Status: GOOD (  30.32  )
X-Spam-Score: -0.2 (/)
X-Spam-Report: SpamAssassin version 3.4.4 on bombadil.infradead.org summary:
 Content analysis details:   (-0.2 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -0.0 RCVD_IN_DNSWL_NONE     RBL: Sender listed at https://www.dnswl.org/,
 no trust [2607:f8b0:4864:20:0:0:0:d41 listed in]
 [list.dnswl.org]
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
 -0.0 SPF_PASS               SPF: sender matches SPF record
 0.0 FREEMAIL_FROM          Sender email is commonly abused enduser mail
 provider [champetier.etienne[at]gmail.com]
 -0.1 DKIM_VALID_AU          Message has a valid DKIM or DK signature from
 author's domain
 -0.1 DKIM_VALID_EF          Message has a valid DKIM or DK signature from
 envelope-from domain
 0.1 DKIM_SIGNED            Message has a DKIM or DK signature, not necessarily
 valid
 -0.1 DKIM_VALID Message has at least one valid DKIM or DK signature
Subject: Re: [OpenWrt-Devel] [PATCH RFC procd] jail: add option to provide
 /dev/console to containers
X-BeenThere: openwrt-devel@lists.openwrt.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <openwrt-devel.lists.openwrt.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/openwrt-devel>, 
 <mailto:openwrt-devel-request@lists.openwrt.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/openwrt-devel/>
List-Post: <mailto:openwrt-devel@lists.openwrt.org>
List-Help: <mailto:openwrt-devel-request@lists.openwrt.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/openwrt-devel>,
 <mailto:openwrt-devel-request@lists.openwrt.org?subject=subscribe>
Cc: John Crispin <john@phrozen.org>,
 OpenWrt Development List <openwrt-devel@lists.openwrt.org>,
 Felix Fietkau <nbd@nbd.name>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: "openwrt-devel" <openwrt-devel-bounces@lists.openwrt.org>
Errors-To: openwrt-devel-bounces+lists+openwrt-devel=lfdr.de@lists.openwrt.org

SGkgRGFuaWVsCgpMZSBkaW0uIDI2IGF2ci4gMjAyMCDDoCAwNjo1MywgRGFuaWVsIEdvbGxlIDxk
YW5pZWxAbWFrcm90b3BpYS5vcmc+IGEgw6ljcml0IDoKPgo+IEhpIEV0aWVubmUsCj4KPiBPbiBT
YXQsIEFwciAyNSwgMjAyMCBhdCAxMDozNzowMVBNIC0wNDAwLCBFdGllbm5lIENoYW1wZXRpZXIg
d3JvdGU6Cj4gPiBIaSBEYW5pZWwsCj4gPgo+ID4gTGUgc2FtLiAyNSBhdnIuIDIwMjAgw6AgMTk6
NDgsIERhbmllbCBHb2xsZSA8ZGFuaWVsQG1ha3JvdG9waWEub3JnPiBhIMOpY3JpdCA6Cj4gPiA+
Cj4gPiA+IENyZWF0ZSBVTklYLzk4IFBUWSwgcGFzcyBtYXN0ZXIgZmQgdG8gcHJvY2QgYW5kIHNl
dHVwIG1vdW50LWJpbmQgb2YKPiA+ID4gc2xhdmUgUFRTIGRldmljZSBvbiAvZGV2L2NvbnNvbGUg
aW5zaWRlIGphaWwuCj4gPiA+IEFsbG93IGF0dGFjaGluZyB0byBhbiBpbnN0YW5jZSdzIGNvbnNv
bGUgYnkgdXNpbmcgdGhlIG5ld2x5IGludHJvZHVjZWQKPiA+ID4gdWphaWwtY29uc29sZSBjb21t
YW5kIChubyBtdWx0aXBsZXhpbmcgZm9yIG5vdykuCj4gPgo+ID4gSnVzdCBjdXJpb3VzIGhvdyBm
YXIgeW91IHdhbnQgdG8gcHVzaCB1amFpbCA/Cj4gPiBpZSBkbyB5b3Ugd2FudCBhIGRvY2tlciBs
aXRlIC8gd2hhdCBmZWF0dXJlcyBkbyB5b3Ugd2FudCB0byBhZGQgPwo+Cj4gTW9yZSBsaWtlIHJ1
bmMtbGl0ZSB3aXRoIHVidXMgc3VwcG9ydCA6KQo+IElkZWFsbHkgd2l0aCByb3VnaGx5IDgwJSBv
ZiBmZWF0dXJlcyBjb3ZlcmVkIHdpdGggYWJvdXQgMjAlIG9mIHRoZQo+IGNvZGUuLi4KPiBNb3N0
IGZlYXR1cmVzIGhhdmUgYmVlbiBhZGRlZCBieSBub3csIG5leHQgc3RlcHMgd291bGQgYmUgY2xl
YW5pbmcgdXAKPiBhbmQgZml4aW5nIHRoaW5ncy4gRm9yIG5vdywgdXNlcm5zIHN1cHBvcnQgbmVl
ZHMgYSBsb3QgbW9yZSBsb3ZlIHRvCj4gZnVuY3Rpb24gcHJvcGVybHksIHN0YXJ0aW5nIHdpdGgg
ZGVjaWRpbmcgYWJvdXQgcXVpdGUgZnVuZGFtZW50YWwKPiB0aGluZ3MgbGlrZSB0aGlzIG9uZToK
Pgo+IGh0dHBzOi8vYXVyLmFyY2hsaW51eC5vcmcvY2dpdC9hdXIuZ2l0L3RyZWUvdWJ1bnR1LXVu
cHJpdmlsZWdlZC1vdmVybGF5ZnMucGF0Y2g/aD1saW51eC11c2VybnMKPgo+IChvciB1c2UgRlVT
RS1iYXNlZCBhcHByb2FjaCBsaWtlIExYQywgYnV0IHRoYXQncyBhIGxvdCBvZiBvdmVyaGVhZC4u
LikKPgo+IFdoYXQgSSdtIHN0aWxsIHBsYW5uaW5nIGZvciBwcm9jZC91amFpbCBpcyBiYXNpYyBz
dXBwb3J0IGZvciBjZ3JvdXBzdjIKPiAoaW5jbHVkaW5nIGEgd2F5IHRvIHVzZSBjZ3JvdXAtZGV2
aWNlcyB2aWEgc3RhdGljIEJQRiwgc2ltaWxhciB0byBob3cKPiB3ZSBnZW5lcmF0ZSBCUEYgZm9y
IHNlY2NvbXAgZmlsdGVyKQo+IFNvIG5vIHZvbHVtZS9pbWFnZS1tYW5hZ2VtZW50LCBubyBkb2Nr
ZXIgaW5kZXgsIG5vIGZyZWV6ZXIvbWlncmF0aW9uLAo+IGJ1dCBnb29kIGVub3VnaCB0byBib290
IERlYmlhbiwgQXJjaCBvciBBbHBpbmUgcm9vdGZzLgo+Cj4gU2VlIG15IGluY29tcGxldGUgcHJv
dG90eXBlIHRvb2w6IGh0dHBzOi8vZ3V0aHViLmNvbS9kYW5nb3dydC91eGMKPgo+IFRoZSBpZGVh
IGlzIHRvIGFkZCB1c2VmdWwgZmVhdHVyZXMgdG8gcHJvY2QgZm9yIHNpbmdsZSBzZXJ2aWNlcyB1
cCB0bwo+IGZ1bGwtc3lzdGVtIGNvbnRhaW5lcnMgcnVubmluZyBzeXN0ZW1kIGluc2lkZSAoYW5k
IGV2ZXJ5dGhpbmcgaW4KPiBiZXR3ZWVuKS4gVGhpbmsgb2YgbmV0d29yay1uYW1lc3BhY2VzIHdo
aWNoIGlzIGFscmVhZHkgdXNlZnVsIG5vdyB0bwo+IHdpcmUgdXAgYW55IHNlcnZpY2Ugd2l0aCB2
ZXRoIGRldmljZShzKSBpbiBpdCdzIG93biBuZXRucyBvciB0bXBvdmVybGF5Cj4gd2hpY2ggaXMg
dXNlZnVsIGVnLiBmb3IgdHJhbnNtaXNzaW9uIHdoaWNoIHdhbnRzIHRvIGNyZWF0ZSB0ZW1wb3Jh
cnkKPiBmaWxlcyBhdCBydW4tdGltZSBoYXZpbmcgYSByYW5kb20gbmFtZXMuLi4KPgo+IEFueXdh
eSwgYWxsIHRlc3RpbmcsIGZlZWRiYWNrIGFuZCByZXZpZXcgaXMgaGlnaGx5IGFwcHJlY2lhdGVk
IQoKTmljZSEKCk9uZSByZWFsbHkgdXNlZnVsIGZlYXR1cmUgdGhhdCBJIHdvdWxkIGxpa2UgdG8g
aGF2ZSBpcyBhbWJpZW50CmNhcGFiaWxpdGllcywgdG8gZWFzaWx5IHJ1biBhcyBub24gcm9vdCBt
YW55IGRhZW1vbnMKKGFuZCBpZGVhbGx5IGl0IHNob3VsZCBiZSBpbiBwcm9jZCAvIGFsd2F5cyBh
dmFpbGFibGUpCgpUaGFua3MgZm9yIGFsbCB0aGlzIHdvcmsKRXRpZW5uZQoKPgo+Cj4gQ2hlZXJz
Cj4KPgo+Cj4gRGFuaWVsCj4KPgo+Cj4KPiA+Cj4gPiBSZWdhcmRzCj4gPiBFdGllbm5lCj4gPgo+
ID4gPgo+ID4gPiBTaWduZWQtb2ZmLWJ5OiBEYW5pZWwgR29sbGUgPGRhbmllbEBtYWtyb3RvcGlh
Lm9yZz4KPiA+ID4gLS0tCj4gPiA+ICBDTWFrZUxpc3RzLnR4dCAgICAgfCAgIDYgKysKPiA+ID4g
IGphaWwvY29uc29sZS5jICAgICB8IDIwOSArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysKPiA+ID4gIGphaWwvamFpbC5jICAgICAgICB8ICA4MyArKysrKysrKysr
KysrKysrKy0KPiA+ID4gIHNlcnZpY2UvaW5zdGFuY2UuYyB8ICA3MCArKysrKysrKysrKysrKysK
PiA+ID4gIHNlcnZpY2UvaW5zdGFuY2UuaCB8ICAgMyArCj4gPiA+ICBzZXJ2aWNlL3NlcnZpY2Uu
YyAgfCAgNzEgKysrKysrKysrKysrKysrCj4gPiA+ICA2IGZpbGVzIGNoYW5nZWQsIDQzOCBpbnNl
cnRpb25zKCspLCA0IGRlbGV0aW9ucygtKQo+ID4gPiAgY3JlYXRlIG1vZGUgMTAwNjQ0IGphaWwv
Y29uc29sZS5jCj4gPiA+Cj4gPiA+IGRpZmYgLS1naXQgYS9DTWFrZUxpc3RzLnR4dCBiL0NNYWtl
TGlzdHMudHh0Cj4gPiA+IGluZGV4IGNmZjQ3Y2YuLjNlYjc5ZjkgMTAwNjQ0Cj4gPiA+IC0tLSBh
L0NNYWtlTGlzdHMudHh0Cj4gPiA+ICsrKyBiL0NNYWtlTGlzdHMudHh0Cj4gPiA+IEBAIC0xMTAs
NiArMTEwLDEyIEBAIElOU1RBTEwoVEFSR0VUUyB1amFpbAo+ID4gPiAgICAgICAgIFJVTlRJTUUg
REVTVElOQVRJT04gJHtDTUFLRV9JTlNUQUxMX1NCSU5ESVJ9Cj4gPiA+ICApCj4gPiA+ICBBRERf
REVQRU5ERU5DSUVTKHVqYWlsIGNhcGFiaWxpdGllcy1uYW1lcy1oKQo+ID4gPiArCj4gPiA+ICtB
RERfRVhFQ1VUQUJMRSh1amFpbC1jb25zb2xlIGphaWwvY29uc29sZS5jKQo+ID4gPiArVEFSR0VU
X0xJTktfTElCUkFSSUVTKHVqYWlsLWNvbnNvbGUgJHt1Ym94fSAke3VidXN9ICR7YmxvYm1zZ19q
c29ufSkKPiA+ID4gK0lOU1RBTEwoVEFSR0VUUyB1amFpbC1jb25zb2xlCj4gPiA+ICsgICAgICAg
UlVOVElNRSBERVNUSU5BVElPTiAke0NNQUtFX0lOU1RBTExfU0JJTkRJUn0KPiA+ID4gKykKPiA+
ID4gIGVuZGlmKCkKPiA+ID4KPiA+ID4gIElGKFVUUkFDRV9TVVBQT1JUKQo+ID4gPiBkaWZmIC0t
Z2l0IGEvamFpbC9jb25zb2xlLmMgYi9qYWlsL2NvbnNvbGUuYwo+ID4gPiBuZXcgZmlsZSBtb2Rl
IDEwMDY0NAo+ID4gPiBpbmRleCAwMDAwMDAwLi43NWNlOWM1Cj4gPiA+IC0tLSAvZGV2L251bGwK
PiA+ID4gKysrIGIvamFpbC9jb25zb2xlLmMKPiA+ID4gQEAgLTAsMCArMSwyMDkgQEAKPiA+ID4g
Ky8qCj4gPiA+ICsgKiBDb3B5cmlnaHQgKEMpIDIwMjAgRGFuaWVsIEdvbGxlIDxkYW5pZWxAbWFr
cm90b3BpYS5vcmc+Cj4gPiA+ICsgKgo+ID4gPiArICogVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29m
dHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkKPiA+ID4gKyAqIGl0
IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNl
IHZlcnNpb24gMi4xCj4gPiA+ICsgKiBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUg
Rm91bmRhdGlvbgo+ID4gPiArICoKPiA+ID4gKyAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRl
ZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAo+ID4gPiArICogYnV0IFdJVEhP
VVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKPiA+
ID4gKyAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9T
RS4gIFNlZSB0aGUKPiA+ID4gKyAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3Jl
IGRldGFpbHMuCj4gPiA+ICsgKi8KPiA+ID4gKwo+ID4gPiArI2luY2x1ZGUgPHN0ZGxpYi5oPgo+
ID4gPiArI2luY2x1ZGUgPGZjbnRsLmg+Cj4gPiA+ICsjaW5jbHVkZSA8bGlidWJveC91c3RyZWFt
Lmg+Cj4gPiA+ICsjaW5jbHVkZSA8bGlidWJ1cy5oPgo+ID4gPiArI2luY2x1ZGUgPHNpZ25hbC5o
Pgo+ID4gPiArI2luY2x1ZGUgPHN0ZGlvLmg+Cj4gPiA+ICsjaW5jbHVkZSA8c3RkbGliLmg+Cj4g
PiA+ICsjaW5jbHVkZSA8dW5pc3RkLmg+Cj4gPiA+ICsjaW5jbHVkZSA8ZmNudGwuaD4KPiA+ID4g
KyNpbmNsdWRlIDxlcnJuby5oPgo+ID4gPiArI2luY2x1ZGUgPHN5cy90eXBlcy5oPgo+ID4gPiAr
I2luY2x1ZGUgPHRlcm1pb3MuaD4KPiA+ID4gKwo+ID4gPiArc3RhdGljIGlubGluZSBpbnQgc2V0
dXBfdGlvcyhpbnQgZmQsIHN0cnVjdCB0ZXJtaW9zICpvbGR0aW9zKQo+ID4gPiArewo+ID4gPiAr
ICAgICAgIHN0cnVjdCB0ZXJtaW9zIG5ld3Rpb3M7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICBpZiAo
IWlzYXR0eShmZCkpIHsKPiA+ID4gKyAgICAgICAgICAgICAgIHJldHVybiAtMTsKPiA+ID4gKyAg
ICAgICB9Cj4gPiA+ICsKPiA+ID4gKyAgICAgICAvKiBHZXQgY3VycmVudCB0ZXJtaW9zICovCj4g
PiA+ICsgICAgICAgaWYgKHRjZ2V0YXR0cihmZCwgb2xkdGlvcykpCj4gPiA+ICsgICAgICAgICAg
ICAgICByZXR1cm4gLTE7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICBuZXd0aW9zID0gKm9sZHRpb3M7
Cj4gPiA+ICsKPiA+ID4gKyAgICAgICAvKiBSZW1vdmUgdGhlIGVjaG8gY2hhcmFjdGVycyBhbmQg
c2lnbmFsIHJlY2VwdGlvbiwgdGhlIGVjaG8KPiA+ID4gKyAgICAgICAgKiB3aWxsIGJlIGRvbmUg
d2l0aCBtYXN0ZXIgcHJveHlpbmcgKi8KPiA+ID4gKyAgICAgICBuZXd0aW9zLmNfaWZsYWcgJj0g
fklHTkJSSzsKPiA+ID4gKyAgICAgICBuZXd0aW9zLmNfaWZsYWcgJj0gQlJLSU5UOwo+ID4gPiAr
ICAgICAgIG5ld3Rpb3MuY19sZmxhZyAmPSB+KEVDSE98SUNBTk9OfElTSUcpOwo+ID4gPiArICAg
ICAgIG5ld3Rpb3MuY19jY1tWTUlOXSA9IDE7Cj4gPiA+ICsgICAgICAgbmV3dGlvcy5jX2NjW1ZU
SU1FXSA9IDA7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICAvKiBTZXQgbmV3IGF0dHJpYnV0ZXMgKi8K
PiA+ID4gKyAgICAgICBpZiAodGNzZXRhdHRyKGZkLCBUQ1NBRkxVU0gsICZuZXd0aW9zKSkKPiA+
ID4gKyAgICAgICAgICAgICAgIHJldHVybiAtMTsKPiA+ID4gKwo+ID4gPiArICAgICAgIHJldHVy
biAwOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICsKPiA+ID4gKwo+ID4gPiArI2RlZmluZSBPUFRf
QVJHUyAgICAgICAiaTpzOiIKPiA+ID4gKwo+ID4gPiArc3RhdGljIHN0cnVjdCB1c3RyZWFtX2Zk
IGN1ZmQ7Cj4gPiA+ICtzdGF0aWMgc3RydWN0IHVzdHJlYW1fZmQgbHVmZDsKPiA+ID4gKwo+ID4g
PiArc3RhdGljIHZvaWQgdXNhZ2UoKQo+ID4gPiArewo+ID4gPiArICAgICAgIGZwcmludGYoc3Rk
ZXJyLCAidWphaWwtY29uc29sZSAtcyA8c2VydmljZT4gWy1pIDxpbnN0YW5jZT5dXG4iKTsKPiA+
ID4gKyAgICAgICBleGl0KDEpOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICtzdGF0aWMgdm9pZCBj
bGllbnRfY2Ioc3RydWN0IHVzdHJlYW0gKnMsIGludCBieXRlcykKPiA+ID4gK3sKPiA+ID4gKyAg
ICAgICBjaGFyICpidWY7Cj4gPiA+ICsgICAgICAgaW50IGxlbiwgcnY7Cj4gPiA+ICsKPiA+ID4g
KyAgICAgICBkbyB7Cj4gPiA+ICsgICAgICAgICAgICAgICBidWYgPSB1c3RyZWFtX2dldF9yZWFk
X2J1ZihzLCAmbGVuKTsKPiA+ID4gKyAgICAgICAgICAgICAgIGlmICghYnVmKQo+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICBicmVhazsKPiA+ID4gKwo+ID4gPiArICAgICAgICAgICAgICAg
cnYgPSB1c3RyZWFtX3dyaXRlKCZsdWZkLnN0cmVhbSwgYnVmLCBsZW4sIGZhbHNlKTsKPiA+ID4g
Kwo+ID4gPiArICAgICAgICAgICAgICAgaWYgKHJ2ID4gMCkKPiA+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgdXN0cmVhbV9jb25zdW1lKHMsIHJ2KTsKPiA+ID4gKwo+ID4gPiArICAgICAgICAg
ICAgICAgaWYgKHJ2IDw9IGxlbikKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7
Cj4gPiA+ICsgICAgICAgfSB3aGlsZSgxKTsKPiA+ID4gK30KPiA+ID4gKwo+ID4gPiArc3RhdGlj
IHZvaWQgbG9jYWxfY2Ioc3RydWN0IHVzdHJlYW0gKnMsIGludCBieXRlcykKPiA+ID4gK3sKPiA+
ID4gKyAgICAgICBjaGFyICpidWY7Cj4gPiA+ICsgICAgICAgaW50IGxlbiwgcnY7Cj4gPiA+ICsK
PiA+ID4gKyAgICAgICBkbyB7Cj4gPiA+ICsgICAgICAgICAgICAgICBidWYgPSB1c3RyZWFtX2dl
dF9yZWFkX2J1ZihzLCAmbGVuKTsKPiA+ID4gKyAgICAgICAgICAgICAgIGlmICghYnVmKQo+ID4g
PiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiA+ID4gKwo+ID4gPiArICAgICAgICAg
ICAgICAgaWYgKChsZW4gPiAwKSAmJiAoYnVmWzBdID09IDIpKQo+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHVsb29wX2VuZCgpOwo+ID4gPiArCj4gPiA+ICsgICAgICAgICAg
ICAgICBydiA9IHVzdHJlYW1fd3JpdGUoJmN1ZmQuc3RyZWFtLCBidWYsIGxlbiwgZmFsc2UpOwo+
ID4gPiArCj4gPiA+ICsgICAgICAgICAgICAgICBpZiAocnYgPiAwKQo+ID4gPiArICAgICAgICAg
ICAgICAgICAgICAgICB1c3RyZWFtX2NvbnN1bWUocywgcnYpOwo+ID4gPiArCj4gPiA+ICsgICAg
ICAgICAgICAgICBpZiAocnYgPD0gbGVuKQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBi
cmVhazsKPiA+ID4gKyAgICAgICB9IHdoaWxlKDEpOwo+ID4gPiArfQo+ID4gPiArCj4gPiA+ICtp
bnQgbWFpbihpbnQgYXJnYywgY2hhciAqKmFyZ3YpCj4gPiA+ICt7Cj4gPiA+ICsgICAgICAgc3Ry
dWN0IHVidXNfY29udGV4dCAqY3R4Owo+ID4gPiArICAgICAgIHVpbnQzMl90IGlkOwo+ID4gPiAr
ICAgICAgIHN0YXRpYyBzdHJ1Y3QgYmxvYl9idWYgcmVxOwo+ID4gPiArICAgICAgIGNoYXIgKnNl
cnZpY2VfbmFtZSA9IE5VTEwsICppbnN0YW5jZV9uYW1lID0gTlVMTDsKPiA+ID4gKyAgICAgICBp
bnQgY2xpZW50X2ZkLCBzZXJ2ZXJfZmQsIHR0eV9mZDsKPiA+ID4gKyAgICAgICBzdHJ1Y3QgdGVy
bWlvcyBvbGR0ZXJtaW9zOwo+ID4gPiArICAgICAgIGludCBjaDsKPiA+ID4gKwo+ID4gPiArICAg
ICAgIHdoaWxlICgoY2ggPSBnZXRvcHQoYXJnYywgYXJndiwgT1BUX0FSR1MpKSAhPSAtMSkgewo+
ID4gPiArICAgICAgICAgICAgICAgc3dpdGNoIChjaCkgewo+ID4gPiArICAgICAgICAgICAgICAg
Y2FzZSAnaSc6Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlX25hbWUgPSBv
cHRhcmc7Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4gPiArICAgICAg
ICAgICAgICAgY2FzZSAncyc6Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2Vf
bmFtZSA9IG9wdGFyZzsKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gPiA+
ICsgICAgICAgICAgICAgICBkZWZhdWx0Ogo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICB1
c2FnZSgpOwo+ID4gPiArICAgICAgICAgICAgICAgfQo+ID4gPiArICAgICAgIH0KPiA+ID4gKwo+
ID4gPiArICAgICAgIGlmICghc2VydmljZV9uYW1lKQo+ID4gPiArICAgICAgICAgICAgICAgdXNh
Z2UoKTsKPiA+ID4gKwo+ID4gPiArICAgICAgIGN0eCA9IHVidXNfY29ubmVjdChOVUxMKTsKPiA+
ID4gKyAgICAgICBpZiAoIWN0eCkgewo+ID4gPiArICAgICAgICAgICAgICAgZnByaW50ZihzdGRl
cnIsICJjYW4ndCBjb25uZWN0IHRvIHVidXMhXG4iKTsKPiA+ID4gKyAgICAgICAgICAgICAgIHJl
dHVybiAtMTsKPiA+ID4gKyAgICAgICB9Cj4gPiA+ICsKPiA+ID4gKyAgICAgICAvKiBvcGVuIHBz
ZXVkby10ZXJtaW5hbCBwYWlyICovCj4gPiA+ICsgICAgICAgY2xpZW50X2ZkID0gcG9zaXhfb3Bl
bnB0KE9fUkRXUiB8IE9fTk9DVFRZKTsKPiA+ID4gKyAgICAgICBpZiAoY2xpZW50X2ZkIDwgMCkg
ewo+ID4gPiArICAgICAgICAgICAgICAgZnByaW50ZihzdGRlcnIsICJjYW4ndCBjcmVhdGUgdmly
dHVhbCBjb25zb2xlIVxuIik7Cj4gPiA+ICsgICAgICAgICAgICAgICB1YnVzX2ZyZWUoY3R4KTsK
PiA+ID4gKyAgICAgICAgICAgICAgIHJldHVybiAtMTsKPiA+ID4gKyAgICAgICB9Cj4gPiA+ICsg
ICAgICAgc2V0dXBfdGlvcyhjbGllbnRfZmQsICZvbGR0ZXJtaW9zKTsKPiA+ID4gKyAgICAgICBn
cmFudHB0KGNsaWVudF9mZCk7Cj4gPiA+ICsgICAgICAgdW5sb2NrcHQoY2xpZW50X2ZkKTsKPiA+
ID4gKyAgICAgICBzZXJ2ZXJfZmQgPSBvcGVuKHB0c25hbWUoY2xpZW50X2ZkKSwgT19SRFdSIHwg
T19OT0NUVFkpOwo+ID4gPiArICAgICAgIGlmIChzZXJ2ZXJfZmQgPCAwKSB7Cj4gPiA+ICsgICAg
ICAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImNhbid0IG9wZW4gdmlydHVhbCBjb25zb2xlIVxu
Iik7Cj4gPiA+ICsgICAgICAgICAgICAgICBjbG9zZShjbGllbnRfZmQpOwo+ID4gPiArICAgICAg
ICAgICAgICAgdWJ1c19mcmVlKGN0eCk7Cj4gPiA+ICsgICAgICAgICAgICAgICByZXR1cm4gLTE7
Cj4gPiA+ICsgICAgICAgfQo+ID4gPiArCj4gPiA+ICsgICAgICAgc2V0dXBfdGlvcyhzZXJ2ZXJf
ZmQsICZvbGR0ZXJtaW9zKTsKPiA+ID4gKyAgICAgICB0dHlfZmQgPSBvcGVuKCIvZGV2L3R0eSIs
IE9fUkRXUik7Cj4gPiA+ICsgICAgICAgc2V0dXBfdGlvcyh0dHlfZmQsICZvbGR0ZXJtaW9zKTsK
PiA+ID4gKwo+ID4gPiArICAgICAgIC8qIHJlZ2lzdGVyIHNlcnZlci1zaWRlIHdpdGggcHJvY2Qg
Ki8KPiA+ID4gKyAgICAgICBibG9iX2J1Zl9pbml0KCZyZXEsIDApOwo+ID4gPiArICAgICAgIGJs
b2Jtc2dfYWRkX3N0cmluZygmcmVxLCAibmFtZSIsIHNlcnZpY2VfbmFtZSk7Cj4gPiA+ICsgICAg
ICAgaWYgKGluc3RhbmNlX25hbWUpCj4gPiA+ICsgICAgICAgICAgICAgICBibG9ibXNnX2FkZF9z
dHJpbmcoJnJlcSwgImluc3RhbmNlIiwgaW5zdGFuY2VfbmFtZSk7Cj4gPiA+ICsKPiA+ID4gKyAg
ICAgICBpZiAodWJ1c19sb29rdXBfaWQoY3R4LCAic2VydmljZSIsICZpZCkgfHwKPiA+ID4gKyAg
ICAgICAgICAgdWJ1c19pbnZva2VfZmQoY3R4LCBpZCwgImNvbnNvbGVfYXR0YWNoIiwgcmVxLmhl
YWQsIE5VTEwsIE5VTEwsIDMwMDAsIHNlcnZlcl9mZCkpIHsKPiA+ID4gKyAgICAgICAgICAgICAg
IGZwcmludGYoc3RkZXJyLCAidWJ1cyByZXF1ZXN0IGZhaWxlZFxuIik7Cj4gPiA+ICsgICAgICAg
ICAgICAgICBjbG9zZShzZXJ2ZXJfZmQpOwo+ID4gPiArICAgICAgICAgICAgICAgY2xvc2UoY2xp
ZW50X2ZkKTsKPiA+ID4gKyAgICAgICAgICAgICAgIGJsb2JfYnVmX2ZyZWUoJnJlcSk7Cj4gPiA+
ICsgICAgICAgICAgICAgICB1YnVzX2ZyZWUoY3R4KTsKPiA+ID4gKyAgICAgICAgICAgICAgIHJl
dHVybiAtMjsKPiA+ID4gKyAgICAgICB9Cj4gPiA+ICsKPiA+ID4gKyAgICAgICBjbG9zZShzZXJ2
ZXJfZmQpOwo+ID4gPiArICAgICAgIGJsb2JfYnVmX2ZyZWUoJnJlcSk7Cj4gPiA+ICsgICAgICAg
dWJ1c19mcmVlKGN0eCk7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICB1bG9vcF9pbml0KCk7Cj4gPiA+
ICsKPiA+ID4gKyAgICAgICAvKiBmb3J3YXJkIGJldHdlZW4gc3RkaW8gYW5kIGNsaWVudF9mZCB1
bnRpbCBkZXRhY2ggaXMgcmVxdWVzdGVkICovCj4gPiA+ICsgICAgICAgbHVmZC5zdHJlYW0ubm90
aWZ5X3JlYWQgPSBsb2NhbF9jYjsKPiA+ID4gKyAgICAgICB1c3RyZWFtX2ZkX2luaXQoJmx1ZmQs
IHR0eV9mZCk7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICBjdWZkLnN0cmVhbS5ub3RpZnlfcmVhZCA9
IGNsaWVudF9jYjsKPiA+ID4gKy8qIFRvRG86IGhhbmRsZSByZW1vdGUgY2xvc2UgYW5kIG90aGVy
IGV2ZW50cyAqLwo+ID4gPiArLy8gICAgIGN1ZmQuc3RyZWFtLm5vdGlmeV9zdGF0ZSA9IGNsaWVu
dF9zdGF0ZV9jYjsKPiA+ID4gKyAgICAgICB1c3RyZWFtX2ZkX2luaXQoJmN1ZmQsIGNsaWVudF9m
ZCk7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICBmcHJpbnRmKHN0ZGVyciwgImF0dGFjaGluZyB0byBq
YWlsIGNvbnNvbGUuIHByZXNzIFtDVFJMXStbQl0gdG8gZXhpdC5cbiIpOwo+ID4gPiArICAgICAg
IGNsb3NlKDApOwo+ID4gPiArICAgICAgIGNsb3NlKDEpOwo+ID4gPiArICAgICAgIGNsb3NlKDIp
Owo+ID4gPiArICAgICAgIHVsb29wX3J1bigpOwo+ID4gPiArCj4gPiA+ICsgICAgICAgdGNzZXRh
dHRyKHR0eV9mZCwgVENTQUZMVVNILCAmb2xkdGVybWlvcyk7Cj4gPiA+ICsgICAgICAgdXN0cmVh
bV9mcmVlKCZsdWZkLnN0cmVhbSk7Cj4gPiA+ICsgICAgICAgdXN0cmVhbV9mcmVlKCZjdWZkLnN0
cmVhbSk7Cj4gPiA+ICsgICAgICAgY2xvc2UoY2xpZW50X2ZkKTsKPiA+ID4gKwo+ID4gPiArICAg
ICAgIHJldHVybiAwOwo+ID4gPiArfQo+ID4gPiBkaWZmIC0tZ2l0IGEvamFpbC9qYWlsLmMgYi9q
YWlsL2phaWwuYwo+ID4gPiBpbmRleCA4YWU0NzdjLi45MjU3MDAxIDEwMDY0NAo+ID4gPiAtLS0g
YS9qYWlsL2phaWwuYwo+ID4gPiArKysgYi9qYWlsL2phaWwuYwo+ID4gPiBAQCAtNDAsNyArNDAs
NyBAQAo+ID4gPiAgI2luY2x1ZGUgPGxpYnVidXMuaD4KPiA+ID4KPiA+ID4gICNkZWZpbmUgU1RB
Q0tfU0laRSAgICAgKDEwMjQgKiAxMDI0KQo+ID4gPiAtI2RlZmluZSBPUFRfQVJHUyAgICAgICAi
UzpDOm46aDpyOnc6ZDpwc3Vsb2NVOkc6TlI6ZkZPOlQ6RSIKPiA+ID4gKyNkZWZpbmUgT1BUX0FS
R1MgICAgICAgIlM6QzpuOmg6cjp3OmQ6cHN1bG9jVTpHOk5SOmZGTzpUOkV5Igo+ID4gPgo+ID4g
PiAgc3RhdGljIHN0cnVjdCB7Cj4gPiA+ICAgICAgICAgY2hhciAqbmFtZTsKPiA+ID4gQEAgLTU4
LDYgKzU4LDcgQEAgc3RhdGljIHN0cnVjdCB7Cj4gPiA+ICAgICAgICAgaW50IHByb2NmczsKPiA+
ID4gICAgICAgICBpbnQgcm9ubHk7Cj4gPiA+ICAgICAgICAgaW50IHN5c2ZzOwo+ID4gPiArICAg
ICAgIGludCBjb25zb2xlOwo+ID4gPiAgICAgICAgIGludCBwd191aWQ7Cj4gPiA+ICAgICAgICAg
aW50IHB3X2dpZDsKPiA+ID4gICAgICAgICBpbnQgZ3JfZ2lkOwo+ID4gPiBAQCAtNzEsNiArNzIs
OCBAQCBpbnQgZGVidWcgPSAwOwo+ID4gPgo+ID4gPiAgc3RhdGljIGNoYXIgY2hpbGRfc3RhY2tb
U1RBQ0tfU0laRV07Cj4gPiA+Cj4gPiA+ICtpbnQgY29uc29sZV9mZDsKPiA+ID4gKwo+ID4gPiAg
c3RhdGljIGludCBta2Rpcl9wKGNoYXIgKmRpciwgbW9kZV90IG1hc2spCj4gPiA+ICB7Cj4gPiA+
ICAgICAgICAgY2hhciAqbCA9IHN0cnJjaHIoZGlyLCAnLycpOwo+ID4gPiBAQCAtMTg0LDYgKzE4
Nyw3MiBAQCBvdXQ6Cj4gPiA+ICAgICAgICAgcmV0dXJuIHJldDsKPiA+ID4gIH0KPiA+ID4KPiA+
ID4gK3N0YXRpYyB2b2lkIHBhc3NfY29uc29sZShpbnQgY29uc29sZV9mZCkKPiA+ID4gK3sKPiA+
ID4gKyAgICAgICBzdHJ1Y3QgdWJ1c19jb250ZXh0ICpjdHggPSB1YnVzX2Nvbm5lY3QoTlVMTCk7
Cj4gPiA+ICsgICAgICAgc3RhdGljIHN0cnVjdCBibG9iX2J1ZiByZXE7Cj4gPiA+ICsgICAgICAg
dWludDMyX3QgaWQ7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICBpZiAoIWN0eCkKPiA+ID4gKyAgICAg
ICAgICAgICAgIHJldHVybjsKPiA+ID4gKwo+ID4gPiArICAgICAgIGJsb2JfYnVmX2luaXQoJnJl
cSwgMCk7Cj4gPiA+ICsgICAgICAgYmxvYm1zZ19hZGRfc3RyaW5nKCZyZXEsICJuYW1lIiwgb3B0
cy5uYW1lKTsKPiA+ID4gKwo+ID4gPiArICAgICAgIGlmICh1YnVzX2xvb2t1cF9pZChjdHgsICJz
ZXJ2aWNlIiwgJmlkKSB8fAo+ID4gPiArICAgICAgICAgICB1YnVzX2ludm9rZV9mZChjdHgsIGlk
LCAiY29uc29sZV9zZXQiLCByZXEuaGVhZCwgTlVMTCwgTlVMTCwgMzAwMCwgY29uc29sZV9mZCkp
Cj4gPiA+ICsgICAgICAgICAgICAgICBJTkZPKCJ1YnVzIHJlcXVlc3QgZmFpbGVkXG4iKTsKPiA+
ID4gKwo+ID4gPiArICAgICAgIGNsb3NlKGNvbnNvbGVfZmQpOwo+ID4gPiArICAgICAgIGJsb2Jf
YnVmX2ZyZWUoJnJlcSk7Cj4gPiA+ICsgICAgICAgdWJ1c19mcmVlKGN0eCk7Cj4gPiA+ICt9Cj4g
PiA+ICsKPiA+ID4gK3N0YXRpYyBpbnQgY3JlYXRlX2Rldl9jb25zb2xlKGNvbnN0IGNoYXIgKmph
aWxfcm9vdCkKPiA+ID4gK3sKPiA+ID4gKyAgICAgICBjaGFyICpjb25zb2xlX2ZuYW1lOwo+ID4g
PiArICAgICAgIGNoYXIgZGV2X2NvbnNvbGVfcGF0aFtQQVRIX01BWF07Cj4gPiA+ICsgICAgICAg
aW50IHNsYXZlX2NvbnNvbGVfZmQ7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICAvKiBPcGVuIFVOSVgv
OTggdmlydHVhbCBjb25zb2xlICovCj4gPiA+ICsgICAgICAgY29uc29sZV9mZCA9IHBvc2l4X29w
ZW5wdChPX1JEV1IgfCBPX05PQ1RUWSk7Cj4gPiA+ICsgICAgICAgaWYgKGNvbnNvbGVfZmQgPT0g
LTEpCj4gPiA+ICsgICAgICAgICAgICAgICByZXR1cm4gLTE7Cj4gPiA+ICsKPiA+ID4gKyAgICAg
ICBjb25zb2xlX2ZuYW1lID0gcHRzbmFtZShjb25zb2xlX2ZkKTsKPiA+ID4gKyAgICAgICBERUJV
RygiZ290IGNvbnNvbGUgZmQgJWQgYW5kIFBUUyBjbGllbnQgbmFtZSAlc1xuIiwgY29uc29sZV9m
ZCwgY29uc29sZV9mbmFtZSk7Cj4gPiA+ICsgICAgICAgaWYgKCFjb25zb2xlX2ZuYW1lKQo+ID4g
PiArICAgICAgICAgICAgICAgZ290byBub19jb25zb2xlOwo+ID4gPiArCj4gPiA+ICsgICAgICAg
Z3JhbnRwdChjb25zb2xlX2ZkKTsKPiA+ID4gKyAgICAgICB1bmxvY2twdChjb25zb2xlX2ZkKTsK
PiA+ID4gKwo+ID4gPiArICAgICAgIC8qIHBhc3MgUFRZIG1hc3RlciB0byBwcm9jZCAqLwo+ID4g
PiArICAgICAgIHBhc3NfY29uc29sZShjb25zb2xlX2ZkKTsKPiA+ID4gKwo+ID4gPiArICAgICAg
IC8qIG1vdW50LWJpbmQgUFRZIHNsYXZlIHRvIC9kZXYvY29uc29sZSBpbiBqYWlsICovCj4gPiA+
ICsgICAgICAgc25wcmludGYoZGV2X2NvbnNvbGVfcGF0aCwgc2l6ZW9mKGRldl9jb25zb2xlX3Bh
dGgpLCAiJXMvZGV2L2NvbnNvbGUiLCBqYWlsX3Jvb3QpOwo+ID4gPiArICAgICAgIGNsb3NlKGNy
ZWF0KGRldl9jb25zb2xlX3BhdGgsIDA2MjApKTsKPiA+ID4gKwo+ID4gPiArICAgICAgIGlmICht
b3VudChjb25zb2xlX2ZuYW1lLCBkZXZfY29uc29sZV9wYXRoLCBOVUxMLCBNU19CSU5ELCBOVUxM
KSkKPiA+ID4gKyAgICAgICAgICAgICAgIGdvdG8gbm9fY29uc29sZTsKPiA+ID4gKwo+ID4gPiAr
ICAgICAgIC8qIHVzZSBQVFkgc2xhdmUgZm9yIHN0ZGlvICovCj4gPiA+ICsgICAgICAgc2xhdmVf
Y29uc29sZV9mZCA9IG9wZW4oY29uc29sZV9mbmFtZSwgT19SRFdSIHwgT19OT0NUVFkpOwo+ID4g
PiArICAgICAgIGR1cDIoc2xhdmVfY29uc29sZV9mZCwgMCk7Cj4gPiA+ICsgICAgICAgZHVwMihz
bGF2ZV9jb25zb2xlX2ZkLCAxKTsKPiA+ID4gKyAgICAgICBkdXAyKHNsYXZlX2NvbnNvbGVfZmQs
IDIpOwo+ID4gPiArICAgICAgIGNsb3NlKHNsYXZlX2NvbnNvbGVfZmQpOwo+ID4gPiArCj4gPiA+
ICsgICAgICAgSU5GTygidXNpbmcgZ3Vlc3QgY29uc29sZSAlc1xuIiwgY29uc29sZV9mbmFtZSk7
Cj4gPiA+ICsKPiA+ID4gKyAgICAgICByZXR1cm4gMDsKPiA+ID4gKwo+ID4gPiArbm9fY29uc29s
ZToKPiA+ID4gKyAgICAgICBjbG9zZShjb25zb2xlX2ZkKTsKPiA+ID4gKyAgICAgICByZXR1cm4g
MTsKPiA+ID4gK30KPiA+ID4gKwo+ID4gPiAgc3RhdGljIGludCBidWlsZF9qYWlsX2ZzKHZvaWQp
Cj4gPiA+ICB7Cj4gPiA+ICAgICAgICAgY2hhciBqYWlsX3Jvb3RbXSA9ICIvdG1wL3VqYWlsLVhY
WFhYWCI7Cj4gPiA+IEBAIC0yNDcsNiArMzE2LDkgQEAgc3RhdGljIGludCBidWlsZF9qYWlsX2Zz
KHZvaWQpCj4gPiA+ICAgICAgICAgaWYgKG1vdW50KE5VTEwsIHRtcGRldmRpciwgInRtcGZzIiwg
TVNfTk9BVElNRSB8IE1TX05PRVhFQyB8IE1TX05PU1VJRCwgInNpemU9MU0iKSkKPiA+ID4gICAg
ICAgICAgICAgICAgIHJldHVybiAtMTsKPiA+ID4KPiA+ID4gKyAgICAgICBpZiAob3B0cy5jb25z
b2xlKQo+ID4gPiArICAgICAgICAgICAgICAgY3JlYXRlX2Rldl9jb25zb2xlKGphaWxfcm9vdCk7
Cj4gPiA+ICsKPiA+ID4gICAgICAgICBpZiAobW91bnRfYWxsKGphaWxfcm9vdCkpIHsKPiA+ID4g
ICAgICAgICAgICAgICAgIEVSUk9SKCJtb3VudF9hbGwoKSBmYWlsZWRcbiIpOwo+ID4gPiAgICAg
ICAgICAgICAgICAgcmV0dXJuIC0xOwo+ID4gPiBAQCAtNDY4LDYgKzU0MCw3IEBAIHN0YXRpYyB2
b2lkIHVzYWdlKHZvaWQpCj4gPiA+ICAgICAgICAgZnByaW50ZihzdGRlcnIsICIgIC1PIDxkaXI+
XHRkaXJlY3RvcnkgZm9yIHIvdyBvdmVybGF5ZnNcbiIpOwo+ID4gPiAgICAgICAgIGZwcmludGYo
c3RkZXJyLCAiICAtVCA8c2l6ZT5cdHVzZSB0bXBmcyByL3cgb3ZlcmxheWZzIHdpdGggPHNpemU+
XG4iKTsKPiA+ID4gICAgICAgICBmcHJpbnRmKHN0ZGVyciwgIiAgLUVcdFx0ZmFpbCBpZiBqYWls
IGNhbm5vdCBiZSBzZXR1cFxuIik7Cj4gPiA+ICsgICAgICAgZnByaW50ZihzdGRlcnIsICIgIC15
XHRcdHByb3ZpZGUgamFpbCBjb25zb2xlXG4iKTsKPiA+ID4gICAgICAgICBmcHJpbnRmKHN0ZGVy
ciwgIlxuV2FybmluZzogYnkgZGVmYXVsdCByb290IGluc2lkZSB0aGUgamFpbCBpcyB0aGUgc2Ft
ZVxuXAo+ID4gPiAgYW5kIGhlIGhhcyB0aGUgc2FtZSBwb3dlcnMgYXMgcm9vdCBvdXRzaWRlIHRo
ZSBqYWlsLFxuXAo+ID4gPiAgdGh1cyBoZSBjYW4gZXNjYXBlIHRoZSBqYWlsIGFuZC9vciBicmVh
ayBzdHVmZi5cblwKPiA+ID4gQEAgLTQ4Niw3ICs1NTksNiBAQCBzdGF0aWMgaW50IGV4ZWNfamFp
bCh2b2lkICpwaXBlc19wdHIpCj4gPiA+ICAgICAgICAgY2xvc2UocGlwZXNbMF0pOwo+ID4gPiAg
ICAgICAgIGNsb3NlKHBpcGVzWzNdKTsKPiA+ID4KPiA+ID4gLQo+ID4gPiAgICAgICAgIGJ1Zlsw
XSA9ICdpJzsKPiA+ID4gICAgICAgICBpZiAod3JpdGUocGlwZXNbMV0sIGJ1ZiwgMSkgPCAxKSB7
Cj4gPiA+ICAgICAgICAgICAgICAgICBFUlJPUigiY2FuJ3Qgd3JpdGUgdG8gcGFyZW50XG4iKTsK
PiA+ID4gQEAgLTcyMCw2ICs3OTIsOSBAQCBpbnQgbWFpbihpbnQgYXJnYywgY2hhciAqKmFyZ3Yp
Cj4gPiA+ICAgICAgICAgICAgICAgICBjYXNlICdFJzoKPiA+ID4gICAgICAgICAgICAgICAgICAg
ICAgICAgb3B0cy5yZXF1aXJlX2phaWwgPSAxOwo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAg
ICBicmVhazsKPiA+ID4gKyAgICAgICAgICAgICAgIGNhc2UgJ3knOgo+ID4gPiArICAgICAgICAg
ICAgICAgICAgICAgICBvcHRzLmNvbnNvbGUgPSAxOwo+ID4gPiArICAgICAgICAgICAgICAgICAg
ICAgICBicmVhazsKPiA+ID4gICAgICAgICAgICAgICAgIH0KPiA+ID4gICAgICAgICB9Cj4gPiA+
Cj4gPiA+IEBAIC03ODgsOSArODYzLDkgQEAgaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKiphcmd2
KQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBhZGRfbW91bnQoIi9kZXYvbnVsbCIsIDAs
IC0xKTsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgYWRkX21vdW50KCIvZGV2L3JhbmRv
bSIsIDAsIC0xKTsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgYWRkX21vdW50KCIvZGV2
L3VyYW5kb20iLCAwLCAtMSk7Cj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIGFkZF9tb3Vu
dCgiL2Rldi90dHkiLCAwLCAtMSk7Cj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGFkZF9t
b3VudCgiL2Rldi96ZXJvIiwgMCwgLTEpOwo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBh
ZGRfbW91bnQoIi9kZXYvY29uc29sZSIsIDAsIC0xKTsKPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgYWRkX21vdW50KCIvZGV2L3B0bXgiLCAwLCAtMSk7Cj4gPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgIGFkZF9tb3VudCgiL2Rldi90dHkiLCAwLCAtMSk7Cj4gPiA+Cj4gPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgIGlmICghb3B0cy5leHRyb290ICYmIChvcHRzLnVzZXIgfHwgb3B0
cy5ncm91cCkpIHsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRfbW91
bnQoIi9ldGMvcGFzc3dkIiwgMCwgLTEpOwo+ID4gPiBkaWZmIC0tZ2l0IGEvc2VydmljZS9pbnN0
YW5jZS5jIGIvc2VydmljZS9pbnN0YW5jZS5jCj4gPiA+IGluZGV4IDc1ZmQ5MWYuLjE0MjIwOGEg
MTAwNjQ0Cj4gPiA+IC0tLSBhL3NlcnZpY2UvaW5zdGFuY2UuYwo+ID4gPiArKysgYi9zZXJ2aWNl
L2luc3RhbmNlLmMKPiA+ID4gQEAgLTEwOSw2ICsxMDksNyBAQCBlbnVtIHsKPiA+ID4gICAgICAg
ICBKQUlMX0FUVFJfTkVUTlMsCj4gPiA+ICAgICAgICAgSkFJTF9BVFRSX1VTRVJOUywKPiA+ID4g
ICAgICAgICBKQUlMX0FUVFJfQ0dST1VQU05TLAo+ID4gPiArICAgICAgIEpBSUxfQVRUUl9DT05T
T0xFLAo+ID4gPiAgICAgICAgIEpBSUxfQVRUUl9SRVFVSVJFSkFJTCwKPiA+ID4gICAgICAgICBf
X0pBSUxfQVRUUl9NQVgsCj4gPiA+ICB9Owo+ID4gPiBAQCAtMTI1LDYgKzEyNiw3IEBAIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgYmxvYm1zZ19wb2xpY3kgamFpbF9hdHRyW19fSkFJTF9BVFRSX01BWF0g
PSB7Cj4gPiA+ICAgICAgICAgW0pBSUxfQVRUUl9ORVROU10gPSB7ICJuZXRucyIsIEJMT0JNU0df
VFlQRV9CT09MIH0sCj4gPiA+ICAgICAgICAgW0pBSUxfQVRUUl9VU0VSTlNdID0geyAidXNlcm5z
IiwgQkxPQk1TR19UWVBFX0JPT0wgfSwKPiA+ID4gICAgICAgICBbSkFJTF9BVFRSX0NHUk9VUFNO
U10gPSB7ICJjZ3JvdXBzbnMiLCBCTE9CTVNHX1RZUEVfQk9PTCB9LAo+ID4gPiArICAgICAgIFtK
QUlMX0FUVFJfQ09OU09MRV0gPSB7ICJjb25zb2xlIiwgQkxPQk1TR19UWVBFX0JPT0wgfSwKPiA+
ID4gICAgICAgICBbSkFJTF9BVFRSX1JFUVVJUkVKQUlMXSA9IHsgInJlcXVpcmVqYWlsIiwgQkxP
Qk1TR19UWVBFX0JPT0wgfSwKPiA+ID4gIH07Cj4gPiA+Cj4gPiA+IEBAIC0yNzQsNiArMjc2LDkg
QEAgamFpbF9ydW4oc3RydWN0IHNlcnZpY2VfaW5zdGFuY2UgKmluLCBjaGFyICoqYXJndikKPiA+
ID4gICAgICAgICBpZiAoamFpbC0+Y2dyb3Vwc25zKQo+ID4gPiAgICAgICAgICAgICAgICAgYXJn
dlthcmdjKytdID0gIi1GIjsKPiA+ID4KPiA+ID4gKyAgICAgICBpZiAoamFpbC0+Y29uc29sZSkK
PiA+ID4gKyAgICAgICAgICAgICAgIGFyZ3ZbYXJnYysrXSA9ICIteSI7Cj4gPiA+ICsKPiA+ID4g
ICAgICAgICBpZiAoaW4tPmV4dHJvb3QpIHsKPiA+ID4gICAgICAgICAgICAgICAgIGFyZ3ZbYXJn
YysrXSA9ICItUiI7Cj4gPiA+ICAgICAgICAgICAgICAgICBhcmd2W2FyZ2MrK10gPSBpbi0+ZXh0
cm9vdDsKPiA+ID4gQEAgLTQ1Myw2ICs0NTgsMTggQEAgaW5zdGFuY2VfZnJlZV9zdGRpbyhzdHJ1
Y3Qgc2VydmljZV9pbnN0YW5jZSAqaW4pCj4gPiA+ICAgICAgICAgICAgICAgICBjbG9zZShpbi0+
X3N0ZGVyci5mZC5mZCk7Cj4gPiA+ICAgICAgICAgICAgICAgICBpbi0+X3N0ZGVyci5mZC5mZCA9
IC0xOwo+ID4gPiAgICAgICAgIH0KPiA+ID4gKwo+ID4gPiArICAgICAgIGlmIChpbi0+Y29uc29s
ZS5mZC5mZCA+IC0xKSB7Cj4gPiA+ICsgICAgICAgICAgICAgICB1c3RyZWFtX2ZyZWUoJmluLT5j
b25zb2xlLnN0cmVhbSk7Cj4gPiA+ICsgICAgICAgICAgICAgICBjbG9zZShpbi0+Y29uc29sZS5m
ZC5mZCk7Cj4gPiA+ICsgICAgICAgICAgICAgICBpbi0+Y29uc29sZS5mZC5mZCA9IC0xOwo+ID4g
PiArICAgICAgIH0KPiA+ID4gKwo+ID4gPiArICAgICAgIGlmIChpbi0+Y29uc29sZV9jbGllbnQu
ZmQuZmQgPiAtMSkgewo+ID4gPiArICAgICAgICAgICAgICAgdXN0cmVhbV9mcmVlKCZpbi0+Y29u
c29sZV9jbGllbnQuc3RyZWFtKTsKPiA+ID4gKyAgICAgICAgICAgICAgIGNsb3NlKGluLT5jb25z
b2xlX2NsaWVudC5mZC5mZCk7Cj4gPiA+ICsgICAgICAgICAgICAgICBpbi0+Y29uc29sZV9jbGll
bnQuZmQuZmQgPSAtMTsKPiA+ID4gKyAgICAgICB9Cj4gPiA+ICB9Cj4gPiA+Cj4gPiA+ICB2b2lk
Cj4gPiA+IEBAIC01NzAsNiArNTg3LDQ2IEBAIGluc3RhbmNlX3N0ZG91dChzdHJ1Y3QgdXN0cmVh
bSAqcywgaW50IGJ5dGVzKQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcl9v
ZihzLCBzdHJ1Y3Qgc2VydmljZV9pbnN0YW5jZSwgX3N0ZG91dC5zdHJlYW0pKTsKPiA+ID4gIH0K
PiA+ID4KPiA+ID4gK3N0YXRpYyB2b2lkCj4gPiA+ICtpbnN0YW5jZV9jb25zb2xlKHN0cnVjdCB1
c3RyZWFtICpzLCBpbnQgYnl0ZXMpCj4gPiA+ICt7Cj4gPiA+ICsgICAgICAgc3RydWN0IHNlcnZp
Y2VfaW5zdGFuY2UgKmluID0gY29udGFpbmVyX29mKHMsIHN0cnVjdCBzZXJ2aWNlX2luc3RhbmNl
LCBjb25zb2xlLnN0cmVhbSk7Cj4gPiA+ICsgICAgICAgY2hhciAqYnVmOwo+ID4gPiArICAgICAg
IGludCBsZW47Cj4gPiA+ICsKPiA+ID4gKyAgICAgICBkbyB7Cj4gPiA+ICsgICAgICAgICAgICAg
ICBidWYgPSB1c3RyZWFtX2dldF9yZWFkX2J1ZihzLCAmbGVuKTsKPiA+ID4gKyAgICAgICAgICAg
ICAgIGlmICghYnVmKQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiA+ID4g
Kwo+ID4gPiArICAgICAgICAgICAgICAgdWxvZyhMT0dfSU5GTywgIm91dDogJXNcbiIsIGJ1Zik7
Cj4gPiA+ICsKPiA+ID4gKyAgICAgICAgICAgICAgIC8qIHRlc3QgaWYgY29uc29sZSBjbGllbnQg
aXMgYXR0YWNoZWQgKi8KPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChpbi0+Y29uc29sZV9jbGll
bnQuZmQuZmQgPiAtMSkKPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgdXN0cmVhbV93cml0
ZSgmaW4tPmNvbnNvbGVfY2xpZW50LnN0cmVhbSwgYnVmLCBsZW4sIGZhbHNlKTsKPiA+ID4gKwo+
ID4gPiArICAgICAgICAgICAgICAgdXN0cmVhbV9jb25zdW1lKHMsIGxlbik7Cj4gPiA+ICsgICAg
ICAgfSB3aGlsZSAoMSk7Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gK3N0YXRpYyB2b2lkCj4gPiA+
ICtpbnN0YW5jZV9jb25zb2xlX2NsaWVudChzdHJ1Y3QgdXN0cmVhbSAqcywgaW50IGJ5dGVzKQo+
ID4gPiArewo+ID4gPiArICAgICAgIHN0cnVjdCBzZXJ2aWNlX2luc3RhbmNlICppbiA9IGNvbnRh
aW5lcl9vZihzLCBzdHJ1Y3Qgc2VydmljZV9pbnN0YW5jZSwgY29uc29sZV9jbGllbnQuc3RyZWFt
KTsKPiA+ID4gKyAgICAgICBjaGFyICpidWY7Cj4gPiA+ICsgICAgICAgaW50IGxlbjsKPiA+ID4g
Kwo+ID4gPiArICAgICAgIGRvIHsKPiA+ID4gKyAgICAgICAgICAgICAgIGJ1ZiA9IHVzdHJlYW1f
Z2V0X3JlYWRfYnVmKHMsICZsZW4pOwo+ID4gPiArICAgICAgICAgICAgICAgaWYgKCFidWYpCj4g
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwo+ID4gPiArCj4gPiA+ICsgICAgICAg
ICAgICAgICB1bG9nKExPR19JTkZPLCAiaW46ICVzXG4iLCBidWYpOwo+ID4gPiArICAgICAgICAg
ICAgICAgdXN0cmVhbV93cml0ZSgmaW4tPmNvbnNvbGUuc3RyZWFtLCBidWYsIGxlbiwgZmFsc2Up
Owo+ID4gPiArICAgICAgICAgICAgICAgdXN0cmVhbV9jb25zdW1lKHMsIGxlbik7Cj4gPiA+ICsg
ICAgICAgfSB3aGlsZSAoMSk7Cj4gPiA+ICt9Cj4gPiA+ICsKPiA+ID4gIHN0YXRpYyB2b2lkCj4g
PiA+ICBpbnN0YW5jZV9zdGRlcnIoc3RydWN0IHVzdHJlYW0gKnMsIGludCBieXRlcykKPiA+ID4g
IHsKPiA+ID4gQEAgLTkwNSw2ICs5NjIsMTAgQEAgaW5zdGFuY2VfamFpbF9wYXJzZShzdHJ1Y3Qg
c2VydmljZV9pbnN0YW5jZSAqaW4sIHN0cnVjdCBibG9iX2F0dHIgKmF0dHIpCj4gPiA+ICAgICAg
ICAgICAgICAgICBqYWlsLT5jZ3JvdXBzbnMgPSBibG9ibXNnX2dldF9ib29sKHRiW0pBSUxfQVRU
Ul9DR1JPVVBTTlNdKTsKPiA+ID4gICAgICAgICAgICAgICAgIGphaWwtPmFyZ2MrKzsKPiA+ID4g
ICAgICAgICB9Cj4gPiA+ICsgICAgICAgaWYgKHRiW0pBSUxfQVRUUl9DT05TT0xFXSkgewo+ID4g
PiArICAgICAgICAgICAgICAgamFpbC0+Y29uc29sZSA9IGJsb2Jtc2dfZ2V0X2Jvb2wodGJbSkFJ
TF9BVFRSX0NPTlNPTEVdKTsKPiA+ID4gKyAgICAgICAgICAgICAgIGphaWwtPmFyZ2MrKzsKPiA+
ID4gKyAgICAgICB9Cj4gPiA+Cj4gPiA+ICAgICAgICAgaWYgKHRiW0pBSUxfQVRUUl9NT1VOVF0p
IHsKPiA+ID4gICAgICAgICAgICAgICAgIHN0cnVjdCBibG9iX2F0dHIgKmN1cjsKPiA+ID4gQEAg
LTEyMzIsNiArMTI5MywxNCBAQCBpbnN0YW5jZV9pbml0KHN0cnVjdCBzZXJ2aWNlX2luc3RhbmNl
ICppbiwgc3RydWN0IHNlcnZpY2UgKnMsIHN0cnVjdCBibG9iX2F0dHIgKgo+ID4gPiAgICAgICAg
IGluLT5fc3RkZXJyLnN0cmVhbS5zdHJpbmdfZGF0YSA9IHRydWU7Cj4gPiA+ICAgICAgICAgaW4t
Pl9zdGRlcnIuc3RyZWFtLm5vdGlmeV9yZWFkID0gaW5zdGFuY2Vfc3RkZXJyOwo+ID4gPgo+ID4g
PiArICAgICAgIGluLT5jb25zb2xlLmZkLmZkID0gLTI7Cj4gPiA+ICsgICAgICAgaW4tPmNvbnNv
bGUuc3RyZWFtLnN0cmluZ19kYXRhID0gdHJ1ZTsKPiA+ID4gKyAgICAgICBpbi0+Y29uc29sZS5z
dHJlYW0ubm90aWZ5X3JlYWQgPSBpbnN0YW5jZV9jb25zb2xlOwo+ID4gPiArCj4gPiA+ICsgICAg
ICAgaW4tPmNvbnNvbGVfY2xpZW50LmZkLmZkID0gLTI7Cj4gPiA+ICsgICAgICAgaW4tPmNvbnNv
bGVfY2xpZW50LnN0cmVhbS5zdHJpbmdfZGF0YSA9IHRydWU7Cj4gPiA+ICsgICAgICAgaW4tPmNv
bnNvbGVfY2xpZW50LnN0cmVhbS5ub3RpZnlfcmVhZCA9IGluc3RhbmNlX2NvbnNvbGVfY2xpZW50
Owo+ID4gPiArCj4gPiA+ICAgICAgICAgYmxvYm1zZ19saXN0X2luaXQoJmluLT5uZXRkZXYsIHN0
cnVjdCBpbnN0YW5jZV9uZXRkZXYsIG5vZGUsIGluc3RhbmNlX25ldGRldl9jbXApOwo+ID4gPiAg
ICAgICAgIGJsb2Jtc2dfbGlzdF9pbml0KCZpbi0+ZmlsZSwgc3RydWN0IGluc3RhbmNlX2ZpbGUs
IG5vZGUsIGluc3RhbmNlX2ZpbGVfY21wKTsKPiA+ID4gICAgICAgICBibG9ibXNnX2xpc3Rfc2lt
cGxlX2luaXQoJmluLT5lbnYpOwo+ID4gPiBAQCAtMTMzNSw2ICsxNDA0LDcgQEAgdm9pZCBpbnN0
YW5jZV9kdW1wKHN0cnVjdCBibG9iX2J1ZiAqYiwgc3RydWN0IHNlcnZpY2VfaW5zdGFuY2UgKmlu
LCBpbnQgdmVyYm9zZSkKPiA+ID4gICAgICAgICAgICAgICAgIGJsb2Jtc2dfYWRkX3U4KGIsICJu
ZXRucyIsIGluLT5qYWlsLm5ldG5zKTsKPiA+ID4gICAgICAgICAgICAgICAgIGJsb2Jtc2dfYWRk
X3U4KGIsICJ1c2VybnMiLCBpbi0+amFpbC51c2VybnMpOwo+ID4gPiAgICAgICAgICAgICAgICAg
YmxvYm1zZ19hZGRfdTgoYiwgImNncm91cHNucyIsIGluLT5qYWlsLmNncm91cHNucyk7Cj4gPiA+
ICsgICAgICAgICAgICAgICBibG9ibXNnX2FkZF91OChiLCAiY29uc29sZSIsIChpbi0+Y29uc29s
ZS5mZC5mZCA+IC0xKSk7Cj4gPiA+ICAgICAgICAgICAgICAgICBibG9ibXNnX2Nsb3NlX3RhYmxl
KGIsIHIpOwo+ID4gPiAgICAgICAgICAgICAgICAgaWYgKCFhdmxfaXNfZW1wdHkoJmluLT5qYWls
Lm1vdW50LmF2bCkpIHsKPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGJsb2Jt
c2dfbGlzdF9ub2RlICp2YXI7Cj4gPiA+IGRpZmYgLS1naXQgYS9zZXJ2aWNlL2luc3RhbmNlLmgg
Yi9zZXJ2aWNlL2luc3RhbmNlLmgKPiA+ID4gaW5kZXggNDNhNjU2MS4uNDQwMGNkNCAxMDA2NDQK
PiA+ID4gLS0tIGEvc2VydmljZS9pbnN0YW5jZS5oCj4gPiA+ICsrKyBiL3NlcnZpY2UvaW5zdGFu
Y2UuaAo+ID4gPiBAQCAtMzIsNiArMzIsNyBAQCBzdHJ1Y3QgamFpbCB7Cj4gPiA+ICAgICAgICAg
Ym9vbCBuZXRuczsKPiA+ID4gICAgICAgICBib29sIHVzZXJuczsKPiA+ID4gICAgICAgICBib29s
IGNncm91cHNuczsKPiA+ID4gKyAgICAgICBib29sIGNvbnNvbGU7Cj4gPiA+ICAgICAgICAgY2hh
ciAqbmFtZTsKPiA+ID4gICAgICAgICBjaGFyICpob3N0bmFtZTsKPiA+ID4gICAgICAgICBzdHJ1
Y3QgYmxvYm1zZ19saXN0IG1vdW50Owo+ID4gPiBAQCAtODIsNiArODMsOCBAQCBzdHJ1Y3Qgc2Vy
dmljZV9pbnN0YW5jZSB7Cj4gPiA+ICAgICAgICAgc3RydWN0IHVsb29wX3RpbWVvdXQgdGltZW91
dDsKPiA+ID4gICAgICAgICBzdHJ1Y3QgdXN0cmVhbV9mZCBfc3Rkb3V0Owo+ID4gPiAgICAgICAg
IHN0cnVjdCB1c3RyZWFtX2ZkIF9zdGRlcnI7Cj4gPiA+ICsgICAgICAgc3RydWN0IHVzdHJlYW1f
ZmQgY29uc29sZTsKPiA+ID4gKyAgICAgICBzdHJ1Y3QgdXN0cmVhbV9mZCBjb25zb2xlX2NsaWVu
dDsKPiA+ID4KPiA+ID4gICAgICAgICBzdHJ1Y3QgYmxvYl9hdHRyICpjb21tYW5kOwo+ID4gPiAg
ICAgICAgIHN0cnVjdCBibG9iX2F0dHIgKnRyaWdnZXI7Cj4gPiA+IGRpZmYgLS1naXQgYS9zZXJ2
aWNlL3NlcnZpY2UuYyBiL3NlcnZpY2Uvc2VydmljZS5jCj4gPiA+IGluZGV4IDc1NTE0N2MuLjFk
MjYyOTEgMTAwNjQ0Cj4gPiA+IC0tLSBhL3NlcnZpY2Uvc2VydmljZS5jCj4gPiA+ICsrKyBiL3Nl
cnZpY2Uvc2VydmljZS5jCj4gPiA+IEBAIC0yNzQsNiArMjc0LDE3IEBAIHN0YXRpYyBjb25zdCBz
dHJ1Y3QgYmxvYm1zZ19wb2xpY3kgZ2V0X2RhdGFfcG9saWN5W10gPSB7Cj4gPiA+ICAgICAgICAg
W0RBVEFfVFlQRV0gPSB7ICJ0eXBlIiwgQkxPQk1TR19UWVBFX1NUUklORyB9LAo+ID4gPiAgfTsK
PiA+ID4KPiA+ID4gK2VudW0gewo+ID4gPiArICAgICAgIFNFUlZJQ0VfQ09OU09MRV9OQU1FLAo+
ID4gPiArICAgICAgIFNFUlZJQ0VfQ09OU09MRV9JTlNUQU5DRSwKPiA+ID4gKyAgICAgICBfX1NF
UlZJQ0VfQ09OU09MRV9NQVgsCj4gPiA+ICt9Owo+ID4gPiArCj4gPiA+ICtzdGF0aWMgY29uc3Qg
c3RydWN0IGJsb2Jtc2dfcG9saWN5IHNlcnZpY2VfY29uc29sZV9wb2xpY3lbX19TRVJWSUNFX0NP
TlNPTEVfTUFYXSA9IHsKPiA+ID4gKyAgICAgICBbU0VSVklDRV9DT05TT0xFX05BTUVdID0geyAi
bmFtZSIsIEJMT0JNU0dfVFlQRV9TVFJJTkcgfSwKPiA+ID4gKyAgICAgICBbU0VSVklDRV9DT05T
T0xFX0lOU1RBTkNFXSA9IHsgImluc3RhbmNlIiwgQkxPQk1TR19UWVBFX1NUUklORyB9LAo+ID4g
PiArfTsKPiA+ID4gKwo+ID4gPiAgc3RhdGljIGludAo+ID4gPiAgc2VydmljZV9oYW5kbGVfc2V0
KHN0cnVjdCB1YnVzX2NvbnRleHQgKmN0eCwgc3RydWN0IHVidXNfb2JqZWN0ICpvYmosCj4gPiA+
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdWJ1c19yZXF1ZXN0X2RhdGEgKnJlcSwgY29uc3Qg
Y2hhciAqbWV0aG9kLAo+ID4gPiBAQCAtNjcyLDYgKzY4Myw2NCBAQCBzZXJ2aWNlX2dldF9kYXRh
KHN0cnVjdCB1YnVzX2NvbnRleHQgKmN0eCwgc3RydWN0IHVidXNfb2JqZWN0ICpvYmosCj4gPiA+
ICAgICAgICAgcmV0dXJuIDA7Cj4gPiA+ICB9Cj4gPiA+Cj4gPiA+ICtzdGF0aWMgaW50Cj4gPiA+
ICtzZXJ2aWNlX2hhbmRsZV9jb25zb2xlKHN0cnVjdCB1YnVzX2NvbnRleHQgKmN0eCwgc3RydWN0
IHVidXNfb2JqZWN0ICpvYmosCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB1
YnVzX3JlcXVlc3RfZGF0YSAqcmVxLCBjb25zdCBjaGFyICptZXRob2QsCj4gPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBibG9iX2F0dHIgKm1zZykKPiA+ID4gK3sKPiA+ID4gKyAg
ICAgICBib29sIGF0dGFjaCA9ICFzdHJjbXAobWV0aG9kLCAiY29uc29sZV9hdHRhY2giKTsKPiA+
ID4gKyAgICAgICBzdHJ1Y3QgYmxvYl9hdHRyICp0YltfX1NFUlZJQ0VfQ09OU09MRV9NQVhdOwo+
ID4gPiArICAgICAgIHN0cnVjdCBzZXJ2aWNlICpzOwo+ID4gPiArICAgICAgIHN0cnVjdCBzZXJ2
aWNlX2luc3RhbmNlICppbjsKPiA+ID4gKyAgICAgICBpbnQgY29uc29sZV9mZCA9IC0xOwo+ID4g
PiArCj4gPiA+ICsgICAgICAgY29uc29sZV9mZCA9IHVidXNfcmVxdWVzdF9nZXRfY2FsbGVyX2Zk
KHJlcSk7Cj4gPiA+ICsgICAgICAgaWYgKGNvbnNvbGVfZmQgPCAwKQo+ID4gPiArICAgICAgICAg
ICAgICAgcmV0dXJuIFVCVVNfU1RBVFVTX0lOVkFMSURfQVJHVU1FTlQ7Cj4gPiA+ICsKPiA+ID4g
KyAgICAgICBpZiAoIW1zZykKPiA+ID4gKyAgICAgICAgICAgICAgIGdvdG8gZXJyX2NvbnNvbGVf
ZmQ7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICBibG9ibXNnX3BhcnNlKHNlcnZpY2VfY29uc29sZV9w
b2xpY3ksIF9fU0VSVklDRV9DT05TT0xFX01BWCwgdGIsIGJsb2Jtc2dfZGF0YShtc2cpLCBibG9i
bXNnX2RhdGFfbGVuKG1zZykpOwo+ID4gPiArICAgICAgIGlmICghdGJbU0VSVklDRV9DT05TT0xF
X05BTUVdKQo+ID4gPiArICAgICAgICAgICAgICAgZ290byBlcnJfY29uc29sZV9mZDsKPiA+ID4g
Kwo+ID4gPiArICAgICAgIHMgPSBhdmxfZmluZF9lbGVtZW50KCZzZXJ2aWNlcywgYmxvYm1zZ19k
YXRhKHRiW1NFUlZJQ0VfQ09OU09MRV9OQU1FXSksIHMsIGF2bCk7Cj4gPiA+ICsgICAgICAgaWYg
KCFzKQo+ID4gPiArICAgICAgICAgICAgICAgZ290byBlcnJfY29uc29sZV9mZDsKPiA+ID4gKwo+
ID4gPiArICAgICAgIGlmICh0YltTRVJWSUNFX0NPTlNPTEVfSU5TVEFOQ0VdKSB7Cj4gPiA+ICsg
ICAgICAgICAgICAgICBpbiA9IHZsaXN0X2ZpbmQoJnMtPmluc3RhbmNlcywgYmxvYm1zZ19kYXRh
KHRiW1NFUlZJQ0VfQ09OU09MRV9JTlNUQU5DRV0pLCBpbiwgbm9kZSk7Cj4gPiA+ICsgICAgICAg
fSBlbHNlIHsKPiA+ID4gKyAgICAgICAgICAgICAgIC8qIHVzZSBmaXJzdCBlbGVtZW50IGluIGlu
c3RhbmNlcyBsaXN0ICovCj4gPiA+ICsgICAgICAgICAgICAgICB2bGlzdF9mb3JfZWFjaF9lbGVt
ZW50KCZzLT5pbnN0YW5jZXMsIGluLCBub2RlKQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICBicmVhazsKPiA+ID4gKyAgICAgICB9Cj4gPiA+ICsgICAgICAgaWYgKCFpbikKPiA+ID4gKyAg
ICAgICAgICAgICAgIGdvdG8gZXJyX2NvbnNvbGVfZmQ7Cj4gPiA+ICsKPiA+ID4gKyAgICAgICBp
ZiAoYXR0YWNoKSB7Cj4gPiA+ICsgICAgICAgICAgICAgICBpZiAoaW4tPmNvbnNvbGUuZmQuZmQg
PCAwKSB7Cj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlKGNvbnNvbGVfZmQpOwo+
ID4gPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVUJVU19TVEFUVVNfTk9UX1NVUFBP
UlRFRDsKPiA+ID4gKyAgICAgICAgICAgICAgIH0KPiA+ID4gKwo+ID4gPiArICAgICAgICAgICAg
ICAgLyogY2xvc2UgYW5kIHJlcGxhY2UgZXhpc3RpbmcgYXR0YWNoZWQgY29uc29sZSAqLwo+ID4g
PiArICAgICAgICAgICAgICAgaWYgKGluLT5jb25zb2xlX2NsaWVudC5mZC5mZCA+IC0xKQo+ID4g
PiArICAgICAgICAgICAgICAgICAgICAgICBjbG9zZShpbi0+Y29uc29sZV9jbGllbnQuZmQuZmQp
Owo+ID4gPiArCj4gPiA+ICsgICAgICAgICAgICAgICB1c3RyZWFtX2ZkX2luaXQoJmluLT5jb25z
b2xlX2NsaWVudCwgY29uc29sZV9mZCk7Cj4gPiA+ICsgICAgICAgfSBlbHNlIHsKPiA+ID4gKyAg
ICAgICAgICAgICAgIHVzdHJlYW1fZmRfaW5pdCgmaW4tPmNvbnNvbGUsIGNvbnNvbGVfZmQpOwo+
ID4gPiArICAgICAgIH0KPiA+ID4gKwo+ID4gPiArICAgICAgIHJldHVybiBVQlVTX1NUQVRVU19P
SzsKPiA+ID4gK2Vycl9jb25zb2xlX2ZkOgo+ID4gPiArICAgICAgIGNsb3NlKGNvbnNvbGVfZmQp
Owo+ID4gPiArICAgICAgIHJldHVybiBVQlVTX1NUQVRVU19JTlZBTElEX0FSR1VNRU5UOwo+ID4g
PiArfQo+ID4gPiArCj4gPiA+ICsKPiA+ID4gIHN0YXRpYyBzdHJ1Y3QgdWJ1c19tZXRob2QgbWFp
bl9vYmplY3RfbWV0aG9kc1tdID0gewo+ID4gPiAgICAgICAgIFVCVVNfTUVUSE9EKCJzZXQiLCBz
ZXJ2aWNlX2hhbmRsZV9zZXQsIHNlcnZpY2Vfc2V0X2F0dHJzKSwKPiA+ID4gICAgICAgICBVQlVT
X01FVEhPRCgiYWRkIiwgc2VydmljZV9oYW5kbGVfc2V0LCBzZXJ2aWNlX3NldF9hdHRycyksCj4g
PiA+IEBAIC02ODQsNiArNzUzLDggQEAgc3RhdGljIHN0cnVjdCB1YnVzX21ldGhvZCBtYWluX29i
amVjdF9tZXRob2RzW10gPSB7Cj4gPiA+ICAgICAgICAgVUJVU19NRVRIT0QoInZhbGlkYXRlIiwg
c2VydmljZV9oYW5kbGVfdmFsaWRhdGUsIHZhbGlkYXRlX3BvbGljeSksCj4gPiA+ICAgICAgICAg
VUJVU19NRVRIT0QoImdldF9kYXRhIiwgc2VydmljZV9nZXRfZGF0YSwgZ2V0X2RhdGFfcG9saWN5
KSwKPiA+ID4gICAgICAgICBVQlVTX01FVEhPRCgic3RhdGUiLCBzZXJ2aWNlX2hhbmRsZV9zdGF0
ZSwgc2VydmljZV9zdGF0ZV9hdHRycyksCj4gPiA+ICsgICAgICAgVUJVU19NRVRIT0QoImNvbnNv
bGVfc2V0Iiwgc2VydmljZV9oYW5kbGVfY29uc29sZSwgc2VydmljZV9jb25zb2xlX3BvbGljeSks
Cj4gPiA+ICsgICAgICAgVUJVU19NRVRIT0QoImNvbnNvbGVfYXR0YWNoIiwgc2VydmljZV9oYW5k
bGVfY29uc29sZSwgc2VydmljZV9jb25zb2xlX3BvbGljeSksCj4gPiA+ICB9Owo+ID4gPgo+ID4g
PiAgc3RhdGljIHN0cnVjdCB1YnVzX29iamVjdF90eXBlIG1haW5fb2JqZWN0X3R5cGUgPQo+ID4g
PiAtLQo+ID4gPiAyLjI2LjIKPiA+ID4KPiA+ID4KPiA+ID4gX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KPiA+ID4gb3BlbndydC1kZXZlbCBtYWlsaW5nIGxp
c3QKPiA+ID4gb3BlbndydC1kZXZlbEBsaXN0cy5vcGVud3J0Lm9yZwo+ID4gPiBodHRwczovL2xp
c3RzLm9wZW53cnQub3JnL21haWxtYW4vbGlzdGluZm8vb3BlbndydC1kZXZlbAo+ID4KPiA+IF9f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCj4gPiBvcGVud3J0
LWRldmVsIG1haWxpbmcgbGlzdAo+ID4gb3BlbndydC1kZXZlbEBsaXN0cy5vcGVud3J0Lm9yZwo+
ID4gaHR0cHM6Ly9saXN0cy5vcGVud3J0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL29wZW53cnQtZGV2
ZWwKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCm9wZW53
cnQtZGV2ZWwgbWFpbGluZyBsaXN0Cm9wZW53cnQtZGV2ZWxAbGlzdHMub3BlbndydC5vcmcKaHR0
cHM6Ly9saXN0cy5vcGVud3J0Lm9yZy9tYWlsbWFuL2xpc3RpbmZvL29wZW53cnQtZGV2ZWwK
