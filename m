Return-Path: <openwrt-devel-bounces+lists+openwrt-devel=lfdr.de@lists.openwrt.org>
X-Original-To: lists+openwrt-devel@lfdr.de
Delivered-To: lists+openwrt-devel@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 7FB651E9A7C
	for <lists+openwrt-devel@lfdr.de>; Sun, 31 May 2020 23:18:20 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:
	Content-Transfer-Encoding:Content-Type:List-Subscribe:List-Help:List-Post:
	List-Archive:List-Unsubscribe:List-Id:Subject:Message-Id:In-Reply-To:To:
	References:Date:Mime-Version:From:Reply-To:Cc:Content-ID:Content-Description:
	Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:
	List-Owner; bh=9aJAHTI9Y5j3RVPlxi1VrknJxszmU7f1yWv0yvUEUvo=; b=p61ycPJrMew5yF
	ZLduBG4VKNLsX6SKcejbfCgQC9tmX/vsqiSZlgPPfgTbA3Pfq2Kpx9yYNciXkeb4beaNZJxB1QSi2
	VCIRlBFdgEFoAqcMIS2q00q2qt7R6usGbFViWN51uKqgAHG+iMJCqioFpq77YSNJI1QvCfO1+RZvO
	Aly9LP2vXWfwy/L3YXuQCc3ryNChAnqTLPWMaSKmS7m6vNCEoEaRi1bxhZwASF/WOAfBmdhLJpHON
	BM4bWsMd5jzf5myhwFJLhw/iMrS4rgqLoosJZNcDVCtjK8Q7Q3knPDslMQ+BbAMa1VuOJfEtDN69t
	2E6ViANxBaA4StOHemKQ==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92.3 #3 (Red Hat Linux))
	id 1jfVLU-0005Fe-90; Sun, 31 May 2020 21:18:16 +0000
Received: from mail.redfish-solutions.com ([45.33.216.244])
 by bombadil.infradead.org with esmtps (Exim 4.92.3 #3 (Red Hat Linux))
 id 1jfVLN-0005EY-7S
 for openwrt-devel@lists.openwrt.org; Sun, 31 May 2020 21:18:11 +0000
Received: from macmini.redfish-solutions.com (macmini.redfish-solutions.com
 [192.168.1.38]) (authenticated bits=0)
 by mail.redfish-solutions.com (8.15.2/8.15.2) with ESMTPSA id 04VLI0ak019246
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT)
 for <openwrt-devel@lists.openwrt.org>; Sun, 31 May 2020 15:18:00 -0600
From: Philip Prindeville <philipp_subx@redfish-solutions.com>
Mime-Version: 1.0 (Mac OS X Mail 13.4 \(3608.80.23.2.2\))
Date: Sun, 31 May 2020 15:17:59 -0600
References: <20200527195959.615-1-philipp@redfish-solutions.com>
To: openwrt-devel <openwrt-devel@lists.openwrt.org>
In-Reply-To: <20200527195959.615-1-philipp@redfish-solutions.com>
Message-Id: <6B229AF6-2832-438D-BEB7-7BD32CEDFAB4@redfish-solutions.com>
X-Mailer: Apple Mail (2.3608.80.23.2.2)
X-Scanned-By: MIMEDefang 2.84 on 192.168.1.3
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20200531_141809_454122_7BA78DBA 
X-CRM114-Status: GOOD (  20.93  )
X-Spam-Score: 0.0 (/)
X-Spam-Report: SpamAssassin version 3.4.4 on bombadil.infradead.org summary:
 Content analysis details:   (0.0 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -0.0 SPF_PASS               SPF: sender matches SPF record
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
Subject: Re: [OpenWrt-Devel] [PATCH v2 1/1] firewall3: harden string
 functions that might overflow
X-BeenThere: openwrt-devel@lists.openwrt.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <openwrt-devel.lists.openwrt.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/openwrt-devel>, 
 <mailto:openwrt-devel-request@lists.openwrt.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/openwrt-devel/>
List-Post: <mailto:openwrt-devel@lists.openwrt.org>
List-Help: <mailto:openwrt-devel-request@lists.openwrt.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/openwrt-devel>,
 <mailto:openwrt-devel-request@lists.openwrt.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: "openwrt-devel" <openwrt-devel-bounces@lists.openwrt.org>
Errors-To: openwrt-devel-bounces+lists+openwrt-devel=lfdr.de@lists.openwrt.org

Rm9yIHRob3NlIGNvbmNlcm5lZCBhYm91dCBibG9hdCwgZXRjLiBvbiB4ODZfNjQvTVVTTCwgYWxs
IG9mIHRoZSBjaGFuZ2VzIGFkZCBhYm91dCA1MDAgYnl0ZXMgZXh0cmEgdG8gdGhlIHNpemUgb2Yg
ZmlyZXdhbGzigJlzIGV4ZWN1dGFibGUuCgoKCj4gT24gTWF5IDI3LCAyMDIwLCBhdCAxOjU5IFBN
LCBQaGlsaXAgUHJpbmRldmlsbGUgPHBoaWxpcHBAcmVkZmlzaC1zb2x1dGlvbnMuY29tPiB3cm90
ZToKPiAKPiBGcm9tOiBQaGlsaXAgUHJpbmRldmlsbGUgPHBoaWxpcHBAcmVkZmlzaC1zb2x1dGlv
bnMuY29tPgo+IAo+IE1ha2Ugc3VyZSBubyBidWZmZXIgb3ZlcnJ1bnMgcHJlc2VudCBhIHZ1bG5l
cmFiaWxpdHkgaW4gdGhlIGZpcmV3YWxsLgo+IAo+IEdldCByaWQgb2YgdW5zYWZlIHN0cmluZyBm
dW5jdGlvbnM6IHN0cmNweSwgc3RybmNweSwgc3RyY2F0LCBzdHJuY2F0LAo+IHNwcmludGYsIGV0
Yy4gIERvaW5nIHBvaW50ZXIgYXJpdGhlbWV0aWMgd2l0aCB0aGUgcmV0dXJuIHZhbHVlIG9mCj4g
c3ByaW50ZigpIGlzIGluaGVyZW50bHkgdW5zb3VuZC4gIFBlciB0aGUgc3ByaW50ZigpIG1hbiBw
YWdlOgo+IAo+ICAgIFRoZSBmdW5jdGlvbnMgc25wcmludGYoKSBhbmQgdnNucHJpbnRmKCkgZG8g
bm90IHdyaXRlICBtb3JlICB0aGFuICBzaXplCj4gICAgYnl0ZXMgIChpbmNsdWRpbmcgdGhlIHRl
cm1pbmF0aW5nIG51bGwgYnl0ZSAoJ1wwJykpLiAgSWYgdGhlIG91dHB1dCB3YXMKPiAgICB0cnVu
Y2F0ZWQgZHVlIHRvIHRoaXMgbGltaXQsIHRoZW4gdGhlIHJldHVybiB2YWx1ZSAgaXMgIHRoZSAg
bnVtYmVyICBvZgo+ICAgIGNoYXJhY3RlcnMgIChleGNsdWRpbmcgdGhlIHRlcm1pbmF0aW5nIG51
bGwgYnl0ZSkgd2hpY2ggd291bGQgaGF2ZSBiZWVuCj4gICAgd3JpdHRlbiB0byB0aGUgZmluYWwg
c3RyaW5nIGlmIGVub3VnaCBzcGFjZSBoYWQgYmVlbiBhdmFpbGFibGUuICAgVGh1cywKPiAgICBh
ICByZXR1cm4gIHZhbHVlICBvZiAgc2l6ZSBvciBtb3JlIG1lYW5zIHRoYXQgdGhlIG91dHB1dCB3
YXMgdHJ1bmNhdGVkLgo+IAo+IFRodXMgdGhlIGNvbnN0cnVjdDoKPiAKPiAgIHAgKz0gc3ByaW50
ZihwLCAuLi4pOwo+IAo+IGlzIHVuc2FmZSBhcyB0aGUgcmV0dXJuIHZhbHVlIGNvdWxkIHB1dCB5
b3Ugd2VsbCBiZXlvbmQgdGhlIGVuZCBvZgo+IHdoYXRldmVyIGJ1ZmZlciBwIHBvaW50cyB0by4K
PiAKPiBTaWduZWQtb2ZmLWJ5OiBQaGlsaXAgUHJpbmRldmlsbGUgPHBoaWxpcHBAcmVkZmlzaC1z
b2x1dGlvbnMuY29tPgo+IC0tLQo+IGRlZmF1bHRzLmMgICB8ICAyICstCj4gaXB0YWJsZXMuYyAg
IHwgNjUgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQo+IG9wdGlvbnMuYyAgICB8IDI0ICsrKysrKysrKysrLS0tLS0tLS0KPiByZWRpcmVjdHMuYyAg
fCAxNiArKysrKysrKy0tLS0tCj4gcnVsZXMuYyAgICAgIHwgIDQgKystLQo+IHNuYXRzLmMgICAg
ICB8IDE2ICsrKysrKysrLS0tLS0KPiB1dGlscy5jICAgICAgfCAxNyArKysrKysrLS0tLS0tLQo+
IHV0aWxzLmggICAgICB8ICA2ICsrKysrCj4geHRhYmxlcy0xMC5oIHwgIDggKysrLS0tLQo+IHh0
YWJsZXMtNS5oICB8ICA0ICsrLS0KPiAxMCBmaWxlcyBjaGFuZ2VkLCA5NSBpbnNlcnRpb25zKCsp
LCA2NyBkZWxldGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvZGVmYXVsdHMuYyBiL2RlZmF1bHRz
LmMKPiBpbmRleCA2MGE0YzgxZjc3M2JmOTUyNzQwN2FjNjFiMDczMWU5NDBmOWM1NDYzLi5iZDY5
ZTZiMmY3NjUwNTg3NTVkYWFiYjNkZGU4Zjg5ZjE5MjM4NjIyIDEwMDY0NAo+IC0tLSBhL2RlZmF1
bHRzLmMKPiArKysgYi9kZWZhdWx0cy5jCj4gQEAgLTIzNiw3ICsyMzYsNyBAQCBmdzNfcHJpbnRf
ZGVmYXVsdF9oZWFkX3J1bGVzKHN0cnVjdCBmdzNfaXB0X2hhbmRsZSAqaGFuZGxlLAo+IAl7Cj4g
CWNhc2UgRlczX1RBQkxFX0ZJTFRFUjoKPiAKPiAtCQlzcHJpbnRmKGxvZGV2Lm5hbWUsICJsbyIp
Owo+ICsJCXN0cmxjcHkobG9kZXYubmFtZSwgImxvIiwgc2l6ZW9mKGxvZGV2Lm5hbWUpKTsKPiAK
PiAJCXIgPSBmdzNfaXB0X3J1bGVfY3JlYXRlKGhhbmRsZSwgTlVMTCwgJmxvZGV2LCBOVUxMLCBO
VUxMLCBOVUxMKTsKPiAJCWZ3M19pcHRfcnVsZV90YXJnZXQociwgIkFDQ0VQVCIpOwo+IGRpZmYg
LS1naXQgYS9pcHRhYmxlcy5jIGIvaXB0YWJsZXMuYwo+IGluZGV4IDU1OWZlN2RlZmVmM2JlODVj
NGViMjkzNDg4NGNhZjU0OWY5MzJiYzUuLmRjZjhlMjNmYmQ5ODQ1ZTZiZTRhOGJjMDcyZjcwZDky
MzhlYmFiNTEgMTAwNjQ0Cj4gLS0tIGEvaXB0YWJsZXMuYwo+ICsrKyBiL2lwdGFibGVzLmMKPiBA
QCAtMTQ0LDcgKzE0NCw3IEBAIGdldF9rZXJuZWxfdmVyc2lvbih2b2lkKQo+IAlpbnQgeCA9IDAs
IHkgPSAwLCB6ID0gMDsKPiAKPiAJaWYgKHVuYW1lKCZ1dHMpID09IC0xKQo+IC0JCXNwcmludGYo
dXRzLnJlbGVhc2UsICIzLjAuMCIpOwo+ICsJCXN0cmxjcHkodXRzLnJlbGVhc2UsICIzLjAuMCIs
IHNpemVvZih1dHMucmVsZWFzZSkpOwo+IAo+IAlzc2NhbmYodXRzLnJlbGVhc2UsICIlZC4lZC4l
ZCIsICZ4LCAmeSwgJnopOwo+IAlrZXJuZWxfdmVyc2lvbiA9IDB4MTAwMDAgKiB4ICsgMHgxMDAg
KiB5ICsgejsKPiBAQCAtOTA2LDcgKzkwNiw3IEBAIGZ3M19pcHRfcnVsZV9zcG9ydF9kcG9ydChz
dHJ1Y3QgZnczX2lwdF9ydWxlICpyLAo+IAlpZiAoc3AgJiYgc3AtPnNldCkKPiAJewo+IAkJaWYg
KHNwLT5wb3J0X21pbiA9PSBzcC0+cG9ydF9tYXgpCj4gLQkJCXNwcmludGYoYnVmLCAiJXUiLCBz
cC0+cG9ydF9taW4pOwo+ICsJCQlzbnByaW50ZihidWYsIHNpemVvZihidWYpLCAiJXUiLCBzcC0+
cG9ydF9taW4pOwo+IAkJZWxzZQo+IAkJCXNucHJpbnRmKGJ1Ziwgc2l6ZW9mKGJ1ZiksICIldTol
dSIsIHNwLT5wb3J0X21pbiwgc3AtPnBvcnRfbWF4KTsKPiAKPiBAQCAtOTE2LDcgKzkxNiw3IEBA
IGZ3M19pcHRfcnVsZV9zcG9ydF9kcG9ydChzdHJ1Y3QgZnczX2lwdF9ydWxlICpyLAo+IAlpZiAo
ZHAgJiYgZHAtPnNldCkKPiAJewo+IAkJaWYgKGRwLT5wb3J0X21pbiA9PSBkcC0+cG9ydF9tYXgp
Cj4gLQkJCXNwcmludGYoYnVmLCAiJXUiLCBkcC0+cG9ydF9taW4pOwo+ICsJCQlzbnByaW50Zihi
dWYsIHNpemVvZihidWYpLCAiJXUiLCBkcC0+cG9ydF9taW4pOwo+IAkJZWxzZQo+IAkJCXNucHJp
bnRmKGJ1Ziwgc2l6ZW9mKGJ1ZiksICIldToldSIsIGRwLT5wb3J0X21pbiwgZHAtPnBvcnRfbWF4
KTsKPiAKPiBAQCAtOTI5LDcgKzkyOSw4IEBAIGZ3M19pcHRfcnVsZV9kZXZpY2Uoc3RydWN0IGZ3
M19pcHRfcnVsZSAqciwgY29uc3QgY2hhciAqZGV2aWNlLCBib29sIG91dCkKPiB7Cj4gCWlmIChk
ZXZpY2UpIHsKPiAJCXN0cnVjdCBmdzNfZGV2aWNlIGRldiA9IHsgLmFueSA9IGZhbHNlIH07Cj4g
LQkJc3RybmNweShkZXYubmFtZSwgZGV2aWNlLCBzaXplb2YoZGV2Lm5hbWUpIC0gMSk7Cj4gKwo+
ICsJCXN0cmxjcHkoZGV2Lm5hbWUsIGRldmljZSwgc2l6ZW9mKGRldi5uYW1lKSk7Cj4gCQlmdzNf
aXB0X3J1bGVfaW5fb3V0KHIsIChvdXQpID8gTlVMTCA6ICZkZXYsIChvdXQpID8gJmRldiA6IE5V
TEwpOwo+IAl9Cj4gfQo+IEBAIC05NDMsNyArOTQ0LDcgQEAgZnczX2lwdF9ydWxlX21hYyhzdHJ1
Y3QgZnczX2lwdF9ydWxlICpyLCBzdHJ1Y3QgZnczX21hYyAqbWFjKQo+IAlpZiAoIW1hYykKPiAJ
CXJldHVybjsKPiAKPiAtCXNwcmludGYoYnVmLCAiJTAyeDolMDJ4OiUwMng6JTAyeDolMDJ4OiUw
MngiLAo+ICsJc25wcmludGYoYnVmLCBzaXplb2YoYnVmKSwgIiUwMng6JTAyeDolMDJ4OiUwMng6
JTAyeDolMDJ4IiwKPiAJICAgICAgICBhZGRyWzBdLCBhZGRyWzFdLCBhZGRyWzJdLCBhZGRyWzNd
LCBhZGRyWzRdLCBhZGRyWzVdKTsKPiAKPiAJZnczX2lwdF9ydWxlX2FkZGFyZyhyLCBmYWxzZSwg
Ii1tIiwgIm1hYyIpOwo+IEBAIC05NjIsNyArOTYzLDcgQEAgZnczX2lwdF9ydWxlX2ljbXB0eXBl
KHN0cnVjdCBmdzNfaXB0X3J1bGUgKnIsIHN0cnVjdCBmdzNfaWNtcHR5cGUgKmljbXApCj4gCWlm
IChyLT5oLT5mYW1pbHkgPT0gRlczX0ZBTUlMWV9WNikKPiAJewo+IAkJaWYgKGljbXAtPmNvZGU2
X21pbiA9PSAwICYmIGljbXAtPmNvZGU2X21heCA9PSAweEZGKQo+IC0JCQlzcHJpbnRmKGJ1Ziwg
IiV1IiwgaWNtcC0+dHlwZTYpOwo+ICsJCQlzbnByaW50ZihidWYsIHNpemVvZihidWYpLCAiJXUi
LCBpY21wLT50eXBlNik7Cj4gCQllbHNlCj4gCQkJc25wcmludGYoYnVmLCBzaXplb2YoYnVmKSwg
IiV1LyV1IiwgaWNtcC0+dHlwZTYsIGljbXAtPmNvZGU2X21pbik7Cj4gCj4gQEAgLTk3Miw3ICs5
NzMsNyBAQCBmdzNfaXB0X3J1bGVfaWNtcHR5cGUoc3RydWN0IGZ3M19pcHRfcnVsZSAqciwgc3Ry
dWN0IGZ3M19pY21wdHlwZSAqaWNtcCkKPiAjZW5kaWYKPiAJewo+IAkJaWYgKGljbXAtPmNvZGVf
bWluID09IDAgJiYgaWNtcC0+Y29kZV9tYXggPT0gMHhGRikKPiAtCQkJc3ByaW50ZihidWYsICIl
dSIsIGljbXAtPnR5cGUpOwo+ICsJCQlzbnByaW50ZihidWYsIHNpemVvZihidWYpLCAiJXUiLCBp
Y21wLT50eXBlKTsKPiAJCWVsc2UKPiAJCQlzbnByaW50ZihidWYsIHNpemVvZihidWYpLCAiJXUv
JXUiLCBpY21wLT50eXBlLCBpY21wLT5jb2RlX21pbik7Cj4gCj4gQEAgLTk5MCwxMiArOTkxLDEy
IEBAIGZ3M19pcHRfcnVsZV9saW1pdChzdHJ1Y3QgZnczX2lwdF9ydWxlICpyLCBzdHJ1Y3QgZncz
X2xpbWl0ICpsaW1pdCkKPiAKPiAJZnczX2lwdF9ydWxlX2FkZGFyZyhyLCBmYWxzZSwgIi1tIiwg
ImxpbWl0Iik7Cj4gCj4gLQlzcHJpbnRmKGJ1ZiwgIiV1LyVzIiwgbGltaXQtPnJhdGUsIGZ3M19s
aW1pdF91bml0c1tsaW1pdC0+dW5pdF0pOwo+ICsJc25wcmludGYoYnVmLCBzaXplb2YoYnVmKSwg
IiV1LyVzIiwgbGltaXQtPnJhdGUsIGZ3M19saW1pdF91bml0c1tsaW1pdC0+dW5pdF0pOwo+IAlm
dzNfaXB0X3J1bGVfYWRkYXJnKHIsIGxpbWl0LT5pbnZlcnQsICItLWxpbWl0IiwgYnVmKTsKPiAK
PiAJaWYgKGxpbWl0LT5idXJzdCA+IDApCj4gCXsKPiAtCQlzcHJpbnRmKGJ1ZiwgIiV1IiwgbGlt
aXQtPmJ1cnN0KTsKPiArCQlzbnByaW50ZihidWYsIHNpemVvZihidWYpLCAiJXUiLCBsaW1pdC0+
YnVyc3QpOwo+IAkJZnczX2lwdF9ydWxlX2FkZGFyZyhyLCBsaW1pdC0+aW52ZXJ0LCAiLS1saW1p
dC1idXJzdCIsIGJ1Zik7Cj4gCX0KPiB9Cj4gQEAgLTEwMDQsOCArMTAwNSw4IEBAIHZvaWQKPiBm
dzNfaXB0X3J1bGVfaXBzZXQoc3RydWN0IGZ3M19pcHRfcnVsZSAqciwgc3RydWN0IGZ3M19zZXRt
YXRjaCAqbWF0Y2gpCj4gewo+IAljaGFyIGJ1ZltzaXplb2YoImRzdCxkc3QsZHN0XDAiKV07Cj4g
LQljaGFyICpwID0gYnVmOwo+IAlpbnQgaSA9IDA7Cj4gKwlGSUxFICpmcCA9IE5VTEw7Cj4gCj4g
CXN0cnVjdCBmdzNfaXBzZXQgKnNldDsKPiAJc3RydWN0IGZ3M19pcHNldF9kYXRhdHlwZSAqdHlw
ZTsKPiBAQCAtMTAxMywxOCArMTAxNCwyMSBAQCBmdzNfaXB0X3J1bGVfaXBzZXQoc3RydWN0IGZ3
M19pcHRfcnVsZSAqciwgc3RydWN0IGZ3M19zZXRtYXRjaCAqbWF0Y2gpCj4gCWlmICghbWF0Y2gg
fHwgIW1hdGNoLT5zZXQgfHwgIW1hdGNoLT5wdHIpCj4gCQlyZXR1cm47Cj4gCj4gKwlmcCA9IGZt
ZW1vcGVuKGJ1Ziwgc2l6ZW9mKGJ1ZiksICJ3Iik7Cj4gCXNldCA9IG1hdGNoLT5wdHI7Cj4gCWxp
c3RfZm9yX2VhY2hfZW50cnkodHlwZSwgJnNldC0+ZGF0YXR5cGVzLCBsaXN0KQo+IAl7Cj4gCQlp
ZiAoaSA+PSAzKQo+IAkJCWJyZWFrOwo+IAo+IC0JCWlmIChwID4gYnVmKQo+IC0JCQkqcCsrID0g
JywnOwo+ICsJCWlmIChmdGVsbChmcCkgIT0gMCkKPiArCQkJZnB1dGMoJywnLCBmcCk7Cj4gKwo+
ICsJCWZwdXRzKG1hdGNoLT5kaXJbaV0gPyBtYXRjaC0+ZGlyW2ldIDogdHlwZS0+ZGlyLCBmcCk7
Cj4gCj4gLQkJcCArPSBzcHJpbnRmKHAsICIlcyIsIG1hdGNoLT5kaXJbaV0gPyBtYXRjaC0+ZGly
W2ldIDogdHlwZS0+ZGlyKTsKPiAJCWkrKzsKPiAJfQo+ICsJZmNsb3NlKGZwKTsKPiAKPiAJZncz
X2lwdF9ydWxlX2FkZGFyZyhyLCBmYWxzZSwgIi1tIiwgInNldCIpOwo+IAo+IEBAIC0xMDUxLDcg
KzEwNTUsNiBAQCBmdzNfaXB0X3J1bGVfdGltZShzdHJ1Y3QgZnczX2lwdF9ydWxlICpyLCBzdHJ1
Y3QgZnczX3RpbWUgKnRpbWUpCj4gCXN0cnVjdCB0bSBlbXB0eSA9IHsgMCB9Owo+IAo+IAljaGFy
IGJ1Zls4NF07IC8qIHNpemVvZigiMSwyLDMsLi4uLDMwLDMxXDAiKSAqLwo+IC0JY2hhciAqcDsK
PiAKPiAJYm9vbCBkMSA9IG1lbWNtcCgmdGltZS0+ZGF0ZXN0YXJ0LCAmZW1wdHksIHNpemVvZihl
bXB0eSkpOwo+IAlib29sIGQyID0gbWVtY21wKCZ0aW1lLT5kYXRlc3RvcCwgJmVtcHR5LCBzaXpl
b2YoZW1wdHkpKTsKPiBAQCAtMTA4MSw3ICsxMDg0LDcgQEAgZnczX2lwdF9ydWxlX3RpbWUoc3Ry
dWN0IGZ3M19pcHRfcnVsZSAqciwgc3RydWN0IGZ3M190aW1lICp0aW1lKQo+IAo+IAlpZiAodGlt
ZS0+dGltZXN0YXJ0KQo+IAl7Cj4gLQkJc3ByaW50ZihidWYsICIlMDJkOiUwMmQ6JTAyZCIsCj4g
KwkJc25wcmludGYoYnVmLCBzaXplb2YoYnVmKSwgIiUwMmQ6JTAyZDolMDJkIiwKPiAJCSAgICAg
ICAgdGltZS0+dGltZXN0YXJ0IC8gMzYwMCwKPiAJCSAgICAgICAgdGltZS0+dGltZXN0YXJ0ICUg
MzYwMCAvIDYwLAo+IAkJICAgICAgICB0aW1lLT50aW1lc3RhcnQgJSA2MCk7Cj4gQEAgLTEwOTEs
NyArMTA5NCw3IEBAIGZ3M19pcHRfcnVsZV90aW1lKHN0cnVjdCBmdzNfaXB0X3J1bGUgKnIsIHN0
cnVjdCBmdzNfdGltZSAqdGltZSkKPiAKPiAJaWYgKHRpbWUtPnRpbWVzdG9wKQo+IAl7Cj4gLQkJ
c3ByaW50ZihidWYsICIlMDJkOiUwMmQ6JTAyZCIsCj4gKwkJc25wcmludGYoYnVmLCBzaXplb2Yo
YnVmKSwgIiUwMmQ6JTAyZDolMDJkIiwKPiAJCSAgICAgICAgdGltZS0+dGltZXN0b3AgLyAzNjAw
LAo+IAkJICAgICAgICB0aW1lLT50aW1lc3RvcCAlIDM2MDAgLyA2MCwKPiAJCSAgICAgICAgdGlt
ZS0+dGltZXN0b3AgJSA2MCk7Cj4gQEAgLTExMDEsMzMgKzExMDQsNDEgQEAgZnczX2lwdF9ydWxl
X3RpbWUoc3RydWN0IGZ3M19pcHRfcnVsZSAqciwgc3RydWN0IGZ3M190aW1lICp0aW1lKQo+IAo+
IAlpZiAodGltZS0+bW9udGhkYXlzICYgMHhGRkZGRkZGRSkKPiAJewo+IC0JCWZvciAoaSA9IDEs
IHAgPSBidWY7IGkgPCAzMjsgaSsrKQo+ICsJCUZJTEUgKmZwID0gZm1lbW9wZW4oYnVmLCBzaXpl
b2YoYnVmKSwgInciKTsKPiArCj4gKwkJZm9yIChpID0gMTsgaSA8IDMyOyBpKyspCj4gCQl7Cj4g
CQkJaWYgKGZ3M19oYXNiaXQodGltZS0+bW9udGhkYXlzLCBpKSkKPiAJCQl7Cj4gLQkJCQlpZiAo
cCA+IGJ1ZikKPiAtCQkJCQkqcCsrID0gJywnOwo+ICsJCQkJaWYgKGZ0ZWxsKGZwKSAhPSAwKQo+
ICsJCQkJCWZwdXRjKCcsJywgZnApOwo+IAo+IC0JCQkJcCArPSBzcHJpbnRmKHAsICIldSIsIGkp
Owo+ICsJCQkJZnByaW50ZihmcCwgIiV1IiwgaSk7Cj4gCQkJfQo+IAkJfQo+IAo+ICsJCWZjbG9z
ZShmcCk7Cj4gKwo+IAkJZnczX2lwdF9ydWxlX2FkZGFyZyhyLCBmdzNfaGFzYml0KHRpbWUtPm1v
bnRoZGF5cywgMCksICItLW1vbnRoZGF5cyIsIGJ1Zik7Cj4gCX0KPiAKPiAJaWYgKHRpbWUtPndl
ZWtkYXlzICYgMHhGRSkKPiAJewo+IC0JCWZvciAoaSA9IDEsIHAgPSBidWY7IGkgPCA4OyBpKysp
Cj4gKwkJRklMRSAqZnAgPSBmbWVtb3BlbihidWYsIHNpemVvZihidWYpLCAidyIpOwo+ICsKPiAr
CQlmb3IgKGkgPSAxOyBpIDwgODsgaSsrKQo+IAkJewo+IAkJCWlmIChmdzNfaGFzYml0KHRpbWUt
PndlZWtkYXlzLCBpKSkKPiAJCQl7Cj4gLQkJCQlpZiAocCA+IGJ1ZikKPiAtCQkJCQkqcCsrID0g
JywnOwo+ICsJCQkJaWYgKGZ0ZWxsKGZwKSAhPSAwKQo+ICsJCQkJCWZwdXRjKCcsJywgZnApOwo+
IAo+IC0JCQkJcCArPSBzcHJpbnRmKHAsICIldSIsIGkpOwo+ICsJCQkJZnByaW50ZihmcCwgIiV1
IiwgaSk7Cj4gCQkJfQo+IAkJfQo+IAo+ICsJCWZjbG9zZShmcCk7Cj4gKwo+IAkJZnczX2lwdF9y
dWxlX2FkZGFyZyhyLCBmdzNfaGFzYml0KHRpbWUtPndlZWtkYXlzLCAwKSwgIi0td2Vla2RheXMi
LCBidWYpOwo+IAl9Cj4gfQo+IEBAIC0xMTQxLDkgKzExNTIsOSBAQCBmdzNfaXB0X3J1bGVfbWFy
ayhzdHJ1Y3QgZnczX2lwdF9ydWxlICpyLCBzdHJ1Y3QgZnczX21hcmsgKm1hcmspCj4gCQlyZXR1
cm47Cj4gCj4gCWlmIChtYXJrLT5tYXNrIDwgMHhGRkZGRkZGRikKPiAtCQlzcHJpbnRmKGJ1Ziwg
IjB4JXgvMHgleCIsIG1hcmstPm1hcmssIG1hcmstPm1hc2spOwo+ICsJCXNucHJpbnRmKGJ1Ziwg
c2l6ZW9mKGJ1ZiksICIweCV4LzB4JXgiLCBtYXJrLT5tYXJrLCBtYXJrLT5tYXNrKTsKPiAJZWxz
ZQo+IC0JCXNwcmludGYoYnVmLCAiMHgleCIsIG1hcmstPm1hcmspOwo+ICsJCXNucHJpbnRmKGJ1
Ziwgc2l6ZW9mKGJ1ZiksICIweCV4IiwgbWFyay0+bWFyayk7Cj4gCj4gCWZ3M19pcHRfcnVsZV9h
ZGRhcmcociwgZmFsc2UsICItbSIsICJtYXJrIik7Cj4gCWZ3M19pcHRfcnVsZV9hZGRhcmcociwg
bWFyay0+aW52ZXJ0LCAiLS1tYXJrIiwgYnVmKTsKPiBAQCAtMTE1Nyw3ICsxMTY4LDcgQEAgZncz
X2lwdF9ydWxlX2RzY3Aoc3RydWN0IGZ3M19pcHRfcnVsZSAqciwgc3RydWN0IGZ3M19kc2NwICpk
c2NwKQo+IAlpZiAoIWRzY3AgfHwgIWRzY3AtPnNldCkKPiAJCXJldHVybjsKPiAKPiAtCXNwcmlu
dGYoYnVmLCAiMHgleCIsIGRzY3AtPmRzY3ApOwo+ICsJc25wcmludGYoYnVmLCBzaXplb2YoYnVm
KSwgIjB4JXgiLCBkc2NwLT5kc2NwKTsKPiAKPiAJZnczX2lwdF9ydWxlX2FkZGFyZyhyLCBmYWxz
ZSwgIi1tIiwgImRzY3AiKTsKPiAJZnczX2lwdF9ydWxlX2FkZGFyZyhyLCBkc2NwLT5pbnZlcnQs
ICItLWRzY3AiLCBidWYpOwo+IGRpZmYgLS1naXQgYS9vcHRpb25zLmMgYi9vcHRpb25zLmMKPiBp
bmRleCA3ODcwMTQzYjAzZjU1Mjk3NDY2YTY1NDBlZmQzNzMwZDM4NzczZjQ5Li42ZGEwNmVmNWE3
YmU5YmRkZTA0MTJjYTAzOThmNjU0NzhkNDVhMWNmIDEwMDY0NAo+IC0tLSBhL29wdGlvbnMuYwo+
ICsrKyBiL29wdGlvbnMuYwo+IEBAIC05MzksNyArOTM5LDcgQEAgZnczX3BhcnNlX3NldG1hdGNo
KHZvaWQgKnB0ciwgY29uc3QgY2hhciAqdmFsLCBib29sIGlzX2xpc3QpCj4gCQlyZXR1cm4gZmFs
c2U7Cj4gCX0KPiAKPiAtCXN0cm5jcHkobS0+bmFtZSwgcCwgc2l6ZW9mKG0tPm5hbWUpIC0gMSk7
Cj4gKwlzdHJsY3B5KG0tPm5hbWUsIHAsIHNpemVvZihtLT5uYW1lKSk7Cj4gCj4gCWZvciAoaSA9
IDAsIHAgPSBzdHJ0b2soTlVMTCwgIiBcdCwiKTsKPiAJICAgICBpIDwgMyAmJiBwICE9IE5VTEw7
Cj4gQEAgLTk4Nyw3ICs5ODcsNyBAQCBmdzNfcGFyc2VfY3RoZWxwZXIodm9pZCAqcHRyLCBjb25z
dCBjaGFyICp2YWwsIGJvb2wgaXNfbGlzdCkKPiAJaWYgKCp2YWwpCj4gCXsKPiAJCW0uc2V0ID0g
dHJ1ZTsKPiAtCQlzdHJuY3B5KG0ubmFtZSwgdmFsLCBzaXplb2YobS5uYW1lKSAtIDEpOwo+ICsJ
CXN0cmxjcHkobS5uYW1lLCB2YWwsIHNpemVvZihtLm5hbWUpKTsKPiAJCXB1dF92YWx1ZShwdHIs
ICZtLCBzaXplb2YobSksIGlzX2xpc3QpOwo+IAkJcmV0dXJuIHRydWU7Cj4gCX0KPiBAQCAtMTIz
NywzOCArMTIzNyw0MiBAQCBmdzNfcGFyc2VfYmxvYl9vcHRpb25zKHZvaWQgKnMsIGNvbnN0IHN0
cnVjdCBmdzNfb3B0aW9uICpvcHRzLAo+IGNvbnN0IGNoYXIgKgo+IGZ3M19hZGRyZXNzX3RvX3N0
cmluZyhzdHJ1Y3QgZnczX2FkZHJlc3MgKmFkZHJlc3MsIGJvb2wgYWxsb3dfaW52ZXJ0LCBib29s
IGFzX2NpZHIpCj4gewo+IC0JY2hhciAqcCwgaXBbSU5FVDZfQUREUlNUUkxFTl07Cj4gKwljaGFy
IGlwW0lORVQ2X0FERFJTVFJMRU5dOwo+IAlzdGF0aWMgY2hhciBidWZbSU5FVDZfQUREUlNUUkxF
TiAqIDIgKyAyXTsKPiAKPiAtCXAgPSBidWY7Cj4gKwlGSUxFICpmcCA9IGZtZW1vcGVuKGJ1Ziwg
c2l6ZW9mKGJ1ZiksICJ3Iik7Cj4gCj4gCWlmIChhZGRyZXNzLT5pbnZlcnQgJiYgYWxsb3dfaW52
ZXJ0KQo+IC0JCXAgKz0gc3ByaW50ZihwLCAiISIpOwo+ICsJCWZwdXRjKCchJywgZnApOwo+IAo+
IAlpbmV0X250b3AoYWRkcmVzcy0+ZmFtaWx5ID09IEZXM19GQU1JTFlfVjQgPyBBRl9JTkVUIDog
QUZfSU5FVDYsCj4gCSAgICAgICAgICAmYWRkcmVzcy0+YWRkcmVzcy52NCwgaXAsIHNpemVvZihp
cCkpOwo+IAo+IC0JcCArPSBzcHJpbnRmKHAsICIlcyIsIGlwKTsKPiArCWZwdXRzKGlwLCBmcCk7
Cj4gCj4gCWlmIChhZGRyZXNzLT5yYW5nZSkKPiAJewo+IAkJaW5ldF9udG9wKGFkZHJlc3MtPmZh
bWlseSA9PSBGVzNfRkFNSUxZX1Y0ID8gQUZfSU5FVCA6IEFGX0lORVQ2LAo+IAkJICAgICAgICAg
ICZhZGRyZXNzLT5tYXNrLnY0LCBpcCwgc2l6ZW9mKGlwKSk7Cj4gCj4gLQkJcCArPSBzcHJpbnRm
KHAsICItJXMiLCBpcCk7Cj4gKwkJZnB1dGMoJy0nLCBmcCk7Cj4gKwkJZnB1dHMoaXAsIGZwKTsK
PiAJfQo+IAllbHNlIGlmICghYXNfY2lkcikKPiAJewo+IAkJaW5ldF9udG9wKGFkZHJlc3MtPmZh
bWlseSA9PSBGVzNfRkFNSUxZX1Y0ID8gQUZfSU5FVCA6IEFGX0lORVQ2LAo+IAkJICAgICAgICAg
ICZhZGRyZXNzLT5tYXNrLnY0LCBpcCwgc2l6ZW9mKGlwKSk7Cj4gCj4gLQkJcCArPSBzcHJpbnRm
KHAsICIvJXMiLCBpcCk7Cj4gKwkJZnB1dGMoJy8nLCBmcCk7Cj4gKwkJZnB1dHMoaXAsIGZwKTsK
PiAJfQo+IAllbHNlCj4gCXsKPiAtCQlwICs9IHNwcmludGYocCwgIi8ldSIsIGZ3M19uZXRtYXNr
MmJpdGxlbihhZGRyZXNzLT5mYW1pbHksCj4gLQkJICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJmFkZHJlc3MtPm1hc2sudjYpKTsKPiArCQlmcHJpbnRmKGZwLCAiLyV1
IiwgZnczX25ldG1hc2syYml0bGVuKGFkZHJlc3MtPmZhbWlseSwKPiArCQkgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICZhZGRyZXNzLT5tYXNrLnY2KSk7Cj4gCX0KPiAKPiAr
CWZjbG9zZShmcCk7Cj4gKwo+IAlyZXR1cm4gYnVmOwo+IH0KPiBkaWZmIC0tZ2l0IGEvcmVkaXJl
Y3RzLmMgYi9yZWRpcmVjdHMuYwo+IGluZGV4IGI5MjgyODdkZWViYjBmODQwN2FhNWVjYmM0ZGFi
NzViZGRhMDVjNjYuLmFiNmRiZGZlYzhhOTk1OTIwZGU2Njk0MTQzNTliZmEyYzczMWM4NjggMTAw
NjQ0Cj4gLS0tIGEvcmVkaXJlY3RzLmMKPiArKysgYi9yZWRpcmVjdHMuYwo+IEBAIC0xNTUsNyAr
MTU1LDcgQEAgcmVzb2x2ZV9kZXN0KHN0cnVjdCB1Y2lfZWxlbWVudCAqZSwgc3RydWN0IGZ3M19y
ZWRpcmVjdCAqcmVkaXIsCj4gCQkJaWYgKCFjb21wYXJlX2FkZHIoYWRkciwgJnJlZGlyLT5pcF9y
ZWRpcikpCj4gCQkJCWNvbnRpbnVlOwo+IAo+IC0JCQlzdHJuY3B5KHJlZGlyLT5kZXN0Lm5hbWUs
IHpvbmUtPm5hbWUsIHNpemVvZihyZWRpci0+ZGVzdC5uYW1lKSAtIDEpOwo+ICsJCQlzdHJsY3B5
KHJlZGlyLT5kZXN0Lm5hbWUsIHpvbmUtPm5hbWUsIHNpemVvZihyZWRpci0+ZGVzdC5uYW1lKSk7
Cj4gCQkJcmVkaXItPmRlc3Quc2V0ID0gdHJ1ZTsKPiAJCQlyZWRpci0+X2Rlc3QgPSB6b25lOwo+
IAo+IEBAIC00NjUsNyArNDY1LDcgQEAgc2V0X3JlZGlyZWN0KHN0cnVjdCBmdzNfaXB0X3J1bGUg
KnIsIHN0cnVjdCBmdzNfcG9ydCAqcG9ydCkKPiAJaWYgKHBvcnQgJiYgcG9ydC0+c2V0KQo+IAl7
Cj4gCQlpZiAocG9ydC0+cG9ydF9taW4gPT0gcG9ydC0+cG9ydF9tYXgpCj4gLQkJCXNwcmludGYo
YnVmLCAiJXUiLCBwb3J0LT5wb3J0X21pbik7Cj4gKwkJCXNucHJpbnRmKGJ1Ziwgc2l6ZW9mKGJ1
ZiksICIldSIsIHBvcnQtPnBvcnRfbWluKTsKPiAJCWVsc2UKPiAJCQlzbnByaW50ZihidWYsIHNp
emVvZihidWYpLCAiJXUtJXUiLCBwb3J0LT5wb3J0X21pbiwgcG9ydC0+cG9ydF9tYXgpOwo+IAo+
IEBAIC00NzcsMjQgKzQ3NywyOCBAQCBzdGF0aWMgdm9pZAo+IHNldF9zbmF0X2RuYXQoc3RydWN0
IGZ3M19pcHRfcnVsZSAqciwgZW51bSBmdzNfZmxhZyB0YXJnZXQsCj4gICAgICAgICAgICAgICBz
dHJ1Y3QgZnczX2FkZHJlc3MgKmFkZHIsIHN0cnVjdCBmdzNfcG9ydCAqcG9ydCkKPiB7Cj4gKwlj
aGFyIGlwW0lORVRfQUREUlNUUkxFTl07Cj4gCWNoYXIgYnVmW3NpemVvZigiMjU1LjI1NS4yNTUu
MjU1OjY1NTM1LTY1NTM1XDAiKV07Cj4gCj4gLQlidWZbMF0gPSAnXDAnOwo+ICsJRklMRSAqZnAg
PSBmbWVtb3BlbihidWYsIHNpemVvZihidWYpLCAidyIpOwo+IAo+IAlpZiAoYWRkciAmJiBhZGRy
LT5zZXQpCj4gCXsKPiAtCQlpbmV0X250b3AoQUZfSU5FVCwgJmFkZHItPmFkZHJlc3MudjQsIGJ1
Ziwgc2l6ZW9mKGJ1ZikpOwo+ICsJCWluZXRfbnRvcChBRl9JTkVULCAmYWRkci0+YWRkcmVzcy52
NCwgaXAsIHNpemVvZihpcCkpOwo+ICsJCWZwdXRzKGlwLCBmcCk7Cj4gCX0KPiAKPiAJaWYgKHBv
cnQgJiYgcG9ydC0+c2V0KQo+IAl7Cj4gCQlpZiAocG9ydC0+cG9ydF9taW4gPT0gcG9ydC0+cG9y
dF9tYXgpCj4gLQkJCXNwcmludGYoYnVmICsgc3RybGVuKGJ1ZiksICI6JXUiLCBwb3J0LT5wb3J0
X21pbik7Cj4gKwkJCWZwcmludGYoZnAsICI6JXUiLCBwb3J0LT5wb3J0X21pbik7Cj4gCQllbHNl
Cj4gLQkJCXNwcmludGYoYnVmICsgc3RybGVuKGJ1ZiksICI6JXUtJXUiLAo+ICsJCQlmcHJpbnRm
KGZwLCAiOiV1LSV1IiwKPiAJCQkgICAgICAgIHBvcnQtPnBvcnRfbWluLCBwb3J0LT5wb3J0X21h
eCk7Cj4gCX0KPiAKPiArCWZjbG9zZShmcCk7Cj4gKwo+IAlpZiAodGFyZ2V0ID09IEZXM19GTEFH
X0ROQVQpCj4gCXsKPiAJCWZ3M19pcHRfcnVsZV90YXJnZXQociwgIkROQVQiKTsKPiBkaWZmIC0t
Z2l0IGEvcnVsZXMuYyBiL3J1bGVzLmMKPiBpbmRleCA1MjMwYTg2MjNmYTg5N2YxMTExY2I3Zjdl
NzAxMmYwNmM0YWNiNTAzLi5lZDJlZmFkYzJlOWQ2YTE1ODk4ZmI2YjIyMmI5NjI3OGY3YzNiZTgx
IDEwMDY0NAo+IC0tLSBhL3J1bGVzLmMKPiArKysgYi9ydWxlcy5jCj4gQEAgLTM2MCwxNCArMzYw
LDE0IEBAIHN0YXRpYyB2b2lkIHNldF90YXJnZXQoc3RydWN0IGZ3M19pcHRfcnVsZSAqciwgc3Ry
dWN0IGZ3M19ydWxlICpydWxlKQo+IAljYXNlIEZXM19GTEFHX01BUks6Cj4gCQluYW1lID0gcnVs
ZS0+c2V0X21hcmsuc2V0ID8gIi0tc2V0LW1hcmsiIDogIi0tc2V0LXhtYXJrIjsKPiAJCW1hcmsg
PSBydWxlLT5zZXRfbWFyay5zZXQgPyAmcnVsZS0+c2V0X21hcmsgOiAmcnVsZS0+c2V0X3htYXJr
Owo+IC0JCXNwcmludGYoYnVmLCAiMHgleC8weCV4IiwgbWFyay0+bWFyaywgbWFyay0+bWFzayk7
Cj4gKwkJc25wcmludGYoYnVmLCBzaXplb2YoYnVmKSwgIjB4JXgvMHgleCIsIG1hcmstPm1hcmss
IG1hcmstPm1hc2spOwo+IAo+IAkJZnczX2lwdF9ydWxlX3RhcmdldChyLCAiTUFSSyIpOwo+IAkJ
ZnczX2lwdF9ydWxlX2FkZGFyZyhyLCBmYWxzZSwgbmFtZSwgYnVmKTsKPiAJCXJldHVybjsKPiAK
PiAJY2FzZSBGVzNfRkxBR19EU0NQOgo+IC0JCXNwcmludGYoYnVmLCAiMHgleCIsIHJ1bGUtPnNl
dF9kc2NwLmRzY3ApOwo+ICsJCXNucHJpbnRmKGJ1Ziwgc2l6ZW9mKGJ1ZiksICIweCV4IiwgcnVs
ZS0+c2V0X2RzY3AuZHNjcCk7Cj4gCj4gCQlmdzNfaXB0X3J1bGVfdGFyZ2V0KHIsICJEU0NQIik7
Cj4gCQlmdzNfaXB0X3J1bGVfYWRkYXJnKHIsIGZhbHNlLCAiLS1zZXQtZHNjcCIsIGJ1Zik7Cj4g
ZGlmZiAtLWdpdCBhL3NuYXRzLmMgYi9zbmF0cy5jCj4gaW5kZXggMWQ3OGY5M2YzMDY2MmY0NzVk
MjRiZDU4MTdhMDNjMWIxMDZiMDJlYy4uNjQ0OWNhODc3Mjg0YjkwOTJkODRmNzczZjEwMzM5YmY5
NmU3N2FiYiAxMDA2NDQKPiAtLS0gYS9zbmF0cy5jCj4gKysrIGIvc25hdHMuYwo+IEBAIC0yNjUs
MjQgKzI2NSwyNiBAQCBzdGF0aWMgdm9pZAo+IHNldF90YXJnZXQoc3RydWN0IGZ3M19pcHRfcnVs
ZSAqciwgc3RydWN0IGZ3M19zbmF0ICpzbmF0LAo+ICAgICAgICAgICAgc3RydWN0IGZ3M19wcm90
b2NvbCAqcHJvdG8pCj4gewo+IC0JY2hhciBidWZbc2l6ZW9mKCIyNTUuMjU1LjI1NS4yNTU6NjU1
MzUtNjU1MzVcMCIpXTsKPiAtCj4gCWlmIChzbmF0LT50YXJnZXQgPT0gRlczX0ZMQUdfU05BVCkK
PiAJewo+IC0JCWJ1ZlswXSA9ICdcMCc7Cj4gKwkJY2hhciBpcFtJTkVUX0FERFJTVFJMRU5dOwo+
ICsJCWNoYXIgYnVmW3NpemVvZigiMjU1LjI1NS4yNTUuMjU1OjY1NTM1LTY1NTM1XDAiKV07Cj4g
Kwo+ICsJCUZJTEUgKmZwID0gZm1lbW9wZW4oYnVmLCBzaXplb2YoYnVmKSwgInciKTsKPiAKPiAJ
CWlmIChzbmF0LT5pcF9zbmF0LnNldCkKPiAJCXsKPiAtCQkJaW5ldF9udG9wKEFGX0lORVQsICZz
bmF0LT5pcF9zbmF0LmFkZHJlc3MudjQsIGJ1Ziwgc2l6ZW9mKGJ1ZikpOwo+ICsJCQlpbmV0X250
b3AoQUZfSU5FVCwgJnNuYXQtPmlwX3NuYXQuYWRkcmVzcy52NCwgaXAsIHNpemVvZihpcCkpOwo+
ICsJCQlmcHV0cyhpcCwgZnApOwo+IAkJfQo+IAo+IAkJaWYgKHNuYXQtPnBvcnRfc25hdC5zZXQg
JiYgcHJvdG8gJiYgIXByb3RvLT5hbnkgJiYKPiAJCSAgICAocHJvdG8tPnByb3RvY29sID09IDYg
fHwgcHJvdG8tPnByb3RvY29sID09IDE3IHx8IHByb3RvLT5wcm90b2NvbCA9PSAxKSkKPiAJCXsK
PiAJCQlpZiAoc25hdC0+cG9ydF9zbmF0LnBvcnRfbWluID09IHNuYXQtPnBvcnRfc25hdC5wb3J0
X21heCkKPiAtCQkJCXNwcmludGYoYnVmICsgc3RybGVuKGJ1ZiksICI6JXUiLCBzbmF0LT5wb3J0
X3NuYXQucG9ydF9taW4pOwo+ICsJCQkJZnByaW50ZihmcCwgIjoldSIsIHNuYXQtPnBvcnRfc25h
dC5wb3J0X21pbik7Cj4gCQkJZWxzZQo+IC0JCQkJc3ByaW50ZihidWYgKyBzdHJsZW4oYnVmKSwg
IjoldS0ldSIsCj4gKwkJCQlmcHJpbnRmKGZwLCAiOiV1LSV1IiwKPiAJCQkJCQlzbmF0LT5wb3J0
X3NuYXQucG9ydF9taW4sIHNuYXQtPnBvcnRfc25hdC5wb3J0X21heCk7Cj4gCj4gCQkJaWYgKHNu
YXQtPmNvbm5saW1pdF9wb3J0cykgewo+IEBAIC0yOTYsNiArMjk4LDggQEAgc2V0X3RhcmdldChz
dHJ1Y3QgZnczX2lwdF9ydWxlICpyLCBzdHJ1Y3QgZnczX3NuYXQgKnNuYXQsCj4gCQkJfQo+IAkJ
fQo+IAo+ICsJCWZjbG9zZShmcCk7Cj4gKwo+IAkJZnczX2lwdF9ydWxlX3RhcmdldChyLCAiU05B
VCIpOwo+IAkJZnczX2lwdF9ydWxlX2FkZGFyZyhyLCBmYWxzZSwgIi0tdG8tc291cmNlIiwgYnVm
KTsKPiAJfQo+IGRpZmYgLS1naXQgYS91dGlscy5jIGIvdXRpbHMuYwo+IGluZGV4IGRhNjU2MzI0
M2MwNjczZjgzOTNjMTZmNjUxMTZhZWI4OGJhMGVhNmMuLmRkYzBmMzlhZjFlMmE1Y2ZlNjkwNGNm
OTdkYzE3Zjc2ZjlhMjMzZWYgMTAwNjQ0Cj4gLS0tIGEvdXRpbHMuYwo+ICsrKyBiL3V0aWxzLmMK
PiBAQCAtMTkxLDggKzE5MSw3IEBAIGZ3M19maW5kX2NvbW1hbmQoY29uc3QgY2hhciAqY21kKQo+
IAkJaWYgKChwbGVuICsgY2xlbikgPj0gc2l6ZW9mKHBhdGgpKQo+IAkJCWNvbnRpbnVlOwo+IAo+
IC0JCXN0cm5jcHkocGF0aCwgc2VhcmNoLCBwbGVuKTsKPiAtCQlzcHJpbnRmKHBhdGggKyBwbGVu
LCAiLyVzIiwgY21kKTsKPiArCQlzbnByaW50ZihwYXRoLCBzaXplb2YocGF0aCksICIlLipzLyVz
IiwgcGxlbiwgc2VhcmNoLCBjbWQpOwo+IAo+IAkJaWYgKCFzdGF0KHBhdGgsICZzKSAmJiBTX0lT
UkVHKHMuc3RfbW9kZSkpCj4gCQkJcmV0dXJuIHBhdGg7Cj4gQEAgLTQ0OSwxMyArNDQ4LDEzIEBA
IHdyaXRlX2RlZmF1bHRzX3VjaShzdHJ1Y3QgdWNpX2NvbnRleHQgKmN0eCwgc3RydWN0IGZ3M19k
ZWZhdWx0cyAqZCwKPiAJcHRyLnZhbHVlICA9IGZ3M19mbGFnX25hbWVzW2QtPnBvbGljeV9mb3J3
YXJkXTsKPiAJdWNpX3NldChjdHgsICZwdHIpOwo+IAo+IC0Jc3ByaW50ZihidWYsICIweCV4Iiwg
ZC0+ZmxhZ3NbMF0pOwo+ICsJc25wcmludGYoYnVmLCBzaXplb2YoYnVmKSwgIjB4JXgiLCBkLT5m
bGFnc1swXSk7Cj4gCXB0ci5vICAgICAgPSBOVUxMOwo+IAlwdHIub3B0aW9uID0gIl9fZmxhZ3Nf
djQiOwo+IAlwdHIudmFsdWUgID0gYnVmOwo+IAl1Y2lfc2V0KGN0eCwgJnB0cik7Cj4gCj4gLQlz
cHJpbnRmKGJ1ZiwgIjB4JXgiLCBkLT5mbGFnc1sxXSk7Cj4gKwlzbnByaW50ZihidWYsIHNpemVv
ZihidWYpLCAiMHgleCIsIGQtPmZsYWdzWzFdKTsKPiAJcHRyLm8gICAgICA9IE5VTEw7Cj4gCXB0
ci5vcHRpb24gPSAiX19mbGFnc192NiI7Cj4gCXB0ci52YWx1ZSAgPSBidWY7Cj4gQEAgLTYxMiwx
MyArNjExLDEzIEBAIHdyaXRlX3pvbmVfdWNpKHN0cnVjdCB1Y2lfY29udGV4dCAqY3R4LCBzdHJ1
Y3QgZnczX3pvbmUgKnosCj4gCQl1Y2lfc2V0KGN0eCwgJnB0cik7Cj4gCX0KPiAKPiAtCXNwcmlu
dGYoYnVmLCAiMHgleCIsIHotPmZsYWdzWzBdKTsKPiArCXNucHJpbnRmKGJ1Ziwgc2l6ZW9mKGJ1
ZiksICIweCV4Iiwgei0+ZmxhZ3NbMF0pOwo+IAlwdHIubyAgICAgID0gTlVMTDsKPiAJcHRyLm9w
dGlvbiA9ICJfX2ZsYWdzX3Y0IjsKPiAJcHRyLnZhbHVlICA9IGJ1ZjsKPiAJdWNpX3NldChjdHgs
ICZwdHIpOwo+IAo+IC0Jc3ByaW50ZihidWYsICIweCV4Iiwgei0+ZmxhZ3NbMV0pOwo+ICsJc25w
cmludGYoYnVmLCBzaXplb2YoYnVmKSwgIjB4JXgiLCB6LT5mbGFnc1sxXSk7Cj4gCXB0ci5vICAg
ICAgPSBOVUxMOwo+IAlwdHIub3B0aW9uID0gIl9fZmxhZ3NfdjYiOwo+IAlwdHIudmFsdWUgID0g
YnVmOwo+IEBAIC02NjAsNyArNjU5LDcgQEAgd3JpdGVfaXBzZXRfdWNpKHN0cnVjdCB1Y2lfY29u
dGV4dCAqY3R4LCBzdHJ1Y3QgZnczX2lwc2V0ICpzLAo+IAo+IAlsaXN0X2Zvcl9lYWNoX2VudHJ5
KHR5cGUsICZzLT5kYXRhdHlwZXMsIGxpc3QpCj4gCXsKPiAtCQlzcHJpbnRmKGJ1ZiwgIiVzXyVz
IiwgdHlwZS0+ZGlyLCBmdzNfaXBzZXRfdHlwZV9uYW1lc1t0eXBlLT50eXBlXSk7Cj4gKwkJc25w
cmludGYoYnVmLCBzaXplb2YoYnVmKSwgIiVzXyVzIiwgdHlwZS0+ZGlyLCBmdzNfaXBzZXRfdHlw
ZV9uYW1lc1t0eXBlLT50eXBlXSk7Cj4gCQlwdHIubyAgICAgID0gTlVMTDsKPiAJCXB0ci5vcHRp
b24gPSAibWF0Y2giOwo+IAkJcHRyLnZhbHVlICA9IGJ1ZjsKPiBAQCAtNjc3LDcgKzY3Niw3IEBA
IHdyaXRlX2lwc2V0X3VjaShzdHJ1Y3QgdWNpX2NvbnRleHQgKmN0eCwgc3RydWN0IGZ3M19pcHNl
dCAqcywKPiAKPiAJaWYgKHMtPnBvcnRyYW5nZS5zZXQpCj4gCXsKPiAtCQlzcHJpbnRmKGJ1Ziwg
IiV1LSV1Iiwgcy0+cG9ydHJhbmdlLnBvcnRfbWluLCBzLT5wb3J0cmFuZ2UucG9ydF9tYXgpOwo+
ICsJCXNucHJpbnRmKGJ1Ziwgc2l6ZW9mKGJ1ZiksICIldS0ldSIsIHMtPnBvcnRyYW5nZS5wb3J0
X21pbiwgcy0+cG9ydHJhbmdlLnBvcnRfbWF4KTsKPiAJCXB0ci5vICAgICAgPSBOVUxMOwo+IAkJ
cHRyLm9wdGlvbiA9ICJwb3J0cmFuZ2UiOwo+IAkJcHRyLnZhbHVlICA9IGJ1ZjsKPiBAQCAtMTAy
MSw3ICsxMDIwLDcgQEAgZnczX2NoZWNrX2xvb3BiYWNrX2Rldihjb25zdCBjaGFyICpuYW1lKQo+
IAkJcmV0dXJuIGZhbHNlOwo+IAo+IAltZW1zZXQoJmlmciwgMCwgc2l6ZW9mKGlmcikpOwo+IC0J
c3RybmNweShpZnIuaWZyX25hbWUsIG5hbWUsIHNpemVvZihpZnIuaWZyX25hbWUpIC0gMSk7Cj4g
KwlzdHJsY3B5KGlmci5pZnJfbmFtZSwgbmFtZSwgc2l6ZW9mKGlmci5pZnJfbmFtZSkpOwo+IAo+
IAlpZiAoaW9jdGwocywgU0lPQ0dJRkZMQUdTLCAmaWZyKSA+PSAwKSB7Cj4gCQlpZiAoaWZyLmlm
cl9mbGFncyAmIElGRl9MT09QQkFDSykKPiBkaWZmIC0tZ2l0IGEvdXRpbHMuaCBiL3V0aWxzLmgK
PiBpbmRleCAyNTRiZWE0NWQ0OGIyMDdiYTQ2YTNjNDI3ZDQ3ZDMyNzgxNDE5NWVlLi5iNzkwYjI3
OWFhMDQxMzM0MzVhNWZkMzU5ZDQyMzExNmZkNjMzN2M3IDEwMDY0NAo+IC0tLSBhL3V0aWxzLmgK
PiArKysgYi91dGlscy5oCj4gQEAgLTg5LDYgKzg5LDEyIEBAIHZvaWQgaW5mbyhjb25zdCBjaGFy
ICpmb3JtYXQsIC4uLikKPiAgICAgKCEoZmxhZ3MgJiAoKDE8PEZXM19UQUJMRV9GSUxURVIpfCgx
PDxGVzNfVEFCTEVfTkFUKXwgICAgICAgICAgICAgICAgICBcCj4gICAgICAgICAgICAgICAgICgx
PDxGVzNfVEFCTEVfTUFOR0xFKXwoMTw8RlczX1RBQkxFX1JBVykpKSkKPiAKPiArI2lmIGRlZmlu
ZWQoX19HTElCQ19fKQo+ICsvKiBlbXVsYXRpbmcgc3RybGNhdCgpIHdvdWxkbid0IGJlIG5lYXJs
eSBhcyBlYXN5Li4uICovCj4gKyNkZWZpbmUgc3RybGNweShkLCBzLCBsKSBcCj4gKwkodm9pZClz
cHJpbnRmKGQsIGwsICIlcyIsIHMpCj4gKyNlbmRpZgo+ICsKPiAKPiB2b2lkICogZnczX2FsbG9j
KHNpemVfdCBzaXplKTsKPiBjaGFyICogZnczX3N0cmR1cChjb25zdCBjaGFyICpzKTsKPiBkaWZm
IC0tZ2l0IGEveHRhYmxlcy0xMC5oIGIveHRhYmxlcy0xMC5oCj4gaW5kZXggN2VhNTMxNWE0NWE1
NTUxZjE1MGU2MGQ2M2U5YmM2YjkyY2FmNjgzMC4uYzJjOTc1MWU0NDNmYzAxNDVhY2RkYmE0YjVj
NWU2NmIyOTMzYjVjYyAxMDA2NDQKPiAtLS0gYS94dGFibGVzLTEwLmgKPiArKysgYi94dGFibGVz
LTEwLmgKPiBAQCAtNDYsOSArNDYsOSBAQCBzdGF0aWMgaW5saW5lIHZvaWQKPiBmdzNfeHRfc2V0
X21hdGNoX25hbWUoc3RydWN0IHh0YWJsZXNfbWF0Y2ggKm0pCj4gewo+ICAgICBpZiAobS0+cmVh
bF9uYW1lKQo+IC0gICAgICAgIHN0cmNweShtLT5tLT51LnVzZXIubmFtZSwgbS0+cmVhbF9uYW1l
KTsKPiArICAgICAgICBzdHJsY3B5KG0tPm0tPnUudXNlci5uYW1lLCBtLT5yZWFsX25hbWUsIHNp
emVvZihtLT5tLT51LnVzZXIubmFtZSkpOwo+ICAgICBlbHNlCj4gLSAgICAgICAgc3RyY3B5KG0t
Pm0tPnUudXNlci5uYW1lLCBtLT5uYW1lKTsKPiArICAgICAgICBzdHJsY3B5KG0tPm0tPnUudXNl
ci5uYW1lLCBtLT5uYW1lLCBzaXplb2YobS0+bS0+dS51c2VyLm5hbWUpKTsKPiB9Cj4gCj4gc3Rh
dGljIGlubGluZSBib29sCj4gQEAgLTkzLDkgKzkzLDkgQEAgc3RhdGljIGlubGluZSB2b2lkCj4g
ZnczX3h0X3NldF90YXJnZXRfbmFtZShzdHJ1Y3QgeHRhYmxlc190YXJnZXQgKnQsIGNvbnN0IGNo
YXIgKm5hbWUpCj4gewo+ICAgICBpZiAodC0+cmVhbF9uYW1lKQo+IC0gICAgICAgIHN0cmNweSh0
LT50LT51LnVzZXIubmFtZSwgdC0+cmVhbF9uYW1lKTsKPiArICAgICAgICBzdHJsY3B5KHQtPnQt
PnUudXNlci5uYW1lLCB0LT5yZWFsX25hbWUsIHNpemVvZih0LT50LT51LnVzZXIubmFtZSkpOwo+
ICAgICBlbHNlCj4gLSAgICAgICAgc3RyY3B5KHQtPnQtPnUudXNlci5uYW1lLCBuYW1lKTsKPiAr
ICAgICAgICBzdHJsY3B5KHQtPnQtPnUudXNlci5uYW1lLCBuYW1lLCBzaXplb2YodC0+dC0+dS51
c2VyLm5hbWUpKTsKPiB9Cj4gCj4gc3RhdGljIGlubGluZSBib29sCj4gZGlmZiAtLWdpdCBhL3h0
YWJsZXMtNS5oIGIveHRhYmxlcy01LmgKPiBpbmRleCA5ZDExY2FlY2NkZjNhMGZhODA4YThmOGZi
MGJkMzFiM2U5YmZkYzdjLi5mYWI0OGRkZDQwMjk1MTU3MmQ1ZDQwOTcwMTFhYzY4ZTRlMmUwM2Fm
IDEwMDY0NAo+IC0tLSBhL3h0YWJsZXMtNS5oCj4gKysrIGIveHRhYmxlcy01LmgKPiBAQCAtMzYs
NyArMzYsNyBAQCBmdzNfeHRfZ2V0X21hdGNoX25hbWUoc3RydWN0IHh0YWJsZXNfbWF0Y2ggKm0p
Cj4gc3RhdGljIGlubGluZSB2b2lkCj4gZnczX3h0X3NldF9tYXRjaF9uYW1lKHN0cnVjdCB4dGFi
bGVzX21hdGNoICptKQo+IHsKPiAtICAgIHN0cmNweShtLT5tLT51LnVzZXIubmFtZSwgbS0+bmFt
ZSk7Cj4gKyAgICBzdHJsY3B5KG0tPm0tPnUudXNlci5uYW1lLCBtLT5uYW1lLCBzaXplb2YobS0+
bS0+dS51c2VyLm5hbWUpKTsKPiB9Cj4gCj4gc3RhdGljIGlubGluZSBib29sCj4gQEAgLTY3LDcg
KzY3LDcgQEAgZnczX3h0X2dldF90YXJnZXRfbmFtZShzdHJ1Y3QgeHRhYmxlc190YXJnZXQgKnQp
Cj4gc3RhdGljIGlubGluZSB2b2lkCj4gZnczX3h0X3NldF90YXJnZXRfbmFtZShzdHJ1Y3QgeHRh
Ymxlc190YXJnZXQgKnQsIGNvbnN0IGNoYXIgKm5hbWUpCj4gewo+IC0gICAgc3RyY3B5KHQtPnQt
PnUudXNlci5uYW1lLCBuYW1lKTsKPiArICAgIHN0cmxjcHkodC0+dC0+dS51c2VyLm5hbWUsIG5h
bWUsIHNpemVvZih0LT50LT51LnVzZXIubmFtZSkpOwo+IH0KPiAKPiBzdGF0aWMgaW5saW5lIGJv
b2wKPiAtLSAKPiAyLjE3LjIKPiAKPiAKPiBfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwo+IG9wZW53cnQtZGV2ZWwgbWFpbGluZyBsaXN0Cj4gb3BlbndydC1k
ZXZlbEBsaXN0cy5vcGVud3J0Lm9yZwo+IGh0dHBzOi8vbGlzdHMub3BlbndydC5vcmcvbWFpbG1h
bi9saXN0aW5mby9vcGVud3J0LWRldmVsCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18Kb3BlbndydC1kZXZlbCBtYWlsaW5nIGxpc3QKb3BlbndydC1kZXZl
bEBsaXN0cy5vcGVud3J0Lm9yZwpodHRwczovL2xpc3RzLm9wZW53cnQub3JnL21haWxtYW4vbGlz
dGluZm8vb3BlbndydC1kZXZlbAo=
